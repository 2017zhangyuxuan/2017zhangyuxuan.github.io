<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Function Objects ç›¸å…³é—®é¢˜è®°å½•</title>
    <link href="/2023/11/27/2023-11/2023-11-27%20Function%20Objects%20%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    <url>/2023/11/27/2023-11/2023-11-27%20Function%20Objects%20%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>æ­¤å‰åœ¨å­¦ä¹ ç®€å•çº¿ç¨‹æ± æ—¶ç”¨åˆ°äº† <code>std::bind</code> ï¼Œæ‰€ä»¥ä¹Ÿå­¦ä¹ äº†ç›¸å…³å†…å®¹ï¼Œå…¶ä¸­ä¹Ÿé‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œç‰¹æ­¤è®°å½•ä¸€ä¸‹ã€‚åŸæœ¬æ˜¯æ‰“ç®—æ”¾åœ¨â€œçº¿ç¨‹æ± â€é‚£ç¯‡æ–‡ç« é‡Œä½œä¸ºä¸€ä¸ªå°ç« èŠ‚ï¼Œåæ¥æƒ³æƒ³è¿™é‡Œé‡åˆ°çš„é—®é¢˜ä¸åŸæ–‡å…³ç³»å¹¶ä¸æ˜¯å¾ˆå¯†åˆ‡ï¼Œæ‰€ä»¥è¿˜æ˜¯å•ç‹¬æ‹†åˆ†å‡ºæ¥å†™ä¸ªå°æ–‡ç« ã€‚</p><h1 id="function-objects"><a class="markdownIt-Anchor" href="#function-objects"></a> Function Objects</h1><p>Function objects çš„å®šä¹‰æ¦‚å¿µå¯ä»¥ç›´æ¥å‚è€ƒ <a href="https://en.cppreference.com/w/cpp/utility/functional%EF%BC%8C%E7%AE%80%E5%8D%95%E7%BF%BB%E8%AF%91%E4%B8%80%E4%B8%8B%EF%BC%8C%E5%B0%B1%E6%98%AF%E5%8F%AF%E4%BB%A5%E8%B0%83%E7%94%A8">https://en.cppreference.com/w/cpp/utility/functionalï¼Œç®€å•ç¿»è¯‘ä¸€ä¸‹ï¼Œå°±æ˜¯å¯ä»¥è°ƒç”¨</a> operator() çš„å¯¹è±¡è¢«è§†ä½œæ˜¯ function objectsï¼Œè€Œç›¸å…³è”çš„å‡½æ•°è°ƒç”¨<code>INVOKE</code>æ–‡æ¡£ä¸Šä¹Ÿç»™å‡ºäº†è¯¦ç»†è¯´æ˜ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202311271133288.png" alt="Function invoaction" /></p><p>è¿™é‡Œç®€å•æ€»ç»“ä¸€ä¸‹ï¼Œå°±æ˜¯å‡½æ•°è°ƒç”¨æ“ä½œå¯ä»¥è§†ä¸º <code>INVOKE(f, t1, t2, ... , tN)</code>ï¼Œå¯ä»¥æ€»ç»“ä¸ºå¦‚ä¸‹ä¸‰ç§æƒ…å†µï¼š</p><ul><li>å¦‚æœ <code>f</code>æ˜¯ä¸€ä¸ªæŒ‡å‘ <code>T</code> ç±»æˆå‘˜å‡½æ•°çš„æŒ‡é’ˆï¼Œé‚£ä¹ˆä¼šæ ¹æ® <code>t1</code> çš„ç±»å‹ä¸åŒï¼ˆç±»å‹ä¸ºTæˆ–æ˜¯Tçš„æ´¾ç”Ÿç±»ï¼Œå¯¹è±¡å¼•ç”¨ï¼Œå¯¹è±¡æŒ‡é’ˆï¼‰ï¼Œé‡‡å–å¯¹åº”çš„å‡½æ•°è°ƒç”¨æ–¹å¼ï¼ˆ<strong>æ³¨æ„ï¼Œè¿™é‡Œçš„æŒ‡é’ˆä¹Ÿå¯ä»¥æ˜¯æ™ºèƒ½æŒ‡é’ˆ</strong>ï¼‰</li><li>å¦‚æœ <code>f</code>æ˜¯ä¸€ä¸ªæŒ‡å‘ <code>T</code> ç±»çš„æˆå‘˜å˜é‡ï¼Œå¹¶ä¸” <code>N</code> ä¸º1ï¼Œåˆ™ç­‰åŒäºè¦å»è®¿é—®è¿™ä¸ªç±»çš„æˆå‘˜å˜é‡ï¼ˆä¹Ÿä¼šæ ¹æ®<code>t1</code>ç±»å‹åšå‡ºé€‚é…çš„è°ƒç”¨ï¼‰</li><li>å¦‚æœä¸æ˜¯ä¸Šè¿°ä¸¤ç§æƒ…å†µï¼Œåˆ™ç­‰åŒäº <code>f(t1, t2, ..., tN)</code>ï¼Œè¿›è¡Œä¸€æ¬¡å‡½æ•°è°ƒç”¨ï¼Œè¿™é‡Œçš„ <code>f</code> å°±æ˜¯ä¸€ä¸ª FunctionObject</li></ul><h1 id="é—®é¢˜è®°å½•"><a class="markdownIt-Anchor" href="#é—®é¢˜è®°å½•"></a> é—®é¢˜è®°å½•</h1><p>ç„¶ååœ¨çœ‹ mem_fn , bind, function ç›¸å…³å®ä¾‹ä»£ç æ—¶ï¼Œå¯¹ä¸€äº›ä¼ å‚æ–¹å¼å¾ˆç–‘æƒ‘ï¼Œé€šè¿‡ç”¨ä¸åŒçš„æ–¹å¼æ¥ä¼ å…¥å¯¹è±¡ã€æŒ‡é’ˆã€å¼•ç”¨ï¼Œä¼šæœ‰ä¸åŒçš„è¾“å‡ºè¡¨ç°ï¼Œå…·ä½“ç¤ºä¾‹ä»£ç å’Œè¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼Œä¹Ÿå¯ä»¥ç›´æ¥çœ‹è¿™ä¸ªé“¾æ¥ <a href="https://compiler-explorer.com/z/n81o8bssP">https://compiler-explorer.com/z/n81o8bssP</a> ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;functional&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Foo</span></span><br><span class="hljs-class">&#123;</span><br>    <span class="hljs-built_in">Foo</span>(<span class="hljs-keyword">int</span> num) : <span class="hljs-built_in">num_</span>(num) &#123;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">print_add</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span>   </span>&#123; num_ += i;&#125;<br>    <span class="hljs-keyword">int</span> num_;<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  <br><span class="hljs-function">Foo <span class="hljs-title">ff</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span>;<br>    <span class="hljs-keyword">auto</span> f1 = std::<span class="hljs-built_in">mem_fn</span>(&amp;Foo::print_add);<br>    <span class="hljs-built_in">f1</span>(ff, <span class="hljs-number">1</span>);<br>    cout &lt;&lt; <span class="hljs-string">&quot;mem_fn pass ff, after exec, ff num : &quot;</span> &lt;&lt; ff.num_ &lt;&lt; endl;<br>    <span class="hljs-built_in">f1</span>(&amp;ff, <span class="hljs-number">1</span>);<br>    cout &lt;&lt; <span class="hljs-string">&quot;mem_fn pass &amp;ff, after exec, ff num : &quot;</span> &lt;&lt; ff.num_ &lt;&lt; endl;<br><br><br>    <span class="hljs-keyword">auto</span> f2 = std::<span class="hljs-built_in">bind</span>(&amp;Foo::print_add, placeholders::_1, placeholders::_2);<br>    <span class="hljs-built_in">f2</span>(ff, <span class="hljs-number">1</span>);<br>    cout &lt;&lt; <span class="hljs-string">&quot;bind use placeholder_1 to pass ff, after exec, ff num : &quot;</span> &lt;&lt; ff.num_ &lt;&lt; endl;<br><br>    std::function&lt;<span class="hljs-built_in"><span class="hljs-keyword">void</span></span>(<span class="hljs-keyword">int</span>)&gt; f3 = std::<span class="hljs-built_in">bind</span>(&amp;Foo::print_add, ff, placeholders::_1);<br>    <span class="hljs-built_in">f3</span>(<span class="hljs-number">1</span>);<br>    cout &lt;&lt; <span class="hljs-string">&quot;bind pass ff, after exec, ff num : &quot;</span> &lt;&lt; ff.num_ &lt;&lt; endl;<br><br>    std::function&lt;<span class="hljs-built_in"><span class="hljs-keyword">void</span></span>(<span class="hljs-keyword">int</span>)&gt; f4 = std::<span class="hljs-built_in">bind</span>(&amp;Foo::print_add, &amp;ff, placeholders::_1);<br>    <span class="hljs-built_in">f4</span>(<span class="hljs-number">1</span>);<br>    cout &lt;&lt; <span class="hljs-string">&quot;bind pass &amp;ff, after exec, ff num : &quot;</span> &lt;&lt; ff.num_ &lt;&lt; endl;<br><br>    <span class="hljs-keyword">auto</span> f5 = std::<span class="hljs-built_in">bind</span>(f1, placeholders::_1, placeholders::_2);<br>    <span class="hljs-built_in">f5</span>(ff, <span class="hljs-number">1</span>);<br>    cout &lt;&lt; <span class="hljs-string">&quot;bind_mem_fn pass ff, after exec, ff num : &quot;</span> &lt;&lt; ff.num_ &lt;&lt; endl;<br><br>    <span class="hljs-keyword">auto</span> f6 = std::<span class="hljs-built_in">bind</span>(f1, placeholders::_1, placeholders::_2);<br>    <span class="hljs-built_in">f6</span>(&amp;ff, <span class="hljs-number">1</span>);<br>    cout &lt;&lt; <span class="hljs-string">&quot;bind_mem_fn pass &amp;ff, after exec, ff num : &quot;</span> &lt;&lt; ff.num_ &lt;&lt; endl;<br><br><br>    std::function&lt;<span class="hljs-built_in"><span class="hljs-keyword">void</span></span>(Foo, <span class="hljs-keyword">int</span>)&gt; f7 = &amp;Foo::print_add;<br>    <span class="hljs-built_in">f7</span>(std::<span class="hljs-built_in">ref</span>(ff), <span class="hljs-number">1</span>);<br>    cout &lt;&lt; <span class="hljs-string">&quot;function(Foo), pass ff, after exec, ff num : &quot;</span> &lt;&lt; ff.num_ &lt;&lt;endl;<br><br>    std::function&lt;<span class="hljs-built_in"><span class="hljs-keyword">void</span></span>(Foo*, <span class="hljs-keyword">int</span>)&gt; f8 = &amp;Foo::print_add;<br>    <span class="hljs-built_in">f8</span>(&amp;ff, <span class="hljs-number">1</span>);<br>    cout &lt;&lt; <span class="hljs-string">&quot;function(Foo*), pass ff*, after exec, ff num : &quot;</span> &lt;&lt; ff.num_ &lt;&lt;endl;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">mem_fn <span class="hljs-keyword">pass</span> ff, after <span class="hljs-built_in">exec</span>, ff num : <span class="hljs-number">2</span><br>mem_fn <span class="hljs-keyword">pass</span> &amp;ff, after <span class="hljs-built_in">exec</span>, ff num : <span class="hljs-number">3</span><br>bind use placeholder_1 to <span class="hljs-keyword">pass</span> ff, after <span class="hljs-built_in">exec</span>, ff num : <span class="hljs-number">4</span><br>bind <span class="hljs-keyword">pass</span> ff, after <span class="hljs-built_in">exec</span>, ff num : <span class="hljs-number">4</span><br>bind <span class="hljs-keyword">pass</span> &amp;ff, after <span class="hljs-built_in">exec</span>, ff num : <span class="hljs-number">5</span><br>bind_mem_fn <span class="hljs-keyword">pass</span> ff, after <span class="hljs-built_in">exec</span>, ff num : <span class="hljs-number">6</span><br>bind_mem_fn <span class="hljs-keyword">pass</span> &amp;ff, after <span class="hljs-built_in">exec</span>, ff num : <span class="hljs-number">7</span><br>function(Foo), <span class="hljs-keyword">pass</span> ff, after <span class="hljs-built_in">exec</span>, ff num : <span class="hljs-number">7</span><br>function(Foo*), <span class="hljs-keyword">pass</span> ff*, after <span class="hljs-built_in">exec</span>, ff num : <span class="hljs-number">8</span><br></code></pre></td></tr></table></figure><hr /><p>é‚£ä¹ˆæ ¹æ®è¾“å‡ºç»“æœä¸éš¾å‘ç°å¦‚ä¸‹å‡ ä¸ªç°è±¡ï¼š</p><ol><li>å¯¹äº mem_fn ä¹Ÿå°±æ˜¯ä»£ç é‡Œçš„ f1 ï¼Œæ— è®ºä¼ å…¥çš„æ˜¯ ff è¿˜æ˜¯ &amp;ff ï¼Œæ‰§è¡Œåéƒ½æ˜¯èƒ½æ­£å¸¸ä¿®æ”¹ ff å¯¹è±¡ä¸­çš„ num_ å€¼ã€‚</li><li>å¯¹äº bindï¼Œå¦‚æœæå‰ç»‘å®šäº† ffï¼Œåˆ™æ‰§è¡Œåå¹¶æ²¡æœ‰ä¿®æ”¹ ff å¯¹è±¡ä¸­çš„ num_ å€¼ï¼›è€Œå¦‚æœä½¿ç”¨ placeholder æˆ–è€… ä¼ å…¥ &amp;ff ï¼Œåˆ™ä¹Ÿå¯ä»¥æ­£å¸¸ä¿®æ”¹ã€‚</li><li>å¯¹äº functionï¼Œå¦‚æœæŒ‡å®šç¬¬ä¸€ä¸ªå‚æ•°ä¸º Fooï¼Œæ­¤æ—¶ä¼ å…¥ ffï¼Œæ‰§è¡Œåä¹Ÿæ²¡æœ‰ä¿®æ”¹ ff å¯¹è±¡ä¸­çš„ num_ å€¼ã€‚</li></ol><p>æ‰€ä»¥æˆ‘å½“æ—¶å°±æŒºå›°æƒ‘çš„ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰ä¸Šè¿°çš„å·®å¼‚ï¼Œå¯¹åº”çš„åŸç†åˆæ˜¯ä»€ä¹ˆï¼Ÿåæ¥ä¹Ÿæ˜¯æŸ¥é˜…äº†ä¸€å¤©ï¼Œå¹¶æœ€ç»ˆåœ¨ StackOverflow ä¸Šæé—®åï¼Œå¾—åˆ°äº†è§£ç­”ï¼Œå…·ä½“å¯ä»¥çœ‹è¿™ä¸ªé“¾æ¥ <a href="https://stackoverflow.com/questions/77542768/mem-fn-bind-function-difference-when-passing-parameters/77542820?noredirect=1#comment136703728_77542820">StackOverflow æé—®</a> ã€‚</p><h1 id="åˆ†ææ€è€ƒ"><a class="markdownIt-Anchor" href="#åˆ†ææ€è€ƒ"></a> åˆ†ææ€è€ƒ</h1><p>ç®€å•æ¥è¯´ï¼Œç›¸ä¼¼çš„ä¼ å‚æ–¹å¼å´å¾—åˆ°äº†ä¸åŒçš„ç»“æœï¼Œå¦‚ä»£ç é‡Œçš„ <code>f1(ff,1)</code> å’Œ <code>f7(ff,1)</code>ï¼Œè¿™å…¶å®æ˜¯ç”±äºä¼ å‚æ—¶ä¸€ä¸ªæ˜¯ pass by referenceï¼Œä¸€ä¸ªæ˜¯ pass by value å¯¼è‡´çš„ã€‚ä¸‹é¢ä¼šè¿›ä¸€æ­¥åœ°å¯¹ä¸Šè¿°ä¸‰ç‚¹è¿›è¡Œåˆ†æã€‚</p><ol><li>å¯¹äº <code>mem_fn</code> çš„è¡¨ç°ï¼Œä¹Ÿå°±æ˜¯ <code>f1</code> å’Œ <code>f2</code>ï¼Œä»–ä»¬ä¼ å€¼æ–¹å¼éƒ½æ˜¯ pass by referenceï¼Œè¿™ä¸€ç‚¹å¯ä»¥åœ¨ <a href="https://en.cppreference.com/w/cpp/utility/functional/mem_fn">https://en.cppreference.com/w/cpp/utility/functional/mem_fn</a> å¾—åˆ°è¯å®ï¼Œå¯ä»¥çœ‹åˆ° <code>operator()(Arg&amp;&amp;... args)</code>å½¢å‚æ ¼å¼ä¸º <code>Args&amp;&amp;</code> å¼•ç”¨æ ¼å¼ï¼Œç„¶åè¿›è¡Œå®Œç¾è½¬å‘å†æ‰§è¡Œå‡½æ•°è°ƒç”¨ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±åˆå¯ä»¥è”æƒ³ä¹‹å‰æåˆ°çš„ <code>INVOKE</code> è°ƒç”¨è§„åˆ™ã€‚å› ä¸ºæ˜¯å¼•ç”¨ï¼Œæ‰€ä»¥ä¼ å…¥<code>ff</code>å¯¹è±¡åæ‰§è¡Œè°ƒç”¨èƒ½å¤Ÿç›´æ¥ä¿®æ”¹å¯¹è±¡ï¼Œä¼ å…¥<code>&amp;ff</code>è°ƒç”¨ä¹Ÿæ˜¯ä¿®æ”¹ <code>ff</code> å¯¹è±¡æœ¬èº«ã€‚</li></ol><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202311271133362.png" alt="Member function" /></p><ol start="2"><li>å¯¹äº <code>std::bind</code>ï¼Œè¿”å›ä¸€ä¸ª function objectï¼Œå¯¹è¯¥ object ä¼ å…¥çš„å‚æ•°éƒ½æ˜¯æ‹·è´æˆ–è€…ç§»åŠ¨ï¼Œé™¤éä½¿ç”¨ <code>std::ref</code> æˆ–è€… <code>std::cref</code>è¡¨ç¤ºä¼ å…¥å¼•ç”¨ï¼Œæ‰€ä»¥ä¼ å…¥ <code>ff</code> æˆ–è€… <code>&amp;ff</code>æ—¶éƒ½æ˜¯è¿›è¡Œæ‹·è´ï¼Œåœ¨çœŸæ­£ <code>INVOKE</code>æ—¶ <code>f3</code> ä¸èƒ½ä¿®æ”¹<code>ff</code> å¯¹è±¡ï¼Œ<code>f4</code> å¯ä»¥ã€‚å½“ä½†ä½¿ç”¨ <code>placeholders</code> æ—¶ï¼Œå¯ä»¥çœ‹åˆ°å¯¹åº”è¯´æ˜ï¼Œä¼šå°†å¯¹åº”ä¼ å…¥çš„å‚æ•°è½¬å‘ï¼Œè½¬å˜æˆ &amp;&amp; å¼•ç”¨ç±»å‹ï¼Œå› æ­¤è¿™æ˜¯ä¼ å…¥æ˜¯ä¸ªå¼•ç”¨ï¼Œæ‰€ä»¥ <code>f2</code> çš„è°ƒç”¨èƒ½å¤Ÿä¿®æ”¹ <code>ff</code> å¯¹è±¡ã€‚</li></ol><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202311271133403.png" alt="" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202311271133452.png" alt="Notes" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202311271133508.png" alt="placeholders" /></p><hr /><p>å¯¹äº std::bind å‚æ•°çš„æ‹·è´ï¼Œè¿˜å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ bind çš„æ—¶å€™æ‹·è´çš„æ˜¯å®å‚ï¼Œåœ¨çœŸæ­£è°ƒç”¨æ‰§è¡Œæ—¶æ‰å»æ‹·è´å½¢å‚ï¼Œæ‰€ä»¥å½“æ‹·è´æŒ‡é’ˆçš„å€¼æ—¶å€™éœ€è¦ç‰¹åˆ«æ³¨æ„å¯¹åº”çš„ç”Ÿå‘½å‘¨æœŸã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;functional&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span>&#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">A</span>() &#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;construct A &quot;</span> &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-built_in">A</span>(<span class="hljs-keyword">const</span> A&amp; a) &#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;construct A from a&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span>&#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">B</span>() &#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;construct B &quot;</span> &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-built_in">B</span>(<span class="hljs-keyword">const</span> A&amp; a)  &#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;construct B from A&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">(B b)</span> </span>&#123;<br>    cout &lt;&lt;<span class="hljs-string">&quot;do test&quot;</span> &lt;&lt; endl;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    A a;<br>    cout &lt;&lt; <span class="hljs-string">&quot;ready to do bind&quot;</span> &lt;&lt; endl;<br>    <span class="hljs-keyword">auto</span> f = std::<span class="hljs-built_in">bind</span>(test, a);<br>    cout &lt;&lt; <span class="hljs-string">&quot;ready to do test&quot;</span> &lt;&lt; endl;<br>    <span class="hljs-built_in">f</span>();<br>&#125;<br><br><span class="hljs-comment">// è¾“å‡ºç»“æœ</span><br><span class="hljs-comment">// construct A </span><br><span class="hljs-comment">// ready to do bind</span><br><span class="hljs-comment">// construct A from a</span><br><span class="hljs-comment">// ready to do test</span><br><span class="hljs-comment">// construct B from A</span><br><span class="hljs-comment">// do test</span><br></code></pre></td></tr></table></figure><ol start="3"><li>å¯¹äº <code>std::function</code>ï¼Œå¯ä»¥çœ‹åˆ°å¯¹åº”çš„ <code>operator()</code>æ¥å—å‚æ•°çš„ç±»å‹æ˜¯ <code>Args...</code> è€Œä¸æ˜¯ mem_fn çš„ <code>Args&amp;&amp;...</code>ï¼Œæ³¨æ„åˆ°è¿™ä¸¤è€…ç»†å¾®çš„å·®åˆ«äº†ä¹ˆï¼Ÿè¿™é‡Œå…¶å®å°±éšå«è¯´æ˜ä¼ å…¥çš„å‚æ•°éƒ½æ˜¯æ‹·è´ä¼ å…¥çš„ï¼Œæ‰€ä»¥ <code>f7</code> æ‰§è¡Œåå¹¶ä¸ä¼šå½±å“ <code>ff</code> å¯¹è±¡ã€‚</li></ol><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202311271133587.png" alt="std::function operator()" /></p><h1 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h1><p>æ­¤æ¬¡é‡åˆ°çš„é—®é¢˜ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å¯¹äºæŸä¸ªç»“æœç°è±¡ä¸ç†è§£ï¼Œæˆ–è€…è¯´æ˜¯ä¸ç¬¦åˆé¢„æœŸè€Œäº§ç”Ÿç–‘æƒ‘ï¼Œä½†å…¶å®ä»è¿™ä¸ªç°è±¡ï¼Œå†ç»“åˆä¸€ä¸‹C++çŸ¥è¯†ï¼Œä¸éš¾æƒ³åˆ°ä¸€ä¸ªæ˜¯å€¼ä¼ é€’ä¸€ä¸ªæ˜¯å¼•ç”¨ä¼ é€’ï¼Œä½†æˆ‘å½“æ—¶å°±æ˜¯æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„ä½è¯ï¼Œæ¥è¯´æ˜ä¸ºä»€ä¹ˆè¿™é‡Œæ˜¯å€¼ä¼ é€’æˆ–æ˜¯å¼•ç”¨ä¼ é€’ã€‚åæ¥ä¹Ÿæ˜¯ä»”ç»†ç¿»é˜…äº† cppreference ä¸Šçš„è¯´æ˜ï¼Œæ‰çœ‹åˆ°è¯æ®ï¼Œä¸è¿‡é™äºæˆ‘ä¸ªäººèƒ½åŠ›ï¼Œå¯èƒ½ä¸Šè¿°çš„åˆ†æä¹Ÿä»…ä»…æ˜¯æˆ‘ä¸ªäººçš„æ¨æµ‹ï¼Œè‡ªèº«ä¹Ÿæ²¡æœ‰å¾ˆé€å½»åœ°ç†è§£ï¼Œæ‰€ä»¥å¦‚æœå“ªé‡Œç†è§£æœ‰è¯¯ï¼Œè¿˜è¯·è”ç³»æˆ‘è¿›è¡Œæ”¹æ­£ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>C++</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€éªšæ“ä½œã€‘åˆ¶ä½œä¸€ä¸ªç‚«é…·çš„Githubä¸ªäººä¸»é¡µ</title>
    <link href="/2023/11/19/2023-11/2023-11-19%E3%80%90%E9%AA%9A%E6%93%8D%E4%BD%9C%E3%80%91%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E7%82%AB%E9%85%B7%E7%9A%84Github%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5/"/>
    <url>/2023/11/19/2023-11/2023-11-19%E3%80%90%E9%AA%9A%E6%93%8D%E4%BD%9C%E3%80%91%E5%88%B6%E4%BD%9C%E4%B8%80%E4%B8%AA%E7%82%AB%E9%85%B7%E7%9A%84Github%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šå›¾ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202311201610533.png" alt="" /></p><center>ğŸ‘†<em>å›¾ç‰‡æ¥æºï¼šitgoyo ä¸ªäººä¸»é¡µ<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="https://github.com/itgoyo">[1]</span></a></sup></em></center><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202311201612706.png" alt="" /></p><center>ğŸ‘†<em>å›¾ç‰‡æ¥æºï¼šäºŒä¸«è®²æ¢µ ä¸ªäººä¸»é¡µ<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="https://github.com/eryajf">[2]</span></a></sup></em></center><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202311201618499.png" alt="" /></p><center>ğŸ‘†<em>å›¾ç‰‡æ¥æºï¼šHein Thant ä¸ªäººä¸»é¡µ<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="https://github.com/IndieCoderMM">[3]</span></a></sup></em></center><hr /><p>æ€ä¹ˆæ ·ï¼Œçœ‹åˆ°è¿™äº›é£æ ¼å„å¼‚çš„ä¸ªäººä¸»é¡µï¼Œæ˜¯ä¸æ˜¯å¤§ä¸ºéœ‡æ’¼ï¼Œ<s>å¤Ÿä¸å¤Ÿç‚«é…·ï¼Œå¤Ÿä¸å¤ŸèŠ±å“¨</s>ï¼Œå¦‚æœä½ ä¹Ÿæƒ³åŒ…è£…ä¸‹è‡ªå·±ï¼Œå¥½å¥½æ‰“æ‰®ä¸‹ä¸ªäººä¸»é¡µï¼Œé‚£å°±è¯·ç»§ç»­é˜…è¯»ä¸‹æ–‡å®æ“éƒ¨åˆ†ã€‚</p><h1 id="å®æ“"><a class="markdownIt-Anchor" href="#å®æ“"></a> å®æ“</h1><p>å…¶å®ä¿®æ”¹çš„åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯åˆ›å»ºä¸€ä¸ªä¸è‡ªå·±Githubè´¦å·åŒåçš„ä¸€ä¸ªä»“åº“ï¼Œç„¶åæ·»åŠ ä¸€ä¸ª<text>README.md</text>æ–‡ä»¶ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­ç¼–è¾‘å¡«å†™è‡ªå·±çš„ä¸ªäººä»‹ç»ï¼Œå°±åƒä¸‹é¢æç¤ºçš„é‚£æ ·ã€‚è€Œmarkdownæ–‡ä»¶æ”¯æŒå†…åµŒhtmlï¼Œå› æ­¤å€ŸåŠ©ä¸€äº›å¤§ä½¬æä¾›çš„å¼€æºhttpæœåŠ¡ï¼Œè¯·æ±‚å¯¹åº”çš„èµ„æºï¼Œå°±å¯ä»¥æ’ç‰ˆè®¾è®¡å‡ºæ¼‚äº®ç¾è§‚çš„ä¸ªäººä¸»é¡µã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202311201638069.png" alt="åˆ›å»ºåŒåä»“åº“" /></p><p>é‚£ä¹ˆï¼Œä¸Šå“ªå»æ‰¾ç¾è§‚ç‚«é…·çš„æ¨¡æ¿å‘¢ï¼Ÿå¯ä»¥çœ‹çœ‹è¿™ä¸ªä»“åº“ <a href="https://github.com/LHRUN/bubble">https://github.com/LHRUN/bubble</a><sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="Github Profileç´ æä»“åº“">[5]</span></a></sup>ï¼Œè¿™ä¸ªä»“åº“æä¾›äº†ä¸€ä¸ªç´ æåº“é“¾æ¥<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="https://bubble-awesome-profile.vercel.app/">[4]</span></a></sup>ï¼Œé‡Œé¢åŒ…å«å„ç§ç»„ä»¶ï¼Œå¯ä»¥å½¢è±¡ç”ŸåŠ¨åœ°å±•ç¤ºä½ çš„Githubæ•°æ®ï¼Œåƒæ˜¯commitï¼Œstarsï¼Œprç­‰ã€‚æ­¤å¤–ï¼Œä¸Šé¢è¿™ä¸ªä»“åº“ä¹Ÿæ”¶é›†äº†å¾ˆå¤šGithubç”¨æˆ·çš„ä¸ªäººä¸»é¡µï¼Œä½ ä¹Ÿå¯ä»¥ä»ä¸­æŒ‘é€‰è‡ªå·±ä¸­æ„çš„æ’ç‰ˆï¼Œç„¶åå‚è€ƒå¯¹åº”çš„ä»£ç è¿›è¡Œè®¾è®¡ã€‚æ›´ç®€å•ç²—æš´çš„æ–¹å¼ï¼Œå°±æ˜¯é€šè¿‡forkä»–/å¥¹çš„ä»“åº“ï¼Œç„¶åå°†ä»“åº“åæ”¹ä¸ºè‡ªå·±çš„Githubåç§°ï¼Œå°±å¯ä»¥æ‹¥æœ‰ä¸ä¹‹ç›¸åŒçš„ä¸ªäººä¸»é¡µã€‚</p><h1 id="ç»“æŸè¯­"><a class="markdownIt-Anchor" href="#ç»“æŸè¯­"></a> ç»“æŸè¯­</h1><p>è™½ç„¶ç‚«é…·èŠ±å“¨çš„ä¸ªäººä¸»é¡µï¼Œçš„ç¡®èƒ½ä»¤äººè€³ç›®ä¸€æ–°ï¼Œä½†ä¹Ÿåˆ«å¿˜äº†Githubç¤¾åŒºçš„åˆè¡·ï¼Œå¤šå¤šå‚ä¸å­¦ä¹ ä¼˜è´¨çš„å¼€æºé¡¹ç›®ï¼Œè´¡çŒ®è‡ªå·±çš„çŸ¥è¯†å’Œæ–¹æ¡ˆï¼Œåœ¨å„ç§æ€æƒ³äº¤æµç¢°æ’ä¸­ï¼Œæˆé•¿ä¸ºä¸€åGeekã€‚åˆ‡å¿Œå› å°å¤±å¤§ï¼Œæ²‰è¿·æŠ˜è…¾äº›è¾¹è§’æ–™çš„äº‹ï¼Œå°±åƒè¿™æ¬¡ä¿®æ”¹è‡ªå·±çš„ä¸ªäººä¸»é¡µï¼Œæ²¡æœ‰å®è´¨æ€§çš„å†…å®¹å’Œå‡ºå½©é¡¹ç›®ï¼Œæ²¡æœ‰å®æ‰“å®çš„æ•°æ®æ”¯æ’‘ï¼ŒåŒ…è£…å¾—å†å¦‚ä½•ç¾è§‚ï¼Œéƒ½åªæ˜¯æµäºè¡¨é¢ç½¢äº†ã€‚</p><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://github.com/itgoyo">https://github.com/itgoyo</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://github.com/eryajf">https://github.com/eryajf</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://github.com/IndieCoderMM">https://github.com/IndieCoderMM</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://bubble-awesome-profile.vercel.app/">https://bubble-awesome-profile.vercel.app/</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://github.com/LHRUN/bubble">Github Profileç´ æä»“åº“</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>éªšæ“ä½œç³»åˆ—</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Github</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C++ç®€å•çº¿ç¨‹æ± </title>
    <link href="/2023/11/17/2023-11/2023-11-17%20C++%E7%AE%80%E5%8D%95%E7%BA%BF%E7%A8%8B%E6%B1%A0/"/>
    <url>/2023/11/17/2023-11/2023-11-17%20C++%E7%AE%80%E5%8D%95%E7%BA%BF%E7%A8%8B%E6%B1%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>ä¹‹å‰å¯¹C++å¤šçº¿ç¨‹è¿™å—ä¸€ç›´ä¸å¤ªç†Ÿæ‚‰ï¼Œè€Œæ°å¥½è¿™æ®µæ—¶é—´çœ‹åˆ°ä¸€æ®µç®€å•çº¿ç¨‹æ± å®ç°çš„ä»£ç ï¼Œæ‰€ä»¥æƒ³ç€ä¸å¦‚è¶æ­¤æœºä¼šå­¦ä¹ ä¸€ä¸‹ã€‚æœ¬æ–‡ä¼šå…ˆä»‹ç»ä¸‹çº¿ç¨‹æ± å®ç°é‡Œç”¨åˆ°çš„ç›¸å…³åŒæ­¥åŸè¯­ï¼Œå¦‚äº’æ–¥é”å’Œæ¡ä»¶å˜é‡ï¼Œå†æ¥ç®€å•åˆ†æå…¶å®ç°ã€‚</p><h1 id="äº’æ–¥é”"><a class="markdownIt-Anchor" href="#äº’æ–¥é”"></a> äº’æ–¥é”</h1><p>æ­£å¦‚ã€ŠLinuxå¤šçº¿ç¨‹æœåŠ¡ç«¯ç¼–ç¨‹ã€‹ä¸€ä¹¦ä¸­æŒ‡å‡ºï¼Œâ€œäº’æ–¥å™¨ï¼ˆmutexï¼‰ææ€•æ˜¯ç”¨å¾—æœ€å¤šçš„åŒæ­¥åŸè¯­ï¼Œç²—ç•¥åœ°è¯´ï¼Œå®ƒä¿æŠ¤äº†ä¸´ç•ŒåŒºï¼Œä»»ä½•ä¸€ä¸ªæ—¶åˆ»æœ€å¤šåªèƒ½ç”±ä¸€ä¸ªçº¿ç¨‹åœ¨æ­¤mutexåˆ’å‡ºçš„ä¸´ç•ŒåŒºå†…æ´»åŠ¨ã€‚å•ç‹¬ä½¿ç”¨mutexæ—¶ï¼Œæˆ‘ä»¬ä¸»è¦ä¸ºäº†ä¿æŠ¤å…±äº«æ•°æ®â€ã€‚ä¹¦ä¸­ä¹Ÿæåˆ°äº†ä½¿ç”¨mutexæ—¶å»ºè®®çš„å››ä¸ªåŸåˆ™ï¼š</p><ul><li>ç”¨RAIIæ‰‹æ³•å°è£…mutexçš„åˆ›å»ºã€é”€æ¯ã€åŠ é”ã€è§£é”è¿™å››ä¸ªæ“ä½œã€‚</li><li>åªç”¨éé€’å½’çš„mutexï¼ˆå³ä¸å¯é‡å…¥çš„mutexï¼‰ã€‚</li><li>ä¸æ‰‹å·¥è°ƒç”¨lock() å’Œ unlock() å‡½æ•°ï¼Œä¸€åˆ‡äº¤ç»™æ ˆä¸Šçš„Guardå¯¹è±¡çš„æ„é€ å’Œææ„å‡½æ•°è´Ÿè´£ã€‚</li><li>åœ¨æ¯æ¬¡æ„é€ Guardå¯¹è±¡çš„æ—¶å€™ï¼Œæ€è€ƒä¸€è·¯ä¸Šï¼ˆè°ƒç”¨æ ˆä¸Šï¼‰å·²ç»æŒæœ‰çš„é”ï¼Œé˜²æ­¢å› åŠ é”é¡ºåºä¸åŒè€Œå¯¼è‡´æ­»é”ã€‚</li></ul><p>è¿™é‡Œä»…å¯¹ä¸Šè¿°çš„ç¬¬ä¸‰ç‚¹å±•å¼€ä»‹ç»å®é™…ç”¨æ³•ï¼Œé€šå¸¸ <code>std::mutex</code> éƒ½ä¼šç»“åˆ <code>std::lock_guardã€std::scoped_lockã€std::unique_lock</code> æ¥ä½¿ç”¨ã€‚</p><p>å…¶ä¸­ <code>std::lock_guard</code> çš„ç”¨æ³•å¦‚ä¸‹æ‰€ç¤ºï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯åœ¨æ„é€ çš„æ—¶å€™ä¼ å…¥ä¸€ä¸ª mutexï¼Œåœ¨å®ƒçš„æ„é€ å‡½æ•°ä¸­ä¼šæ‰§è¡Œ <code>mutex.lock()</code> ï¼Œè€Œåœ¨ <code>lock_guard</code> ææ„å‡½æ•°ä¸­ä¼šæ‰§è¡Œ <code>mutex.unlock()</code> ä»è€Œå®ç°äº†è‡ªåŠ¨çš„åŠ é”å’Œè§£é”æ“ä½œã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs C++">std::mutex g_mutex;<br><br>&#123;<br><span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lock</span><span class="hljs-params">(g_mutex)</span></span>;<br><span class="hljs-comment">// ä»¥ä¸‹éƒ½æ˜¯ä¸´ç•ŒåŒº</span><br>...<br>&#125;<br></code></pre></td></tr></table></figure><p><code>std::scoped_lock</code> å’Œ <code>std::lock_guard</code> ç”¨æ³•ç±»ä¼¼ï¼Œä¸»è¦åŒºåˆ«åœ¨äº std::scoped_lock æ”¯æŒåŒæ—¶ä¸ºå¤šä¸ª mutex è¿›è¡Œä¸Šé”å’Œè§£é”ï¼ŒåŸºæœ¬ç”¨æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs C++">std::mutex m1, m2;<br><br>&#123;<br>std::<span class="hljs-built_in">scoped_lock</span>(m1,m2);<br>...<br>&#125;<br></code></pre></td></tr></table></figure><p>std::unique_lock ç›¸æ¯” std::lock_guard æ›´å¤šåŠ çš„çµæ´»ï¼Œæ‹¥æœ‰æ›´å¤šçš„æˆå‘˜å‡½æ•°ï¼Œå¦‚ <code>lock() , unlock()</code>ç­‰ï¼Œä¹Ÿå°±æ˜¯è¯´ unique_lock å¯ä»¥æå‰é‡Šæ”¾é”ï¼Œè€Œä¸å¿…ç­‰åˆ°ææ„çš„æ—¶å€™å†é‡Šæ”¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c++">std::mutex g_mutex;<br><br>&#123;<br>  <span class="hljs-function">std::unique_lock <span class="hljs-title">lk</span><span class="hljs-params">(g_mutex)</span></span>;<br>  <span class="hljs-comment">// ä¸´ç•ŒåŒº</span><br>  ...<br>  <span class="hljs-comment">// æå‰é‡Šæ”¾é”</span><br>  lk.<span class="hljs-built_in">unlock</span>();<br>  <span class="hljs-comment">// åšä¸€äº›åç»­çš„å¤„ç†</span><br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><center><figure class="half">    <img   src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202311301139801.png" width="45%"/> <img  src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202311301139253.png" width="45%" />  <br>  <em>å·¦: lock_guardï¼Œå³: unique_lock </em> </figure> </center><h1 id="æ¡ä»¶å˜é‡"><a class="markdownIt-Anchor" href="#æ¡ä»¶å˜é‡"></a> æ¡ä»¶å˜é‡</h1><p>condition_variable æ¡ä»¶å˜é‡æ˜¯C++11ä¸­å°±æœ‰çš„classï¼Œé€šè¿‡ä½¿ç”¨ std::mutex æ¥å®ç°åŒæ­¥åŸè¯­ï¼Œè¿™é‡Œç®€å•ä»‹ç»ä¸‹ä¸¤ä¸ªå…³é”®çš„æˆå‘˜å‡½æ•°<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="C++11æ¡ä»¶å˜é‡condition_variableè¯¦è§£">[1]</span></a></sup>ã€‚</p><h2 id="waitå‡½æ•°ä½¿ç”¨"><a class="markdownIt-Anchor" href="#waitå‡½æ•°ä½¿ç”¨"></a> waitå‡½æ•°ä½¿ç”¨</h2><p>æ­£å¦‚ cppreference é‡Œæè¿°çš„é‚£æ ·ï¼Œcondition_variable çš„ wait å‡½æ•°æä¾›äº†ä¸¤ç§å‡½æ•°åŸå‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">wait</span> <span class="hljs-params">(unique_lock&lt;mutex&gt;&amp; lck)</span></span>;ï¼ˆ<span class="hljs-number">1</span>ï¼‰<br><span class="hljs-keyword">template</span> &lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Predicate</span>&gt;</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">wait</span> <span class="hljs-params">(unique_lock&lt;mutex&gt;&amp; lck, Predicate pred)</span></span>;ï¼ˆ<span class="hljs-number">2</span>ï¼‰<br></code></pre></td></tr></table></figure><ul><li><p>å¯¹äºå‡½æ•°åŸå‹ï¼ˆ1ï¼‰ï¼Œæ‰§è¡Œ wait å‡½æ•°ï¼Œä¼šç›´æ¥è§£é”ä¼ å…¥çš„äº’æ–¥é‡å¹¶é˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°å…¶ä»–çš„æŸä¸ªçº¿ç¨‹è°ƒç”¨ notify_one æˆ–è€… notify_all åï¼Œè¯¥çº¿ç¨‹è¢«å”¤é†’ï¼Œ<strong>ä¼šé‡æ–°å°è¯•è·å–äº’æ–¥é‡</strong>ï¼Œå¦‚æœå¾—ä¸åˆ°çº¿ç¨‹å°±ä¼šé˜»å¡åœ¨è¿™é‡Œï¼Œç›´åˆ°è·å–åˆ°äº’æ–¥é‡ä¸ºæ­¢æ‰ä¼šç»“æŸ waitï¼Œç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚</p></li><li><p>å¯¹äºå‡½æ•°åŸå‹ï¼ˆ2ï¼‰ï¼Œç­‰åŒäºå¦‚ä¸‹çš„ä»£ç ï¼Œè¯¥å‡½æ•°ä¸»è¦ç”¨äºé¿å…ä¸€äº›è™šå‡å”¤é†’ï¼ˆspurious awakeningsï¼‰çš„æƒ…å†µï¼Œé€šè¿‡æŒ‡å®šçš„åˆ¤æ–­æ¡ä»¶å†³å®šæ˜¯å¦ç»§ç»­ç­‰å¾…ã€‚éœ€è¦æ³¨æ„çš„äº‹ï¼Œ<strong>åœ¨è¿›å…¥è¯¥å¾ªç¯å‰ï¼Œå¿…é¡»è¦è·å–åˆ°äº’æ–¥é‡ï¼Œè€Œæ‰§è¡Œå®Œ wait åï¼Œä¹Ÿéœ€è¦é‡æ–°è·å–åˆ°äº’æ–¥é‡</strong>ï¼Œå³è¿™é‡Œçš„äº’æ–¥é‡ä¼šä¿æŠ¤æ‰§è¡Œ stop_waiting() ã€‚</p></li></ul> <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">while</span> (!<span class="hljs-built_in">stop_waiting</span>())<br>&#123;<br>    <span class="hljs-built_in">wait</span>(lock);<br>&#125;<br></code></pre></td></tr></table></figure><hr /><p>wait å‡½æ•°çš„å…·ä½“ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒä¸‹é¢ä»£ç <sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="condition_variable wait ç¤ºä¾‹ä»£ç ">[2]</span></a></sup></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;chrono&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;condition_variable&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span><br><br>std::condition_variable cv;<br>std::mutex cv_m;    <span class="hljs-comment">// This mutex is used for three purposes:</span><br>                    <span class="hljs-comment">// 1) to synchronize accesses to i</span><br>                    <span class="hljs-comment">// 2) to synchronize accesses to std::cerr</span><br>                    <span class="hljs-comment">// 3) for the condition variable cv</span><br><span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">waits</span><span class="hljs-params">(<span class="hljs-keyword">int</span> num)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">lk</span><span class="hljs-params">(cv_m)</span></span>;<br>    std::cerr &lt;&lt; <span class="hljs-string">&quot;num:&quot;</span> &lt;&lt; num &lt;&lt; <span class="hljs-string">&quot; Waiting...\n&quot;</span>;<br>    cv.<span class="hljs-built_in">wait</span>(lk, []&#123; <span class="hljs-keyword">return</span> i == <span class="hljs-number">1</span>; &#125;);<br>    std::cerr &lt;&lt; <span class="hljs-string">&quot;num:&quot;</span> &lt;&lt; num &lt;&lt; <span class="hljs-string">&quot; ...finished waiting. i == 1\n&quot;</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">signals</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">1</span>));<br>    &#123;<br>        <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lk</span><span class="hljs-params">(cv_m)</span></span>;<br>        std::cerr &lt;&lt; <span class="hljs-string">&quot;Notifying...\n&quot;</span>;<br>    &#125;<br>    cv.<span class="hljs-built_in">notify_all</span>();<br><br>    std::this_thread::<span class="hljs-built_in">sleep_for</span>(std::chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">1</span>));<br><br>    &#123;<br>        <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lk</span><span class="hljs-params">(cv_m)</span></span>;<br>        i = <span class="hljs-number">1</span>;<br>        std::cerr &lt;&lt; <span class="hljs-string">&quot;Notifying again...\n&quot;</span>;<br>    &#125;<br>    cv.<span class="hljs-built_in">notify_all</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-function">std::thread <span class="hljs-title">t1</span><span class="hljs-params">(waits, <span class="hljs-number">1</span>)</span>, <span class="hljs-title">t2</span><span class="hljs-params">(waits, <span class="hljs-number">2</span>)</span>, <span class="hljs-title">t3</span><span class="hljs-params">(waits, <span class="hljs-number">3</span>)</span>, <span class="hljs-title">t4</span><span class="hljs-params">(signals)</span></span>;<br>    t1.<span class="hljs-built_in">join</span>();<br>    t2.<span class="hljs-built_in">join</span>();<br>    t3.<span class="hljs-built_in">join</span>();<br>    t4.<span class="hljs-built_in">join</span>();<br>&#125;<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ä¸€ç»„å¯èƒ½çš„è¾“å‡ºä¸ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">num:3 Waiting...<br>num:1 Waiting...<br>num:2 Waiting...<br>Notifying...<br>Notifying again...<br>num:3 ...finished waiting. i == 1<br>num:2 ...finished waiting. i == 1<br>num:1 ...finished waiting. i == 1<br></code></pre></td></tr></table></figure><p>ç®€å•åˆ†æä¸€ä¸‹ä¸Šé¢çš„ä»£ç å’Œè¾“å‡ºç»“æœï¼šåœ¨ main å‡½æ•°ä¸­åˆ›å»ºäº†ä¸‰ä¸ª waits çº¿ç¨‹å’Œä¸€ä¸ª signals çº¿ç¨‹ï¼Œç„¶åä¸»çº¿ç¨‹ç­‰å¾…æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ã€‚ç”±äº signals çº¿ç¨‹ä¼šå…ˆ sleep 1 ç§’ï¼Œæ‰€ä»¥å…ˆæ‰§è¡Œä¸‰ä¸ª waits çº¿ç¨‹ï¼Œè€Œè¿™ä¸‰ä¸ªçº¿ç¨‹æ‰§è¡Œçš„é¡ºåºæ˜¯éšæœºçš„ï¼Œå½“å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹å…ˆæ‰§è¡Œæ‹¿åˆ°é”åï¼Œæ‰§è¡Œè¾“å‡º Waitingï¼ˆè¾“å‡ºç»“æœé‡Œç¬¬ä¸€ä¸ªæ‰§è¡Œçš„å°±æ˜¯çº¿ç¨‹3ï¼‰ï¼Œç„¶åæ‰§è¡Œ wait ï¼Œç”±äºä¸æ»¡è¶³æ¡ä»¶æ‰€ä»¥ä¼šé‡Šæ”¾é”å¹¶é˜»å¡å½“å‰çº¿ç¨‹ã€‚ç´§æ¥ç€ï¼Œå…¶ä»–ä¸¤ä¸ªç”±äºæ²¡æœ‰æ‹¿åˆ°äº’æ–¥é”è€Œè¢«é˜»å¡çš„çº¿ç¨‹ï¼Œå…¶ä¸­ä¸€ä¸ªæ‹¿åˆ°äº†é”ï¼Œä¹Ÿç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œé‡å¤ç±»ä¼¼çš„æ“ä½œã€‚æœ€åä¸‰ä¸ªçº¿ç¨‹éƒ½åœ¨ç­‰å¾…è¢«å”¤é†’ã€‚</p><p>signals çº¿ç¨‹ç¡çœ å®Œä¹‹åï¼Œç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œ notify_allï¼Œå”¤é†’äº†ç­‰å¾…çš„ä¸‰ä¸ªçº¿ç¨‹ï¼Œè€Œæ¯ä¸ªçº¿ç¨‹å”¤é†’ä¹Ÿéƒ½ä¼šå»å°è¯•è·å–äº’æ–¥é”ï¼Œå› æ­¤æ­¤æ—¶ä¸‰ä¸ªçº¿ç¨‹è¿˜æ˜¯ç›¸å½“äºä»¥éšæœºé¡ºåºä¸²è¡Œæ‰§è¡Œï¼Œä½†æ˜¯å› ä¸ºæ²¡æœ‰æ»¡è¶³é€€å‡ºç­‰å¾…çš„æ¡ä»¶ï¼ˆi == 1ï¼‰ï¼Œæ‰€ä»¥åˆä¼šé‡Šæ”¾é”å¹¶è¿›å…¥ç­‰å¾…ã€‚signals çº¿ç¨‹å°† i èµ‹å€¼ä¸º1åï¼Œç¬¬äºŒæ¬¡æ‰§è¡Œ notify_allï¼Œæ­¤æ—¶waits ä¸‰ä¸ªçº¿ç¨‹ä¾æ¬¡æ‹¿åˆ°é”ï¼Œå¹¶åˆ¤æ–­ç»“æŸæ¡ä»¶æˆç«‹åï¼Œç»§ç»­å¾€ä¸‹æ‰§è¡Œè¾“å‡ºï¼Œæœ€ç»ˆè¾“å‡ºçš„é¡ºåºä¹Ÿæ˜¯éšæœºçš„ã€‚</p><h2 id="notify_one-notify_all"><a class="markdownIt-Anchor" href="#notify_one-notify_all"></a> notify_one &amp; notify_all</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">notify_one</span><span class="hljs-params">()</span> <span class="hljs-keyword">noexcept</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">notify_all</span><span class="hljs-params">()</span> <span class="hljs-keyword">noexcept</span></span>;<br></code></pre></td></tr></table></figure><p>ä¸¤ä¸ª notify çš„å‡½æ•°åŸå‹ä¹Ÿéƒ½æ¯”è¾ƒç®€å•ï¼Œå…¶ä¸­ notify_one æ˜¯å»å”¤é†’å½“å‰æ¡ä»¶å˜é‡ç­‰å¾…é˜Ÿåˆ—é‡Œçš„ä¸€ä¸ªçº¿ç¨‹ï¼Œå¦‚æœæ²¡æœ‰çº¿ç¨‹åœ¨ç­‰å¾…ï¼Œåˆ™å‡½æ•°ä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼Œå¦‚æœç­‰å¾…çš„çº¿ç¨‹å¤šäºä¸€ä¸ªï¼Œåˆ™å”¤é†’çš„çº¿ç¨‹æ˜¯éšæœºçš„ã€‚notify_all åˆ™æ˜¯å»å”¤é†’æ‰€æœ‰æ­£åœ¨ç­‰å¾…çš„çº¿ç¨‹ã€‚</p><p>åœ¨ cppreference æŒ‡å‡ºï¼Œé€šçŸ¥çº¿ç¨‹ä¸éœ€è¦æŒæœ‰ä¸ç­‰å¾…çº¿ç¨‹çº¿ç¨‹ç›¸åŒçš„äº’æ–¥é”ï¼Œå¦‚æœæŒæœ‰çš„è¯ï¼Œåè€Œå¯èƒ½æ˜¯ä¸€ç§æ€§èƒ½åŠ£åŒ–ï¼Œå› ä¸ºè¢«é€šçŸ¥çš„çº¿ç¨‹å› ä¸ºæ— æ³•è·å–åˆ°é”è€Œå†æ¬¡é˜»å¡ï¼Œç›´åˆ°é€šçŸ¥çº¿ç¨‹é‡Šæ”¾é”ã€‚å› æ­¤ï¼Œä¸€äº›å®ç°ï¼ˆç‰¹åˆ«æ˜¯è®¸å¤špthreadå®ç°ï¼‰ä¸ºè¯†åˆ«è¿™ç§æƒ…å†µï¼Œåœ¨ notify è°ƒç”¨ä¸­ï¼Œä¼šç›´æ¥å°†ç­‰å¾…çº¿ç¨‹ä»æ¡ä»¶å˜é‡çš„ç­‰å¾…é˜Ÿåˆ—ä¸­è½¬ç§»åˆ°äº’æ–¥é”çš„ç­‰å¾…é˜Ÿåˆ—é‡Œï¼Œä»è€Œé¿å…äº†è¿™ç§ â€œhurry up and waitâ€ æƒ…å†µã€‚</p><h1 id="çº¿ç¨‹æ± å®ç°"><a class="markdownIt-Anchor" href="#çº¿ç¨‹æ± å®ç°"></a> çº¿ç¨‹æ± å®ç°</h1><p>ä¸€ä¸ªç®€å•çº¿ç¨‹æ± çš„å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼Œè¿™é‡Œé’ˆå¯¹æ¯ä¸ªæˆå‘˜å‡½æ•°ä½œç®€è¦åˆ†æã€‚</p><ul><li>é¦–å…ˆæ˜¯æ„é€ å‡½æ•°ï¼Œå°±æ˜¯åœ¨å¯åŠ¨å¤šä¸ª worker çº¿ç¨‹ï¼Œæ‰§è¡Œ <code>Run</code> è¿™ä¸€å¾ªç¯å‡½æ•°ã€‚</li><li>ææ„å‡½æ•°ï¼Œä¸»è¦æ˜¯å»è°ƒç”¨ <code>Stop</code> å‡½æ•°ï¼Œç»ˆæ­¢æ‰€æœ‰ worker çº¿ç¨‹ï¼Œè¿›è¡Œèµ„æºå›æ”¶ã€‚</li><li><code>AddTask</code> å‡½æ•°ï¼Œä½¿ç”¨ <code>std::bind</code> å°†ä¼ å…¥çš„å‚æ•°è½¬åŒ–ä¸º function objectï¼ŒåŠ å…¥åˆ° <code>pending_tasks_</code> é˜Ÿåˆ—ä¸­ï¼Œå¹¶åˆ©ç”¨æ¡ä»¶å˜é‡å»å”¤é†’ä¸€ä¸ªç©ºé—²çš„ worker çº¿ç¨‹å»æ‰§è¡Œå¯¹åº”ä»»åŠ¡ã€‚ï¼ˆè¿™é‡Œè¿˜æœ‰ Parameter Pack ç›¸å…³çŸ¥è¯†ç‚¹ï¼Œåç»­æœ‰æœºä¼šå†å±•å¼€è®²è®²ã€‚ï¼‰</li><li><code>Stop</code> å‡½æ•°ï¼Œå”¤é†’æ‰€æœ‰ worker çº¿ç¨‹ï¼Œç­‰å¾…æ‰€æœ‰çº¿ç¨‹å¤„ç†å®Œå½“å‰ä»»åŠ¡åé€€å‡ºçº¿ç¨‹ï¼Œå›æ”¶çº¿ç¨‹èµ„æºã€‚</li><li><code>Run</code> å‡½æ•°ï¼Œworker çº¿ç¨‹çš„è¿è¡Œçš„å¾ªç¯å‡½æ•°ï¼Œé€šè¿‡æ¡ä»¶å˜é‡çš„ <code>wait</code> æ¥åˆ¤æ–­å½“å‰æ˜¯å¦æœ‰å¾…å¤„ç†çš„ä»»åŠ¡æˆ–è€…çº¿ç¨‹æ± æ˜¯å¦ç»ˆæ­¢ï¼Œå¦‚æœæ”¶åˆ°ç»ˆæ­¢ä¿¡å·ï¼Œåˆ™é€€å‡ºæ­»å¾ªç¯ï¼Œå¦åˆ™ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªä»»åŠ¡æ‰§è¡Œã€‚</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleThreadPool</span> <span class="hljs-keyword">final</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">SimpleThreadPool</span>(<span class="hljs-keyword">size_t</span> num_threads) : <span class="hljs-built_in">num_threads_</span>(num_threads) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">size_t</span> i = <span class="hljs-number">0</span>; i &lt; num_threads; ++i) &#123;<br>            workers_.<span class="hljs-built_in">emplace_back</span>(&amp;SimpleThreadPool::Run, <span class="hljs-keyword">this</span>, i);<br>        &#125;<br>    &#125;<br><br>    ~<span class="hljs-built_in">SimpleThreadPool</span>() &#123; <span class="hljs-keyword">if</span>(!stop_) &#123; <span class="hljs-built_in">Stop</span>(); &#125; &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">template</span>&lt;class Func, class... Args&gt;</span><br><span class="hljs-function">    <span class="hljs-keyword">void</span> <span class="hljs-title">AddTask</span><span class="hljs-params">(Func &amp;&amp;func, Args &amp;&amp;... args)</span> </span>&#123;<br>        <span class="hljs-keyword">auto</span> task = std::<span class="hljs-built_in">bind</span>(std::forward&lt;Func&gt;(func), std::forward&lt;Args&gt;(args)...);<br>        <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">guard</span><span class="hljs-params">(mutex_)</span></span>;<br>        pending_tasks_.<span class="hljs-built_in">push</span>(task);<br>        cv_.<span class="hljs-built_in">notify_one</span>();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Stop</span><span class="hljs-params">()</span> </span>&#123;<br>        &#123;<br>            <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">guard</span><span class="hljs-params">(mutex_)</span></span>;<br>            <span class="hljs-keyword">if</span> (stop_) &#123; <span class="hljs-keyword">return</span>; &#125;<br>            stop_ = <span class="hljs-literal">true</span>;<br>            cv_.<span class="hljs-built_in">notify_all</span>();<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> &amp;w: workers_) &#123; w.<span class="hljs-built_in">join</span>(); &#125;<br>    &#125;<br><br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Run</span><span class="hljs-params">(<span class="hljs-keyword">size_t</span> i)</span> </span>&#123;<br>        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>            std::function&lt;<span class="hljs-built_in"><span class="hljs-keyword">void</span></span>()&gt; task;<br>            &#123;<br>                <span class="hljs-function">std::unique_lock&lt;std::mutex&gt; <span class="hljs-title">guard</span><span class="hljs-params">(mutex_)</span></span>;<br>                cv_.<span class="hljs-built_in">wait</span>(guard, [<span class="hljs-keyword">this</span>]() &#123; <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>-&gt;stop_ || !<span class="hljs-keyword">this</span>-&gt;pending_tasks_.<span class="hljs-built_in">empty</span>(); &#125;);<br>                <span class="hljs-keyword">if</span> (stop_) &#123; <span class="hljs-keyword">break</span>; &#125;<br>                task = std::<span class="hljs-built_in">move</span>(pending_tasks_.<span class="hljs-built_in">front</span>());<br>                pending_tasks_.<span class="hljs-built_in">pop</span>();<br>            &#125;<br>            <span class="hljs-built_in">task</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">size_t</span> num_threads_;<br>    <span class="hljs-keyword">mutable</span> std::mutex mutex_;<br>    <span class="hljs-keyword">mutable</span> std::condition_variable cv_;<br>    std::queue&lt;std::function&lt;<span class="hljs-keyword">void</span>()&gt;&gt; pending_tasks_;<br>    std::vector&lt;std::thread&gt; workers_;<br>    <span class="hljs-keyword">bool</span> stop_&#123;<span class="hljs-literal">false</span>&#125;;<br>&#125;;<br></code></pre></td></tr></table></figure><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/599172163">C++11æ¡ä»¶å˜é‡condition_variableè¯¦è§£</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://en.cppreference.com/w/cpp/thread/condition_variable/wait">condition_variable wait ç¤ºä¾‹ä»£ç </a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>C++</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>çº¿ç¨‹æ± </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸­å›½é“¶è¡Œæ€»è¡Œé¢è¯•ç»å†</title>
    <link href="/2023/11/16/2023-11/2023-11-16%20%E4%B8%AD%E5%9B%BD%E9%93%B6%E8%A1%8C%E6%80%BB%E8%A1%8C%E9%9D%A2%E8%AF%95%E7%BB%8F%E5%8E%86/"/>
    <url>/2023/11/16/2023-11/2023-11-16%20%E4%B8%AD%E5%9B%BD%E9%93%B6%E8%A1%8C%E6%80%BB%E8%A1%8C%E9%9D%A2%E8%AF%95%E7%BB%8F%E5%8E%86/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>ä¸­å›½é“¶è¡Œçš„é¢è¯•åº”è¯¥ä¼šæ˜¯æˆ‘ç§‹æ‹›é‡Œçš„æœ€åä¸€åœºé¢è¯•å§ï¼Œæˆ‘çš„ç§‹æ‹›å¤§æ¦‚ï¼Œä¹Ÿè®¸ï¼Œä¼šæ­¢æ­¥äºæ­¤äº†ï¼Œä¹‹åå°˜åŸƒè½å®šçš„è¯ä¼°è®¡ä¼šå†å†™ä¸€ç¯‡æ€»ç»“å§ã€‚è€Œæ­¤æ¬¡é“¶è¡Œæ€»è¡Œçš„é¢è¯•å½¢å¼ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡å‚ä¸ï¼Œåƒæ˜¯æ— é¢†å¯¼é¢è¯•ã€è‹±è¯­é¢è¯•ç­‰ï¼Œæ‰€ä»¥ä¹Ÿç‰¹æ­¤è®°å½•ä¸€ä¸‹ï¼Œä¸ºåæ¥è€…æä¾›å‚è€ƒã€‚</p><h1 id="é¢è¯•ç»å†"><a class="markdownIt-Anchor" href="#é¢è¯•ç»å†"></a> é¢è¯•ç»å†</h1><p>æ­¤æ¬¡æˆ‘åº”è˜çš„æ˜¯ä¿¡æ¯ç§‘æŠ€ç®¡åŸ¹ç”Ÿçš„å²—ä½ï¼Œå…·ä½“æµç¨‹çš„è¯ï¼Œå…ˆæ˜¯ç­¾åˆ°ï¼Œç„¶åæŠ½ç­¾åˆ†ç»„ï¼Œå…ˆè¿›è¡Œæ— é¢†å¯¼å°ç»„é¢è¯•ï¼Œç„¶ååºå·é åçš„å…ˆè¿›è¡Œè‹±è¯­é¢è¯•ï¼Œé å‰çš„åˆ™æ˜¯å…ˆè¿›è¡Œç»“æ„åŒ–é¢è¯•ï¼Œç„¶åå†è¿›è¡Œäº¤æ¢ã€‚</p><p>é¦–å…ˆè®²è®²æ— é¢†å¯¼å°ç»„é¢è¯•ï¼ŒåŸºæœ¬æ˜¯æ¯ç»„6ä¸ªäººè¿›è¡Œè®¨è®ºï¼Œæ—¶é—´å®‰æ’çš„è¯ï¼Œä¼šæœ‰7åˆ†é’Ÿçœ‹ææ–™æ—¶é—´ï¼Œç„¶åæ˜¯30åˆ†é’Ÿçš„è‡ªç”±è®¨è®ºï¼Œå¹¶ä¸”æœ€ç»ˆéœ€è¦ä¸€ä¸ªç™½æ¿æ±‡æŠ¥ï¼ˆæ±‡æŠ¥çš„æ—¶é—´ä¹Ÿæ˜¯ç®—åœ¨30åˆ†é’Ÿé‡Œï¼‰ã€‚æˆ‘ä»¬è¿™ç»„æŠ½åˆ°çš„é¢˜ç›®æ˜¯è®¾è®¡ä¸€ä¸ªè‡ªé©¾æ¸¸APPï¼Œè€å®è¯´ï¼Œå› ä¸ºæ˜¯ç¬¬ä¸€æ¬¡å‚åŠ è¿™ç§æ— é¢†å¯¼é¢è¯•ï¼Œå¤šå°‘æ˜¯ç´§å¼ çš„ï¼ŒåŸºæœ¬æ²¡ä»€ä¹ˆæ€è·¯ï¼Œå½“åˆ«äººå·²ç»åœ¨åˆ·åˆ·åœ°å¼€å§‹åŠ¨ç¬”æ—¶ï¼Œæˆ‘åœ¨æ…¢åååœ°çœ‹ææ–™ï¼Œæƒ³ä¸å‡ºæ‰€ä»¥ç„¶æ¥ï¼Œåˆ°æœ€åä¹Ÿåªæ˜¯å°†ææ–™ç»™å‡ºçš„ä¸‰ä¸ªç”¨æˆ·ç—›ç‚¹ç®€å•å¤è¿°å†™äº†ä¸‹ã€‚åˆ°æ­£å¼å¼€å§‹è®¨è®ºæ—¶ï¼Œå…¶ä»–åŒå­¦ä¹Ÿæ˜¯å„æ˜¾ç¥é€šï¼Œçº·çº·è¸Šè·ƒå‘è¨€ï¼Œè€Œæˆ‘åœ¨å…¶ä¸­æ˜¾å¾—æœ‰äº›ä¸çŸ¥æ‰€æªï¼Œæƒ³è¦è¯´äº›ä»€ä¹ˆï¼Œå´è¢«äººæŠ¢ç€è¯è¯´ã€‚åŸå…ˆæˆ‘çœŸæ˜¯æƒ³å¾—å¤ªç®€å•äº†ï¼Œè‡ªä»¥ä¸ºæ˜¯å¾ˆæœ‰å‹‡æ°”ã€æ•¢äºå‘è¨€çš„ç±»å‹ï¼Œä½†å…¶å®å¤šå°‘æ˜¯æœ‰äº›ç‹‚å¦„è‡ªå¤§äº†ï¼ŒçœŸåˆ°äº†é‚£ä¸ªæ¿€çƒˆè®¨è®ºçš„åœºæ™¯ä¸‹ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„åº•æ°”å’Œè‡ªä¿¡ï¼Œä»¥åŠçŸ¥è¯†å‚¨å¤‡ï¼Œæ˜¯å¾ˆéš¾æ‰“ç ´è‡ªå·±çš„å¿ƒç†éšœç¢ï¼Œæ¥å‚ä¸åˆ°è¿™åœºæ€ç»´çš„ç¢°æ’ä¹‹ä¸­ã€‚åˆ°æœ€åï¼Œæˆ‘å¥½åƒè¯´è¿‡çš„è¯ä¹Ÿæ²¡è¶…è¿‡3å¥ï¼Œè€å®è¯´è¿˜æ˜¯å¿ƒæ€æ²¡æœ‰æ‘†æ­£ï¼Œæˆ–è€…è¯´åœ¨ä¸­é€”å·²ç»ç ´é˜²äº†ï¼Œå·²ç»æ”¾å¼ƒäº†ï¼Œå·²ç»æƒ³ç€â€ç®—äº†ï¼Œç®—äº†ï¼Œéƒ½è¿™æ ·äº†ï¼Œå°±å½“é‡åœ¨å‚ä¸äº†â€œã€‚æˆ–è®¸è¯´é”™è¯å¹¶ä¸å¯æ€•ï¼Œä½†ä»¤äººæ‚²å“€çš„æ˜¯è¿å‘å£°çš„å‹‡æ°”éƒ½ä¸§å¤±äº†ï¼Œä»¤äººç—›å¿ƒç–¾é¦–çš„æ˜¯ï¼Œæˆ‘ç”šè‡³ä¸æ„¿åšæŒåˆ°æœ€åï¼Œä¸æ„¿å»é¢å¯¹è¿™åœºæŒ‘æˆ˜å’Œè‹¦éš¾ï¼Œè€Œæ˜¯æ—©æ—©åœ°ä¸¢ç›”å¸ç”²ï¼Œæˆäº†ä¸€åé€ƒå…µã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202311161859672.webp" alt="" /></p><p>æ¥ç€æˆ‘æ˜¯å†å»è‹±è¯­é¢è¯•ï¼Œä¸­è¡Œçš„è‹±è¯­é¢è¯•å½¢å¼ä¹Ÿå¾ˆæ–°é¢–ï¼Œé‡‡å–äº†è¾©è®ºçš„å½¢å¼ï¼Œæˆ‘å’ŒåŒç»„çš„å¦ä¸€åæˆå‘˜ä¸€èµ·å’Œå¦å¤–ä¸¤ååŒå­¦è¿›è¡Œè‹±è¯­çš„è¾©è®ºï¼Œå…·ä½“æ—¶é—´å®‰æ’æ˜¯ï¼Œ5åˆ†é’Ÿçš„çœ‹è¾©é¢˜æ€è€ƒï¼Œ5åˆ†é’Ÿçš„å°ç»„è®¨è®ºï¼Œ5åˆ†é’Ÿçš„è‡ªç”±è¾©è®ºã€‚æˆ‘è¿™è¾¹æŠ½åˆ°çš„é¢˜ç›®æ˜¯ <em>The railway shoud charge less for non-seat tickets</em>. ä¸€å¼€å§‹çœ‹é¢˜æ€è€ƒçš„æ—¶å€™ï¼Œæˆ‘è¿˜æŠŠrailwayç†è§£æˆäº†åœ°é“çš„æ„æ€ï¼Œåˆ°åå°ç»„è®¨è®ºçš„æ—¶å€™æ‰æ˜ç™½è¿‡æ¥ï¼ŒçœŸæ˜¯ä»¤äººè‹¦ç¬‘ä¸å¾—ã€‚ç„¶åè‡ªç”±è¾©è®ºçš„è¿‡ç¨‹çš„è¯ï¼ŒåŸºæœ¬åˆæ˜¯é‡ç°äº†æ— é¢†å¯¼å°ç»„çš„æƒ…æ™¯ï¼ŒåŸºæœ¬åˆæ˜¯æ²¡æ’ä¸Šä¸€å¥è¯ï¼Œå…¨ç¨‹çœ‹ç€ teammate å’Œå¯¹æ–¹å±•å¼€è®ºè¿°äº¤æµã€‚æœ€åå”¯ä¸€çš„å‘è¨€ï¼Œä¹Ÿæ˜¯ç£•ç£•ç»Šç»Šã€‚ç°åœ¨å¤ç›˜æ¥çœ‹ï¼Œä¸»è¦è¿˜æ˜¯ç¼ºä¹å¼€å£çš„å‹‡æ°”ï¼Œå› ä¸ºæ²¡æœ‰å¬æ‡‚å¯¹æ–¹åœ¨è¯´ä»€ä¹ˆï¼Œä»è€Œå¯¼è‡´æ— åŠ›å¼€å£ï¼Œç»§è€Œæ”¾å¼ƒå‘è¨€ï¼Œå…¶å®çœŸçš„æ²¡ä»€ä¹ˆï¼Œæ²¡å¬æ¸…æ¥šçš„è¯å°±è®©å¯¹æ–¹å†è®ºè¿°ä¸€éï¼ŒåŒæ—¶äº®æ˜è‡ªå·±çš„è§‚ç‚¹å³å¯ï¼Œæœ€é‡è¦çš„è¿˜æ˜¯è‡ªä¿¡ï¼Œè¿˜æ˜¯è¦æ•¢äºå‘è¨€ï¼Œä¸å¿…å»è¿½æ±‚æµåˆ©æˆ–è¯­é€Ÿï¼Œå…³é”®è¯´æ¸…æ¥šè§‚ç‚¹ã€å…³é”®å­—ã€‚</p><p>é‚£ä¹ˆæœ€åæ˜¯ç»“æ„åŒ–é¢è¯•ï¼Œå°±æ˜¯ç»™äº†ä¸€å¼ çº¸ï¼Œçº¸ä¸Šä¼šæœ‰ä¸‰é“é¢˜ï¼Œæ¯é“é¢˜ä¼šæœ‰2~3åˆ†é’Ÿçš„ä½œç­”æ—¶é—´ï¼Œæˆ‘çš„è¯ï¼Œç¬¬ä¸€é“æ˜¯ä¸€å¥â€ä¹ è¯­â€œï¼Œå¤§æ„æ˜¯å¹´è½»äººè¦ç›´é¢è‹¦éš¾æŒ‘æˆ˜ï¼Œäº‰åšæ—¶ä»£å¼„æ½®å„¿ï¼Œéœ€è¦è°ˆè°ˆè‡ªå·±çš„ç†è§£ï¼Œä»¥åŠæœªæ¥å¦‚ä½•åœ¨å·¥ä½œä¸­è·µè¡Œï¼›ç¬¬äºŒé“çš„è¯æ˜¯äºŒé€‰ä¸€ä½œç­”ï¼Œä¸€ä¸ªæ˜¯å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯¹å…¶ä¸­çš„å…ƒéŸ³å­—æ¯è¿›è¡Œåè½¬ï¼Œå¦ä¸€ä¸ªé€‰æ‹©æ—¶è®²è®²åœ¨æ¨èç³»ç»Ÿä¸­å¦‚ä½•è§£å†³å†·å¯åŠ¨é—®é¢˜ï¼›ç¬¬ä¸‰é“æ˜¯é’ˆå¯¹äºæ•°å­—åŒ–åŒ»ç–—ç§‘æŠ€ï¼Œæœ‰äººè®¤ä¸ºæœ‰å¥½æœ‰åï¼Œæ¥è°ˆè°ˆè‡ªå·±çš„ç†è§£ã€‚ç­”å®Œä¹‹åçš„è¯ï¼Œé¢è¯•ä¹Ÿè¿½é—®äº†ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚å°±æœ‰é¢è¯•å®˜é—®æˆ‘ä¸ºä»€ä¹ˆåœ¨æ— é¢†å¯¼å°ç»„è®¨è®ºæœŸé—´åŸºæœ¬æ²¡æœ‰è¯´è¯ï¼Œæˆ‘ä¹Ÿåªèƒ½ç¬‘ç€å¦‚å®å›ç­”ã€‚</p><h1 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h1><p>è¿™æ¬¡çš„é¢è¯•åˆæ˜¯ä¸€æ¬¡å¯¹æˆ‘çš„æ‹·æ‰“ï¼Œä¹Ÿä½“ç°å‡ºäº†æˆ‘çš„ç§ç§ä¸è¶³ï¼Œæˆ‘å¯ä»¥æœ‰å¾ˆå¤šç†ç”±æ¥æ©ç›–è¿™æ¬¡å¤±åˆ©ï¼Œæ¥é€ƒé¿è¿™æ¬¡å¤±è´¥ï¼Œæ¥æ¬ºéª—å®‰æ…°è‡ªå·±æ²¡æœ‰å…³ç³»ï¼Œä½†é—®é¢˜ç»ˆç©¶æ˜¯æ²¡æœ‰è§£å†³ã€‚åŸåœ°è¸æ­¥ï¼Œä¸æ€è¿›å–ï¼Œé‚£åˆæ€ä¹ˆåœ¨ä¼—äººä¹‹ä¸­è„±é¢–è€Œå‡ºï¼Ÿ</p>  <p class='note note-info' ><font size='5'>ä½ åæ‰‹æ— åŠ›ï¼Œæ­£æ‰‹ä¸ç²¾ï¼Œè„šæ­¥æ¾æ•£ï¼Œååº”è¿Ÿé’ï¼Œæ²¡ä¸€ä¸ªåŠ¨ä½œåƒæ ·ï¼Œå°±ä½ è¿™æ ·è¿˜æƒ³ç»™æˆ‘åŒå°è¾ƒé‡å—ï¼Ÿåšä½ çš„ç¾æ¢¦ï¼</font>  <br>    <font size='4' align='right'><i align="right">â€”â€”ã€Šä¹’ä¹“ã€‹</i></font></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202311161716081.png" alt="ä¹’ä¹“-å­”æ–‡é©" /></p>]]></content>
    
    
    <categories>
      
      <category>ç§‹æ‹›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚è°ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç§‹æ‹›æµ…è°ˆ</title>
    <link href="/2023/10/17/2023-10/%E7%A7%8B%E6%8B%9B%E6%B5%85%E8%B0%88/"/>
    <url>/2023/10/17/2023-10/%E7%A7%8B%E6%8B%9B%E6%B5%85%E8%B0%88/</url>
    
    <content type="html"><![CDATA[<p class="note note-primary">  æ²¡æƒ³åˆ°é¸½äº†ä¸€å¹´å¤šï¼Œå±…ç„¶ä¼šæ˜¯è¿™æ ·çš„æ–¹å¼ï¼Œåœ¨è¿™æ ·çš„ä¸€ä¸ªæ—¶é—´æ¥æ›´æ–°åšå®¢ï¼Œæˆ–è®¸ï¼ŒçœŸçš„æ˜¯æœ‰äº›å¤±è´¥å§ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202310172029585.jpeg" alt="" /></p><hr /><p>æ›´æ–°çš„èµ·å› ï¼Œè¿˜æ˜¯å› ä¸ºä»Šå¤©ä¸‹åˆåä¸ºçš„é¢è¯•ï¼Œæœ€ååœ¨ä¸šåŠ¡ä¸»ç®¡é¢æŒ‚æ‰äº†ï¼Œåœ¨å®˜ç½‘ä¸ŠæŸ¥è¯¢åˆ°ç»“æœçš„é‚£ä¸€åˆ»è«åçš„ç”µæµæ¶Œè¿‡å…¨èº«ï¼Œå˜´é‡Œå–ƒå–ƒç€ï¼Œâ€œæ˜¯å—ï¼Œè¿™æ ·å—ã€‚ã€‚ã€‚â€</p><p>â€œæˆ‘è¿˜æ˜¯å¤±è´¥äº†å‘¢ã€‚â€</p><p>å°±åƒæ˜¯å‹å®éª†é©¼çš„æœ€åä¸€æ ¹ç¨»è‰ï¼Œè¿™ä¸€æ¬¡çš„å¤±åˆ©ä¹Ÿè®©æˆ‘ç™¾æ„Ÿäº¤é›†ï¼Œå†²ç ´äº†æˆ‘çš„é˜²çº¿ï¼ˆè™½ç„¶æˆ‘ä¹Ÿå·²ç»éº»æœ¨äº†ï¼‰ã€‚å›å¤´æƒ³æƒ³ï¼Œä¸»ç®¡æŒ‚äººä¹Ÿå¹¶éæ¯«æ— é“ç†ï¼Œé¦–å…ˆä¸€ä¸ªæ˜¯äºŒé¢ç¬¬ä¸€æ¬¡çš„æ‰‹æ’•é¢˜æ²¡å†™å‡ºæ¥ï¼ˆè™½ç„¶äºŒé¢æ˜¯è¿‡äº†ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯å¯èƒ½äº¤æµçš„æ—¶å€™ï¼Œæ²¡æœ‰è¡¨è¾¾å‡ºè¿«åˆ‡æƒ³è¦å»çš„æ„æ„¿ï¼Œå¯èƒ½è¡¨ç°å‡ºæ¥çš„è¿˜æ˜¯é‚£ç§æ‰¾æ‰¾æœºä¼šçš„æ€åº¦ï¼Œå¦å¤–çš„è¯ï¼Œå¯èƒ½å°±æ˜¯è°ˆåå“ªé‡Œä¸å¾—ä½“ï¼Œæˆ–è€…å“ªä¸ªéƒ¨åˆ†è§¦åŠé›·åŒºäº†ï¼Œæˆ–è€…æš´éœ²æˆ‘æœ¬æ€§æ— èƒ½äº†ï¼Ÿæˆ–è®¸å§ï¼Œä½†æ— è®ºå¦‚ä½•ï¼Œä»ç»“æœä¸Šçœ‹ï¼Œæˆ‘è·Ÿåä¸ºçš„ç¼˜åˆ†ä¼¼ä¹åˆ°æ­¤ä¸ºæ­¢äº†ï¼Œä¸ï¼Œåº”è¯¥æ˜¯å½»åº•ç»“æŸäº†ï¼Œå½»å½»åº•åº•ï¼Œç»æ— å¯èƒ½ã€‚</p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202310172207348.jpeg" alt ="ä¸ç”˜å¿ƒ" width="50%" height="50%" align="middle"/></center><p>æ˜¯å•Šï¼Œä»8æœˆåº•å›å­¦æ ¡å¼€å§‹æ­£å¼åŠªåŠ›å‡†å¤‡ç§‹æ‹›ï¼Œåˆ°ç°åœ¨10æœˆä¸­æ—¬å¤šï¼Œé™¤äº†å­—èŠ‚çš„è½¬æ­£äº‰å–åˆ°çš„æ„å‘ï¼Œæ²¡æœ‰å†æ‹¿åˆ°å…¶ä»–çš„æ„å‘æˆ–æ˜¯offeräº†ï¼Œå†é™¤å»è¿˜åœ¨æ³¡æ± å­çš„å¿«æ‰‹å’Œé˜¿é‡Œäº‘ï¼Œå…¶ä»–æ‰€æœ‰çš„æŠ•é€’éƒ½å¤±è´¥äº†ï¼Œå¤±è´¥å¾—å¦‚æ­¤å½»åº•ã€‚å¼€å§‹å‰æ‰‹æ¡æœ‰ä¸€ä¸ªæ„å‘ï¼Œå¿«ç»“æŸäº†ä¹Ÿåªæœ‰è¿™ä¸€ä¸ªï¼Œå¤šå°‘æœ‰äº›æ‚²å‡‰ï¼Œä¸æ˜¯ä¹ˆã€‚æƒ³æƒ³å¼€å§‹æ—¶çš„æ„æ°”å¥‹å‘ï¼Œå¯¹ä¸­å°å‚çš„ç½®ä¹‹ä¸ç†ï¼Œä¸æ„¿æŠ•é€’ï¼Œè¿›è¡Œæ—¶çš„å››å¤„ç¢°å£ï¼Œå„ç§æ‹·æ‰“ï¼Œåæ‚”è«åŠæ—¶çš„åŒ†å¿™æŠ•é€’ï¼Œäº¡ç¾Šè¡¥ç‰¢ï¼Œä»¥åŠæœ€åçš„ä¸€è´¥æ¶‚åœ°ï¼Œç«¹ç¯®æ‰“æ°´ä¸€åœºç©ºï¼Œå¤šå°‘æœ‰äº›è®½åˆºï¼Œä¸æ˜¯ä¹ˆï¼Ÿ</p><p>æƒ³æƒ³è‡ªèº«çš„åŸå› ï¼Œç¬¬ä¸€ï¼Œç§‹æ‹›å‡†å¤‡å¾—æ™šï¼Œ8æœˆåº•æ‰å¼€å§‹å‡†å¤‡ï¼Œå„ç±»æå‰æ‰¹ä¹Ÿéƒ½æ²¡æ•¢å°è¯•æŠ•é€’ï¼Œå¦‚æœæ—©ç‚¹å¼€å§‹å‡†å¤‡ï¼Œç»“æœä¼šä¸ä¼šä¸ä¸€æ ·ï¼Œå¯æ˜¯ä»æ¥æ²¡æœ‰å¦‚æœï¼›ç¬¬äºŒï¼Œç§‹æ‹›æœŸé—´è¿˜ä¸å¤ŸåŠªåŠ›ï¼ŒåªæŠ•å…¥äº†80%çš„æ—¶é—´ï¼Œæ²¡æœ‰æŠ•å…¥100%ï¼Œæ‰€ä»¥æ‰ä¼šæœ‰è¿™ç§ä¸ä¸Šä¸ä¸‹çš„å¤±è½æ„Ÿï¼Œä¸ç”˜å¿ƒï¼Œâ€œå¦‚æœå½“åˆè‡ªå·±æŠŠé‚£äº›å¨±ä¹æ—¶é—´éƒ½æŠ•å…¥è¿›å»ï¼Œç»“æœä¼šä¸ä¼šä¸ä¸€æ ·â€ï¼Œå¯æ˜¯ä»æ¥æ²¡æœ‰å¦‚æœï¼›ç¬¬ä¸‰ï¼›ç§‹æ‹›å‡†å¤‡çš„ç­–ç•¥è¿˜æ˜¯æœ‰ç‚¹é—®é¢˜ï¼Œæˆ–è€…è¯´æ‰§è¡ŒåŠ›ä¸å¤Ÿï¼Œæ˜æ˜æ—©å°±è®¡åˆ’è¦æå‰æ¢³ç†å®Œä¸€éå…«è‚¡ç›¸å…³çŸ¥è¯†ï¼Œä½†è¿Ÿè¿Ÿæ²¡æœ‰æŒ‰è®¡åˆ’æ‰§è¡Œï¼Œå€’æ˜¯ä»¥å„ç§é¢è¯•ã€ç¬”è¯•å æ®æ—¶é—´ä¸ºç”±è€Œæ¨è„±ï¼Œå°æ—coding çš„ç½‘ç«™ç”šè‡³æ˜¯æ˜¨å¤©æ‰åˆšæ‰“å¼€ï¼Œå¦‚æœèƒ½æå‰ä¸€ä¸ªæœˆå¤ä¹ ä¸€éï¼Œç»“æœä¼šä¸ä¼šä¸ä¸€æ ·ï¼Œå¯æ˜¯æ²¡æœ‰å¦‚æœï¼›ç¬¬å››ï¼Œæ€§æ ¼ä¸å¤Ÿæˆç†Ÿï¼Œæ€åº¦ä¸å¤Ÿè¯šæ³ï¼Œé¢è¯•çš„æ²¡æœ‰è¡¨è¾¾å‡ºå¼ºçƒˆæƒ³å»å¯¹æ–¹éƒ¨é—¨çš„æ„æ„¿ï¼Œæ˜¾å¾—æœ‰äº›éšæ€§ï¼Œå¯èƒ½åœ¨å¯¹æ–¹çœ‹æ¥æˆ‘åªæ˜¯æ¥ç¢°ä¸ªè¿æ°”æ‰¾æ‰¾æœºä¼šï¼Œèƒ½äº‰å–åˆ°æœ€å¥½ï¼Œæ²¡æœ‰ä¹Ÿæ— æ‰€è°“çš„æ€åº¦ã€‚<del>ï¼ˆå­—èŠ‚ä¿åº•å¸¦æ¥çš„è‡ªè´Ÿï¼‰</del></p><p>å†æƒ³æƒ³å¯èƒ½çš„å®¢è§‚åŸå› å§ï¼ˆè®©è‡ªå·±å¥½å—äº›ï¼‰ï¼Œç¬¬ä¸€ï¼Œåœ°åŸŸåŠ£åŠ¿ï¼Œèº«å¤„è½¯å¾®ï¼Œè·‘åˆ°æœ¬éƒ¨æˆ–æ˜¯å¸‚åŒºè¦å¤§è´¹å‘¨æŠ˜ï¼Œç‰¹åˆ«æŠ˜è…¾ï¼Œæ‰€ä»¥ä¸æ˜¯æ„æ„¿ç‰¹åˆ«å¼ºçƒˆçš„å…¬å¸å•ä½ä¸æƒ³è·‘ä¸€è¶Ÿï¼Œä¹Ÿå› æ­¤é”™è¿‡äº†æœ¬éƒ¨å¤§é‡çš„å®£è®²ä¼šå’Œæ‹›è˜ä¼šï¼Œæˆ–è®¸å°±é”™è¿‡äº†ä¸å°‘å¥½çš„æœºé‡ï¼›ç¬¬äºŒï¼Œä¸¤æ®µå®ä¹ ç»å†éƒ½åœ¨å­—èŠ‚ï¼Œæ—¶é—´ä¹Ÿç‰¹åˆ«é•¿ï¼Œä¸éš¾è®©äººè”æƒ³ä½ å¯¹å­—èŠ‚çš„ä¸€ä¸ªå¿ è¯šåº¦ï¼Œä»¥åŠå»åˆ«çš„å…¬å¸çš„å¯èƒ½æ€§ï¼Œæˆ–è®¸å°±æ˜¯ï¼Œæˆä¹Ÿå­—èŠ‚ï¼Œè´¥ä¹Ÿå­—èŠ‚ã€‚</p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202310172156548.jpeg" width="50%" height="50%" align="middle"/></center></br><p>ä¸è¿‡ç§‹æ‹›è¿˜æ²¡æ­£å¼ç»“æŸï¼Œå€’ä¹Ÿä¸å¿…å¦‚æ­¤æ‚²è§‚ï¼Œç»§ç»­å¤‡æˆ˜ï¼Œç­‰å¾…æ—¶æœºï¼Œä¸ä»¥ç‰©å–œä¸ä»¥å·±æ‚²ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202310172213561.jpeg" alt="" /></p>]]></content>
    
    
    <categories>
      
      <category>ç§‹æ‹›</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚è°ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C++æµ‹è¯•å·¥å…·</title>
    <link href="/2022/07/30/2022-07/C++%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/"/>
    <url>/2022/07/30/2022-07/C++%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>è¯´æ¥æƒ­æ„§ï¼Œæ–­æ›´äº†ä¸€ä¸ªå¤šæœˆäº†ï¼Œä¸€æ–¹é¢çš„ç¡®æ˜¯æœ€è¿‘å¼€å§‹å®ä¹ ï¼Œæ—¶é—´å˜å¾—ç´§å¼ èµ·æ¥ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿçš„ç¡®æ˜¯è‡ªå·±å·æ‡’äº†ï¼Œæ¾æ‡ˆäº†ä¸å°‘ã€‚å¦å¤–ï¼Œæ¯”è¾ƒéš¾å—çš„æ˜¯ï¼Œæœ¬æ¥è¿™ç¯‡åšæ–‡å·²ç»åœ¨å¦ä¸€å°ç”µè„‘ä¸Šå†™å¥½äº†å¤§æ¦‚ï¼Œå‡†å¤‡ä¸Šå‘¨å°±å‘çš„ï¼Œä½†æ˜¯å› ä¸ºè¢«ä¸€äº›äº‹æƒ…è€½æäº†ï¼Œç»“æœè¿™å‘¨å†å»æ‰¾çš„æ—¶å€™ï¼Œç»“æœå‘ç°åŸæ–‡æ‰¾ä¸åˆ°äº†ï¼ŒçœŸçš„æ˜¯è€å€’éœ‰è›‹äº†ï¼Œæ‰€ä»¥åªèƒ½ç¡¬ç€å¤´çš®é‡æ–°å†™ä¸€ç¯‡ QAQã€‚</p><h1 id="gtest"><a class="markdownIt-Anchor" href="#gtest"></a> gtest</h1><p>é‚£ä¹ˆé¦–å…ˆæ¥ä»‹ç»GoogleTestï¼ˆç®€ç§°gtestï¼‰ï¼Œè¿™æ˜¯ç”±googleæ¨å‡ºçš„C++æµ‹è¯•æ¡†æ¶ï¼Œå…¶åŠŸèƒ½ä¹‹å¼ºå¤§è‡ªç„¶ä¸å¿…å¤šè¯´ï¼Œæ¥ä¸‹æ¥å°±ç®€å•ä»‹ç»gtestçš„ç›¸å…³æ¦‚å¿µåŠå…¶ä½¿ç”¨ï¼Œæ›´å¤šçš„ä½¿ç”¨è¯´æ˜å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://google.github.io/googletest/primer.html">https://google.github.io/googletest/primer.html</a></p><p>é¦–å…ˆä»‹ç»ä¸€äº›æœ¯è¯­æ¦‚å¿µï¼Œåˆ†åˆ«æ˜¯ <em>Test</em>, <em>Test Case</em> and <em>Test Suite</em> ï¼Œè¿™å‡ ä¸ªå•è¯åœ¨gtestæ¡†æ¶ä¸­çš„å«ä¹‰ ä¸åœ¨<a href="http://www.istqb.org/">ISTQB</a>ï¼ˆå›½é™…è½¯ä»¶æµ‹è¯•èµ„è´¨è®¤è¯å§”å‘˜ä¼šï¼‰å®šä¹‰çš„å«ä¹‰æœ‰æ‰€ä¸åŒï¼Œè¿™é‡Œå°±ä»‹ç»åœ¨gtesté‡Œçš„å«ä¹‰ã€‚å› ä¸ºå†å²åŸå› ï¼Œåœ¨gtestä¸­ï¼Œ <em>Test</em> è®¤ä¸ºæ˜¯ä¸€ä¸ªå•å…ƒæµ‹è¯•ç¨‹åºï¼ˆæŒ‡å®šè¾“å…¥ï¼Œæ£€æµ‹è¾“å‡ºï¼‰ï¼Œè€Œ <em>Test Cast</em> è¢«è®¤ä¸ºæ˜¯ä¸€ç»„ç›¸å…³çš„æµ‹è¯•ï¼Œç°åœ¨ï¼Œgoogleå¼€å§‹ç”¨ <em>Test Suite</em> æ¥æ›¿æ¢ <em>Test Case</em>ã€‚</p><p>æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€äº›åŸºæœ¬æ¦‚å¿µï¼Œä¾‹å¦‚åœ¨gtestä¸­ï¼Œä½¿ç”¨æ–­è¨€ï¼ˆAssertionï¼‰åˆ¤æ–­ä¸€ä¸ªæ¡ä»¶æˆç«‹ä¸å¦ï¼Œä¸€ä¸ª Assertion çš„ç»“æœå¯ä»¥æ˜¯success, non-fatal failure, or fatal failureï¼Œ å¦‚æœæ˜¯fatal failure åˆ™æµ‹è¯•ç¨‹åºç›´æ¥ç»ˆæ­¢ï¼Œè€Œå¦‚æœæ˜¯non-fatal failureï¼Œåˆ™ç¨‹åºç¨‹åºç»§ç»­æ‰§è¡Œï¼Œåªæœ‰å½“æµ‹è¯•ç¨‹åºæ²¡æœ‰å‡ºç°ä»»ä½• failure æ—¶ï¼Œæµ‹è¯•æ‰ç®—é€šè¿‡ã€‚ä¸€ä¸ª Test Suiteå¯ä»¥åŒ…å«å¤šä¸ª testï¼Œè¿™äº› test å¯ä»¥å…±äº«ä¸€äº›å¯¹è±¡å’Œæµç¨‹ï¼Œå¯ä»¥æ”¾åœ¨ TestFixture classä¸­ã€‚è€Œä¸€ä¸ªæµ‹è¯•ç¨‹åºå¯ä»¥åŒ…å«å¤šä¸ª Test Suiteã€‚</p><p>åˆšåˆšæåˆ°äº†Assertion æ–­è¨€ï¼Œç›¸å…³çš„APIå°±æ˜¯ASSERT_ * å’Œ EXPECT_ * ï¼Œå¦‚æœASSERTå¤±è´¥äº†åˆ™ç¨‹åºæ‰§è¡Œï¼Œè€ŒEXPECTå¤±è´¥äº†ï¼Œåˆ™ç¨‹åºä¼šç»§ç»­æ‰§è¡Œä¸‹é¢çš„æµ‹è¯•ã€‚å¯ä»¥ä½¿ç”¨TEST() å®å®šä¹‰æ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„å•å…ƒæµ‹è¯•ï¼ŒåŒæ—¶gtestä½¿ç”¨TestSuiteNameæ¥æ±‡æ€»testï¼Œæ‰€ä»¥å…·æœ‰ç›¸å…³æ€§çš„testä½¿ç”¨ç›¸åŒçš„TestSuiteNameã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">func</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span> </span>&#123;...&#125;<br><br><span class="hljs-built_in">TEST</span>(TestSuiteName, TestName1) &#123;<br>  <span class="hljs-built_in">EXPECT_EQ</span>(<span class="hljs-built_in">func</span>(<span class="hljs-number">0</span>), <span class="hljs-number">0</span>);<br>&#125;<br><br><span class="hljs-built_in">TEST</span>(TestSuiteName, TestName2) &#123;<br>  <span class="hljs-built_in">EXPECT_EQ</span>(<span class="hljs-built_in">func</span>(<span class="hljs-number">0</span>), <span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>TestSuiteName å’Œ TestName æœ€å¥½ä¸è¦ä½¿ç”¨ä¸‹åˆ’çº¿</strong>ï¼Œå› ä¸ºåœ¨gtestæºç ä¸­ï¼Œä¼šä½¿ç”¨ä¸‹åˆ’çº¿å°†å®ƒä»¬æ‹¼æ¥æˆä¸€ä¸ªç±»åã€‚è¿™å†ç®€å•ä»‹ç»ä¸‹gtestçš„å®ç°å§ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨TESTç¼–å†™å¥½ä¸€ä¸ªtestï¼Œè¯¥å®ä¼šå°†å…¶å±•å¼€ä¸ºä¸€ä¸ªç±»ï¼Œå¹¶å£°æ˜ä¸€ä¸ªTestBodyå‡½æ•°ï¼Œè€ŒTestBodyçš„å®ç°å°±æ˜¯TESTé‡Œç”¨æˆ·ç¼–å†™çš„é€»è¾‘ã€‚</p></blockquote><p>è€Œå½“TestSuiteä¸­æœ‰å…¬å…±æµç¨‹æ—¶ï¼Œå°±å¯ä»¥æå–å‡ºæ¥ï¼Œé¿å…é‡å¤ç¼–å†™ï¼Œè¿™å°±æ˜¯TestFixtureã€‚TestFixtureéœ€è¦ä½¿ç”¨TEST_Fæ¥å®šä¹‰testï¼Œå…¶ä¸­<code>SetUp</code>å‡½æ•°åœ¨ä¼šåœ¨æ¯æ¬¡TEST_Fæ‰§è¡Œå‰åˆå§‹åŒ–ä¸€æ¬¡ï¼Œ<code>TearDown</code> å‡½æ•°åˆ™æ˜¯æ¯æ¬¡åœ¨æ‰§è¡Œå®Œä¹‹åæ‰§è¡Œï¼Œé‡Šæ”¾èµ„æºã€‚ä¸€ä¸ªç®€å•ä¾‹å­å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;gtest/gtest.h&quot;</span></span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FuncTest</span> :</span> <span class="hljs-keyword">public</span> ::testing::Test &#123;<br> <span class="hljs-keyword">protected</span>:<br>  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SetUp</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>&#123;<br>     q1_.<span class="hljs-built_in">Enqueue</span>(<span class="hljs-number">1</span>);<br>     q2_.<span class="hljs-built_in">Enqueue</span>(<span class="hljs-number">2</span>);<br>     q2_.<span class="hljs-built_in">Enqueue</span>(<span class="hljs-number">3</span>);<br>  &#125;<br><br>  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">TearDown</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>&#123;<br>  &#125;<br><br>  Queue&lt;<span class="hljs-keyword">int</span>&gt; q0_;<br>  Queue&lt;<span class="hljs-keyword">int</span>&gt; q1_;<br>  Queue&lt;<span class="hljs-keyword">int</span>&gt; q2_;<br>&#125;;<br><br><span class="hljs-built_in">TEST_F</span>(FuncTest, IsEmptyInitially) &#123;<br>  <span class="hljs-built_in">EXPECT_EQ</span>(q0_.<span class="hljs-built_in">size</span>(), <span class="hljs-number">0</span>);<br>&#125;<br><br><span class="hljs-built_in">TEST_F</span>(FuncTest, DequeueWorks) &#123;<br>  <span class="hljs-keyword">int</span>* n = q0_.<span class="hljs-built_in">Dequeue</span>();<br>  <span class="hljs-built_in">EXPECT_EQ</span>(n, <span class="hljs-literal">nullptr</span>);<br><br>  n = q1_.<span class="hljs-built_in">Dequeue</span>();<br>  <span class="hljs-built_in">ASSERT_NE</span>(n, <span class="hljs-literal">nullptr</span>);    <span class="hljs-comment">// ç»§ç»­è¿è¡Œå·²æ— å¿…è¦ï¼Œå¤±è´¥æ—¶ç›´æ¥ä¸­æ–­</span><br>  <span class="hljs-built_in">EXPECT_EQ</span>(*n, <span class="hljs-number">1</span>);         <span class="hljs-comment">// ç»§ç»­è¿è¡Œæš´éœ²æ›´å¤šé—®é¢˜</span><br>  <span class="hljs-built_in">EXPECT_EQ</span>(q1_.<span class="hljs-built_in">size</span>(), <span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">delete</span> n;<br><br>  ....<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span> **argv)</span> </span>&#123;<br>  ::testing::<span class="hljs-built_in">InitGoogleTest</span>(&amp;argc, argv);<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">RUN_ALL_TESTS</span>();<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•´ä½“æµç¨‹ï¼š</p><ol><li><p>ç¼“å­˜gtest flagsçš„çŠ¶æ€ï¼›</p></li><li><p>ä¸ºç¬¬ä¸€ä¸ªteståˆ›å»ºTestFixtureå¯¹è±¡ï¼›</p></li><li><p>gteståˆ›å»ºFuncTestå¯¹è±¡ï¼ˆo1ï¼‰ï¼›</p></li><li><p>o1.SetUp()ï¼›</p></li><li><p>åŸºäºo1ï¼Œè¿è¡Œç¬¬ä¸€ä¸ªtestï¼ˆIsEmptyInitiallyï¼‰ï¼›</p></li><li><p>o1.TearDownï¼›</p></li><li><p>ææ„o1ï¼›</p></li><li><p>åœ¨gtest flagsä¸­å­˜å‚¨çŠ¶æ€ï¼›</p></li><li><p>é‡å¤ä¸Šè¿°æ“ä½œï¼Œè¿è¡Œä¸‹ä¸€ä¸ªtestï¼ˆDequeueWorksï¼‰ï¼Œä¸€ç›´åˆ°ç»“æŸï¼›</p></li></ol><p class='note note-info'>  è¿˜å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœéœ€è¦è®¿é—®private & protected æˆå‘˜å’Œå‡½æ•°ï¼Œå¯ä»¥æ·»åŠ ç¼–è¯‘é€‰é¡¹ -fon-access-controlï¼Œå¦‚æœä½¿ç”¨cmakeçš„è¯ï¼Œå¯ä»¥æ·»åŠ  ADD_COMPILE_OPTIONS(-fno-access-control) </p><h1 id="gmock"><a class="markdownIt-Anchor" href="#gmock"></a> gmock</h1><p>gmockä¹Ÿæ˜¯gtestæµ‹è¯•æ¡†æ¶ä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå½“æˆ‘ä»¬æµ‹è¯•ä¸€ä¸ªæ¨¡å—çš„æ—¶å€™ï¼Œå¯èƒ½æ¶‰åŠåˆ°å’Œå…¶ä»–æ¨¡å—äº¤äº’ï¼Œæ­¤æ—¶å¯ä»¥å°†æ¨¡å—ä¹‹é—´çš„æ¥å£mockï¼Œæ¨¡æ‹Ÿäº¤äº’è¿‡ç¨‹ï¼Œå…¶ä½œç”¨ç±»ä¼¼ç™½ç›’æµ‹è¯•ä¸­çš„æ‰“æ¡©çš„æ¦‚å¿µã€‚ï¼ˆæ‰“æ¡©æ˜¯è½¯ä»¶æµ‹è¯•é‡Œå•å…ƒæµ‹è¯•çš„ä¸€ç§æ–¹æ³•ï¼Œå•å…ƒæµ‹è¯•æ¶‰åŠæ‰‹å·¥ç¼–å†™æµ‹è¯•é›†ã€æŒ‡å®šè¾“å…¥æ•°æ®ä»¥åŠä¸ºç¼ºå°‘çš„å‡½æ•°æä¾›æ¡©å‡½æ•°ã€‚ç»™æ¡©å‡½æ•°æä¾›è¿”å›å€¼å«åšæ‰“æ¡©ã€‚ï¼‰</p><p>å…³äºgmockçš„ä½¿ç”¨ä¹Ÿå¯ä»¥æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://google.github.io/googletest/gmock_for_dummies.html">https://google.github.io/googletest/gmock_for_dummies.html</a></p><p>å…¶åŸºæœ¬ä½¿ç”¨æ–¹å¼ä¸ºï¼Œå½“éœ€è¦mockæŸä¸€ä¸ªç±»çš„æˆå‘˜æ–¹æ³•ï¼ˆæ³¨æ„ï¼šéœ€è¦å£°æ˜ä¸º<strong>è™šå‡½æ•°</strong>ï¼‰ï¼Œå®šä¹‰ä¸€ä¸ªæ´¾ç”Ÿç±»ï¼Œç„¶åç»§æ‰¿éœ€è¦mockçš„ç±»ï¼Œå¹¶å£°æ˜<code>MOCK_METHOD</code> ï¼Œç„¶åè®¾ç½®<code>EXPECT_CALL</code>æŒ‡å®šå…¶å‡½æ•°çš„è¿”å›è¡Œä¸ºã€‚å¦‚ä¸‹é¢çš„ä¾‹å­æ‰€ç¤ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// origin file</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Origin</span> &#123;</span><br>    virutal ~<span class="hljs-built_in">Origin</span>() &#123;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">int</span> <span class="hljs-title">Do</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span> <span class="hljs-keyword">const</span> </span>= <span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">int</span> <span class="hljs-title">Do2</span><span class="hljs-params">()</span> <span class="hljs-keyword">const</span> </span>= <span class="hljs-number">0</span>;<br>&#125;;<br><br><span class="hljs-comment">// --------------------------------------------------------------</span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;gmock/gmock.h&quot;</span></span><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mock</span>:</span> <span class="hljs-keyword">public</span> Origin &#123;                       <span class="hljs-comment">// æ´¾ç”Ÿ</span><br>    <span class="hljs-keyword">public</span>:<br>        <span class="hljs-built_in">MOCK_METHOD</span>(<span class="hljs-keyword">int</span>, Do, (<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y), (<span class="hljs-keyword">override</span>));<br>        <span class="hljs-built_in">MOCK_METHOD</span>(<span class="hljs-keyword">int</span>, Do2, (), (<span class="hljs-keyword">const</span>, <span class="hljs-keyword">override</span>));<br>&#125;;<br><br><span class="hljs-keyword">using</span> ::testing::Return;                          <span class="hljs-comment">// å¼•å…¥ä¾èµ–å‡½æ•°</span><br><span class="hljs-keyword">using</span> ::testing::_;                               <span class="hljs-comment">// å¼•å…¥ä¾èµ–å‡½æ•°</span><br><br><span class="hljs-built_in">TEST</span>(BarTest, DoesThis) &#123;<br>  MockFoo foo;                                    <span class="hljs-comment">// æ„å»ºmockå¯¹è±¡</span><br><br>  <span class="hljs-built_in">ON_CALL</span>(foo, <span class="hljs-built_in">Do2</span>())                         <span class="hljs-comment">// è®¾ç½®é»˜è®¤è¡Œä¸º,ä¸è¦æ±‚è¢«è°ƒç”¨</span><br>      .<span class="hljs-built_in">WillByDefault</span>(<span class="hljs-built_in">Return</span>(<span class="hljs-number">1</span>));<br><br>  <span class="hljs-built_in">EXPECT_CALL</span>(foo, <span class="hljs-built_in">Do2</span>(<span class="hljs-number">5</span>, _))                   <span class="hljs-comment">// å¼€å§‹è®¾ç½®å‘½ä¸­matcher(x=50)æœŸæœ›</span><br>      .<span class="hljs-built_in">Times</span>(<span class="hljs-number">3</span>)                                 <span class="hljs-comment">// æœŸæœ›è¢«è°ƒç”¨çš„æ¬¡æ•°</span><br>      .<span class="hljs-built_in">WillOnce</span>(<span class="hljs-built_in">Return</span>(<span class="hljs-number">100</span>))                    <span class="hljs-comment">// æœŸæœ›çš„action</span><br>      .<span class="hljs-built_in">WillRepeatedly</span>(<span class="hljs-built_in">Return</span>(<span class="hljs-number">90</span>));<br>  <br>  <span class="hljs-built_in">EXPECT_EQ</span>(<span class="hljs-built_in">MyProductionFunction</span>(&amp;foo), <span class="hljs-string">&quot;good&quot;</span>);<span class="hljs-comment">//è°ƒç”¨ä½¿ç”¨mockå¯¹è±¡çš„å‡½æ•°</span><br>                                                <span class="hljs-comment">//å¯ä»¥æ£€æµ‹å‡½æ•°ç»“æœ</span><br>&#125;                           <span class="hljs-comment">// mockå¯¹è±¡ææ„ï¼Œgmockæ£€æµ‹æ˜¯å¦æ»¡è¶³å…¨éƒ¨exception</span><br><br>........<br></code></pre></td></tr></table></figure><blockquote><p>å¦‚æœæ²¡æœ‰æ˜¾ç¤ºæŒ‡å®š<code>Times</code></p><ul><li><code>WillOnce</code> / <code>WillRepeatedly</code> éƒ½æ²¡æœ‰åœ¨ EXPECT_CALL ä¸­è¢«è°ƒç”¨ï¼Œtime = 1</li><li>n ä¸ª <code>WillOnce</code>ï¼Œæ²¡æœ‰ <code>WillRepeatedly</code> (n &gt;= 1)ï¼Œ time = n</li><li>n ä¸ª <code>WillOnce</code>ï¼Œ 1ä¸ª<code>WillRepeatedly</code> (n &gt;= 0)ï¼Œtime = AtLeast(n)</li></ul></blockquote><h2 id="mock_method"><a class="markdownIt-Anchor" href="#mock_method"></a> MOCK_METHOD</h2><p>å…¶åŸºæœ¬ç»“æ„ä¸ºå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMock</span> &#123;</span><br>    <span class="hljs-keyword">public</span>:<br>        <span class="hljs-built_in">MOCK_METHOD</span>(ReturnType, MethodName, (Args..), (Specs..));<br>&#125;<br></code></pre></td></tr></table></figure><p>ReturnTypeoä¸ºè¢«mockå‡½æ•°çš„è¿”å›ç±»å‹ï¼ŒMethodNameä¸ºè¢«mockçš„å‡½æ•°åï¼Œï¼ˆArgsâ€¦)ä¸ºè¢«mockå‡½æ•°çš„å‚æ•°ï¼Œå¯é€‰å‚æ•°ï¼ˆSpecsâ€¦)ä¸ºmockå‡½æ•°ä¿®é¥°å‚æ•°ï¼Œå¦‚override,constç­‰ã€‚</p><h2 id="expect_call"><a class="markdownIt-Anchor" href="#expect_call"></a> EXPECT_CALL</h2><p>ç»™mockå¯¹è±¡çš„å‘½ä¸­matchersçš„methodè®¾å®šexpectionï¼Œéœ€è¦åœ¨è°ƒç”¨mockå¯¹è±¡å‰è®¾ç½®ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-built_in">EXPECT_CALL</span>(mock_object, <span class="hljs-built_in">method</span>(matchers...))<br>    .<span class="hljs-built_in">With</span>(multi_argument_matcher)  <span class="hljs-comment">// Can be used at most once</span><br>    .<span class="hljs-built_in">Times</span>(cardinality)            <span class="hljs-comment">// Can be used at most once</span><br>    .<span class="hljs-built_in">InSequence</span>(sequences...)      <span class="hljs-comment">// Can be used any number of times</span><br>    .<span class="hljs-built_in">After</span>(expectations...)        <span class="hljs-comment">// Can be used any number of times</span><br>    .<span class="hljs-built_in">WillOnce</span>(action)              <span class="hljs-comment">// Can be used any number of times</span><br>    .<span class="hljs-built_in">WillRepeatedly</span>(action)        <span class="hljs-comment">// Can be used at most once</span><br>    .<span class="hljs-built_in">RetiresOnSaturation</span>();        <span class="hljs-comment">// Can be used at most once</span><br></code></pre></td></tr></table></figure><ul><li><p>matchersï¼šå•å€¼matcherï¼Œ_è¡¨ç¤ºæ¥å—ä»»æ„å‚æ•°ï¼Œå†…ç½®çš„matcherå®è¯¦è§<a href="https://google.github.io/googletest/reference/matchers.html">é“¾æ¥</a></p></li><li><p>multi_argument_matcherï¼š <a href="https://google.github.io/googletest/reference/matchers.html#MultiArgMatchers">å¤šå‚æ•°matcher</a>ï¼Œçº¦æŸmethodçš„å‚æ•°çš„å½¢å¼ï¼ˆLt, ç¬¬ä¸€ä¸ªå‚æ•°å°äºç¬¬äºŒï¼‰</p></li><li><p>Timeï¼šAnyNumberã€AtLeastã€Between â€¦ é™å®šæ‰§è¡Œæ¬¡æ•°</p></li><li><p>InSequenceï¼šæŒ‡å®šmockå‡½æ•°çš„è°ƒç”¨é¡ºåºã€‚</p></li><li><p>Afterï¼šæŒ‡å®šmockå‡½æ•°åœ¨ç‰¹å®šå‡½æ•°åè°ƒç”¨</p></li><li><p>WillOnce: mockå‡½æ•°è¢«è°ƒç”¨æ—¶çš„å•æ¬¡<a href="https://google.github.io/googletest/reference/actions.html">è¡Œä¸º</a></p></li><li><p>WillRepeatedly: æ‰€æœ‰åç»­çš„è°ƒç”¨éƒ½å‘½ä¸­çš„è¡Œä¸º</p></li></ul><blockquote><p>EXPECT_CALL(mock, Func())</p><p>.WillOnce(Return(1))               // ç¬¬ä¸€æ¬¡è¿”å›1</p><p>.WillRepeatedly(Return(2))     // åç»­éƒ½è¿”å›2</p></blockquote><ul><li>RetriesOnSaturation: å‘½ä¸­è¶³å¤Ÿæ¬¡æ•°åå¿½ç•¥</li></ul><blockquote><p>EXPECT_CALL(mock, do()).Times(AnyNumber());</p><p>EXPECT_CALL(mock, do(9)).Time(2).RetriesOnSaturation();</p></blockquote><h2 id="å¤„ç†æœªåŒ…è£¹çš„é€—å·"><a class="markdownIt-Anchor" href="#å¤„ç†æœªåŒ…è£¹çš„é€—å·"></a> å¤„ç†æœªåŒ…è£¹çš„é€—å·</h2><p>gmockçš„æ—¶å€™ï¼Œå¦‚æœå‡½æ•°åŸå‹ä¸­åŒ…å«&quot;,&quot;ä¿¡æ¯ï¼Œåˆ™ä¼šç¼–è¯‘å¤±è´¥ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MockM</span> &#123;</span><br>    <span class="hljs-keyword">public</span>:<br>        <span class="hljs-built_in">MOCK_METHOD</span>(std::pair&lt;<span class="hljs-keyword">bool</span>, <span class="hljs-keyword">int</span>&gt;, GetPair, ());<br>        <span class="hljs-built_in">MOCK_METHOD</span>(<span class="hljs-keyword">bool</span>, CheckMap, (std::map&lt;<span class="hljs-keyword">int</span>, <span class="hljs-keyword">double</span>&gt;, <span class="hljs-keyword">bool</span>));<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯é€‰å¦‚ä¸‹çš„è§£å†³æ–¹æ³•ï¼š</p><ol><li>( ) åŒ…è£¹</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Plaintext">class MockM &#123;<br>    public:<br>        MOCK_METHOD((std::pair&lt;bool, int&gt;), GetPair, ());<br>        MOCK_METHOD(bool, CheckMap, ((std::map&lt;int, double&gt;), bool));<br>&#125;<br></code></pre></td></tr></table></figure><ol start="2"><li>å®šä¹‰alias</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Plaintext">class MockM &#123;<br>    public:<br>        using BoolAndInt = std::pair&lt;bool, int&gt;;<br>        MOCK_METHOD(BoolAndInt, GetPair, ());<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æœ‰åºè°ƒç”¨"><a class="markdownIt-Anchor" href="#æœ‰åºè°ƒç”¨"></a> æœ‰åºè°ƒç”¨</h2><p>ä»£ç ä¸­æŒ‡å®šæŸäº›å‡½æ•°ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs undefined">using ::testing::InSequence;<br><br>TEST(FooTest, test) &#123;<br>    &#123;<br>        InSequence seq;<br>        EXPECT_CALL(turtle, PenDown());<br>        EXPECT_CALL(turtle, Forward(100));<br>        EXPECT_CALL(turtle, PenUp());<br>    &#125;<br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="è½»é‡çº§å¼€æºæµ‹è¯•å·¥å…·"><a class="markdownIt-Anchor" href="#è½»é‡çº§å¼€æºæµ‹è¯•å·¥å…·"></a> è½»é‡çº§å¼€æºæµ‹è¯•å·¥å…·</h1><p>å› ä¸ºGoogleTestä¾èµ–æ¯”è¾ƒé‡ï¼Œå› æ­¤ <a href="https://mp.weixin.qq.com/s/-6HMlVLSRdd6ycr5fSqhKw">ç°ä»£C++ Unit Teståº“</a> è¿™ç¯‡æ–‡ç« ä»‹ç»å‡ ä¸ªè½»é‡æ˜“ç”¨çš„å•å…ƒæµ‹è¯•åº“ï¼Œdoctestï¼ˆå¯¹åº”äºgtestï¼‰ï¼Œfakeitï¼ˆå¯¹åº”äºgmockï¼ŒåŒæ—¶è¿˜èƒ½é›†æˆåˆ°gtestä¸­ï¼‰ï¼Œnanobenchï¼ˆbenchmarkåº“ï¼‰ï¼Œè¿™å‡ ä¸ªå¼€æºåº“åªéœ€è¦å¼•å…¥å¤´æ–‡ä»¶å³å¯ä½¿ç”¨ï¼Œéå¸¸æ–¹ä¾¿ã€‚æ–‡ç« é‡Œä¹Ÿéƒ½æœ‰ç®€å•çš„ä½¿ç”¨ä»‹ç»ï¼Œæˆ–è€…çœ‹çœ‹githubä¸Šçš„æ–‡æ¡£å³å¯ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ï¼ˆ<s>å®é™…ä¸Šæ˜¯ä¸æƒ³å†å†™ç¬¬äºŒéäº†</s>ï¼‰ã€‚ä¸è¿‡ç®€å•ä½¿ç”¨ä¹‹åï¼Œä¸ªäººæ„Ÿè§‰å’Œgtestå’Œgmockå·®åˆ«ä¸æ˜¯å¾ˆå¤§ï¼Œå¦‚æœé¡¹ç›®ä¸å¤§æˆ–è€…æ­¤å‰ä¹Ÿæ²¡æ€ä¹ˆç”¨è¿‡C++æµ‹è¯•å·¥å…·çš„è¯ï¼Œè¿™ä¸¤ä¸ªå·¥å…·å¯ä»¥å°è¯•ä¸€ä¸‹çš„ï¼Œå½“ç„¶ç›´æ¥å»å­¦ä¹ gtestå’Œgmockä¹Ÿä¸äºï¼Œå°±æ˜¯éœ€è¦ç‚¹æˆæœ¬ç½¢äº†ã€‚</p><p>ä¸è¿‡è¿™ä¸ªnanobenchåº“è¿˜æ˜¯å€¼å¾—å­¦ä¹ äº†è§£çš„ï¼Œå› ä¸ºæ­¤å‰æˆ‘å¯¹æ€§èƒ½æµ‹è¯•ç›¸å…³çš„å·¥å…·äº†è§£ä¸å¤šï¼Œä¸‹é¢åˆ—äº†ä¸‹å…¶å®˜æ–¹æ–‡æ¡£ä¸Šç»™çš„ä¾‹å­ï¼Œè¿™é‡Œåšä¸ªç®€å•çš„ç¿»è¯‘ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ANKERL_NANOBENCH_IMPLEMENT</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;nanobench.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">double</span> d = <span class="hljs-number">1.0</span>;<br>    ankerl::nanobench::<span class="hljs-built_in">Bench</span>().<span class="hljs-built_in">run</span>(<span class="hljs-string">&quot;some double ops&quot;</span>, [&amp;] &#123;<br>        d += <span class="hljs-number">1.0</span> / d;<br>        <span class="hljs-keyword">if</span> (d &gt; <span class="hljs-number">5.0</span>) &#123;<br>            d -= <span class="hljs-number">5.0</span>;<br>        &#125;<br>        ankerl::nanobench::<span class="hljs-built_in">doNotOptimizeAway</span>(d);<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><table><thead><tr><th style="text-align:right">ns/op</th><th style="text-align:right">op/s</th><th style="text-align:right">err%</th><th style="text-align:right">ins/op</th><th style="text-align:right">cyc/op</th><th style="text-align:right">IPC</th><th style="text-align:right">bra/op</th><th style="text-align:right">miss%</th><th style="text-align:right">total</th><th style="text-align:left">benchmark</th></tr></thead><tbody><tr><td style="text-align:right">7.52</td><td style="text-align:right">132,948,239.79</td><td style="text-align:right">1.1%</td><td style="text-align:right">6.65</td><td style="text-align:right">24.07</td><td style="text-align:right">0.276</td><td style="text-align:right">1.00</td><td style="text-align:right">8.9%</td><td style="text-align:right">0.00</td><td style="text-align:left"><code>some double ops</code></td></tr></tbody></table><p>å…¶ç»“æœå¦‚ä¸Šè¡¨æ‰€ç¤ºï¼Œå¤§æ¦‚å«ä¹‰æ˜¯ä¸Šé¢æ‰§è¡Œçš„ä»£ç èŠ±è´¹äº†7.52çº³ç§’ï¼Œå› æ­¤å¤§çº¦æ¯ç§’èƒ½æ‰§è¡Œ133 millon æ¬¡ï¼Œæµ‹é‡æµ®åŠ¨ç‡ä¸º1.1%ï¼Œæ¯æ¬¡æ‰§è¡Œéœ€è¦6.65æ¡æŒ‡ä»¤ï¼Œ24.07ä¸ªCPUå‘¨æœŸï¼Œå› æ­¤IPC ï¼ˆæŒ‡ä»¤/æ—¶é’Ÿï¼‰ä¸º0.276ã€‚è¯¥ä»£ç ä¸­åªæœ‰1ä¸ªåˆ†æ”¯ï¼Œåˆ†æ”¯é¢„æµ‹å¤±è´¥æ¦‚ç‡ä¸º8.9%ï¼Œæœ€åçš„totalä¸ºæ‰§è¡Œæ—¶é—´ï¼Œè¿™é‡Œæ˜¾ç¤º0.00 è¡¨ç¤ºåªèŠ±è´¹ä¸€äº›æ¯«ç§’ã€‚</p><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCPUçš„ä¸€äº›æ•°æ®ï¼Œå¦‚æŒ‡ä»¤æ•°ï¼ŒCPUå‘¨æœŸï¼Œåˆ†æ”¯æ•°ä¸åˆ†æ”¯é¢„æµ‹å¤±è´¥ç‡åªèƒ½åœ¨Linuxè·å–ï¼Œå› ä¸ºæ˜¯é€šè¿‡perf eventsé‡‡é›†å¾—åˆ°çš„ã€‚</p></blockquote><h1 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h1><p>æœ€åå°ç»“ä¸€ä¸‹å§ï¼Œåœ¨å­¦æ ¡çš„æ—¶å€™ï¼Œå…¶å®è‡ªå·±éƒ½æ²¡æ€ä¹ˆå…³æ³¨è¿‡æµ‹è¯•ï¼Œéšæ‰‹å†™çš„ä¸€äº›é¡¹ç›®ä»£ç ï¼Œéƒ½æ˜¯åªè¦èƒ½æ­£ç¡®å®ç°åŠŸèƒ½å°±è¡Œï¼Œæ²¡æœ‰è¯´è¦å†™ä»€ä¹ˆæµ‹è¯•ä»£ç æ¥ä¿è¯ä»£ç è´¨é‡ï¼Œä½†æ˜¯åˆ°äº†å®é™…ç”Ÿäº§å·¥ä½œä¸­ï¼Œå•å…ƒæµ‹è¯•å°±è¢«é‡è§†èµ·æ¥äº†ï¼Œ</p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>C++</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>googletest</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€æ“ä½œç³»ç»Ÿã€‘å†…å­˜ç®¡ç†</title>
    <link href="/2022/06/11/2022-06/2022-06-11%20%E3%80%90%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%91%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/"/>
    <url>/2022/06/11/2022-06/2022-06-11%20%E3%80%90%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%91%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>æ“ä½œç³»ç»Ÿæ˜¯æ¯ä¸ªç¨‹åºå‘˜éƒ½è¯¥é’»ç ”å­¦ä¹ çš„çŸ¥è¯†ï¼Œæœ€è¿‘ä¹Ÿæ˜¯åœ¨å¤ä¹ å›é¡¾ï¼Œæ‰€ä»¥è¶æ­¤æœºä¼šåšä¸ªç®€å•çš„è®°å½•å’Œæ€»ç»“ï¼Œè€Œæœ¬æ–‡å°†ä¸»è¦ä»‹ç»æ“ä½œç³»ç»Ÿä¸­å†…å­˜ç®¡ç†ç›¸å…³çš„å†…å®¹ã€‚</p><p class='note note-primary'>  <font size=3>      æœ¬æ–‡çš„ä¸€äº›å›¾ç‰‡å’Œæ–‡å­—å°†å¼•ç”¨å‚è€ƒåŒ—äº¬å¤§å­¦é™ˆå‘ç¾¤è€å¸ˆçš„ã€Šæ“ä½œç³»ç»Ÿé«˜çº§è¯¾ç¨‹ã€‹ä¸­çš„PPTè¯¾ä»¶ï¼Œä»¥åŠMIT 6.S081 è¯¾ç¨‹ç›¸å…³å†…å®¹ã€‚  </font></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202207091626839.png" alt="å†…å­˜ç®¡ç†æ€ç»´å¯¼å›¾" /></p><h1 id="é‡è¦æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#é‡è¦æ¦‚å¿µ"></a> é‡è¦æ¦‚å¿µ</h1><p>é¦–å…ˆå¼•å…¥ä¸€äº›é‡è¦æ¦‚å¿µ/å‰ç½®çŸ¥è¯†ç‚¹ï¼š</p><ul><li>ç¨‹åºä»¥æ–‡ä»¶å½¢å¼ï¼ˆå¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ï¼Œå¦‚Linuxä¸Šçš„ELFæ–‡ä»¶æ ¼å¼ï¼Œwindowä¸Šçš„PEæ–‡ä»¶æ ¼å¼ï¼‰ä¿å­˜åœ¨ç£ç›˜ï¼Œç¨‹åºè£…è½½åˆ°å†…å­˜æ‰å¯ä»¥è¿è¡Œ</li><li>ç°ä»£æ“ä½œç³»ç»Ÿé‡‡ç”¨å¤šé“ç¨‹åºè®¾è®¡æ¨¡å‹ï¼šå³å…è®¸å¤šä¸ªç¨‹åºåŒæ—¶è¿›å…¥å†…å­˜</li><li>æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œä½“ç°äº†éš”ç¦»æ€§å’Œå®‰å…¨æ€§ï¼šä¸€ä¸ªè¿›ç¨‹åœ¨æ‰§è¡Œæ—¶ä¸èƒ½è®¿é—®å¦ä¸€ä¸ªè¿›ç¨‹çš„åœ°å€ç©ºé—´ï¼Œä¹Ÿä¸èƒ½å»æ‰§è¡Œä¸é€‚å½“çš„æ“ä½œ</li><li>å±€éƒ¨æ€§åŸç†ï¼šç¨‹åºåœ¨æ‰§è¡Œçš„æ—¶å€™å¾€å¾€å‘ˆç°å±€éƒ¨æ€§è§„å¾‹ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨æŸä¸ªè¾ƒçŸ­çš„æ—¶é—´æ®µå†…ï¼Œç¨‹åºæ‰§è¡Œå±€é™äºæŸä¸€å°éƒ¨åˆ†ï¼Œç¨‹åºè®¿é—®çš„å­˜å‚¨ç©ºé—´ä¹Ÿå±€é™äºæŸä¸ªåŒºåŸŸ<ul><li><strong>æ—¶é—´å±€éƒ¨æ€§ï¼š</strong> å¦‚æœç¨‹åºä¸­çš„æŸæ¡æŒ‡ä»¤ä¸€æ—¦æ‰§è¡Œï¼Œä¸ä¹…ä»¥åè¯¥æŒ‡ä»¤å¯èƒ½å†æ¬¡æ‰§è¡Œï¼›å¦‚æœæŸæ•°æ®è¢«è®¿é—®è¿‡ï¼Œä¸ä¹…ä»¥åè¯¥æ•°æ®å¯èƒ½å†æ¬¡è¢«è®¿é—®ã€‚äº§ç”Ÿæ—¶é—´å±€éƒ¨æ€§çš„å…¸å‹ä¾‹å­ï¼Œå°±æ˜¯åœ¨ç¨‹åºä¸­å­˜åœ¨ç€å¤§é‡çš„å¾ªç¯æ“ä½œï¼›</li><li><strong>ç©ºé—´å±€éƒ¨æ€§ï¼š</strong> ä¸€æ—¦ç¨‹åºè®¿é—®äº†æŸä¸ªå­˜å‚¨å•å…ƒï¼Œåœ¨ä¸ä¹…ä¹‹åï¼Œå…¶é™„è¿‘çš„å­˜å‚¨å•å…ƒä¹Ÿå°†è¢«è®¿é—®ï¼Œå³ç¨‹åºåœ¨ä¸€æ®µæ—¶é—´å†…æ‰€è®¿é—®çš„åœ°å€ï¼Œå¯èƒ½é›†ä¸­åœ¨ä¸€å®šèŒƒå›´ä¹‹å†…ï¼Œè¿™æ˜¯å› ä¸ºæŒ‡ä»¤é€šå¸¸æ˜¯é¡ºåºå­˜æ”¾ã€é¡ºåºæ‰§è¡Œçš„ï¼Œæ•°æ®ä¸€èˆ¬æ˜¯ä»¥å‘é‡ã€æ•°ç»„ã€è¡¨ç­‰å½¢å¼ç°‡èšå­˜å‚¨çš„ã€‚</li></ul></li><li>å­˜å‚¨ä½“ç³»ï¼šå­˜å‚¨å™¨ä¸»è¦æœ‰3ä¸ªæ€§èƒ½æŒ‡æ ‡ï¼šé€Ÿåº¦ã€å®¹é‡ã€æ¯ä½ä»·æ ¼ï¼ˆä½ä»·ï¼‰ï¼Œä¸€èˆ¬æ¥è¯´é€Ÿåº¦å¿«çš„å­˜å‚¨å™¨å®¹é‡åå°ï¼Œä½ä»·è¾ƒè´µï¼›å®¹é‡å¤§çš„ï¼Œé€Ÿåº¦æ…¢ï¼Œä½ä»·ä¾¿å®œã€‚è®¡ç®—æœºä¸­çš„å­˜å‚¨ä½“ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¶Šä¸Šå±‚çš„å­˜å‚¨å™¨æ€§èƒ½ï¼ˆé€Ÿåº¦ï¼‰è¶Šå¥½ï¼Œä½†ä½ä»·è¶Šè´µã€‚</li></ul><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206121617060.png" alt="" style="zoom:50%;" /></center><ul><li>ç¨‹åºæ‰§è¡Œå‰çš„å‡†å¤‡è¿‡ç¨‹<ul><li>åœ¨ç¨‹åºè¿è¡Œå‰ï¼Œé€šå¸¸è¦ç»è¿‡ç¼–è¯‘ã€é“¾æ¥ã€è£…è½½ã€è¿è¡Œç­‰è¿‡ç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚é‚£å°±äº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä»€ä¹ˆæ—¶å€™å°†æŒ‡ä»¤å’Œæ•°æ®ç»‘å®šåˆ°å†…å­˜åœ°å€/ç‰©ç†åœ°å€ï¼Ÿä¹Ÿå°±æ˜¯ä¸‹é¢è¦æ¢è®¨çš„åœ°å€é‡å®šä½ã€‚</li></ul></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206121646479.png" alt="ç¨‹åºæ‰§è¡Œå‰çš„å‡†å¤‡è¿‡ç¨‹" /></p><ul><li><p>åœ°å€é‡å®šä½ï¼šå°†ç”¨æˆ·ç¨‹åºä¸­çš„é€»è¾‘åœ°å€è½¬æ¢ä¸ºè¿è¡Œæ—¶å¯ç”±æœºå™¨ç›´æ¥å¯»å€çš„ç‰©ç†åœ°å€çš„è¿‡ç¨‹ï¼Œå…¶ä½œç”¨æ˜¯ä¿è¯CPUæ‰§è¡ŒæŒ‡ä»¤æ—¶å¯ä»¥æ­£ç¡®åœ°è®¿é—®å†…å­˜å•å…ƒ</p><ul><li>é€»è¾‘åœ°å€ï¼ˆç›¸å¯¹åœ°å€ï¼Œè™šæ‹Ÿåœ°å€ï¼‰ï¼šç”¨æˆ·ç¨‹åºç»è¿‡ç¼–è¯‘ã€æ±‡ç¼–åå½¢æˆç›®æ ‡ä»£ç ï¼Œç›®æ ‡ä»£ç é€šå¸¸é‡‡ç”¨ç›¸å¯¹åœ°å€çš„å½¢å¼ï¼Œ<strong>å…¶é¦–åœ°å€ä¸º0</strong>ï¼Œå…¶ä½™æŒ‡ä»¤ä¸­çš„åœ°å€éƒ½<strong>ç›¸å¯¹äºé¦–åœ°å€è€Œç¼–å€</strong>ã€‚ä¸èƒ½ä½¿ç”¨é€»è¾‘åœ°å€åœ¨å†…å­˜ä¸­è¯»å–ä¿¡æ¯ã€‚</li><li>ç‰©ç†åœ°å€ï¼ˆç»å¯¹åœ°å€ï¼Œå®åœ°å€ï¼‰ï¼šå†…å­˜ä¸­å­˜å‚¨å•å…ƒçš„åœ°å€ï¼Œå¯ä»¥ç›´æ¥å¯»å€ã€‚</li></ul></li><li><p>åœ°å€é‡å®šä½åˆå¯ä»¥åˆ†ä¸ºé™æ€é‡å®šä½å’ŒåŠ¨æ€é‡å®šä½ã€‚</p><ul><li>åœ¨é™æ€é‡å®šä½ä¸­ï¼Œåœ°å€è½¬æ¢å‘ç”Ÿåœ¨è£…è½½æ—¶ï¼šå½“ç¨‹åºè£…è½½åˆ°å†…å­˜ä¸­æ—¶ï¼Œ<code>store</code>æŒ‡ä»¤å¯¹åº”çš„åœ°å€å·²ç»è½¬å˜æˆäº†ç‰©ç†åœ°å€</li><li>åœ¨åŠ¨æ€é‡å®šä½ä¸­ï¼Œåœ°å€è½¬æ¢å‘ç”Ÿåœ¨è¿è¡Œæ—¶ï¼šå½“ç¨‹åºè£…è½½åˆ°å†…å­˜ä¸­æ—¶ï¼Œ<code>store</code>æŒ‡ä»¤å¯¹åº”çš„åœ°å€ä»ç„¶æ˜¯é€»è¾‘åœ°å€ï¼Œå½“çœŸæ­£è¿è¡Œè¯¥æ¡æŒ‡ä»¤æ—¶ï¼Œä¼šé€šè¿‡ç¡¬ä»¶MMUï¼ˆå†…å­˜ç®¡ç†å•å…ƒï¼‰å°†é€»è¾‘åœ°å€è½¬æ¢ä¸ºç‰©ç†åœ°å€</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206121653343.png" alt="é™æ€é‡å®šä½" /></p></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206121653671.png" alt="åŠ¨æ€é‡å®šä½" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206121701693.png" alt="åŠ¨æ€é‡å®šä½å®ç°â€”â€”MMU" /></p><hr /><p>è¿™ä¹Ÿå¼•å‡ºäº†å†…å­˜ç®¡ç†çš„åŸºæœ¬ç›®æ ‡ï¼š</p><ul><li>ç»™è¿›ç¨‹åˆ†é…å†…å­˜â€”â€”åœ°å€ç©ºé—´</li><li>å¾€å†…å­˜åŠ è½½å†…å®¹â€”â€”æ˜ å°„è¿›ç¨‹åœ°å€ç©ºé—´åˆ°ç‰©ç†å†…å­˜</li><li>å­˜å‚¨ä¿æŠ¤â€”â€”åœ°å€è¶Šç•Œã€æƒé™æ§åˆ¶</li><li>ç®¡ç†å…±äº«çš„å†…å­˜</li><li>æœ€å°åŒ–å­˜å‚¨è®¿é—®æ—¶é—´</li></ul><h1 id="å†…å­˜ç®¡ç†æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#å†…å­˜ç®¡ç†æ–¹æ¡ˆ"></a> å†…å­˜ç®¡ç†æ–¹æ¡ˆ</h1><h2 id="ç©ºé—²ç‰©ç†å†…å­˜ç®¡ç†"><a class="markdownIt-Anchor" href="#ç©ºé—²ç‰©ç†å†…å­˜ç®¡ç†"></a> ç©ºé—²ç‰©ç†å†…å­˜ç®¡ç†</h2><p><strong>æ•°æ®ç»“æ„</strong>ï¼š</p><ul><li>ä½å›¾ï¼šæ¯ä¸ªåˆ†é…å•å…ƒå¯¹åº”äºä½å›¾ä¸­çš„ä¸€ä½ï¼Œ0è¡¨ç¤ºç©ºé—²ï¼Œ1è¡¨ç¤ºå ç”¨ï¼ˆæˆ–è€…ç›¸åï¼‰</li><li>ç©ºé—²åŒºè¡¨ã€å·²åˆ†é…åŒºè¡¨ï¼šè¡¨ä¸­çš„æ¯ä¸€é¡¹è®°å½•äº†ç©ºé—²åŒºï¼ˆæˆ–å·²åˆ†é…åŒºï¼‰çš„èµ·å§‹åœ°å€ã€é•¿åº¦ã€æ ‡å¿—</li><li>ç©ºé—²å—é“¾è¡¨</li></ul><p><strong>å†…å­˜åˆ†é…ç®—æ³•</strong>ï¼š</p><ul><li>é¦–æ¬¡é€‚é… (first fit) ï¼šåœ¨ç©ºé—²åŒºè¡¨ä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³è¿›ç¨‹è¦æ±‚çš„ç©ºé—²åŒº</li><li>ä¸‹æ¬¡é€‚é… (next fit) ï¼šä»ä¸Šæ¬¡æ‰¾åˆ°çš„ç©ºé—²åŒºå¤„æ¥ç€æŸ¥æ‰¾</li><li>æœ€ä½³é€‚é… (best fit)ï¼šæŸ¥æ‰¾æ•´ä¸ªç©ºé—²åŒºè¡¨ï¼Œæ‰¾åˆ°èƒ½å¤Ÿæ»¡è¶³è¿›ç¨‹è¦æ±‚çš„æœ€å°ç©ºé—²åŒº</li><li>æœ€å·®é€‚é… (worst fit)ï¼šæ€»æ˜¯åˆ†é…æ»¡è¶³è¿›ç¨‹è¦æ±‚çš„æœ€å¤§ç©ºé—²åŒº</li></ul><hr /><p>ä¼™ä¼´ç³»ç»Ÿâ€”â€”Linuxåº•å±‚é‡‡ç”¨çš„å†…å­˜ç®¡ç†æ–¹æ¡ˆ</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206122210181.png" alt="ä¼™ä¼´ç³»ç»Ÿå†…å­˜åˆ†é…æ–¹æ¡ˆ" /></p><p>ä¸‹å›¾æ˜¯ä¼™ä¼´ç³»ç»Ÿçš„ä¸€ä¸ªä¾‹å­ï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206122211213.png" alt="ä¼™ä¼´ç³»ç»Ÿç¤ºæ„å›¾" /></p><p>å¯ä»¥çœ‹åˆ°åˆ†é…æ—¶ï¼Œå°†å¯ç”¨åŒºé—´ä¸æ–­åˆ†æˆä¸¤å—ï¼Œç›´åˆ°åˆ’åˆ†å‡ºèƒ½æ»¡è¶³éœ€æ±‚çš„æœ€å°å—ï¼ˆæ»¡è¶³2çš„å¹‚æ¬¡ï¼‰ï¼›åœ¨å›æ”¶æ—¶ï¼Œåªæœ‰å½“ä¸¤ä¸ªå¤§å°ç›¸åŒä¸”ç›¸é‚»çš„å†…å­˜å—è¢«é‡Šæ”¾åï¼Œå¯ä»¥è¿›è¡Œå›æ”¶åˆå¹¶ï¼Œâ€œä¼™ä¼´ç³»ç»Ÿâ€çš„å«ä¹‰ä¹Ÿæ˜¯ç”±æ­¤è€Œæ¥ã€‚</p><h2 id="å†…å­˜ç®¡ç†åŸºæœ¬æ–¹æ¡ˆæ±‡æ€»"><a class="markdownIt-Anchor" href="#å†…å­˜ç®¡ç†åŸºæœ¬æ–¹æ¡ˆæ±‡æ€»"></a> å†…å­˜ç®¡ç†åŸºæœ¬æ–¹æ¡ˆæ±‡æ€»</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206122216655.png" alt="å†…å­˜ç®¡ç†åŸºæœ¬æ–¹æ¡ˆæ±‡æ€»" /></p><h3 id="å•ä¸€ç”¨æˆ·è¿ç»­åŒº"><a class="markdownIt-Anchor" href="#å•ä¸€ç”¨æˆ·è¿ç»­åŒº"></a> å•ä¸€ç”¨æˆ·ï¼ˆè¿ç»­åŒºï¼‰</h3><p>ç‰¹ç‚¹ï¼šä¸€æ®µæ—¶é—´å†…åªæœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨å†…å­˜ã€‚</p><p>ç®€å•ï¼Œä½†æ˜¯å†…å­˜åˆ©ç”¨ç‡ä½ã€‚</p><h3 id="å›ºå®šåˆ†åŒº"><a class="markdownIt-Anchor" href="#å›ºå®šåˆ†åŒº"></a> å›ºå®šåˆ†åŒº</h3><p>æŠŠå†…å­˜ç©ºé—²åˆ†å‰²æˆè‹¥å¹²åŒºåŸŸï¼Œæˆä¸ºåˆ†åŒºã€‚ï¼ˆæ¯ä¸ªåˆ†åŒºçš„å¤§å°å¯ä»¥ç›¸åŒä¹Ÿå¯ä»¥ä¸åŒï¼‰</p><p>åˆ†åŒºçš„å¤§å°å›ºå®šä¸å˜ã€‚</p><p>æ¯ä¸ªåˆ†åŒºè£…ä¸€ä¸ªä¸”åªèƒ½è£…ä¸€ä¸ªè¿›ç¨‹ã€‚</p><p>å­˜åœ¨çš„é—®é¢˜ï¼šæœ‰å†…éƒ¨ç¢ç‰‡ï¼Œå¯¹å†…å­˜çš„ä½¿ç”¨ä¸å……åˆ†ï¼Œæ´»åŠ¨è¿›ç¨‹çš„æœ€å¤§æ•°ç›®æ˜¯å›ºå®šçš„ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206122222063.png" alt="å›ºå®šåˆ†åŒºç¤ºæ„å›¾" /></p><h3 id="å¯å˜åˆ†åŒº"><a class="markdownIt-Anchor" href="#å¯å˜åˆ†åŒº"></a> å¯å˜åˆ†åŒº</h3><p>æ ¹æ®è¿›ç¨‹çš„éœ€è¦ï¼ŒæŠŠå†…å­˜ç©ºé—²ç©ºé—´åˆ†å‰²å‡ºä¸€ä¸ªåˆ†åŒºï¼Œåˆ†é…ç»™è¯¥è¿›ç¨‹ã€‚</p><p>å‰©ä½™éƒ¨åˆ†æˆä¸ºæ–°çš„ç©ºé—²åŒºã€‚</p><p>å®ç°çš„æ•°æ®ç»“æ„ï¼šç©ºé—²åŒºè¡¨ï¼Œå·²åˆ†é…è¡¨ã€‚</p><p>å­˜åœ¨çš„é—®é¢˜ï¼šå­˜åœ¨å¤–ç¢ç‰‡ï¼Œå¯¼è‡´å†…å­˜åˆ©ç”¨ç‡ä¸‹é™ã€‚</p><p>è§£å†³æ–¹æ¡ˆï¼šå¯ä»¥é‡‡ç”¨ç´§å‡‘æŠ€æœ¯ã€‚åœ¨å†…å­˜ä¸­ç§»åŠ¨ç¨‹åºï¼Œå°†æ‰€æœ‰å°çš„ç©ºé—²åŒºåˆå¹¶ä¸ºè¾ƒå¤§çš„ç©ºé—²åŒºï¼Œä½†éœ€è¦è€ƒè™‘ç³»ç»Ÿå¼€é”€å’Œç§»åŠ¨æ—¶æœºã€‚</p><h3 id="é¡µå¼å­˜å‚¨ç®¡ç†"><a class="markdownIt-Anchor" href="#é¡µå¼å­˜å‚¨ç®¡ç†"></a> é¡µå¼å­˜å‚¨ç®¡ç†</h3><p>è®¾è®¡æ€æƒ³ï¼š</p><ul><li>ç”¨æˆ·ç¨‹åºåœ°å€ç©ºé—´åˆ’åˆ†æˆå¤§å°ç›¸ç­‰çš„åŒºåŸŸâ€”â€”é¡µ page</li><li>ç‰©ç†å†…å­˜ç©ºé—´æŒ‰é¡µå¤§å°åˆ’åˆ†å¤§å°ç›¸ç­‰çš„åŒºåŸŸï¼Œæˆä¸ºå†…å­˜å—ï¼ˆç‰©ç†é¡µé¢ï¼Œé¡µæ¡†ï¼Œé¡µå¸§ï¼‰page frame</li><li>å†…å­˜åˆ†é…è§„åˆ™ï¼šä»¥é¡µä¸ºå•ä½æœºæ¢°èƒ½åˆ†é…ï¼Œå¹¶æŒ‰è¿›ç¨‹éœ€è¦çš„é¡µæ•°æ¥åˆ†é…ï¼›é€»è¾‘ä¸Šç›¸é‚»çš„é¡µï¼Œç‰©ç†ä¸Šä¸ä¸€å®šç›¸é‚»</li><li>å…¸å‹çš„é¡µé¢å°ºå¯¸ï¼š4K æˆ– 4M</li><li>é€»è¾‘åœ°å€ï¼šå¯¹äº32ä½æœºå™¨ï¼Œé¡µé¢å¤§å°ä¸º4Kï¼Œå…¶é€»è¾‘åœ°å€å¯åˆ†æˆé¡µå·ï¼ˆå‰20ä½ï¼‰å’Œé¡µå†…åç§»ï¼ˆå12ä½ï¼‰ã€‚</li></ul><p>ç›¸å…³æ•°æ®ç»“æ„ä»¥åŠåœ°å€è½¬æ¢ï¼š</p><ul><li>é¡µè¡¨<ul><li>é¡µè¡¨é¡¹ï¼šè®°å½•äº†é€»è¾‘é¡µå·ä¸é¡µæ¡†å·çš„å¯¹åº”å…³ç³»</li><li>æ¯ä¸ªè¿›ç¨‹ä¸€ä¸ªé¡µè¡¨ï¼Œå­˜æ”¾åœ¨å†…å­˜ä¸­</li><li>è¿›ç¨‹æœªæ‰§è¡Œæ—¶ï¼Œé¡µè¡¨çš„å§‹å€å’Œé¡µè¡¨é•¿åº¦æ”¾åœ¨<strong>è¿›ç¨‹æ§åˆ¶å—</strong>ï¼ˆPCBï¼‰ä¸­ï¼Œå½“è¿›ç¨‹è¢«è°ƒåº¦æ—¶ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸ä¼šæŠŠå®ƒä»¬æ”¾åˆ°é¡µè¡¨å¯„å­˜å™¨ä¸­ã€‚</li></ul></li><li>ç©ºé—²å†…å­˜ç®¡ç†</li><li>åœ°å€è½¬æ¢ï¼ˆç¡¬ä»¶æ”¯æŒï¼‰ï¼šCPUå–åˆ°é€»è¾‘åœ°å€ï¼Œè‡ªåŠ¨åˆ’åˆ†ä¸ºé¡µå·å’Œé¡µå†…åœ°å€ï¼›ç”¨é¡µå·æŸ¥é¡µè¡¨ï¼Œå¾—åˆ°é¡µæ¡†å·ï¼Œå†ä¸é¡µå†…åœ°å€ï¼ˆé¡µå†…åç§»ï¼‰æ‹¼æ¥å¾—åˆ°ç‰©ç†åœ°å€</li></ul><p>ä¼˜ç¼ºç‚¹ï¼š</p><ul><li>ä¼˜ç‚¹<ul><li>è™šå­˜é‡å¤§ï¼Œé€‚åˆå¤šé“ç¨‹åºè¿è¡Œï¼Œç”¨æˆ·ä¸å¿…æ‹…å¿ƒå†…å­˜ä¸å¤Ÿçš„è°ƒåº¦æ“ä½œã€‚</li><li>å†…å­˜åˆ©ç”¨ç‡é«˜ï¼Œä¸å¸¸ç”¨çš„é¡µé¢å°½é‡ä¸ç•™åœ¨å†…å­˜ã€‚</li><li>ä¸è¦æ±‚ä½œä¸šè¿ç»­å­˜æ”¾ï¼Œæœ‰æ•ˆåœ°è§£å†³äº†å¤–ç¢ç‰‡é—®é¢˜ï¼ˆä½†å¯èƒ½è¿˜æ˜¯ä¼šæœ‰å†…ç¢ç‰‡äº§ç”Ÿï¼‰ã€‚</li></ul></li><li>ç¼ºç‚¹<ul><li>åœ°å€å˜æ¢æœºæ„å¤æ‚ï¼Œä¸ºæä¾›é€Ÿåº¦é‡‡ç”¨ç¡¬ä»¶å®ç°ï¼Œå¢åŠ äº†æœºå™¨æˆæœ¬</li><li>éœ€è¦ç›¸åº”çš„ç¡¬ä»¶æ”¯æŒï¼Œæ¥å¤„ç†é¡µé¢ä¸­æ–­ã€ç¼ºé¡µä¸­æ–­å¤„ç†ç­‰ï¼Œå¢åŠ ç³»ç»Ÿå¼€é”€ã€‚</li></ul></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206122246280.png" alt="é¡µå¼ç®¡ç†ç¤ºæ„å›¾" /></p><h3 id="æ®µå¼å­˜å‚¨ç®¡ç†"><a class="markdownIt-Anchor" href="#æ®µå¼å­˜å‚¨ç®¡ç†"></a> æ®µå¼å­˜å‚¨ç®¡ç†</h3><p>è®¾è®¡æ€æƒ³ï¼š</p><ul><li>ç”¨æˆ·ç¨‹åºåœ°å€ç©ºé—´ï¼šæŒ‰ç¨‹åºè‡ªèº«çš„é€»è¾‘åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªç¨‹åºæ®µï¼Œæ¯ä¸ªç¨‹åºæ®µéƒ½æœ‰ä¸€ä¸ªæ®µå</li><li>å†…å­˜ç©ºé—´è¢«åŠ¨æ€çš„åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªé•¿åº¦ä¸ç›¸åŒçš„åŒºåŸŸï¼Œç§°ä¸ºç‰©ç†æ®µï¼Œæ¯ä¸ªç‰©ç†æ®µç”±èµ·å§‹åœ°å€å’Œé•¿åº¦ç¡®å®š</li><li>å†…å­˜åˆ†é…è§„åˆ™ï¼šä»¥æ®µä¸ºå•ä½è¿›è¡Œåˆ†é…ï¼Œæ¯ä¸€ä¸ªæ®µåœ¨å†…å­˜ä¸­å æ®è¿ç»­ç©ºé—´ï¼Œä½†å„æ®µä¹‹é—´å¯ä»¥ä¸ç›¸é‚»</li><li>é€»è¾‘åœ°å€ï¼šåˆ†ä¸ºæ®µå·å’Œæ®µå†…åœ°å€</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206122245047.png" alt="æ®µå¼ç®¡ç†ç¤ºæ„å›¾" /></p><p>ç›¸å…³æ•°æ®ç»“æ„åŠåœ°å€è½¬æ¢ï¼š</p><ul><li>æ®µè¡¨<ul><li>è®°å½•äº†æ®µå·ã€æ®µé¦–åœ°å€å’Œæ®µé•¿åº¦ä¹‹é—´çš„å…³ç³»</li><li>æ¯ä¸ªè¿›ç¨‹ä¸€ä¸ªæ®µè¡¨ï¼Œå­˜æ”¾åœ¨å†…å­˜</li></ul></li><li>ç‰©ç†å†…å­˜ç®¡ç†ï¼šåŒå¯å˜åˆ†åŒº</li><li>åœ°å€è½¬æ¢ï¼ˆç¡¬ä»¶æ”¯æŒï¼‰<ul><li>CPUå–åˆ°é€»è¾‘åœ°å€ï¼Œç”¨æ®µå·æŸ¥æ®µè¡¨ï¼Œå¾—åˆ°æ®µçš„èµ·å§‹åœ°å€ï¼Œå†ä¸æ®µå†…åç§»åœ°å€ç›¸åŠ è®¡ç®—å‡ºç‰©ç†åœ°å€</li></ul></li></ul><p>ä¼˜ç¼ºç‚¹<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="ã€å†…å­˜ç®¡ç†ã€‘é¡µå¼&amp;æ®µå¼&amp;æ®µé¡µå¼&amp;ä¼˜ç¼ºç‚¹">[1]</span></a></sup>ï¼š</p><ul><li>ä¼˜ç‚¹<ul><li>æ®µå¼ç®¡ç†æ˜¯ä¸è¿ç»­åˆ†é…å†…å­˜æŠ€æœ¯ä¸­çš„ä¸€ç§ã€‚å…¶æœ€å¤§ç‰¹ç‚¹åœ¨äºä»–æŒ‰ç…§ç”¨æˆ·è§‚ç‚¹ï¼Œå³æŒ‰ç¨‹åºæ®µã€æ•°æ®æ®µç­‰æœ‰æ˜ç¡®é€»è¾‘å«ä¹‰çš„â€œæ®µâ€ï¼Œåˆ†é…å†…å­˜ç©ºé—´ã€‚å…‹æœäº†é¡µå¼çš„ã€ç¡¬æ€§çš„ã€éé€»è¾‘åˆ’åˆ†ç»™ä¿æŠ¤å’Œå…±äº«ä¸æ”¯æ€ä¼¸ç¼©å¸¦æ¥çš„ä¸è‡ªç„¶æ€§<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="æ®µå¼å­˜å‚¨ç®¡ç†">[2]</span></a></sup>ã€‚</li><li>å¯ä»¥åˆ†åˆ«ç¼–å†™å’Œç¼–è¯‘ï¼Œå¯ä»¥é’ˆå¯¹ä¸åŒç±»å‹çš„æ®µé‡‡å–ä¸åŒçš„ä¿æŠ¤ï¼Œå¯ä»¥æŒ‰æ®µä¸ºå•ä½è¿›è¡Œå…±äº«ï¼ŒåŒ…æ‹¬é€šè¿‡åŠ¨æ€é“¾æ¥è¿›è¡Œä»£ç å…±äº«ã€‚</li></ul></li><li>ç¼ºç‚¹ï¼šä¼šäº§ç”Ÿå¤–éƒ¨ç¢ç‰‡</li></ul><hr /><p>è¿™é‡Œå†è§£é‡Šä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆè¯´é¡µå¼å­˜å‚¨çš„åœ°å€ç©ºé—´æ˜¯ä¸€ç»´çš„ï¼Œè€Œæ®µå¼å­˜å‚¨çš„åœ°å€ç©ºé—´æ˜¯äºŒç»´çš„ï¼Ÿ<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="ä¸ºä»€ä¹ˆåˆ†é¡µå­˜å‚¨çš„åœ°å€ç©ºé—´æ˜¯ä¸€ç»´çš„ï¼Œè€Œåˆ†æ®µå­˜å‚¨çš„åœ°å€æ˜¯äºŒç»´çš„">[3]</span></a></sup></p><p>æ®µå·å’Œé¡µå·çš„æ¥å†æ˜¯ä¸åŒçš„ï¼Œæ®µå·æ˜¯ç¨‹åºå‘˜è‡ªå·±å®šä¹‰çš„ï¼Œæ¯ä¸ªæ®µéƒ½æ˜¯æœ‰ç‰¹å®šå«ä¹‰çš„ï¼Œå› æ­¤ä¸åŒæ®µçš„å¤§å°ä¸åŒï¼Œä»£è¡¨çš„æ„ä¹‰ä¹Ÿä¸ç›¸åŒï¼Œå› æ­¤è¦æƒ³æ‰¾åˆ°æŸä¸ªæ•°æ®æˆ–æŒ‡ä»¤ï¼Œéœ€è¦æŒ‡å®šæ®µå·å’Œä½ç§»ä¸¤ä¸ªå˜é‡ã€‚è€Œé¡µå·æ˜¯ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„ï¼Œæœ¬èº«åœ°å€æ˜¯çº¿æ€§è¿ç»­çš„ï¼Œå½“è¦è®¿é—®ç‰¹å®šåœ°å€æ—¶ï¼Œåªéœ€è¦æä¾›åœ°å€å³å¯ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨å°†åœ°å€åˆ’åˆ†ä¸ºé¡µå·å’Œé¡µå†…åç§»ï¼Œè€Œé¡µå·å¯¹äºç¨‹åºå‘˜æ¥è¯´æ˜¯æ²¡æœ‰å®é™…æ„ä¹‰çš„ï¼Œå› æ­¤æ˜¯ä¸€ç»´çš„ã€‚</p><h3 id="æ®µé¡µå¼å­˜å‚¨ç®¡ç†æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#æ®µé¡µå¼å­˜å‚¨ç®¡ç†æ–¹æ¡ˆ"></a> æ®µé¡µå¼å­˜å‚¨ç®¡ç†æ–¹æ¡ˆ</h3><p>äº§ç”ŸèƒŒæ™¯</p><ul><li>ç»“åˆé¡µå¼æ®µå¼ä¼˜ç‚¹ï¼Œå…‹æœäºŒè€…çš„ç¼ºç‚¹</li></ul><p>è®¾è®¡æ€æƒ³</p><ul><li>ç”¨æˆ·ç¨‹åºåˆ’åˆ†ï¼šæŒ‰æ®µå¼åˆ’åˆ†ï¼ˆå¯¹ç”¨æˆ·æ¥è®²ï¼ŒæŒ‰æ®µçš„é€»è¾‘å…³ç³»è¿›è¡Œåˆ’åˆ†ï¼›å¯¹ç³»ç»Ÿæ¥è®²ï¼ŒæŒ‰é¡µåˆ’åˆ†æ¯ä¸€æ®µï¼‰</li><li>å†…å­˜åˆ’åˆ†ï¼šæŒ‰é¡µå¼å­˜å‚¨ç®¡ç†æ–¹æ¡ˆ</li><li>å†…å­˜åˆ†é…ï¼šä»¥é¡µä¸ºå•ä½è¿›è¡Œåˆ†é…</li></ul><p>æ•°æ®ç»“æ„åŠæœ‰å…³æ“ä½œ</p><ul><li>æ®µè¡¨ï¼šè®°å½•äº†æ¯ä¸€æ®µçš„é¡µè¡¨èµ·å§‹åœ°å€å’Œé¡µè¡¨é•¿åº¦</li><li>é¡µè¡¨ï¼šè®°å½•äº†é€»è¾‘é¡µå·ä¸å†…å­˜å—å·çš„å¯¹åº”å…³ç³»ï¼ˆæ¯ä¸€æ®µæœ‰ä¸€ä¸ªï¼Œä¸€ä¸ªç¨‹åºå¯èƒ½æœ‰å¤šä¸ªé¡µè¡¨ï¼‰</li><li>ç©ºé—²åŒºç®¡ç†ä»¥åŠåˆ†é…å›æ”¶ï¼šåŒé¡µå¼ç®¡ç†</li></ul><p>åœ°å€è½¬æ¢</p><ul><li>é€šè¿‡æ®µå·æŸ¥æ®µè¡¨ï¼Œè·å¾—è¯¥æ®µçš„é¡µè¡¨èµ·å§‹åœ°å€ï¼Œå†é€šè¿‡æ®µå†…åœ°å€å¯¹åº”çš„é¡µå·æŸ¥é¡µè¡¨ï¼Œè·å¾—å¯¹åº”çš„é¡µå¸§å·ï¼Œæ‹¼æ¥ä¸Šé¡µå†…åœ°å€ï¼Œæœ€ç»ˆå¾—åˆ°ç‰©ç†åœ°å€</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206132259088.png" alt="åœ°å€è½¬æ¢" /></p><h1 id="å†…å­˜æ‰©å……æŠ€æœ¯"><a class="markdownIt-Anchor" href="#å†…å­˜æ‰©å……æŠ€æœ¯"></a> å†…å­˜æ‰©å……æŠ€æœ¯</h1><p>å½“å†…å­˜ä¸è¶³æ—¶å¦‚ä½•ç®¡ç†ï¼Ÿ</p><ul><li>å†…å­˜ç´§å‡‘ï¼ˆä¾‹å¦‚ï¼šå¯å˜åˆ†åŒºï¼‰</li><li>è¦†ç›–æŠ€æœ¯</li><li>äº¤æ¢æŠ€æœ¯</li><li>è™šå­˜æŠ€æœ¯</li></ul><p>ä¸Šé¢æŠ€æœ¯çš„ç›®æ ‡éƒ½æ˜¯ä¸ºäº†è§£å†³åœ¨è¾ƒå°çš„å­˜å‚¨ç©ºé—´ä¸­è¿è¡Œè¾ƒå¤§ç¨‹åºæ—¶é‡åˆ°çš„çŸ›ç›¾ï¼Œæœ¬å°èŠ‚å°†é‡ç‚¹ä»‹ç»è¦†ç›–æŠ€æœ¯å’Œäº¤æ¢æŠ€æœ¯ï¼Œè™šå­˜æŠ€æœ¯ä¼šåœ¨ä¸‹ä¸€èŠ‚ç€é‡ä»‹ç»ã€‚</p><h2 id="è¦†ç›–æŠ€æœ¯overlaying"><a class="markdownIt-Anchor" href="#è¦†ç›–æŠ€æœ¯overlaying"></a> è¦†ç›–æŠ€æœ¯ï¼ˆOverlayingï¼‰</h2><p>è§£å†³çš„é—®é¢˜ï¼šç¨‹åºå¤§å°è¶…è¿‡ç‰©ç†å†…å­˜æ€»å’Œ</p><p>å®šä¹‰æè¿°ï¼šåœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç¨‹åºçš„ä¸åŒéƒ¨åˆ†åœ¨å†…å­˜ä¸­ç›¸äº’æ›¿ä»£</p><ul><li>æŒ‰ç…§å…¶è‡ªèº«çš„é€»è¾‘ç»“æ„å°†é‚£äº›ä¸ä¼šåŒæ—¶æ‰§è¡Œçš„ç¨‹åºæ®µå…±äº«åŒä¸€å—å†…å­˜åŒºåŸŸ</li><li>è¦æ±‚ç¨‹åºä¸ªæ¨¡å—ä¹‹é—´æœ‰æ˜ç¡®çš„è°ƒç”¨ç»“æ„</li><li>ç¨‹åºå‘˜å£°æ˜è¦†ç›–ç»“æ„ï¼Œæ“ä½œç³»ç»Ÿå®Œæˆè‡ªåŠ¨è¦†ç›–</li><li>ä¸»è¦ç”¨åœ¨æ—©æœŸçš„æ“ä½œç³»ç»Ÿ</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206141624136.png" alt="è¦†ç›–æŠ€æœ¯ç¤ºä¾‹" /></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç¨‹åºæ®µBå’ŒCèƒ½å…±ç”¨åŒä¸€å—å†…å­˜åŒºï¼ŒDã€Eã€Fèƒ½å…±ç”¨åŒä¸€å—å†…å­˜åŒºï¼ˆä¹‹æ‰€ä»¥èƒ½å…±ç”¨ï¼Œæ˜¯å› ä¸ºç¨‹åºçš„é€»è¾‘ä¿è¯è¿™äº›ç¨‹åºæ®µä¸ä¼šåŒæ—¶è¿è¡Œï¼‰ã€‚</p><p>è¦†ç›–æŠ€æœ¯çš„ä¸è¶³ï¼š</p><ul><li>å¢åŠ ç¼–ç¨‹å›°éš¾<ul><li>éœ€è¦ç¨‹åºå‘˜åˆ’åˆ†åŠŸèƒ½æ¨¡å—ï¼Œå¹¶ç¡®å®šæ¨¡å—é—´çš„è¦†ç›–å…³ç³»</li><li>å¢åŠ äº†ç¼–ç¨‹çš„å¤æ‚åº¦</li></ul></li><li>å¢åŠ æ‰§è¡Œæ—¶é—´<ul><li>ä»å¤–å­˜è£…å…¥è¦†ç›–æ¨¡å—</li><li>æ—¶é—´æ¢ç©ºé—´</li></ul></li></ul><h2 id="äº¤æ¢æŠ€æœ¯swapping"><a class="markdownIt-Anchor" href="#äº¤æ¢æŠ€æœ¯swapping"></a> äº¤æ¢æŠ€æœ¯ï¼ˆSwappingï¼‰</h2><p>è®¾è®¡æ€æƒ³</p><ul><li>å†…å­˜ç©ºé—´ç´§å¼ æ—¶ï¼Œç³»ç»Ÿé—´è¯¥å†…å­˜ä¸­æŸäº›è¿›ç¨‹æš‚æ—¶ç§»åˆ°å¤–å­˜ï¼ŒæŠŠå¤–å­˜ä¸­æŸäº›è¿›ç¨‹æ¢è¿›å†…å­˜ï¼Œå æ®å‰è€…æ‰€å ç”¨çš„åŒºåŸŸï¼ˆè¿›ç¨‹åœ¨å†…å­˜ä¸å¤–å­˜ä¹‹é—´çš„åŠ¨æ€è°ƒåº¦ï¼‰</li><li>æœ€æ—©ç”¨äºå°å‹åˆ†æ—¶ç³»ç»Ÿï¼ˆroll in roll outï¼‰</li></ul><p>è®¨è®ºï¼šå®ç°æ—¶éœ€è¦è€ƒè™‘çš„é—®é¢˜</p><ul><li>è¿›ç¨‹çš„ä»€ä¹ˆéƒ¨åˆ†éœ€è¦äº¤æ¢åˆ°ç£ç›˜ï¼Ÿ<ul><li>è¿è¡Œæ—¶åˆ›å»ºæˆ–ä¿®æ”¹çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯<strong>æ ˆå’Œå †</strong>ã€‚è€Œä»£ç æ®µå’Œæ•°æ®æ®µåœ¨ç£ç›˜æœ¬èº«å°±æœ‰æ¥æºï¼Œæ‰€ä»¥æ— éœ€äº¤æ¢</li></ul></li><li>åœ¨ç£ç›˜çš„ä»€ä¹ˆä½ç½®ä¿å­˜è¢«æ¢å‡ºçš„è¿›ç¨‹ï¼Ÿ<ul><li>äº¤æ¢åŒºï¼šä¸€èˆ¬ç³»ç»Ÿä¼šæŒ‡å®šä¸€å—ç‰¹æ®Šçš„ç£ç›˜åŒºåŸŸä½œä¸ºäº¤æ¢ç©ºé—´ï¼ˆswap spaceï¼‰ï¼ŒåŒ…å«è¿ç»­çš„ç£é“ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥ä½¿ç”¨åº•å±‚çš„ç£ç›˜è¯»å†™æ“ä½œå¯¹å…¶é«˜æ•ˆè®¿é—®</li></ul></li><li>ä½•æ—¶éœ€è¦å‘ç”Ÿäº¤æ¢ï¼Ÿ<ul><li>åªè¦ä¸ç”¨å°±æ¢å‡ºï¼ˆå¾ˆå°‘å†ç”¨ï¼‰ï¼›å†…å­˜ç©ºé—´ä¸å¤Ÿæˆ–æœ‰ä¸å¤Ÿçš„å±é™©æ—¶æ¢å‡º</li><li>ä¸è°ƒåº¦å™¨ç»“åˆä½¿ç”¨</li></ul></li><li>å¦‚ä½•é€‰æ‹©è¢«æ¢å‡ºçš„è¿›ç¨‹ï¼Ÿ<ul><li>éœ€è¦è€ƒè™‘è¿›ç¨‹çš„å„ç§å±æ€§ï¼›ä¸åº”è¯¥æ¢å‡ºæ­£å¤„äºç­‰å¾…I/OçŠ¶æ€çš„è¿›ç¨‹</li></ul></li><li>æ¢å‡ºåå†æ¢å…¥çš„è¿›ç¨‹æ˜¯å¦å›åˆ°åŸå¤„ï¼Ÿ<ul><li>æ¢å‡ºååˆæ¢å…¥çš„è¿›ç¨‹ä¸ä¸€å®šå›åˆ°åŸå¤„ï¼ˆé‡‡ç”¨åŠ¨æ€é‡å®šä½ï¼‰</li></ul></li></ul><h1 id="è™šæ‹Ÿå­˜å‚¨ç®¡ç†"><a class="markdownIt-Anchor" href="#è™šæ‹Ÿå­˜å‚¨ç®¡ç†"></a> è™šæ‹Ÿå­˜å‚¨ç®¡ç†</h1><h2 id="ç›¸å…³æœ¯è¯­è¾¨è¯†"><a class="markdownIt-Anchor" href="#ç›¸å…³æœ¯è¯­è¾¨è¯†"></a> ç›¸å…³æœ¯è¯­è¾¨è¯†</h2><ul><li><p><strong>è™šæ‹Ÿå†…å­˜</strong></p><ul><li><p>æŠŠç‰©ç†å†…å­˜ä¸ç£ç›˜ç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œå¾—åˆ°ä¸€ä¸ªå®¹é‡å¾ˆå¤§çš„â€œå†…å­˜â€ï¼Œå³è™šå­˜</p></li><li><p>ç¨‹åºå¼•ç”¨å†…å­˜æ‰€ä½¿ç”¨çš„çš„åœ°å€ä¸å†…å­˜ç‰©ç†åœ°å€æ˜¯ä¸åŒçš„ï¼Œ å¯è¢«è‡ªåŠ¨è½¬æ¢æˆç‰©ç†åœ°å€</p></li><li><p>è™šå­˜å¤§å°å—è®¡ç®—æœºç³»ç»Ÿå¯»å€æœºåˆ¶å’Œå¯ç”¨ç£ç›˜å®¹é‡çš„é™åˆ¶</p></li></ul></li><li><p><strong>è™šæ‹Ÿåœ°å€ç©ºé—´</strong></p><ul><li>åˆ†é…ç»™è¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜</li></ul></li><li><p><strong>è™šæ‹Ÿåœ°å€</strong></p><ul><li>è™šæ‹Ÿå†…å­˜ä¸­æŸä¸€ä½ç½®çš„åœ°å€ï¼Œè¯¥ä½ç½®å¯ä»¥è¢«è®¿é—®ï¼Œä»¿ä½›å®ƒæ˜¯å†…å­˜çš„ä¸€éƒ¨åˆ†</li></ul></li><li><p><strong>è™šæ‹Ÿå­˜å‚¨æŠ€æœ¯</strong></p><ul><li>å½“è¿›ç¨‹è¿è¡Œæ—¶ï¼Œå…ˆå°†å…¶ä¸€éƒ¨åˆ†è£…å…¥å†…å­˜ï¼Œå¦ä¸€éƒ¨åˆ†æš‚æ—¶ä¿å­˜åœ¨ç£ç›˜ï¼›å½“è¦æ‰§è¡Œçš„æŒ‡ä»¤æˆ–è®¿é—®çš„æ•°æ®ä¸å†å†…å­˜æ—¶ï¼Œç”±æ“ä½œç³»ç»Ÿè‡ªåŠ¨å®Œæˆå°†å®ƒä»¬ä»ç£ç›˜è°ƒå…¥å†…å­˜çš„å·¥ä½œ</li></ul></li></ul><h2 id="è™šæ‹Ÿé¡µå¼å­˜å‚¨ç®¡ç†"><a class="markdownIt-Anchor" href="#è™šæ‹Ÿé¡µå¼å­˜å‚¨ç®¡ç†"></a> è™šæ‹Ÿé¡µå¼å­˜å‚¨ç®¡ç†</h2><p>åŸºæœ¬æ€æƒ³</p><ul><li>è£…è½½ç¨‹åºæ—¶ï¼Œä¸æ˜¯è£…å…¥å…¨éƒ¨é¡µé¢ï¼Œè€Œæ˜¯è£…å…¥å‡ ä¸ªç”šè‡³é›¶ä¸ªé¡µé¢</li><li>å¦‚æœè¿›ç¨‹æ‰§è¡Œæ—¶éœ€è¦çš„é¡µé¢ä¸åœ¨å†…å­˜ï¼ˆPage Faultï¼‰ï¼Œåˆ™åŠ¨æ€è£…å…¥æ‰€éœ€é¡µé¢</li><li>éœ€è¦æ—¶ï¼Œå°†å†…å­˜ä¸­æš‚æ—¶ä¸ç”¨çš„ä¸€äº›é¡µé¢äº¤æ¢åˆ°ç£ç›˜ï¼Œä»¥ä¾¿è·å¾—æ›´å¤šçš„å†…å­˜ç©ºé—´</li></ul><p>é€šå¸¸ç”±ä¸¤ç§æ–¹å¼</p><ul><li>è¯·æ±‚è°ƒé¡µï¼ˆdemand pagingï¼‰ï¼šå½“éœ€è¦çš„é¡µé¢ä¸åœ¨å†…å­˜æ—¶ï¼Œå¼•å‘ç¼ºé¡µé”™è¯¯ï¼Œå»è£…å…¥æ‰€éœ€é¡µé¢</li><li>é¢„å…ˆè°ƒé¡µï¼ˆprepagingï¼‰ï¼šåˆ©ç”¨å±€éƒ¨æ€§åŸç†ï¼Œå°†é¢„è®¡åœ¨ä¸ä¹…ä¹‹åä¾¿ä¼šè¢«è®¿é—®çš„é¡µé¢é¢„å…ˆè°ƒå…¥å†…å­˜ã€‚</li></ul><p>è°ƒé¡µæœºåˆ¶</p><ul><li>è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸ä¸ºä¾‹åœ°å€ç©ºé—´åˆ†ç¦»</li><li>è°ƒé¡µç³»ç»Ÿçš„3ä¸ªé‡è¦ç­–ç•¥<ol><li>ç³»ç»Ÿä½•æ—¶æŠŠé¡µé¢è½½å…¥å†…å­˜â€”â€”å–é¡µç­–ç•¥ï¼ˆfetch policyï¼‰</li><li>ç³»ç»ŸæŠŠé¡µé¢æ”¾åœ¨ä½•å¤„â€”â€”é˜²æ­¢ç­–ç•¥ï¼ˆplacement policyï¼‰</li><li>æ‰§è¡Œæ”¾ç½®æ“ä½œæ—¶å‘ç”Ÿé¡µæ¡†ä¸è¶³æ—¶ï¼Œå¦‚ä½•é€‰æ‹©ä»å†…å­˜é‡Œâ€œåˆ é™¤â€å…¶ä»–é¡µæ¡†â€”â€”ç½®æ¢ç­–ç•¥ï¼ˆreplacement policyï¼‰</li></ol></li></ul><hr /><p>è®¾è®¡ä¸å®ç°æ—¶è¦è§£å†³çš„é—®é¢˜ï¼š</p><ul><li>é¡µè¡¨è¡¨é¡¹çš„è®¾è®¡</li><li>å¦‚ä½•å¤„ç†é¡µè¡¨å·¨å¤§çš„é—®é¢˜ï¼Ÿ</li><li>åœ°å€é‡å®šä½ä¸å—è¡¨ï¼ˆTLB)</li><li>ä¸€ç§æœ€å¸¸è§çš„Page Fault â€”â€” ç¼ºé¡µä¸­æ–­</li><li>é©»ç•™é›†ç®¡ç†</li><li>ç½®æ¢ç­–ç•¥</li><li>æ¸…é™¤ç­–ç•¥</li><li>åŠ è½½æ§åˆ¶</li></ul><p>æ¥ä¸‹æ¥å°†è¯¦ç»†ä»‹ç»ä»¥ä¸Šå„ä¸ªé—®é¢˜ã€‚</p><h3 id="é¡µè¡¨è¡¨é¡¹çš„è®¾è®¡"><a class="markdownIt-Anchor" href="#é¡µè¡¨è¡¨é¡¹çš„è®¾è®¡"></a> é¡µè¡¨è¡¨é¡¹çš„è®¾è®¡</h3><p>é¡µè¡¨è¡¨é¡¹é€šå¸¸åŒ…å«é¡µæ¡†å·ã€æœ‰æ•ˆä½ã€è®¿é—®ä½ã€ä¿®æ”¹ä½ã€ä¿æŠ¤ä½ç­‰ã€‚</p><ul><li>é¡µæ¡†å·ï¼ˆå†…å­˜å—å·ã€ç‰©ç†é¡µé¢å·ã€é¡µå¸§å·ï¼‰</li><li>æœ‰æ•ˆä½ï¼ˆé©»ç•™ä½ã€ä¸­æ–­ä½ï¼‰ï¼šè¡¨ç¤ºè¯¥é¡µæ˜¯åœ¨å†…å­˜è¿˜æ˜¯åœ¨ç£ç›˜ï¼ˆValidã€Presentï¼‰</li><li>è®¿é—®ä½ï¼šå¼•ç”¨ä½ï¼ˆReferencedã€Accessedï¼‰</li><li>ä¿®æ”¹ä½ï¼šæŸ¥çœ‹æ­¤é¡µæ˜¯å¦åœ¨å†…å­˜ä¸­è¢«ä¿®æ”¹è¿‡ï¼ˆDirtyã€Modifiedï¼‰</li><li>ä¿æŠ¤ä½ï¼šè¯»/å†™/æ‰§è¡Œï¼ˆProtectionï¼‰</li></ul><p>ä¸‹é¢ä¸¤å¼ å›¾ç»™å‡ºäº†i386(intel 32ä½æœºå™¨)ä»¥åŠRISC-Vçš„é¡µè¡¨é¡¹è®¾è®¡ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142004594.png" alt="i386é¡µç›®å½•é¡¹å’Œé¡µè¡¨é¡¹" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142028348.png" alt="RISC-Vé¡µè¡¨é¡¹" /></p><p>å¯¹äºRISC-Vé¡µè¡¨é¡¹å¸ƒå±€çš„è§£é‡Šï¼š</p><ul><li>Vä½å†³å®šäº†è¯¥é¡µè¡¨é¡¹æ˜¯å¦æœ‰æ•ˆï¼ˆV=1æ—¶æœ‰æ•ˆï¼‰</li><li>Rã€Wã€Xä½åˆ†åˆ«è¡¨ç¤ºæ­¤é¡µæ˜¯å¦å¯ä»¥è¯»å–ã€å†™å…¥å’Œæ‰§è¡Œã€‚å¦‚æœè¿™ä¸ªä¸‰ä¸ªä½éƒ½æ˜¯0ï¼Œé‚£ä¹ˆè¿™ä¸ªé¡µè¡¨é¡¹æ˜¯æŒ‡å‘ä¸‹ä¸€çº§é¡µè¡¨çš„æŒ‡é’ˆï¼Œå¦åˆ™å®ƒæ˜¯é¡µè¡¨æ ‘çš„ä¸€ä¸ªå¶èŠ‚ç‚¹ï¼ˆå¤šçº§é¡µè¡¨ï¼‰</li><li>Uä½è¡¨ç¤ºè¯¥é¡µæ˜¯å¦æ˜¯ç”¨æˆ·é¡µé¢ï¼ˆU=0ï¼Œåˆ™ç”¨æˆ·æ¨¡å¼ä¸èƒ½è®¿é—®æ­¤é¡µé¢ï¼‰</li><li>Gä½è¡¨ç¤ºè¿™ä¸ªæ˜ å°„æ˜¯å¦å¯¹æ‰€æœ‰è™šæ‹Ÿåœ°å€ç©ºé—²æœ‰æ•ˆï¼Œç¡¬ä»¶å¯ä»¥ç”¨è¿™ä¸ªä¿¡æ¯æ¥æé«˜åœ°å€è½¬åŒ–çš„æ€§èƒ½ã€‚</li><li>Aä½è¡¨ç¤ºè‡ªä¸Šæ¬¡Aä½è¢«æ¸…é™¤ä»¥æ¥ï¼Œè¯¥é¡µé¢æ˜¯å¦è¢«è®¿é—®è¿‡ã€‚</li><li>Dä½è¡¨ç¤ºè‡ªä»ä¸Šæ¬¡æ¸…é™¤Dä½ä¾èµ–ï¼Œè¯¥é¡µé¢æ˜¯å¦è¢«å¼„è„ï¼ˆä¾‹å¦‚è¢«å†™å…¥ï¼‰</li><li>RSW ç•™ç»™æ“ä½œç³»ç»Ÿä½¿ç”¨ï¼Œå®ƒä¼šè¢«ç¡¬ä»¶å¿½ç•¥ã€‚</li><li>PPN è¡¨ç¤ºç‰©ç†é¡µå·ï¼Œè¿™æ˜¯ç‰©ç†åœ°å€çš„ä¸€éƒ¨åˆ†ã€‚è‹¥è¿™æ˜¯ä¸€ä¸ªé¡µç›®å½•é¡¹ï¼Œåˆ™PPNç»™å‡ºä¸‹ä¸€ä¸ªé¡µè¡¨çš„åœ°å€ï¼›è‹¥è¿™æ˜¯ä¸€ä¸ªé¡µè¡¨é¡¹ï¼Œåˆ™PPNæ˜¯è½¬æ¢åç‰©ç†åœ°å€çš„ä¸€éƒ¨åˆ†ã€‚</li></ul><h3 id="å¤šçº§é¡µè¡¨"><a class="markdownIt-Anchor" href="#å¤šçº§é¡µè¡¨"></a> å¤šçº§é¡µè¡¨</h3><p>å¤šçº§é¡µè¡¨çš„å¼•å…¥ï¼Œæ˜¯ä¸ºäº†è§£å†³é¡µè¡¨è¿ç»­å­˜æ”¾ï¼Œå¯¼è‡´å ç”¨è¿‡å¤šçš„é—®é¢˜ï¼Œå› ä¸ºè™½ç„¶ä¸€ä¸ªè¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´å¾ˆå¤§ï¼Œä½†æ˜¯å®é™…å ç”¨çš„ç©ºé—´å¾ˆå°ï¼Œæ‰€ä»¥é¡µè¡¨ä¼šå¾ˆç¨€ç–ï¼ˆå³å¤§éƒ¨åˆ†é¡µè¡¨é¡¹éƒ½æ˜¯æ— æ•ˆçš„ï¼‰ã€‚å¦‚æœé‡‡ç”¨ä¸€çº§é¡µè¡¨ï¼Œåˆ™ä¸€ä¸ªè¿›ç¨‹æœ‰ 2^19 é¡µï¼ˆè®¡ç®—è¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼Œ2G / 4Kï¼‰ï¼Œå³éœ€è¦æœ‰2^19ä¸ªé¡µè¡¨é¡¹ï¼Œé‚£ä¹ˆå…‰æ˜¯é¡µè¡¨é¡¹çš„å­˜å‚¨å°±éœ€è¦512é¡µï¼ˆå³2MBï¼‰ï¼Œè€Œè¿›ç¨‹æœ¬èº«å®é™…å¤§å°æˆ–è®¸éƒ½æ²¡è¿™ä¹ˆå¤§ã€‚</p><p>æ‰€ä»¥å¼•å…¥å¤šçº§é¡µè¡¨ï¼Œé€šè¿‡ç´¢å¼•çš„æ€æƒ³ï¼Œè®©ä¸€ä¸ªè¿›ç¨‹çš„é¡µè¡¨çš„å„é¡µä¸ç”¨å†å†…å­˜ä¸­è¿ç»­å­˜æ”¾ï¼Œä¹Ÿä¸ç”¨ç»™æ‰€æœ‰é¡µè¡¨é¡¹éƒ½åˆ†é…å†…å­˜ï¼Œåªéœ€è¦ä¸ºå®é™…ä½¿ç”¨åˆ°çš„è™šæ‹Ÿåœ°å€å»ºç«‹é¡µè¡¨é¡¹æ˜ å°„å³å¯ã€‚</p><ul><li>å› ä¸ºå¦‚æœä¸€çº§é¡µè¡¨ä¸­çš„ä¸€ä¸ª PTE ä¸ºç©ºï¼Œé‚£ä¹ˆç›¸åº”çš„äºŒçº§é¡µè¡¨å°±æ ¹æœ¬ä¸ä¼šå­˜åœ¨ã€‚è¿™æ˜¯ä¸€ç§å·¨å¤§çš„å†…å­˜èŠ‚çº¦ã€‚</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142040370.png" alt="å¤šçº§é¡µè¡¨çš„å¼•å…¥" /></p><p>ä¸‹å›¾ç»™å‡ºäº†äºŒçº§é¡µè¡¨çš„ç»“æ„ï¼Œä»¥åŠåœ°å€æ˜ å°„çš„è¿‡ç¨‹ã€‚è¿™é‡Œè™šæ‹Ÿåœ°å€æ˜¯32ä½çš„ï¼Œæ¯ä¸ªé¡µè¡¨é¡¹å 4ä¸ªå­—èŠ‚ï¼ˆé¡µå¤§å°ä¸º4Kï¼Œå› æ­¤æ¯é¡µéƒ½æœ‰1Kä¸ªé¡µè¡¨é¡¹ï¼‰ã€‚è¿›è¡Œåœ°å€æ˜ å°„æ—¶ï¼Œå‰10ä½ä½œä¸ºé¡µç›®å½•åç§»ï¼ŒæŸ¥æ‰¾é¡µç›®å½•ï¼ˆä¸€çº§é¡µè¡¨ï¼Œç”±å…¨å±€é¡µç›®å½•å¯„å­˜å™¨è®°å½•å…¶ç‰©ç†åœ°å€ï¼‰ä¸Šçš„é¡µè¡¨é¡¹ï¼Œå¾—åˆ°ä¸‹ä¸€çº§é¡µè¡¨çš„ç‰©ç†åœ°å€ï¼Œå†æ ¹æ®å10ä½ä½œä¸ºé¡µè¡¨åç§»ï¼ŒæŸ¥æ‰¾äºŒçº§é¡µè¡¨ä¸Šçš„é¡µè¡¨é¡¹ï¼Œå¾—åˆ°å¯¹åº”æ•°æ®/ä»£ç æ‰€åœ¨çš„é¡µå·ï¼Œå†æ‹¼æ¥æœ«å°¾12ä½çš„é¡µå†…åç§»ï¼Œå¾—åˆ°æœ€ç»ˆçš„ç‰©ç†åœ°å€ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142052121.png" alt="äºŒçº§é¡µè¡¨ç»“æ„ä»¥åŠåœ°å€æ˜ å°„" /></p><h3 id="å¿«è¡¨tlb"><a class="markdownIt-Anchor" href="#å¿«è¡¨tlb"></a> å¿«è¡¨ï¼ˆTLBï¼‰</h3><p>åœ¨å¼•å…¥äºŒçº§é¡µè¡¨æˆ–è€…å¤šçº§é¡µè¡¨åï¼Œå°±éœ€è¦ä¸¤æ¬¡æˆ–ä¸¤æ¬¡ä»¥ä¸Šçš„å†…å­˜è®¿é—®ã€‚è€ŒCPUçš„æŒ‡ä»¤å¤„ç†é€Ÿåº¦ä¸å†…å­˜æŒ‡ä»¤çš„è®¿é—®é€Ÿåº¦å·®å¼‚å¤§ï¼Œå› æ­¤CPUçš„é€Ÿåº¦å¾—ä¸åˆ°å……åˆ†åˆ©ç”¨ã€‚</p><p>ä¸ºäº†åŠ å¿«åœ°å€æ˜ å°„é€Ÿåº¦ï¼Œä»¥æ”¹å–„ç³»ç»Ÿæ€§èƒ½ï¼Œå°±å¼•å…¥äº†å¿«è¡¨ï¼ˆä¹Ÿä½“ç°äº†ç¨‹åºè®¿é—®çš„å±€éƒ¨æ€§åŸç†ï¼‰ã€‚</p><p>å¿«è¡¨è‹±æ–‡åTLBâ€”â€”Translation Look-aside Buffersï¼Œå®é™…ä¸Šä¸€ä¸ªç›¸è”å­˜å‚¨å™¨ï¼Œå…¶ç‰¹ç‚¹æ˜¯æŒ‰å†…å®¹è¿›è¡Œå¹¶è¡ŒæŸ¥æ‰¾ã€‚å¿«è¡¨ä¿å­˜æ­£åœ¨è¿è¡Œè¿›ç¨‹çš„é¡µè¡¨çš„å­é›†ï¼ˆéƒ¨åˆ†è¡¨é¡¹ï¼‰ã€‚</p><p>å…¶å·¥ä½œåŸç†å°±æ˜¯é‡‡ç”¨è”æƒ³æ˜ å°„æŠ€æœ¯æŒ‰å†…å®¹åŒæ—¶æŸ¥æ‰¾ï¼Œå½“è¦è½¬æ¢çš„è™šæ‹Ÿåœ°å€åœ¨TLBä¸­æœ‰è®°å½•/å‘½ä¸­æ—¶ï¼Œåˆ™TLBå¯ä»¥ç›´æ¥è¿”å›å¯¹åº”çš„ç‰©ç†åœ°å€ï¼Œè€Œä¸å†éœ€è¦æ ¹æ®é¡µè¡¨è¿›è¡Œè½¬æ¢ã€‚è€Œæ²¡æœ‰å‘½ä¸­æ—¶ï¼Œåˆ™å†å»æŸ¥æ‰¾é¡µè¡¨ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142126713.png" alt="TLBçš„ä½¿ç”¨" /></p><p>å½“TLBå‘½ä¸­è¿”å›å¯¹åº”æ•°æ®/ä»£ç çš„ç‰©ç†åœ°å€æ—¶ï¼Œè¿˜éœ€è¦å†å»è®¿é—®å†…å­˜ï¼Œä¸ºäº†è¿›ä¸€æ­¥å‡å°‘å†…å­˜è®¿é—®ï¼Œåˆæœ‰äº†é«˜é€Ÿç¼“å­˜Cacheï¼Œç¼“å­˜äº†éƒ¨åˆ†å†…å­˜ä¸­çš„æ•°æ®ï¼Œå½“å‘½ä¸­ç¼“å­˜æ—¶ï¼Œå¯ä»¥ç›´æ¥å¾—åˆ°æ•°æ®è€Œæ— éœ€è®¿é—®å†…å­˜ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142128181.png" alt="TLBä¸é«˜é€Ÿç¼“å­˜" /></p><h3 id="ç¼ºé¡µå¼‚å¸¸å¤„ç†"><a class="markdownIt-Anchor" href="#ç¼ºé¡µå¼‚å¸¸å¤„ç†"></a> ç¼ºé¡µå¼‚å¸¸å¤„ç†</h3><p>åœ¨åœ°å€æ˜ å°„è¿‡ç¨‹ä¸­ï¼Œç¡¬ä»¶æ£€æŸ¥é¡µè¡¨æ—¶å‘ç°æ‰€è¦è®¿é—®çš„é¡µä¸å†å†…å­˜ï¼Œåˆ™äº§ç”Ÿè¯¥å¼‚å¸¸â€”â€”ç¼ºé¡µå¼‚å¸¸ã€‚</p><p>æ“ä½œç³»ç»Ÿæ‰§è¡Œç¼ºé¡µå¼‚å¸¸å¤„ç†ç¨‹åºï¼šè·å¾—ç£ç›˜åœ°å€ï¼ˆåœ¨PCBä¸­è®°å½•ï¼‰ï¼Œå¯åŠ¨ç£ç›˜IOï¼Œå°†è¯¥é¡µè°ƒå…¥å†…å­˜</p><ul><li>å¦‚æœå†…å­˜ä¸­æœ‰ç©ºé—²é¡µæ¡†ï¼Œåˆ™åˆ†é…ä¸€é¡µï¼Œå°†æ–°è°ƒå…¥çš„é¡µè£…å…¥å†…å­˜ï¼Œå¹¶ä¿®æ”¹é¡µè¡¨ä¸­ç›¸åº”é¡µè¡¨é¡¹çš„é©»ç•™ä½/æœ‰æ•ˆä½ï¼Œä»¥åŠç›¸åº”çš„é¡µæ¡†å·</li><li>è‹¥å†…å­˜ä¸­æ²¡æœ‰ç©ºé—²é¡µæ¡†ï¼Œåˆ™éœ€è¦ç½®æ¢æŸä¸€é¡µï¼›è‹¥è¯¥é¡µåœ¨å†…å­˜æœŸé—´è¢«ä¿®æ”¹è¿‡ï¼Œåˆ™è¦å°†å…¶å†™ä¼šç£ç›˜</li></ul><h3 id="é©»ç•™é›†ç®¡ç†"><a class="markdownIt-Anchor" href="#é©»ç•™é›†ç®¡ç†"></a> é©»ç•™é›†ç®¡ç†</h3><p>é©»ç•™é›†å¤§å°ï¼šå³ç»™æ¯ä¸ªè¿›ç¨‹åˆ†é…å¤šå°‘é¡µæ¡†ã€‚æ˜¾ç„¶ï¼Œå½“é©»ç•™é›†è¶Šå¤§æ—¶ï¼Œå‡ºç°ç¼ºé¡µå¼‚å¸¸çš„æ¦‚ç‡è¶Šå°ã€‚</p><p>å¯ä»¥é‡‡å–ä¸åŒçš„åˆ†é…ç­–ç•¥ï¼š</p><ul><li>å›ºå®šåˆ†é…ç­–ç•¥<ul><li>è¿›ç¨‹åˆ›å»ºæ—¶å°±ç¡®å®šé©»ç•™é›†å¤§å°ã€‚å¯ä»¥æ ¹æ®è¿›ç¨‹ç±»å‹ï¼ˆäº¤äº’ã€æ‰¹å¤„ç†ã€åº”ç”¨ç±»ï¼‰æˆ–è€…åŸºäºç¨‹åºå‘˜æˆ–ç®¡ç†å‘˜çš„éœ€è¦æ¥ç¡®å®šã€‚</li></ul></li><li>å¯å˜åˆ†é…ç­–ç•¥<ul><li>æ ¹æ®ç¼ºé¡µç‡è¯„ä¼°å±€éƒ¨æ€§è¡¨ç°ã€‚å½“ç¼ºé¡µç‡é«˜æ—¶å¢åŠ é¡µæ¡†æ•°ï¼Œå½“ç¼ºé¡µç‡ä½æ—¶å‡å°‘é¡µæ¡†æ•°ã€‚</li></ul></li></ul><h3 id="é¡µé¢ç½®æ¢ç®—æ³•"><a class="markdownIt-Anchor" href="#é¡µé¢ç½®æ¢ç®—æ³•"></a> é¡µé¢ç½®æ¢ç®—æ³•</h3><h4 id="ç½®æ¢ç­–ç•¥"><a class="markdownIt-Anchor" href="#ç½®æ¢ç­–ç•¥"></a> ç½®æ¢ç­–ç•¥</h4><p>æ ¹æ®ç½®æ¢èŒƒå›´ï¼ˆè®¡åˆ’ç½®æ¢é¡µé¢çš„é›†åˆæ˜¯å±€é™åœ¨äº§ç”Ÿç¼ºé¡µä¸­æ–­çš„è¿›ç¨‹ï¼Œè¿˜æ˜¯æ‰€æœ‰è¿›ç¨‹çš„é¡µæ¡†ï¼‰ï¼Œåˆå¯åˆ†ä¸ºï¼š</p><ul><li>å±€éƒ¨ç½®æ¢ç­–ç•¥ï¼šä»…åœ¨äº§ç”Ÿæœ¬æ¬¡ç¼ºé¡µçš„è¿›ç¨‹çš„é©»ç•™é›†ä¸­é€‰æ‹©</li><li>å…¨å±€ç½®æ¢ç­–ç•¥ï¼šå°†å†…å­˜ä¸­æ‰€æœ‰ä½é”å®šçš„é¡µæ¡†éƒ½ä½œä¸ºç½®æ¢çš„å€™é€‰</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142148829.png" alt="å±€éƒ¨ç½®æ¢ä¸å…¨å±€ç½®æ¢" /></p><p>ç½®æ¢ç­–ç•¥ï¼šå†³å®šç½®æ¢å½“å‰å†…å­˜ä¸­çš„å“ªä¸€ä¸ªé¡µæ¡†ã€‚</p><p>æ‰€æœ‰ç­–ç•¥çš„ç›®æ ‡éƒ½æ˜¯ä¸ºäº†ç½®æ¢æœ€è¿‘æœ€ä¸å¯èƒ½è®¿é—®çš„é¡µã€‚</p><ul><li>æ ¹æ®å±€éƒ¨æ€§åŸç†ï¼Œæœ€è¿‘çš„è®¿é—®å†å²å’Œæœ€è¿‘å°†è¦è®¿é—®çš„æ¨¡å¼é—´å­˜åœ¨ç›¸å…³æ€§ï¼Œå› æ­¤å¤§å¤šæ•°ç­–ç•¥éƒ½<strong>åŸºäºè¿‡å»çš„è¡Œä¸ºæ¥é¢„æµ‹å°†æ¥çš„è¡Œä¸º</strong>ã€‚</li><li>åŒæ—¶è¦æ³¨æ„ï¼Œç½®æ¢ç­–ç•¥è®¾è®¡å¾—çº¦ç²¾è‡´ã€è¶Šå¤æ‚ï¼Œå®ç°çš„è½¯ç¡¬ä»¶å¼€é”€å°±è¶Šå¤§ã€‚</li><li>ç½®æ¢æ—¶çš„çº¦æŸæ¡ä»¶ï¼šä¸èƒ½ç½®æ¢è¢«é”å®šçš„é¡µæ¡†ã€‚<ul><li>ç»™æ¯ä¸ªé¡µæ¡†å¢åŠ ä¸€ä¸ªé”å®šä½ï¼Œé€šè¿‡è®¾ç½®é”å®šä½ï¼Œä¸è®©æ“ä½œç³»ç»Ÿå°†è¿›ç¨‹ä½¿ç”¨çš„é¡µé¢æ¢å‡ºå†…å­˜ï¼Œé¿å…äº§ç”Ÿç”±äº¤æ¢è¿‡ç¨‹å¸¦æ¥çš„ä¸ç¡®å®šçš„å»¶è¿Ÿã€‚</li><li>ä¾‹å¦‚æ“ä½œç³»ç»Ÿæ ¸å¿ƒä»£ç ã€å…³é”®æ•°æ®ç»“æ„ã€I/Oç¼“å†²åŒºï¼ˆæ­£åœ¨IOçš„å†…å­˜é¡µé¢ï¼‰</li></ul></li></ul><h4 id="å„ç§ç½®æ¢ç®—æ³•"><a class="markdownIt-Anchor" href="#å„ç§ç½®æ¢ç®—æ³•"></a> å„ç§ç½®æ¢ç®—æ³•</h4><p>ç†æƒ³ï¼ˆæœ€ä½³ã€æœ€ä¼˜ï¼‰ç½®æ¢ç®—æ³•ï¼ˆOPTï¼‰</p><ul><li>è®¾è®¡æ€æƒ³ï¼šç½®æ¢ä»¥åä¸å†éœ€è¦çš„æˆ–æœ€è¿œçš„å°†æ¥æ‰ä¼šç”¨åˆ°çš„é¡µé¢</li><li>å®ç°å¾ˆéš¾ï¼Œå› ä¸ºæ— æ³•é¢„æµ‹æœªæ¥çš„ä½¿ç”¨æƒ…å†µ</li></ul><hr /><p>å…ˆè¿›å…ˆå‡ºé¡µé¢ç½®æ¢ç®—æ³•ï¼ˆFIFOï¼‰</p><ul><li>è®¾è®¡æ€æƒ³ï¼šé€‰æ‹©å†…å­˜ä¸­é©»ç•™æ—¶é—´æœ€é•¿çš„é¡µå¹¶ç½®æ¢</li><li>å®ç°ï¼šé¡µé¢é“¾è¡¨æ³•</li><li>FIFOç®—æ³•ä¼šå‡ºç°Beladyç°è±¡ï¼Œå³å½“åˆ†é…ç»™è¿›ç¨‹çš„ç‰©ç†é¡µé¢æ•°å¢åŠ æ—¶ï¼Œç¼ºé¡µæ¬¡æ•°åè€Œå¢åŠ </li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142239620.png" alt="Beladyç°è±¡" /></p><hr /><p>ç¬¬äºŒæ¬¡æœºä¼šç½®æ¢ç®—æ³•ï¼ˆSCRï¼ŒSecond Chance)</p><ul><li><p>è®¾è®¡æ€æƒ³ï¼šæŒ‰ç…§å…ˆè¿›å…ˆå‡ºç®—æ³•é€‰æ‹©æŸä¸€é¡µé¢ï¼Œæ£€æŸ¥å…¶è®¿é—®ä½Rï¼Œå¦‚æœä¸º0ï¼ˆè¡¨æ˜è¿‘æœŸæœªè®¿é—®ï¼‰ï¼Œåˆ™ç½®æ¢è¯¥é¡µï¼›å¦‚æœä¸º1ï¼Œåˆ™ç»™ç¬¬äºŒæ¬¡æœºä¼šï¼Œå¹¶å°†è®¿é—®ä½ç½®0</p></li><li><p>æ—¶é’Ÿç®—æ³•ï¼ˆClockï¼‰ï¼Œæ˜¯SCRçš„ä¸€ç§å®ç°</p></li></ul><hr /><p>æœ€è¿‘æœªä½¿ç”¨ç®—æ³•ï¼ˆNRUï¼ŒNot Recently Usedï¼‰</p><ul><li>è®¾è®¡æ€æƒ³ï¼šé€‰æ‹©åœ¨æœ€è¿‘ä¸€æ®µæ—¶é—´å†…æœªä½¿ç”¨çš„ä¸€é¡µå¹¶ç½®æ¢</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142208452.png" alt="æœ€è¿‘æœªä½¿ç”¨ç®—æ³•NRUå®ç°" /></p><hr /><p>æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ç®—æ³•ï¼ˆLRUï¼ŒLeast Recently Usedï¼‰</p><ul><li>é€‰æ‹©æœ€åä¸€æ¬¡è®¿é—®æ—¶é—´è·ç¦»å½“å‰æ—¶é—´æœ€é•¿çš„ä¸€é¡µå¹¶ç½®æ¢ï¼Œå³ç½®æ¢æœªä½¿ç”¨æ—¶é—´æœ€é•¿çš„ä¸€é¡µ</li><li>æ€§èƒ½ä¸Šæ¥è¿‘OPT</li><li>å®ç°ï¼šä½¿ç”¨æ—¶é—´æˆ³æˆ–ç»´æŠ¤ä¸€ä¸ªè®¿é—®é¡µçš„æ ˆï¼Œä½†æ˜¯å¼€é”€å¤§</li></ul><hr /><p>æœ€ä¸ç»å¸¸ä½¿ç”¨ç®—æ³•ï¼ˆNFUï¼ŒNot Frequently Usedï¼‰</p><ul><li>è®¾è®¡æ€æƒ³ï¼šé€‰æ‹©è®¿é—®æ¬¡æ•°æœ€å°‘çš„é¡µé¢ç½®æ¢</li><li>å®ç°ï¼š<ul><li>è½¯ä»¶è®¡æ•°å™¨ï¼Œä¸€é¡µä¸€ä¸ªï¼Œåˆå€¼ä¸º0</li><li>æ¯æ¬¡æ—¶é’Ÿä¸­æ–­æ—¶ï¼Œè®¡æ•°å™¨åŠ R</li><li>å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œé€‰æ‹©è®¡æ•°å™¨æœ€å°çš„ä¸€é¡µç½®æ¢</li></ul></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142234739.png" alt="è€åŒ–ç®—æ³•â€”â€”NFUçš„ä¼˜åŒ–å®ç°" /></p><p>NFUè€åŒ–ç®—æ³•æ˜¯è½¯ä»¶æ¨¡æ‹Ÿï¼ŒNFUè€åŒ–ç®—æ³•çš„è®¡æ•°å™¨åªæœ‰æœ‰é™ä½æ•°nï¼Œå› æ­¤ç½®æ¢ä¿¡æ¯ä»…é™äºnä¸ªæ—¶é’Ÿæ»´ç­”å†…</p><hr /><p><strong>å·¥ä½œé›†æ¨¡å‹</strong><sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="å†…å­˜ç®¡ç†">[4]</span></a></sup></p><ul><li>åŸºæœ¬æ€æƒ³ï¼šæ ¹æ®ç¨‹åºçš„å±€éƒ¨æ€§åŸç†ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿›ç¨‹åœ¨ä¸€æ®µæ—¶é—´å†…æ€»æ˜¯é›†ä¸­è®¿é—®ä¸€äº›é¡µé¢ï¼Œè¿™äº›é¡µé¢ç§°ä¸º<strong>æ´»è·ƒé¡µé¢</strong>ï¼Œå¦‚æœåˆ†é…ç»™ä¸€ä¸ªè¿›ç¨‹çš„é¡µæ¡†å¤ªå°‘äº†ï¼Œä½¿å¾—è¯¥è¿›ç¨‹æ‰€éœ€çš„æ´»è·ƒé¡µé¢ä¸èƒ½å…¨éƒ¨è£…å…¥å†…å­˜ï¼Œåˆ™è¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å°†é¢‘ç¹å‘ç”Ÿä¸­æ–­</li><li>å¦‚æœèƒ½ä¸ºè¿›ç¨‹æä¾›ä¸æ´»è·ƒé¡µé¢æ•°ç›¸ç­‰çš„é¡µæ¡†æ•°ï¼Œåˆ™å¯å‡å°‘ç¼ºé¡µä¸­æ–­æ¬¡æ•°</li><li>æ´»é¡µé¡µé¢çš„é›†åˆå°±æ˜¯å·¥ä½œé›†ã€‚å·¥ä½œé›†éšç€æ—¶é—´å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä½†åœ¨ä¸€å®šæ—¶é—´å†…æ˜¯æ¯”è¾ƒç¨³å®šçš„</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142246321.png" alt="å·¥ä½œé›†ä¸é©»ç•™é›†" /></p><p><strong>å·¥ä½œé›†ç®—æ³•</strong></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142248373.png" alt="å·¥ä½œé›†ç®—æ³•åŸºæœ¬æ€è·¯" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142248943.png" alt="å·¥ä½œé›†ç®—æ³•å›¾ç¤º" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142248383.png" alt="å·¥ä½œé›†ç®—æ³•å®ç°" /></p><h4 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h4><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142249041.png" alt="å¤šç§é¡µé¢ç½®æ¢ç®—æ³•å°ç»“" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142251883.png" alt="å½±å“ç¼ºé¡µæ¬¡æ•°çš„å› ç´ " /></p><h3 id="æ¸…é™¤ç­–ç•¥"><a class="markdownIt-Anchor" href="#æ¸…é™¤ç­–ç•¥"></a> æ¸…é™¤ç­–ç•¥</h3><p>è¿™é‡Œçš„æ¸…é™¤ç­–ç•¥ä¸»è¦æ˜¯æŒ‡ï¼Œå®šæœŸåœ°å›æ”¶é¡µé¢ï¼Œä»¥ä¿è¯ç³»ç»Ÿå§‹ç»ˆæœ‰ä¸€å®šæ•°é‡çš„ç©ºé—²é¡µæ¡†ã€‚å…·ä½“å†…å®¹æè¿°å¯å‚è€ƒä¸‹å›¾ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206142300700.png" alt="æ¸…é™¤ç­–ç•¥" /></p><h3 id="åŠ è½½æ§åˆ¶"><a class="markdownIt-Anchor" href="#åŠ è½½æ§åˆ¶"></a> åŠ è½½æ§åˆ¶</h3><p>ç³»ç»Ÿå¹¶å‘åº¦ï¼šé©»ç•™åœ¨å†…å­˜ä¸­çš„è¿›ç¨‹æ•°ç›®ã€‚</p><p>é€šè¿‡è°ƒèŠ‚å¹¶å‘è¿›ç¨‹æ•°å¯¹ç³»ç»Ÿè´Ÿè½½è¿›è¡Œæ§åˆ¶ã€‚</p><p><strong>å½“ç³»ç»Ÿå¹¶å‘åº¦è¿‡é«˜æ—¶ï¼Œä¼šå¯¼è‡´è¿›ç¨‹åˆ‡æ¢é¢‘ç¹ï¼Œè€ŒCPUåˆ©ç”¨ç‡ä¸‹é™ã€‚</strong></p><p>è§£å†³æ–¹æ¡ˆï¼šè¿›ç¨‹æŒ‚èµ·ï¼Œå³é‡Šæ”¾ä¸€éƒ¨åˆ†è¿›ç¨‹æ‰€å æœ‰çš„é¡µé¢ï¼ŒæŠŠå®ƒä»¬äº¤æ¢åˆ°ç£ç›˜ä¸Š</p><h1 id="åœ°å€è½¬æ¢ç»ƒä¹ "><a class="markdownIt-Anchor" href="#åœ°å€è½¬æ¢ç»ƒä¹ "></a> åœ°å€è½¬æ¢ç»ƒä¹ </h1><p>æœ€åä¸ºäº†å·©å›ºåœ°å€è½¬æ¢çš„è¿‡ç¨‹ï¼Œæ¥åšé“ç»ƒä¹ é¢˜å§ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ±‚ç»™å‡ºçš„è™šæ‹Ÿåœ°å€å¯¹åº”çš„PDEå’ŒPTEçš„ç‰©ç†åœ°å€ï¼Œå‡è®¾é‡‡ç”¨çš„æ˜¯äºŒçº§é¡µè¡¨ï¼Œå·¦è¾¹è¡¨æ ¼æ˜¯TLBçš„æ•°æ®ï¼Œå³è¾¹è¡¨æ ¼æ˜¯æŸä¸ªç‰©ç†åœ°å€ä¸Šå¯¹åº”æ•°æ®ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206152243902.jpg" alt="åœ°å€è½¬æ¢ç»ƒä¹ é¢˜" /></p><p>å†æ­¤ä¹‹å‰ï¼Œå†ä»‹ç»ä¸€ä¸‹TLBå¿«è¡¨çš„æŸ¥è¯¢æ–¹å¼ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç»™å®šäº†ä¸€ä¸ª14ä½çš„è™šæ‹Ÿåœ°å€ï¼Œå‰8ä½ä¸ºVPNï¼ˆè™šæ‹Ÿåœ°å€é¡µå·ï¼‰ï¼Œå6ä½ä¸ºåœ°å€åç§»ã€‚VPNåˆè¢«åˆ’åˆ†ä¸º TLBTï¼ˆTLB Tagï¼‰å’Œ TLBIï¼ˆTLB Indexï¼‰ï¼Œå› ä¸ºè¿™é‡Œè¡¨æ ¼æ˜¾ç¤ºçš„æ˜¯4è¡Œï¼Œå³TLBæ˜¯å››è·¯ç›¸è¿ï¼Œæ‰€ä»¥Indexéœ€è¦ä¸¤ä½ã€‚åœ¨æŸ¥TLBçš„æ—¶å€™ï¼Œç°æ ¹æ®TLBI å»æŸ¥å¯¹åº”çš„è¡Œæ•°ï¼Œå†æ ¹æ®TLBT å€¼æ¯”å¯¹ è¯¥è¡Œä¸­çš„Tagä¸­ã€‚å¦‚æœå­˜åœ¨å¯¹åº”çš„Tagå€¼ï¼Œå¹¶ä¸”Validæœ‰æ•ˆï¼Œåˆ™è¡¨æ˜å‘½ä¸­TLBï¼Œå¯ä»¥ç›´æ¥è¿”å›å¯¹åº”çš„PPNï¼ˆç‰©ç†é¡µæ¡†å·ï¼‰</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206152259858.jpg" alt="TLBå¿«è¡¨æŸ¥è¯¢" /></p><hr /><p>ä¸‹å›¾æ¼”ç¤ºäº†è™šæ‹Ÿåœ°å€0x9fd28c10çš„åœ°å€æ˜ å°„è¿‡ç¨‹ï¼Œå¦å¤–ä¸¤ä¸ªåœ°å€çš„æ˜ å°„è¿‡ç¨‹ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206160938113.png" alt="åœ°å€æ˜ å°„è¿‡ç¨‹" /></p><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://blog.csdn.net/weixin_44225940/article/details/105266677">ã€å†…å­˜ç®¡ç†ã€‘é¡µå¼&amp;æ®µå¼&amp;æ®µé¡µå¼&amp;ä¼˜ç¼ºç‚¹</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://wenku.baidu.com/view/abc85e4fdeccda38376baf1ffc4ffe473268fd4a.html">æ®µå¼å­˜å‚¨ç®¡ç†</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://blog.csdn.net/xiaotai1234/article/details/107427547">ä¸ºä»€ä¹ˆåˆ†é¡µå­˜å‚¨çš„åœ°å€ç©ºé—´æ˜¯ä¸€ç»´çš„ï¼Œè€Œåˆ†æ®µå­˜å‚¨çš„åœ°å€æ˜¯äºŒç»´çš„</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://www.icode9.com/content-3-1164794.html">å†…å­˜ç®¡ç†</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>æ“ä½œç³»ç»Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å†…å­˜ç®¡ç†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BFSç®—æ³•ä¸ä¸€æ¬¡è¸©å‘è®°å½•</title>
    <link href="/2022/06/03/2022-06/2022-06-03%20BFS%E7%AE%97%E6%B3%95%E4%B8%8E%E4%B8%80%E6%AC%A1%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/"/>
    <url>/2022/06/03/2022-06/2022-06-03%20BFS%E7%AE%97%E6%B3%95%E4%B8%8E%E4%B8%80%E6%AC%A1%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>æœ€è¿‘åœ¨ç»ƒä¹ BFSç®—æ³•ï¼Œåœ¨leecodeä¸Šåˆ·åˆ°è¿™æ ·ä¸€é“é¢˜ <a href="https://leetcode.cn/problems/open-the-lock/">752. æ‰“å¼€è½¬ç›˜é” - åŠ›æ‰£ï¼ˆLeetCodeï¼‰</a>ï¼Œå…¶å®é¢˜ç›®æœ¬èº«çš„è§£æ³•æ€è·¯è¿˜æ˜¯å¾ˆæ¸…æ™°çš„ï¼Œä½†æ˜¯æ²¡æœ‰æ³¨é‡å¥½ç»†èŠ‚ï¼Œå¯¼è‡´è¸©äº†ä¸ªå‘ï¼Œåœ¨debugæ’æŸ¥æ—¶æ›´æ˜¯é‡åˆ°äº†å‡ºä¹æ„æ–™çš„é”™è¯¯ï¼Œæ‰€ä»¥å†™ä¸‹è¿™ç¯‡æ–‡ç« å¸å–æ•™è®­ã€‚</p><h1 id="è§£é¢˜æ€è·¯"><a class="markdownIt-Anchor" href="#è§£é¢˜æ€è·¯"></a> è§£é¢˜æ€è·¯</h1><p>é¢˜ç›®å¤§æ„å°±æ˜¯ç»™å®šå›ºå®šé•¿åº¦ä¸º4çš„å­—ç¬¦ä¸²&quot;0000&quot;ï¼Œæ¯æ¬¡åªèƒ½æ”¹å˜å…¶ä¸­ä¸€ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”ä¸€æ¬¡åªèƒ½åŠ 1æˆ–è€…å‡1ï¼ˆæ¯”å¦‚ â€˜0â€™ -&gt;â€˜9â€™ æˆ– â€˜9â€™-&gt;â€˜0â€™ï¼‰ï¼Œå¹¶ä¸”ç»™å‡ºä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ <code>deadends</code>ï¼Œæ”¹å˜ä¹‹åçš„å­—ç¬¦ä¸²ä¸èƒ½å†</p><p><code>deadends</code>æ•°ç»„ä¸­ï¼Œé—®æœ€å°‘éœ€è¦å¤šå°‘æ¬¡æ”¹å˜èƒ½å˜æˆç›®æ ‡å­—ç¬¦ä¸²<code>target</code>ã€‚</p><p>è§£é¢˜æ€è·¯çš„è¯å°±æ˜¯BFSæœç´¢ï¼ŒæŠŠæ¯ä¸ªå­—ç¬¦ä¸²çœ‹åšä¸€ä¸ªèŠ‚ç‚¹/çŠ¶æ€ï¼Œæ¯æ¬¡æ”¹å˜ä¹‹åå˜æˆä¸€ä¸ªæ–°çš„èŠ‚ç‚¹/çŠ¶æ€ï¼Œè€Œä»ä¸€ä¸ªçŠ¶æ€è½¬å˜ä¸ºå¦ä¸€ä¸ªçŠ¶æ€ï¼Œæœ‰ 4 * 2 ä¸ªé€‰æ‹©ï¼ˆ4ä½ç½®ï¼Œ2ç§å˜æ³•ï¼‰ï¼Œç„¶ååˆ¤æ–­è¯¥çŠ¶æ€æ˜¯å¦ä¸ºæœ€ç»ˆç›®æ ‡çŠ¶æ€ï¼Œä½¿ç”¨BFSæœç´¢å°±å¯ä»¥æ±‚å¾—æœ€å°‘æ¬¡æ•°çš„è½¬å˜ã€‚ä¸‹é¢ç»™å‡ºå…·ä½“å®ç°ä»£ç ã€‚</p><h2 id="æ™®é€šbfsæœç´¢ç‰ˆæœ¬1"><a class="markdownIt-Anchor" href="#æ™®é€šbfsæœç´¢ç‰ˆæœ¬1"></a> æ™®é€šBFSæœç´¢ç‰ˆæœ¬1</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">openLock</span><span class="hljs-params">(vector&lt;string&gt;&amp; deadends, string target)</span> </span>&#123;<br>    unordered_set&lt;string&gt; s;<br>    <span class="hljs-keyword">for</span> (string&amp; str : deadends) &#123;<br>        s.<span class="hljs-built_in">insert</span>(str);<br>    &#125;<br>    string start = <span class="hljs-string">&quot;0000&quot;</span>;<br>    <span class="hljs-keyword">if</span> (s.<span class="hljs-built_in">count</span>(start) &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-keyword">int</span> ans = <span class="hljs-number">0</span>;<br>    queue&lt;string&gt; q;<br>    q.<span class="hljs-built_in">push</span>(start);<br>    s.<span class="hljs-built_in">insert</span>(start);<br>    <span class="hljs-keyword">while</span> (!q.<span class="hljs-built_in">empty</span>()) &#123;<br>        <span class="hljs-keyword">int</span> size = q.<span class="hljs-built_in">size</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i &lt; size; i++) &#123;<br>            start = q.<span class="hljs-built_in">front</span>();<br>            q.<span class="hljs-built_in">pop</span>();<br>            <span class="hljs-keyword">if</span> (start == target) &#123;<br>                <span class="hljs-keyword">return</span> ans;<br>            &#125;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">4</span>;j++) &#123;<br>                string next = start;<br>                next[j] = (start[j] - <span class="hljs-string">&#x27;0&#x27;</span> + <span class="hljs-number">1</span>) % <span class="hljs-number">10</span> + <span class="hljs-string">&#x27;0&#x27;</span>;<br>                <span class="hljs-keyword">if</span> (s.<span class="hljs-built_in">count</span>(next) == <span class="hljs-number">0</span>) &#123;<br>                    s.<span class="hljs-built_in">insert</span>(next);<br>                    q.<span class="hljs-built_in">push</span>(next);<br>                &#125;<br>                next[j] = (start[j] - <span class="hljs-string">&#x27;0&#x27;</span> + <span class="hljs-number">9</span>) % <span class="hljs-number">10</span> + <span class="hljs-string">&#x27;0&#x27;</span>;<br>                <span class="hljs-keyword">if</span> (s.<span class="hljs-built_in">count</span>(next) == <span class="hljs-number">0</span>) &#123;<br>                    s.<span class="hljs-built_in">insert</span>(next);<br>                    q.<span class="hljs-built_in">push</span>(next);<br>                &#125;<br>            &#125;<br>        &#125;<br>        ans++;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ™®é€šbfsæœç´¢ç‰ˆæœ¬2"><a class="markdownIt-Anchor" href="#æ™®é€šbfsæœç´¢ç‰ˆæœ¬2"></a> æ™®é€šBFSæœç´¢ç‰ˆæœ¬2</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">openLock</span><span class="hljs-params">(vector&lt;string&gt;&amp; deadends, string target)</span> </span>&#123;<br>    unordered_set&lt;string&gt; s;<br>    <span class="hljs-keyword">for</span> (string&amp; str : deadends) &#123;<br>        s.<span class="hljs-built_in">insert</span>(str);<br>    &#125;<br>    string start = <span class="hljs-string">&quot;0000&quot;</span>;<br>    <span class="hljs-keyword">if</span> (s.<span class="hljs-built_in">count</span>(start) &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-keyword">int</span> ans = <span class="hljs-number">0</span>;<br>    queue&lt;string&gt; q;<br>    q.<span class="hljs-built_in">push</span>(start);<br>    <span class="hljs-keyword">while</span> (!q.<span class="hljs-built_in">empty</span>()) &#123;<br>        <span class="hljs-keyword">int</span> size = q.<span class="hljs-built_in">size</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i &lt; size; i++) &#123;<br>            start = q.<span class="hljs-built_in">front</span>();<br>            q.<span class="hljs-built_in">pop</span>();<br>            <span class="hljs-keyword">if</span> (start == target) &#123;<br>                <span class="hljs-keyword">return</span> ans;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (s.<span class="hljs-built_in">count</span>(start) &gt; <span class="hljs-number">0</span> ) &#123;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            s.<span class="hljs-built_in">insert</span>(start);<br>            <br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">4</span>;j++) &#123;<br>                string next = start;<br>                next[j] = (start[j] - <span class="hljs-string">&#x27;0&#x27;</span> + <span class="hljs-number">1</span>) % <span class="hljs-number">10</span> + <span class="hljs-string">&#x27;0&#x27;</span>;<br>                <span class="hljs-keyword">if</span> (s.<span class="hljs-built_in">count</span>(next) == <span class="hljs-number">0</span>) &#123;<br>                    q.<span class="hljs-built_in">push</span>(next);<br>                &#125;<br>                next[j] = (start[j] - <span class="hljs-string">&#x27;0&#x27;</span> + <span class="hljs-number">9</span>) % <span class="hljs-number">10</span> + <span class="hljs-string">&#x27;0&#x27;</span>;<br>                <span class="hljs-keyword">if</span> (s.<span class="hljs-built_in">count</span>(next) == <span class="hljs-number">0</span>) &#123;<br>                    q.<span class="hljs-built_in">push</span>(next);<br>                &#125;<br>            &#125;<br>        &#125;<br>        ans++;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="bfsæœç´¢å®ç°æ¯”è¾ƒ"><a class="markdownIt-Anchor" href="#bfsæœç´¢å®ç°æ¯”è¾ƒ"></a> BFSæœç´¢å®ç°æ¯”è¾ƒ</h2><center class="third">    <img src="https://kwaj2xdt3y.feishu.cn/space/api/box/stream/download/asynccode/?code=ZGY4N2UwYWZkNGZiNjU5ODFjYzE2YjRhMTI1ZmU4NWRfZkExdjlBWm5ISE9ST25EZHd1UEc0enI1c0hwZkRSbjdfVG9rZW46Ym94Y25YVDFLcjVCNFVRVmoxbElZZDc0am1oXzE2NTQyNjEwMTc6MTY1NDI2NDYxN19WNA" width=300>    <img src="https://kwaj2xdt3y.feishu.cn/space/api/box/stream/download/asynccode/?code=N2U2YWZiNmQ2OTFhNjhhYTg0MmNmNjlmN2VkNjljYThfcXF1VkhyOW5NTDNyd1ZRVTNDV3E5aUh4VDRURE1BRGtfVG9rZW46Ym94Y25YOVMyQXZrZ1Q3YmFCcDJycVNkQWRnXzE2NTQyNjEwMTc6MTY1NDI2NDYxN19WNA" width=300></center><p>ä¸‹é¢æ¥åˆ†æä¸‹ä¸Šè¿°ä¸¤ä¸ªç‰ˆæœ¬å®ç°çš„åŒºåˆ«ã€‚å·¦å›¾æ˜¯ç‰ˆæœ¬1çš„å†™æ³•ï¼Œå³å›¾æ˜¯ç‰ˆæœ¬2çš„å†™æ³•ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°ä¸¤è€…çš„åŒºåˆ«åœ¨äº s é›†åˆï¼ˆä¹Ÿå°±æ˜¯å·²è®¿é—®èŠ‚ç‚¹çš„é›†åˆï¼‰æ’å…¥çš„ä½ç½®æˆ–è€…è¯´æ—¶æœºä¸åŒã€‚ï¼ˆå¯¹äºç‰ˆæœ¬1æ¥è¯´ï¼Œè¿˜éœ€è¦åœ¨è¿›å…¥é˜Ÿåˆ—å¾ªç¯å‰æŠŠèµ·å§‹èŠ‚ç‚¹åŠ å…¥åˆ°è®¿é—®é›†åˆä¸­ï¼‰</p><p>å·¦å›¾çš„åšæ³•æ˜¯æ”¾å…¥é˜Ÿåˆ—çš„åŒæ—¶å°±æ’å…¥é›†åˆï¼Œè®¤ä¸ºè¯¥èŠ‚ç‚¹å·²è®¿é—®ï¼Œæ‰€ä»¥åœ¨å¤–å±‚å¾ªç¯çœŸæ­£å–å‡ºçš„æ—¶å€™ä¸ç”¨å†è¿›è¡Œåˆ¤æ–­å’Œæ’å…¥ï¼›è€Œå³å›¾çš„åšæ³•æ˜¯å½“èŠ‚ç‚¹ä»é˜Ÿåˆ—ä¸­å–å‡ºçš„æ—¶å€™ï¼Œæ‰è®¤ä¸ºè¯¥èŠ‚ç‚¹è¢«è®¿é—®å†è¿›è¡Œæ’å…¥ï¼Œé‚£ä¹ˆæ­¤æ—¶æ’å…¥é›†åˆå‰åˆ¤æ–­è¯¥èŠ‚ç‚¹æ­¤å‰ä»¥æ˜¯å¦å·²ç»è®¿é—®çš„ if è¯­å¥å°±æ˜¯å¿…é¡»çš„ã€‚å› ä¸ºæŠŠèŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ—çš„æ—¶å€™æ²¡æœ‰è¿›è¡Œåˆ¤æ–­å»é‡ï¼Œé‚£ä¹ˆåœ¨åŒä¸€å±‚level ä¸Šï¼Œæ˜¯ä¼šå­˜åœ¨ä¸¤ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€ç›¸åŒçš„æƒ…å†µï¼Œæ¯”å¦‚(0000-&gt;1000-&gt;2000-&gt;3000-&gt;4000-&gt;5000 ï¼Œ ä¸ 0000-&gt;9000-&gt;8000-&gt;7000-&gt;6000-&gt;5000 è¿™ä¸¤æ¡è·¯å¾„çš„é•¿åº¦éƒ½æ˜¯5ï¼Œæ‰€ä»¥æœ€ç»ˆèŠ‚ç‚¹ä¼šåœ¨åŒä¸€å±‚ä¸Šï¼Œä¹Ÿéƒ½ä¼šè¢«åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚<strong>å¦‚æœä»é˜Ÿåˆ—ä¸­å–å‡ºçš„æ—¶å€™ä¸è¿›è¡Œåˆ¤æ–­æ˜¯å¦å·²ç»è®¿é—®ï¼Œé‚£ä¹ˆå°±ä¼šå»é‡å¤æœç´¢è¿™ä¸¤ä¸ªç›¸åŒèŠ‚ç‚¹çš„è·¯å¾„ï¼Œå¯¼è‡´è€—æ—¶æŒ‡æ•°å¢åŠ ï¼Œè€Œè¿™éƒ¨åˆ†æœç´¢æœ¬è¯¥æ˜¯éœ€è¦è¢«å‰ªæçš„ã€‚</strong></p><p>è€Œæˆ‘å½“æ—¶å°±æ˜¯æ²¡æœ‰æƒ³æ¸…æ¥šè¿™é‡Œçš„é€»è¾‘ï¼Œä¸€å¤´æ ½è¿›è¿™ä¸ªå‘é‡Œï¼Œä¹Ÿæ‰æœ‰äº†è¿™ç¯‡æ–‡ç« ï¼ˆdogeï¼‰ã€‚</p><h2 id="åŒå‘bfsä¼˜åŒ–"><a class="markdownIt-Anchor" href="#åŒå‘bfsä¼˜åŒ–"></a> åŒå‘BFSä¼˜åŒ–</h2><p>è¿™é‡Œå†æä¸€ä¸‹BFSè¿˜æœ‰ä¸€ä¸ªé«˜çº§çš„ä¼˜åŒ–æ–¹æ³•ï¼šåŒå‘BFSã€‚å‚è€ƒ <a href="https://labuladong.gitee.io/algo/1/7/">BFS ç®—æ³•è§£é¢˜å¥—è·¯æ¡†æ¶ :: labuladongçš„ç®—æ³•å°æŠ„</a><sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="BFS ç®—æ³•è§£é¢˜å¥—è·¯æ¡†æ¶ :: labuladongçš„ç®—æ³•å°æŠ„">[1]</span></a></sup>ã€‚</p><p>ä¼ ç»Ÿçš„ BFS æ¡†æ¶å°±æ˜¯ä»èµ·ç‚¹å¼€å§‹å‘å››å‘¨æ‰©æ•£ï¼Œé‡åˆ°ç»ˆç‚¹æ—¶åœæ­¢ï¼›è€ŒåŒå‘ BFS åˆ™æ˜¯ä»èµ·ç‚¹å’Œç»ˆç‚¹åŒæ—¶å¼€å§‹æ‰©æ•£ï¼Œå½“ä¸¤è¾¹æœ‰äº¤é›†çš„æ—¶å€™åœæ­¢ã€‚</p><p>ä»æ—¶é—´å¤æ‚åº¦åˆ†æçš„è¯ï¼Œè™½ç„¶åŒå‘BFSä¼šæœ‰ä¸€å®šçš„ä¼˜åŒ–ï¼Œä½†å’Œæ™®é€šBFSä¸€æ ·ï¼Œå…¶æœ€åå¤æ‚åº¦éƒ½æ˜¯ <code>O(N)</code>ã€‚å¹¶ä¸”åŒå‘ BFS ä¹Ÿæœ‰å±€é™ï¼Œé‚£å°±æ˜¯ä½ å¿…é¡»è¦çŸ¥é“æœ€ç»ˆçš„èŠ‚ç‚¹ä½ç½®æˆ–è€…è¯´æœ€ç»ˆçš„çŠ¶æ€æ˜¯æ€æ ·çš„ã€‚</p><p>ä¸‹é¢ç»™å‡ºäº†ä½¿ç”¨åŒå‘BFSçš„å®ç°ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// åŒå‘BFS</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">openLock</span><span class="hljs-params">(vector&lt;string&gt;&amp; deadends, string target)</span> </span>&#123;<br>    unordered_set&lt;string&gt; visited;<br>    <span class="hljs-keyword">for</span> (string&amp; str : deadends) &#123;<br>        visited.<span class="hljs-built_in">insert</span>(str);<br>    &#125;<br>    unordered_set&lt;string&gt; start;<br>    unordered_set&lt;string&gt; end;<br>    start.<span class="hljs-built_in">insert</span>(<span class="hljs-string">&quot;0000&quot;</span>);<br>    end.<span class="hljs-built_in">insert</span>(target);<br>    <span class="hljs-keyword">if</span> (visited.<span class="hljs-built_in">count</span>(<span class="hljs-string">&quot;0000&quot;</span>) &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-keyword">int</span> ans = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">while</span> (!start.<span class="hljs-built_in">empty</span>() &amp;&amp; !end.<span class="hljs-built_in">empty</span>()) &#123;<br>        unordered_set&lt;string&gt; next_level;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> string&amp; str : start) &#123;<br>            <span class="hljs-keyword">if</span> (end.<span class="hljs-built_in">count</span>(str) &gt; <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">return</span> ans;<br>            &#125;<br>            <span class="hljs-keyword">if</span> (visited.<span class="hljs-built_in">count</span>(str) &gt; <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            visited.<span class="hljs-built_in">insert</span>(str);<br>            <br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">4</span>;j++) &#123;<br>                string next = str;<br>                next[j] = (str[j] - <span class="hljs-string">&#x27;0&#x27;</span> + <span class="hljs-number">1</span>) % <span class="hljs-number">10</span> + <span class="hljs-string">&#x27;0&#x27;</span>;<br>                <span class="hljs-keyword">if</span> (visited.<span class="hljs-built_in">count</span>(next) == <span class="hljs-number">0</span>) &#123;<br>                    next_level.<span class="hljs-built_in">insert</span>(next);<br>                &#125;<br>                next[j] = (str[j] - <span class="hljs-string">&#x27;0&#x27;</span> + <span class="hljs-number">9</span>) % <span class="hljs-number">10</span> + <span class="hljs-string">&#x27;0&#x27;</span>;<br>                <span class="hljs-keyword">if</span> (visited.<span class="hljs-built_in">count</span>(next) == <span class="hljs-number">0</span>) &#123;<br>                    next_level.<span class="hljs-built_in">insert</span>(next);<br>                &#125;<br>            &#125;<br>        &#125;<br>        ans++;<br>        start = end;<br>        end = next_level;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="è¸©å‘è®°å½•"><a class="markdownIt-Anchor" href="#è¸©å‘è®°å½•"></a> è¸©å‘è®°å½•</h1><p>æ¥ä¸‹æ¥å†å…·ä½“è°ˆè°ˆæˆ‘è¸©çš„å‘å§ï¼Œä¸Šæ–‡æåˆ°äº†ä¸¤ä¸ªæ™®é€šBFSæœç´¢å®ç°çš„åŒºåˆ«ï¼Œè€Œæˆ‘å½“æ—¶é‡‡ç”¨çš„å°±æ˜¯ç‰ˆæœ¬2çš„å†™æ³•ï¼Œå¹¶ä¸”æ²¡æœ‰å†™åˆ¤æ–­æ˜¯å¦å·²è®¿é—®çš„é€»è¾‘ï¼Œå› æ­¤é€ æˆç»“æœä¸ç¬¦åˆé¢„æœŸã€‚æ‰€ä»¥æˆ‘ä½¿ç”¨CLionè¿›è¡Œdebugæ’æŸ¥ï¼Œä½†æ˜¯åœ¨debugè¿‡ç¨‹ï¼Œé‡åˆ°äº†ä¸‹é¢è¿™ä¸ªç¦»å¥‡çš„ç°è±¡ã€‚</p><p><img src="https://kwaj2xdt3y.feishu.cn/space/api/box/stream/download/asynccode/?code=YzE1MWRmMjQ5NTZhOTJkZWU2ZGVlYThlZjc4ZWE4YzBfV1JBZ2ZMTm1wMUpwUkp4cGo2OGhBT1ZNeWgzdWhBQ1RfVG9rZW46Ym94Y25MN2hnM0Y2ZWpXQUh3OVppc1p4WEZnXzE2NTQyNjEwMTc6MTY1NDI2NDYxN19WNA" alt="" /></p><p><img src="https://kwaj2xdt3y.feishu.cn/space/api/box/stream/download/asynccode/?code=YWFjMzJmMjBkMzc5YTc0NGM4NWJlZDkyYWRkMTBiZTZfbld0bEdSbGhZTWtBZFJkZUJ6dVRUV0c5NkxWanJ3WFVfVG9rZW46Ym94Y25FclhJS21jZXFQUG1uTEF0QnZvUnllXzE2NTQyNjEwMTc6MTY1NDI2NDYxN19WNA" alt="" /></p><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨debugæ¨¡å¼ä¸‹ï¼Œæ˜æ˜é˜Ÿåˆ—<code>q</code>é‡Œå·²ç»æ²¡æœ‰å…ƒç´ äº†ï¼Œæ˜¾ç¤ºçš„<code>q.size</code>ä¹Ÿä¸º0ï¼Œ ä½†æ˜¯èµ‹å€¼å¾—åˆ°çš„ <code>size</code> å´ä¸ä¸º0ã€‚å½“æ—¶çœŸçš„æ˜¯ç™¾æ€ä¸å¾—å…¶è§£ï¼Œæ•´ä¸ªäººæœ‰ç‚¹å°æ‡µï¼Œç„¶ååŠ å„ç§æ‰“ç‚¹å»çœ‹ï¼Œä½†å‘ç°æ˜æ˜é˜Ÿåˆ—é‡Œå°±æ˜¯æœ‰å€¼ï¼Œå¯æ˜¾ç¤ºçš„å´æ˜¯0ã€‚å› ä¸ºæˆ‘å½“æ—¶è¿˜æ˜¯è®¤ä¸ºç¨‹åºé€»è¾‘æ²¡æœ‰é”™ï¼Œè®¤ä¸ºè¿™é‡Œé˜Ÿåˆ—å°±åº”è¯¥æ˜¯ç©ºï¼Œæ‰€ä»¥ä¸€ç›´è®¤ä¸ºæ˜¯ä¸æ˜¯å…¶ä»–å“ªé‡Œæœ‰é—®é¢˜ã€‚</p><p>ç›´åˆ°åæ¥æ— è®¡å¯æ–½äº†ï¼Œæˆ‘æ‰å¼€å§‹é‡æ–°æ¢³ç†é€»è¾‘ï¼Œç¡®å®šé€»è¾‘ä¸Šè¿™é‡Œçš„é˜Ÿåˆ—æ˜¯å¦æœ‰å€¼ï¼Œç„¶åå°±å‘ç°æ˜¯ä»£ç é€»è¾‘æœ¬èº«æœ‰é—®é¢˜ã€‚è¿™æ ·ä¸€æ¥ï¼Œé—®é¢˜å°±æ˜æœ—è®¸å¤šäº†ï¼Œå¼€å§‹è€ƒè™‘æ˜¯ä¸æ˜¯ç¼–è¯‘å™¨æˆ–è€…è°ƒè¯•å·¥å…·çš„é—®é¢˜ã€‚</p><p>åæ¥å‘ç°çš„ç¡®æ˜¯ç¼–è¯‘å™¨æ˜¾ç¤ºçš„é—®é¢˜ï¼Œåœ¨CLioné‡Œï¼Œå½“é˜Ÿåˆ—é‡Œçš„å…ƒç´ ä¸ªæ•°è¶…è¿‡255æ—¶ï¼Œåªä¼šæ˜¾ç¤º255æˆ–è€…ä¸º0ï¼Œåœ¨vscodeé‡Œè¿›è¡Œæµ‹è¯•æ—¶ä¹ŸåŒæ ·æœ‰è¿™ä¸ªé—®é¢˜ã€‚ä¸è¿‡vscodeå¥½åƒæ˜¯ä¼šä¸€ç›´ä¿æŒsize=255ã€‚</p><p><img src="https://kwaj2xdt3y.feishu.cn/space/api/box/stream/download/asynccode/?code=M2NhZTIxZDJhZjY4MTNjNDFmZTE4NDQ3ZGUyYTA2ZDRfS0JoUHZ6M3lqY1poaUVzNnMzOWhsaFVPQzg1Qm9lRGNfVG9rZW46Ym94Y25BMVV2S3NUREM1eFJKNml5M3FmUUNmXzE2NTQyNjEwMTc6MTY1NDI2NDYxN19WNA" alt="CLionè°ƒè¯•1" /></p><p><img src="https://kwaj2xdt3y.feishu.cn/space/api/box/stream/download/asynccode/?code=Y2UzZTU3NDdmNTIxYTg2OWRmZjhkYjMyYzgzYTI3YzhfUXJWU2xRSENPU0tzQXRuakRJWTVqWFlUNFdhZEp5cVlfVG9rZW46Ym94Y25jbWJOeHY5NDNsSVRNRFI3N3hHdFlmXzE2NTQyNjEwMTc6MTY1NDI2NDYxN19WNA" alt="CLionè°ƒè¯•2" /></p><p><img src="https://kwaj2xdt3y.feishu.cn/space/api/box/stream/download/asynccode/?code=YjA3ZGMzYjE4YzcwY2Y1MTI0YzJiZTJiMDFmZDA3NmJfRXNGQ0J5d0JmNmt3cGRBWXhQUjMyUlVqRjR1a0o1TVNfVG9rZW46Ym94Y25xaVJuQlRsRnpVWmdLVktZV21JalNjXzE2NTQyNjEwMTc6MTY1NDI2NDYxN19WNA" alt="CLionè°ƒè¯•3" /></p><p><img src="https://kwaj2xdt3y.feishu.cn/space/api/box/stream/download/asynccode/?code=OTIyMjgyMWFlZGYzOWVmNmE1MDhmYmFjYmY5MGUxMzlfSVZjV2lHOG1wcVNCUHlXM2xFVHBwemFuY3BYUkRDcVVfVG9rZW46Ym94Y245N0prQktxRVQ4QURRUDh4ajRaZDRmXzE2NTQyNjEwMTc6MTY1NDI2NDYxN19WNA" alt="VsCodeè°ƒè¯•1" /></p><p><img src="https://kwaj2xdt3y.feishu.cn/space/api/box/stream/download/asynccode/?code=ZjY5YjMxODQ1MzAwOTQ1M2M4MzljNDFlMmNmOTU5NTVfQVRKZXNJcEVueTRrYWkyRzd6M3hOaTFZYjhpV0xaaUZfVG9rZW46Ym94Y25NSUJhbjVBRTdybHVGUTBKV2R1NEdlXzE2NTQyNjEwMTc6MTY1NDI2NDYxN19WNA" alt="VsCodeè°ƒè¯•2" /></p><p>ä¹‹ååˆåœ¨CLionä¸Šæµ‹è¯•äº†vectorï¼Œlistï¼Œsetï¼Œdequeï¼Œstackï¼Œmapï¼Œå‘ç°åªæœ‰dequeã€queueã€stackä¼šå‡ºç°æ˜¾ç¤ºçš„sizeå’ŒçœŸå®sizeä¸ä¸€è‡´çš„æƒ…å†µï¼Œä¸éš¾çŒœæƒ³æ ¹æºåœ¨äºdequeï¼Œå› ä¸ºqueueå’Œstackåº•å±‚é»˜è®¤é‡‡ç”¨dequeå®ç°ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µå‘¢ï¼Ÿç¨‹åºé€»è¾‘æ˜¯æ­£å¸¸çš„ï¼Œé‚£ä¹ˆåªå¯èƒ½æ˜¯IDEæ˜¾ç¤ºæˆ–è€…è°ƒè¯•å·¥å…·çš„é—®é¢˜äº†ï¼Œæˆ–è®¸æ˜¯å› ä¸ºdequeåº•å±‚æ•°æ®ç»“æ„æ¯”è¾ƒå¤æ‚ï¼Œå½“å…ƒç´ æ•°é‡å¤§èµ·æ¥ä¹‹åï¼Œè°ƒè¯•å·¥å…·éš¾ä»¥è¿½è¸ªå¯¼è‡´æ˜¾ç¤ºä¸ä¸€è‡´å§ã€‚</p><p>åœ¨stackoverflowä¸Šä¹Ÿæ‰¾åˆ°ä¸€ä¸ªç±»ä¼¼çš„é—®é¢˜ï¼Œè·ŸçŒœæƒ³å¤§ä½“ä¸€è‡´ï¼š<a href="https://stackoverflow.com/questions/53972627/deque-not-growing-larger-than-255-elements">https://stackoverflow.com/questions/53972627/deque-not-growing-larger-than-255-elements</a> <sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="https://stackoverflow.com/questions/53972627/deque-not-growing-larger-than-255-elements">[2]</span></a></sup></p><h1 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h1><p>æ€»çš„æ¥è¯´ï¼Œè¿™æ¬¡è¸©å‘çš„æ•™è®­å°±æ˜¯ï¼Œä¸€å®šè¦å…ˆä»”ç»†ã€æ…é‡åœ°æ€è€ƒå¥½ä»£ç é€»è¾‘ï¼Œè®¤ä¸ºå®åœ¨çœ‹ä¸å‡ºé—®é¢˜æ¥äº†å†å»debugè°ƒè¯•ï¼ˆå¥½åƒè¯´äº†å¥åºŸè¯ã€‚ã€‚ã€‚ï¼‰ï¼Œå¤§æ„å°±æ˜¯ä¸è¦å¤ªä¾é è°ƒè¯•å·¥å…·ï¼Œæˆ–è€…è¯´å…ˆæŠŠä¸€äº›åŸºæœ¬é€»è¾‘ç†æ¸…ï¼Œç¡®å®šä¸€äº›å‰ææ¡ä»¶åå†å»æ’æŸ¥é—®é¢˜ï¼Œä¼šæ›´æœ‰æ•ˆç‡ï¼Œå°±æ¯”å¦‚è¿™æ¬¡å¦‚æœæˆ‘èƒ½ç†æ¸…é€»è¾‘çš„è¯ï¼Œèƒ½ç¡®å®šé˜Ÿåˆ—å¤§å°çš„sizeä¸ä¸º0ï¼Œé‚£å°±èƒ½æ›´å¿«åœ°è¿›è¡Œæ’æŸ¥æµ‹è¯•ï¼Œè€Œä¸æ˜¯åœ¨å“ªé‡Œçº ç»“ï¼Œå¾€é”™è¯¯çš„æ–¹å‘ä¸Šæ€è€ƒäº†ã€‚</p><p>æ­£æ‰€è°“æ–¹å‘é”™äº†ï¼Œæ‰€åšçš„åŠªåŠ›éƒ½æ˜¯å¾’åŠ³ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206032117306.jpeg" alt="è‰ä¸Šé£2" /></p><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://labuladong.gitee.io/algo/1/7/">BFS ç®—æ³•è§£é¢˜å¥—è·¯æ¡†æ¶ :: labuladongçš„ç®—æ³•å°æŠ„</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://stackoverflow.com/questions/53972627/deque-not-growing-larger-than-255-elements">https://stackoverflow.com/questions/53972627/deque-not-growing-larger-than-255-elements</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>BFS</tag>
      
      <tag>CLion</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€STLæºç åˆ†æã€‘åºåˆ—å¼å®¹å™¨ä¹‹list</title>
    <link href="/2022/05/22/2022-05/2022-05-22%20%E3%80%90STL%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8%E4%B9%8Blist/"/>
    <url>/2022/05/22/2022-05/2022-05-22%20%E3%80%90STL%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8%E4%B9%8Blist/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>æœ¬æ–‡ä¸»è¦å†…å®¹å‚è€ƒï¼š<a href="https://mp.weixin.qq.com/s/NcrnwsB2gjq9h7W2hIZ6PQ">2 ä¸‡å­—+20 å›¾å¸¦ä½ æ‰‹æ’• STL åºåˆ—å¼å®¹å™¨æºç </a><sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="2 ä¸‡å­—+20 å›¾å¸¦ä½ æ‰‹æ’• STL åºåˆ—å¼å®¹å™¨æºç ">[1]</span></a></sup>ï¼ŒåŸæ–‡å†…å®¹éå¸¸è¯¦å°½å……å®ï¼Œå»ºè®®å¤§å®¶é˜…è¯»å­¦ä¹ ã€‚è€Œæœ¬æ–‡åˆ™æ˜¯æ‘˜å½•æ€»ç»“å…³é”®éƒ¨åˆ†ï¼Œé‡ç‚¹åˆ†ælistçš„æ•°æ®ç»“æ„å’Œå…³é”®å‡½æ•°å®ç°ã€‚</p><h1 id="listæ•°æ®ç»“æ„"><a class="markdownIt-Anchor" href="#listæ•°æ®ç»“æ„"></a> listæ•°æ®ç»“æ„</h1><p>é¦–å…ˆç®€å•æ¦‚æ‹¬ä¸€ä¸‹ï¼ŒSGI STLé‡Œlistçš„å®ç°æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œå¹¶å®šä¹‰äº†ä¸“å±çš„listè¿­ä»£å™¨ï¼Œæ¥å¯¹è®¿é—®listä¸­çš„èŠ‚ç‚¹ï¼Œè€Œlist_iteratorå…¶å®å°±æ˜¯list_nodeè¿›è¡Œäº†ä¸€äº›å°è£…ã€‚</p><p>ä¸‹é¢ç»™å‡ºlistå®ç°ç›¸å…³çš„ç±»å›¾ï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205241555886.jpeg" alt="ç±»å›¾" /></p><p>liståŒå‘é“¾è¡¨å®ç°å¤§è‡´å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œlistå«æœ‰ä¸€ä¸ª_List_node æŒ‡é’ˆï¼Œä»£è¡¨ç€ä¸€ä¸ªç©ºèŠ‚ç‚¹ï¼ˆendå‡½æ•°è¿”å›è¯¥ä½ç½®çš„è¿­ä»£å™¨ï¼‰ï¼Œå…¶nextæŒ‡å‘é“¾è¡¨ä¸­å®é™…çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆbegin å¯¹åº”çš„ä½ç½®ï¼‰ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205241555207.png" alt="liståŒå‘é“¾è¡¨" /></p><h1 id="listå…³é”®å‡½æ•°å®ç°"><a class="markdownIt-Anchor" href="#listå…³é”®å‡½æ•°å®ç°"></a> listå…³é”®å‡½æ•°å®ç°</h1><ul><li><code>begin</code> ï¼šè¿”å›ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„è¿­ä»£å™¨ã€‚</li><li><code>end</code>ï¼šè¿”å›ç©ºå…ƒç´ èŠ‚ç‚¹çš„è¿­ä»£å™¨ã€‚</li><li><code>insert</code>ï¼š å°†æŸä¸€ä¸ªå…ƒç´ æ’å…¥åˆ°é“¾è¡¨çš„ä¸€ä¸ªä½ç½®ä¸Šï¼Œæœ‰å¤šç»„é‡è½½ï¼Œå…·ä½“å®ç°æ¥è¯´å°±æ˜¯è°ƒæ•´ç›¸å…³æŒ‡é’ˆçš„å€¼ã€‚</li><li><code>push_back</code>ï¼šè°ƒç”¨insertï¼Œåœ¨end( ) ä½ç½®ä¸Šæ’å…¥å…ƒç´ ã€‚</li><li><code>push_front</code>ï¼šè°ƒç”¨insertï¼Œåœ¨begin( ) ä½ç½®ä¸Šæ’å…¥å…ƒç´ ã€‚</li><li><code>erase</code> ï¼šåˆ é™¤èŠ‚ç‚¹ï¼Œä¸»è¦ä¹Ÿæ˜¯è°ƒæ•´ç›¸å…³èŠ‚ç‚¹æŒ‡é’ˆçš„å€¼ï¼Œç„¶åå›æ”¶èŠ‚ç‚¹å†…å­˜å’ŒèŠ‚ç‚¹å…ƒç´ å€¼çš„å†…å­˜ã€‚</li><li><code>pop_back</code>ï¼šè°ƒç”¨eraseï¼Œåˆ é™¤end( ) å‰ä¸€ä¸ªä½ç½®ä¸Šçš„å…ƒç´ ã€‚</li><li><code>pop_front</code>ï¼šè°ƒç”¨eraseï¼Œåˆ é™¤begin( ) ä½ç½®ä¸Šçš„å…ƒç´ ã€‚</li><li><code>transfer(position, first, last)</code> ï¼šå‚æ•°ç±»å‹éƒ½æ˜¯listè¿­ä»£å™¨ï¼Œå‡½æ•°ä½œç”¨æ˜¯å°†[first, last) ä¸Šçš„å…ƒç´ <strong>ç§»åŠ¨</strong>åˆ° position ä½ç½®å‰ã€‚</li><li><code>splice</code>ï¼šæœ‰å¤šä¸ªé‡è½½ï¼Œæ‹¼æ¥å…ƒç´ æˆ–è€…æ˜¯é“¾è¡¨ï¼Œå®ç°ä¸Šæ˜¯å»è°ƒç”¨ transfer å‡½æ•°ã€‚</li><li><code>merge</code> ï¼š å°†ä¼ å…¥çš„ list é“¾è¡¨ x ä¸åŸé“¾è¡¨æŒ‰ä»å°åˆ°å¤§åˆå¹¶åˆ°åŸé“¾è¡¨ä¸­(å‰ææ˜¯ä¸¤ä¸ªé“¾è¡¨éƒ½æ˜¯å·²ç»ä»å°åˆ°å¤§æ’åºäº†)ã€‚mergeçš„å®ç°ä¹Ÿæ˜¯å»è°ƒç”¨ transfer å‡½æ•°ã€‚</li><li><code>reverse</code> ï¼š å®ç°å°†é“¾è¡¨ç¿»è½¬çš„åŠŸèƒ½ï¼Œå®ç°ä¸Šç®€å•æ¥è¯´å°±æ˜¯å°†æ¯ä¸ªèŠ‚ç‚¹çš„ prev ä¸ next å€¼äº’æ¢</li><li><code>operator=</code> èµ‹å€¼æ“ä½œï¼š éœ€è¦è€ƒè™‘ä¸¤ä¸ªé“¾è¡¨çš„å®é™…å¤§å°ä¸ä¸€æ ·æ—¶çš„æƒ…å†µã€‚å¦‚æœåŸé“¾è¡¨å¤§ ï¼Œå¤åˆ¶å®Œåè¦åˆ é™¤æ‰åŸé“¾è¡¨å¤šä½™çš„å…ƒç´ ï¼›å¦‚æœåŸé“¾è¡¨å° ï¼Œå¤åˆ¶å®Œåè¦è¿˜è¦å°†xé“¾è¡¨çš„å‰©ä½™å…ƒç´ ä»¥æ’å…¥çš„æ–¹å¼æ’å…¥åˆ°åŸé“¾è¡¨ä¸­ã€‚</li><li><code>resize</code><strong>ï¼š</strong> é‡æ–°ä¿®æ”¹ list çš„å¤§å°ï¼Œä¼ å…¥ä¸€ä¸ª new_sizeï¼Œå¦‚æœé“¾è¡¨æ—§é•¿åº¦å¤§äº new_size çš„å¤§å°, é‚£å°±åˆ é™¤åé¢å¤šä½™çš„èŠ‚ç‚¹ï¼Œå¦åˆ™æ’å…¥æ–°èŠ‚ç‚¹ã€‚</li><li><code>clear</code><strong>ï¼š</strong> æ¸…é™¤æ‰€æœ‰èŠ‚ç‚¹ï¼šéå†æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé”€æ¯(ææ„å¹¶é‡Šæ”¾)ä¸€ä¸ªèŠ‚ç‚¹ã€‚</li><li><code>remove</code> ï¼š æ¸…é™¤æŒ‡å®šå€¼çš„å…ƒç´ ï¼šéå†æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ‰¾åˆ°å°±ç§»é™¤ã€‚</li><li><code>unique</code> ï¼š æ¸…é™¤æ•°å€¼ç›¸åŒçš„è¿ç»­å…ƒç´ ï¼Œæ³¨æ„åªæœ‰â€œ<strong>è¿ç»­è€Œç›¸åŒçš„å…ƒç´ </strong>â€ï¼Œæ‰ä¼šè¢«ç§»é™¤å‰©ä¸€ä¸ªã€‚éå†æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœåœ¨æ­¤åŒºé—´æ®µæœ‰ç›¸åŒçš„å…ƒç´ å°±ç§»é™¤ä¹‹ã€‚</li></ul><hr /><p>ä¸‹é¢é‡ç‚¹ä»‹ç»ä¸‹listæ ¹æ®è‡ªèº«æ•°æ®ç»“æ„ç‰¹ç‚¹ï¼Œå®ç°çš„sortæˆå‘˜å‡½æ•°ã€‚</p><ul><li><strong>sort å‡½æ•°ï¼š</strong> list å®¹å™¨è‡ªèº«å®ç°ä¸€ä¸ªæ’åºï¼ˆå‡åºï¼‰ï¼Œ<strong>å…¶åŸºæœ¬ç®—æ³•æ€æƒ³è·Ÿå½’å¹¶æ’åºéå¸¸ç±»ä¼¼</strong>ï¼Œå¹¶å€ŸåŠ©<code>merge</code>å‡½æ•°æ¥æ’åºã€‚ç®€å•æ¥è¯´ï¼Œä½¿ç”¨ä¸€ä¸ªé“¾è¡¨æ•°ç»„æ¥å­˜å‚¨æ’åºèŠ‚ç‚¹ï¼Œæ¯ä¸ªä¸‹æ ‡ä¸º i çš„é“¾è¡¨å­˜å‚¨ 2^i çš„èŠ‚ç‚¹ï¼Œæ¯æ¬¡ä»åŸé“¾è¡¨ä¸­å–å‡ºä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œæ’åºï¼Œå¹¶ä¸”æ’åºèŠ‚ç‚¹çš„ä¸ªæ•°æŒ‰ 2^i æŒ‡æ•°é€’å¢ï¼Œæœ€ç»ˆå°†æ•°ç»„ä¸­çš„æ‰€æœ‰é“¾è¡¨è¿›è¡Œ<code>merge</code>åˆå¹¶ï¼Œä»è€Œå®ç°åŸé“¾è¡¨çš„æ’åºã€‚</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205241555270.png" alt="sortå‡½æ•°æºç " /></p><p>ä¸¾ä¸€ä¸ªç®€å•çš„å®ç°è¿‡ç¨‹æ¥å¸®åŠ©ç†è§£ï¼Œä¾‹å¦‚å¯¹äºé“¾è¡¨ å…ƒç´  { 7, 6, 5, 4, 3, 2, 1 }ï¼Œæ’åºè¿‡ç¨‹å¤§è‡´æè¿°å¦‚ä¸‹ï¼š</p><ol><li>ç¬¬1æ¬¡æ’åº (7)</li><li>ç¬¬2æ¬¡æ’åº (6)</li><li>ç¬¬3æ¬¡æ’åº (7)ã€(6) åˆå¹¶æ’åºæˆ (6ã€7)</li><li>ç¬¬4æ¬¡æ’åº (5)</li><li>ç¬¬5æ¬¡æ’åº (4)</li><li>ç¬¬6æ¬¡æ’åº (5)ã€(4) åˆå¹¶æ’åºæˆ (4ã€5)</li><li>ç¬¬7æ¬¡æ’åºï¼ˆ6ã€7ï¼‰ã€(4ã€5ï¼‰åˆå¹¶æ’åºæˆ ï¼ˆ4, 5, 6, 7ï¼‰</li><li>ç¬¬8æ¬¡æ’åº (3)</li><li>ç¬¬9æ¬¡æ’åº (2)</li><li>ç¬¬10æ¬¡æ’åº (3)ã€(2) åˆå¹¶æ’åºæˆ (2, 3)</li><li>ç¬¬11æ¬¡æ’åº (1)</li><li>æœ€ååˆå¹¶æ‰€æœ‰é“¾è¡¨ï¼Œå³ (1) ã€ï¼ˆ2,3) ã€ï¼ˆ4, 5, 6, 7) ä¾æ¬¡åˆå¹¶</li><li>ç¬¬12æ¬¡æ’åº (1) ã€ï¼ˆ2,3) åˆå¹¶æ’åºæˆ (1, 2, 3)</li><li>ç¬¬13æ¬¡æ’åº (1, 2, 3) ã€(4, 5, 6, 7) åˆå¹¶æ’åºæˆ (1, 2, 3, 4, 5, 6, 7)</li><li>å®Œæˆæ’åºï¼Œç»“æŸã€‚</li></ol><p>ä¸‹å›¾æ˜¯æ’åºè¿‡ç¨‹å®ç°çš„å›¾è§£ï¼Œå‚è€ƒäº† <a href="https://blog.csdn.net/qq_31720329/article/details/85535787">C++ STL LIST SORT æ’åºç®—æ³•å›¾è§£_zp0intçš„åšå®¢</a><sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="C++ STL LIST SORT æ’åºç®—æ³•å›¾è§£_zp0intçš„åšå®¢">[2]</span></a></sup>ã€‚</p><ul><li>æ³¨æ„å…¶ä¸­çš„listã€carryã€counter[i] éƒ½æ˜¯åŒå‘é“¾è¡¨ï¼Œå…¶å®éƒ½åŒ…å«æœ‰ä¸€ä¸ªdummyèŠ‚ç‚¹ï¼ˆä¹Ÿå°±æ˜¯end() ä½ç½®èŠ‚ç‚¹ï¼‰ï¼Œä½†æ˜¯ä¸ºäº†æ–¹ä¾¿ï¼Œè¿™é‡Œåªç”»å‡ºäº†å®é™…åŒ…å«çš„èŠ‚ç‚¹å€¼ã€‚</li><li>å›¾é‡Œæ‰€è¯´çš„whileå¾ªç¯æŒ‡çš„æ˜¯ç¬¬ä¸€å±‚ while å¾ªç¯ï¼Œæ¯æ¬¡å¾ªç¯éƒ½æ˜¯ä»listä¸­å–å‡ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œcarry ä½œä¸ºä¸­é—´è¿‡æ¸¡ï¼Œæ‰€ä»¥æ¯æ¬¡å¾ªç¯ç»“æŸålistèŠ‚ç‚¹æ•°å‡ä¸€ï¼Œcarry ä¸ºç©º</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205241556288.svg" alt="sortå‡½æ•°æ•´ä½“å®ç°è¿‡ç¨‹" /></p><p>ä¸Šå›¾æè¿°äº†æ•´ä½“çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œä¸‹å›¾åˆ™å…·ä½“æè¿°ç¬¬å››æ¬¡whileå¾ªç¯é‡Œçš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå…³æ³¨carry å’Œ counteré“¾è¡¨çš„äº¤äº’ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205241559080.jpeg" alt="ç¬¬å››æ¬¡whileå¾ªç¯å…·ä½“è¿‡ç¨‹" /></p><p>åœ¨leecodeä¸Šä¹Ÿæœ‰ä¸€é“ç®—æ³•é¢˜ <a href="https://leetcode.cn/problems/sort-list/">https://leetcode.cn/problems/sort-list/</a> ï¼Œæ°å¥½å°±æ˜¯è¦å¯¹ä¸€æ¡é“¾è¡¨å®ç°æ’åºï¼Œé™¤äº†è‡ªé¡¶å‘ä¸‹çš„å½’å¹¶æ’åºï¼Œå¤§å®¶ä¹Ÿå¯ä»¥å°è¯•ä½¿ç”¨ä¸Šè¿°çš„è¿™ç§ç±»å½’å¹¶æ’åºç®—æ³•è¿›è¡Œå®ç°ï¼Œä¸‹é¢æ˜¯æˆ‘çš„å®ç°ï¼Œä»…ä¾›å‚è€ƒã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Definition for singly-linked list.</span><br><span class="hljs-comment"> * struct ListNode &#123;</span><br><span class="hljs-comment"> *     int val;</span><br><span class="hljs-comment"> *     ListNode *next;</span><br><span class="hljs-comment"> *     ListNode() : val(0), next(nullptr) &#123;&#125;</span><br><span class="hljs-comment"> *     ListNode(int x) : val(x), next(nullptr) &#123;&#125;</span><br><span class="hljs-comment"> *     ListNode(int x, ListNode *next) : val(x), next(next) &#123;&#125;</span><br><span class="hljs-comment"> * &#125;;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function">ListNode* <span class="hljs-title">sortList</span><span class="hljs-params">(ListNode* head)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (head == <span class="hljs-literal">nullptr</span> || head-&gt;next == <span class="hljs-literal">nullptr</span>) &#123;<br>            <span class="hljs-keyword">return</span> head;<br>        &#125; <br>        ListNode* carry = <span class="hljs-literal">nullptr</span>;<br>        ListNode* counter[<span class="hljs-number">16</span>];      <span class="hljs-comment">// å› ä¸ºé¢˜ç›®è¯´æ˜èŠ‚ç‚¹æ•°å°äº50000ä¸ªï¼Œæ‰€ä»¥ç”¨16æ¡é“¾è¡¨è¶³å¤Ÿ</span><br>        <span class="hljs-keyword">int</span> fill = <span class="hljs-number">0</span>;               <span class="hljs-comment">// ä¸‹ä¸€ä¸ªå¡«å……é“¾è¡¨çš„ä¸‹æ ‡</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">16</span>;i++) &#123;<br>            counter[i] = <span class="hljs-literal">nullptr</span>;<br>        &#125;<br>        <span class="hljs-keyword">while</span> (head != <span class="hljs-literal">nullptr</span>) &#123;<br>            <span class="hljs-comment">// æ‹¿å‡ºä¸€ä¸ªå…ƒç´ </span><br>            carry = head;<br>            head = head-&gt;next;<br>            carry-&gt;next = <span class="hljs-literal">nullptr</span>;<br>            <br>            <span class="hljs-keyword">int</span> cur = <span class="hljs-number">0</span>;            <span class="hljs-comment">// å½“å‰æ’åºé“¾è¡¨ä¸‹æ ‡</span><br>            <span class="hljs-keyword">while</span> (cur &lt; fill &amp;&amp; counter[cur] != <span class="hljs-literal">nullptr</span> ) &#123;<br>                counter[cur] = <span class="hljs-built_in">merge</span>(counter[cur], carry);<br>                carry = <span class="hljs-literal">nullptr</span>;            <br>                std::<span class="hljs-built_in">swap</span>(carry, counter[cur++]);<br>            &#125;<br>            std::<span class="hljs-built_in">swap</span>(carry,counter[cur]);<br>            <span class="hljs-keyword">if</span> (cur == fill) &#123;<br>                fill++;<br>            &#125;<br>        <br>        &#125;<br><br>        <span class="hljs-comment">// æœ€åå°†æ‰€æœ‰é“¾è¡¨å…ƒç´ åˆå¹¶</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;fill;i++) &#123;<br>            counter[i] = <span class="hljs-built_in">merge</span>(counter[i<span class="hljs-number">-1</span>],counter[i]);<br>        &#125;<br>        <span class="hljs-keyword">return</span> counter[fill<span class="hljs-number">-1</span>];<br>    &#125;<br><br>    <span class="hljs-comment">// åˆå¹¶ä¸¤æ¡é“¾è¡¨ï¼Œå¹¶è¿”å›åˆå¹¶åçš„é“¾è¡¨å¤´ç»“ç‚¹</span><br>    <span class="hljs-function">ListNode* <span class="hljs-title">merge</span><span class="hljs-params">(ListNode* l1, ListNode* l2)</span> </span>&#123;<br>        ListNode head;<br>        ListNode* cur = &amp;head;<br>        <span class="hljs-keyword">while</span> (l1 != <span class="hljs-literal">nullptr</span> &amp;&amp; l2 != <span class="hljs-literal">nullptr</span>) &#123;<br>            <span class="hljs-keyword">if</span> (l1-&gt;val &lt; l2-&gt;val) &#123;<br>                cur-&gt;next = l1;<br>                l1 = l1-&gt;next;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                cur-&gt;next = l2;<br>                l2 = l2-&gt;next;<br>            &#125;<br>            cur = cur-&gt;next;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (l1 == <span class="hljs-literal">nullptr</span>) &#123;<br>            cur-&gt;next = l2;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (l2 == <span class="hljs-literal">nullptr</span>) &#123;<br>            cur -&gt;next = l1;<br>        &#125;<br>        <span class="hljs-keyword">return</span> head.next;<br>    &#125;<br><br>&#125;;<br></code></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h1><p>æœ€ç»ˆç®€å•æ€»ç»“ä¸€ä¸‹ï¼Œlist æ˜¯ä¸€ç§åŒå‘é“¾è¡¨ã€‚æ¯ä¸ªç»“ç‚¹éƒ½åŒ…å«ä¸€ä¸ªæ•°æ®åŸŸã€ä¸€ä¸ªå‰é©±æŒ‡é’ˆ prev å’Œä¸€ä¸ªåé©±æŒ‡é’ˆ nextã€‚<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="2 ä¸‡å­—+20 å›¾å¸¦ä½ æ‰‹æ’• STL åºåˆ—å¼å®¹å™¨æºç ">[1]</span></a></sup></p><p>ç”±äºå…¶é“¾è¡¨ç‰¹æ€§ï¼Œå®ç°åŒæ ·çš„æ“ä½œï¼Œç›¸å¯¹äº STL ä¸­çš„é€šç”¨ç®—æ³•ï¼Œ list çš„æˆå‘˜å‡½æ•°é€šå¸¸æœ‰æ›´é«˜çš„æ•ˆç‡ï¼Œå†…éƒ¨ä»…éœ€åšä¸€äº›æŒ‡é’ˆçš„æ“ä½œï¼Œå› æ­¤å°½å¯èƒ½é€‰æ‹© list æˆå‘˜å‡½æ•°ã€‚</p><p><strong>ä¼˜ç‚¹</strong></p><ul><li><p>åœ¨å†…éƒ¨æ–¹ä¾¿è¿›è¡Œæ’å…¥åˆ é™¤æ“ä½œã€‚</p></li><li><p>å¯åœ¨ä¸¤ç«¯è¿›è¡Œpushå’Œpopæ“ä½œã€‚</p></li></ul><p><strong>ç¼ºç‚¹</strong></p><ul><li><p>ä¸æ”¯æŒéšæœºè®¿é—®ï¼Œå³ä¸æ”¯æŒä¸‹æ ‡æ“ä½œ[ ] å’Œ .at()ã€‚</p></li><li><p>ç›¸å¯¹äº vector å ç”¨é¢å¤–å†…å­˜å¤šï¼ˆé¢å¤–æŒ‡é’ˆçš„å¼€é”€ï¼‰ã€‚</p></li></ul><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://mp.weixin.qq.com/s/NcrnwsB2gjq9h7W2hIZ6PQ">2 ä¸‡å­—+20 å›¾å¸¦ä½ æ‰‹æ’• STL åºåˆ—å¼å®¹å™¨æºç </a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://blog.csdn.net/qq_31720329/article/details/85535787">C++ STL LIST SORT æ’åºç®—æ³•å›¾è§£_zp0intçš„åšå®¢</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>C++</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>STL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Again</title>
    <link href="/2022/05/17/2022-05/2022-05-17%20Again/"/>
    <url>/2022/05/17/2022-05/2022-05-17%20Again/</url>
    
    <content type="html"><![CDATA[<p class='note note-primary'>  <font size="3">    â€œè¦å°†æˆ‘è¿™ç§äººå¯¼å›æ­£é€”ï¼Œææ€•å¾—å…ˆè¯·äººå…¨é¢å¦å®šæˆ‘ä¸€éæ‰è¡Œï¼Œå¿…é¡»æŠŠæˆ‘é€¼åˆ°æ— å¤„å¯é€ƒã€æ— æ³•è‡ªä¿çš„åœ°æ­¥ï¼Œå†å°†æˆ‘æŠ˜ç£¨å¾—ä½“æ— å®Œè‚¤ã€‚â€                         â€”â€”æ‘˜å½•æ¥è‡ªã€Šä¸‰æ—¥é—´çš„å¹¸ç¦ã€‹ï¼Œä¸‰ç§‹ç¼’  </font></p><p>èµ·åˆåªæ˜¯åˆ°äº†å‘¨äº”æ™šï¼Œæ‰‹ç—’ç—’äº†ï¼Œæƒ³æ‰“å‡ æŠŠè”ç›Ÿï¼Œä½†æ°é€¢èˆå‹ä¸å†å®¿èˆï¼Œå°±ç®—ä¸ç†„ç¯ä¹Ÿä¸ä¼šå½±å“åˆ«äººï¼Œæ‰€ä»¥åˆä»»æ€§æ‰“åˆ°äº†å‡Œæ™¨1ç‚¹ï¼Œæ­¤æ—¶åˆæ²¡äº†ç¡æ„ï¼Œå°±åˆç†¬å¤œçœ‹æ‰‹æœºï¼Œé™·å…¥äº†ä¸æƒ³ç¡è§‰çš„å¢ƒåœ°ï¼Œæ˜æ˜å‘Šè¯‰è‡ªå·±è¿™ä¸ªç‚¹è¦ç¡äº†ï¼Œä½†å´æ§åˆ¶ä¸ä½è‡ªå·±ï¼Œæƒ³ç€çœ‹å®Œè¿™ä¸€é›†å°±ç¡ï¼Œç„¶ååˆæ˜¯ä¸€é›†åˆä¸€é›†ã€‚</p><p>è€Œç†¬å¤œå¸¦æ¥çš„åæœåˆ™æ˜¯ä½œæ¯çš„æ··ä¹±ï¼Œè‡ªä¿¡çš„å—æŒ«ï¼Œè€Œæ¬²æœ›ä¹Ÿä¸æ­¤åŒæ—¶è¶è™šè€Œå…¥ï¼Œâ€åæ­£æ˜¯å‘¨æœ«ï¼Œå°±ç®—å†æ‰“å‡ æŠŠä¹Ÿæ²¡å…³ç³»å§ï¼Œä»Šå¤©å‘¨å…­å°±å†æ‰“ä¸€å¤©å§ï¼Œæ˜å¤©å†å¥½å¥½å­¦ä¹ â€œï¼Œå°±è¿™æ ·è´¥ç»™äº†è‡ªå·±çš„æ¬²æœ›ï¼Œç­‰å›è¿‡ç¥æ¥ï¼Œåˆæ˜¯ä¸€å¤©è¿‡å»äº†ï¼Œåˆåˆ°äº†å¤œæ·±äººé™çš„æ—¶å€™ï¼Œåˆä¸€æ¬¡åœ°ä¸ŠåºŠçœ‹æ‰‹æœºåˆ°å‡Œæ™¨3ã€4ç‚¹ï¼Œç„¶ååˆæ˜¯å¸¦ç€ç–²æƒ«å’Œæ„§ç–šï¼Œè¿æ¥ä¸‹ä¸€å¤©ã€‚</p><p>Again and again.</p><p>ç›´åˆ°å‘¨äºŒæ‰ç»ˆäºå›è¿‡ç¥æ¥ï¼Œå› ä¸ºæœ‰ä¸€ä¸ªæ±‡æŠ¥DDLå¿…é¡»è¦ä¸‹åˆè¿›è¡Œäº†ï¼Œè¿™ä¿ƒä½¿ç€æˆ‘å¿…é¡»å»æ•™å®¤åšPPTï¼Œè€Œå½“æˆ‘æ¼«ä¸ç»å¿ƒåœ°å®Œæˆåï¼Œåˆé™·å…¥äº†è¿·èŒ«çš„å›°å¢ƒï¼Œæˆ–è®¸æ˜¯å› ä¸ºæœ‰å¤ªå¤šç´¯è®¡çš„äº‹æƒ…è¦åšå§ï¼Œä¸€æ—¶é—´åè€Œä¸çŸ¥é“è¯¥å»ä»€ä¹ˆäº†ï¼Œæˆ–è€…è¯´æ²¡æœ‰åŠ¨åŠ›å»åšäº†ã€‚è€Œä¸æ­¤åŒæ—¶ï¼Œé‚ªå¿µåˆåœ¨æˆ‘çš„è„‘æµ·æµ®ç°ï¼Œâ€åæ­£å®Œæˆäº†ä¸€ä¸ªDDLï¼Œä¸å¦‚å†å»ç©å‡ æŠŠå§â€œï¼Œè¿™ä»¤æˆ‘ä¸å¯’è€Œæ —ï¼Œä½†æ•™å®¤çš„æ°›å›´è¿˜æ˜¯åˆ¶æ­¢äº†æˆ‘ï¼ŒæŠŠæˆ‘æ‹‰äº†å›æ¥ã€‚å¯æˆ‘è¿˜æ˜¯ä¸çŸ¥æ‰€æªï¼Œç„¶ååˆåˆ·èµ·äº†Bç«™ï¼Œçœ‹æ¼«ç”»çš„è§£è¯´è§†é¢‘æ‰“å‘æ—¶é—´ï¼Œåæ¥æœ‰çœ‹åˆ°æ¨èçš„ä¸€éƒ¨å°è¯´ã€Šä¸‰æ—¥é—´çš„å¹¸ç¦ã€‹ï¼ŒæŠ±ç€æˆ–è®¸èƒ½ä»ä¸­è·å–ç‚¹ç²¾ç¥åŠ›é‡çš„å¿µå¤´ï¼Œä»ç½‘ä¸Šæ‰¾åˆ°ç”µå­ä¹¦èµ„æºçœ‹äº†èµ·æ¥ã€‚</p><p>å¥½å·§ä¸å·§ï¼Œçœ‹å®Œå¤§æ¦‚2ä¸ªå°æ—¶ï¼Œåˆšå¥½ç¦»æ±‡æŠ¥è¿˜æœ‰ä¸€ä¸ªåƒé¥­çš„æ—¶é—´ã€‚è€Œè¿™æœ¬ä¹¦ä¹Ÿçš„ç¡®ç»™äº†æˆ‘äº›è®¸é¼“èˆï¼Œæˆ–è®¸ç›®å‰çš„å¿ƒå¢ƒä½¿ç„¶ï¼Œæ¥ æœ¨å’Œå®«åŸçš„çˆ±æƒ…å›ºç„¶ä»¤äººåŠ¨å®¹ï¼Œä½†æˆ‘æ›´å¤šæƒ³åˆ°çš„æ˜¯å¯¹æ—¶é—´çš„ ä½“ä¼šã€‚æœ¬è¯¥ä¸ºæ— ä»·ä¹‹å®çš„æ—¶é—´/å¯¿å‘½ï¼Œå´è¢«ä»¥æƒ¨æ·¡çš„ä»·æ ¼æ ‡æ³¨ï¼Œè€Œè¿™æ­£æ˜¯å› ä¸ºè‡ªå·±çš„ä¸çæƒœï¼Œä¸å¹¸ç¦ï¼Œä¸åŠªåŠ›æ”¹å˜æ‰€è‡´ï¼Œä½†å¯¹çœŸæ­£å¿ƒç°æ„å†·ã€å¯¹ä¸€åˆ‡å¤±å»çƒ­æƒ…ã€æ‰¾ä¸åˆ°ç”Ÿæ´»çš„æ„ä¹‰çš„äººæ¥è¯´ï¼Œææ€•ä¹Ÿæ— æ³•æ„è¯†åˆ°è¿™ä¸€ç‚¹ï¼Œæˆ–è€…è¯´å°±ç®—æ„è¯†åˆ°äº†ï¼Œå¿ƒä¹Ÿæ—©å·²éº»æœ¨äº†ç½¢ã€‚</p><p>æˆ–è®¸æˆ‘çš„å¢ƒé‡å’Œä¸»è§’æœ‰äº›ç±»ä¼¼ï¼Œä¹Ÿæ›¾è‡ªå‘½ä¸å‡¡ï¼Œä½†ä¹Ÿé­åˆ°ç°å®çš„æ‰“å‡»ï¼ˆå…¶å®æ˜¯è‡ªå·±ä¸€æ‰‹é€ æˆçš„ï¼‰ï¼Œè®¤æ¸…äº†è‡ªå·±çš„å¹³å‡¡å’Œå¼±å°ï¼Œä¹ŸæŸ“ä¸Šäº†è‡´å‘½çš„é™‹ä¹ ã€‚æˆ–è®¸æ˜¯åœ¨å®ä¹ ç‹¬å±…çš„é‚£æ®µæ—¶å€™æŸ“ä¸Šçš„å§ï¼Œå› ä¸ºæ²¡æœ‰äº†å¤–åœ¨çš„çº¦æŸï¼Œæ‰€ä»¥æ£æ„å¦„ä¸ºï¼Œä¸‰ç•ªäº”æ¬¡åœ°ç†¬å¤œï¼Œç„¶åæ‹–ç€ç–²æƒ«ä¸å ªçš„èº«ä½“å»å®ä¹ ä¸Šç­ã€‚è€Œè¿™æ¶ä¹ ä¹Ÿåœ¨è¯»ç ”æœŸé—´ç»§ç»­æŠ˜ç£¨ç€æˆ‘ï¼Œæ¶ˆç£¨æˆ‘çš„æ„å¿—ï¼Œæˆ‘èƒ½ä¸€æ˜ŸæœŸæ¯å¤©å­¦ä¹ 9å°æ—¶ï¼Œä¹Ÿèƒ½è¿ç»­3å¤©æ¯å¤©æ‰“ä¸Š12ä¸ªå°æ—¶çš„æ¸¸æˆï¼Œç”šè‡³æœŸé—´ç†¬å¤œã€‚æ²¡æœ‰äººæƒ³åˆ°æˆ‘ä¼šå˜æˆè¿™å¹…æ¨¡æ ·ï¼Œå› ä¸ºæˆ‘è‡ªå·±ä¹Ÿæ²¡æƒ³è¿‡è‡ªå·±ä¼šå˜å¾—å¦‚æ­¤ï¼Œæ¸æ¸æˆä¸ºè‡ªå·±åŒæ¶çš„æ¨¡æ ·ã€‚</p><p>ä½†æ›´ä»¤äººæ°”æ„¤çš„æ˜¯ï¼Œæˆ‘å´åªèƒ½äº‹åæ‡Šæ‚”ï¼Œç„¶åå¸¦ç€è€»è¾±å’Œä¸ç”˜é‡æ–°å‡ºå‘ï¼Œå°±åƒä»å‰é‚£æ ·ï¼Œå¥‹æ–—ï¼Œå •è½ï¼Œç„¶ååˆç»§ç»­å¥‹æ–—ã€‚æˆ–è®¸äººå°±æ˜¯è¿™æ ·ä¸€ç§å¤æ‚çš„ç”Ÿç‰©å§ï¼Œæˆ–è€…è¯´æˆ‘æ›´å¸Œæœ›èƒ½è¿™ä¹ˆå»è§£é‡Šï¼Œæ‰¿è®¤è‡ªå·±çš„æ— èƒ½å’Œå¼±å°ï¼Œç„¶åå…»è¶³ç²¾ç¥ï¼Œå†æ¬¡å‘ç”Ÿæ´»å‘å‡ºæŒ‘æˆ˜å§ï¼å°±åƒä»å‰é‚£æ ·ï¼Œâ€ä¸è¿‡æ˜¯ä»å¤´å†æ¥â€œï¼Œâ€ç°åœ¨è¡ŒåŠ¨ä¹Ÿä¸ºæ—¶ä¸æ™šâ€œï¼Œâ€èˆ¹åˆ°æ¡¥å¤´è‡ªç„¶ç›´â€œï¼Œâ€æˆ‘ä¹ŸçŸ¥é“è¿™ä¹ˆç¥ˆæ±‚å¾ˆæ— è€»ï¼Œä½†æˆ‘è¿˜æ˜¯å¸Œæœ›è‡ªå·±å¯ä»¥æœ‰é‡å¤´å†æ¥çš„æœºä¼šâ€œã€‚ã€‚ã€‚</p><p>Again !</p>]]></content>
    
    
    <categories>
      
      <category>ç”Ÿæ´»</category>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚è°ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€è®¾è®¡æ¨¡å¼ã€‘èŒè´£é“¾ä¸å‘½ä»¤æ¨¡å¼</title>
    <link href="/2022/05/09/2022-05/2022-05-09%20%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E8%81%8C%E8%B4%A3%E9%93%BE%E4%B8%8E%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/"/>
    <url>/2022/05/09/2022-05/2022-05-09%20%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E8%81%8C%E8%B4%A3%E9%93%BE%E4%B8%8E%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="chain-of-responsibilityèŒè´£é“¾å¯¹è±¡è¡Œä¸ºæ¨¡å¼"><a class="markdownIt-Anchor" href="#chain-of-responsibilityèŒè´£é“¾å¯¹è±¡è¡Œä¸ºæ¨¡å¼"></a> Chain of Responsibilityï¼ˆèŒè´£é“¾ï¼‰â€”â€”å¯¹è±¡è¡Œä¸ºæ¨¡å¼</h1><h2 id="1-æ„å›¾"><a class="markdownIt-Anchor" href="#1-æ„å›¾"></a> 1. æ„å›¾</h2><p>è®©å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚å‘é€è€…ä¸æ¥æ”¶è€…è€¦åˆåœ¨ä¸€èµ·ã€‚å°†è¿™äº›å¯¹è±¡è¿æ¥æˆä¸€æ¡é“¾ï¼Œå¹¶ä¸”æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p><h2 id="2-åŠ¨æœº"><a class="markdownIt-Anchor" href="#2-åŠ¨æœº"></a> 2. åŠ¨æœº</h2><blockquote><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_38636211/article/details/97762272">è´£ä»»é“¾(Chain of Responsibility)æ¨¡å¼_é¥­å›¢å°ç¥çš„åšå®¢-CSDNåšå®¢_è´£ä»»é“¾</a></p></blockquote><p>ä»ç¬¬ä¸€ä¸ªå¯¹è±¡å¼€å§‹ï¼Œé“¾ä¸­æ”¶åˆ°è¯·æ±‚çš„å¯¹è±¡è¦ä¹ˆäº²è‡ªå¤„ç†å®ƒï¼Œè¦ä¹ˆè½¬å‘ç»™é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå€™é€‰è€…ã€‚æäº¤è¯·æ±‚çš„å¯¹è±¡å¹¶ä¸æ˜ç¡®çŸ¥é“å“ªä¸€ä¸ªå¯¹è±¡å°†ä¼šå¤„ç†å®ƒâ€”â€”æˆ‘ä»¬è¯´è¯¥è¯»è¯·æ±‚æœ‰ä¸€ä¸ªéšå¼çš„æ¥å—è€…ï¼ˆimplicit receiverï¼‰ã€‚<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="è´£ä»»é“¾(Chain of Responsibility)æ¨¡å¼_é¥­å›¢å°ç¥çš„åšå®¢-CSDNåšå®¢_è´£ä»»é“¾">[1]</span></a></sup></p><p>èŒè´£é“¾ä¸Šçš„å¤„ç†è€…è´Ÿè´£å¤„ç†è¯·æ±‚ï¼Œå®¢æˆ·åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°èŒè´£é“¾ä¸Šå³å¯ï¼Œæ— é¡»å…³å¿ƒè¯·æ±‚çš„å¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’ï¼Œæ‰€ä»¥èŒè´£é“¾å°†è¯·æ±‚çš„å‘é€è€…å’Œè¯·æ±‚çš„å¤„ç†è€…è§£è€¦äº†ã€‚</p><h2 id="3-é€‚ç”¨æ€§"><a class="markdownIt-Anchor" href="#3-é€‚ç”¨æ€§"></a> 3. é€‚ç”¨æ€§</h2><p>åœ¨ä»¥ä¸‹æ¡ä»¶ä¸‹ä½¿ç”¨ Chain of Responsibility æ¨¡å¼ï¼š</p><ul><li><p>æœ‰å¤šä¸ªçš„å¯¹è±¡å¯ä»¥å¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œå“ªä¸ªå¯¹è±¡å¤„ç†è¯¥è¯·æ±‚è¿è¡Œæ—¶åˆ»è‡ªåŠ¨ç¡®å®šã€‚</p></li><li><p>ä½ æƒ³åœ¨ä¸æ˜ç¡®æŒ‡å®šæ¥æ”¶è€…çš„æƒ…å†µä¸‹ï¼Œå‘å¤šä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªæäº¤ä¸€ä¸ªè¯·æ±‚ã€‚</p></li><li><p>å¯å¤„ç†ä¸€ä¸ªè¯·æ±‚çš„å¯¹è±¡é›†åˆåº”è¯¥è¢«åŠ¨æ€æŒ‡å®šã€‚</p></li></ul><h2 id="4-ç»“æ„"><a class="markdownIt-Anchor" href="#4-ç»“æ„"></a> 4. ç»“æ„</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205092127248.jpeg" alt="ç»“æ„å›¾" /></p><p>ä¸€ä¸ªå…¸å‹çš„å¯¹è±¡ç»“æœå¯èƒ½å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205092127543.jpeg" alt="" /></p><h2 id="5-å‚ä¸è€…"><a class="markdownIt-Anchor" href="#5-å‚ä¸è€…"></a> 5. å‚ä¸è€…</h2><ul><li>Handler<ul><li>å®šä¹‰ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„æ¥å£</li><li>å½“ä½œä¸ºæ‰€æœ‰ConcreteHandlerçš„æ¥å£æ—¶ï¼Œéœ€è¦è®¾ç½®åç»­é“¾çš„æ¥å£ï¼Œå½“ä½œä¸ºè´£ä»»é“¾æœ€åçš„ç»“å°¾å¯ä»¥ä¸ç”¨è®¾ç½®åç»­æ¥å£</li></ul></li><li>ConcreteHandler<ul><li>å¤„ç†å®ƒæ‰€è´Ÿè´£çš„è¯·æ±‚ã€‚</li><li>å¯è®¿é—®å®ƒçš„åç»§è€…</li><li>å¦‚æœå¯å¤„ç†è¯¥è¯·æ±‚ï¼Œå°±å¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œå¦åˆ™å°†è¯¥è¯·æ±‚è½¬å‘ç»™å®ƒçš„åç»§è€…ã€‚</li></ul></li><li>Client<ul><li>å‘é“¾ä¸Šçš„å…·ä½“å¤„ç†è€…(ConcreteHandler)å¯¹è±¡æäº¤è¯·æ±‚ã€‚</li></ul></li></ul><h2 id="6-åä½œ"><a class="markdownIt-Anchor" href="#6-åä½œ"></a> 6. åä½œ</h2><p>å½“å®¢æˆ·æäº¤ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œè¯·æ±‚æ²¿é“¾ä¼ é€’ç›´è‡³æœ‰ä¸€ä¸ªConcreteHandlerå¯¹è±¡è´Ÿè´£å¤„ç†å®ƒ</p><h2 id="7-æ•ˆæœ"><a class="markdownIt-Anchor" href="#7-æ•ˆæœ"></a> 7. æ•ˆæœ</h2><ul><li>ä¼˜ç‚¹ï¼š<ul><li><strong>é™ä½è€¦åˆåº¦</strong>ã€‚è¯¥æ¨¡å¼ä½¿å¾—ä¸€ä¸ªå¯¹è±¡æ— éœ€çŸ¥é“æ˜¯å…¶ä»–å“ªä¸€ä¸ªå¯¹è±¡çš„å…¶è¯·æ±‚ã€‚å¯¹è±¡ä»…éœ€çŸ¥é“è¯¥è¯·æ±‚ä¼šè¢«â€œæ­£ç¡®â€åœ°å¤„ç†ã€‚æ¥å—è€…å’Œå‘é€è€…éƒ½æ²¡æœ‰å¯¹æ–¹çš„æ˜ç¡®çš„ä¿¡æ¯ï¼Œä¸”é“¾ä¸­çš„å¯¹è±¡ä¸éœ€çŸ¥é“é“¾çš„ç»“æ„ã€‚ç»“æœæ˜¯ï¼Œè´£ä»»é“¾å¯ä»¥ç®€åŒ–å¯¹è±¡çš„ç›¸äº’è¿æ¥ã€‚å®ƒä»¬ä»…éœ€ä¿æŒä¸€ä¸ªæŒ‡å‘å…¶åç»§è€…çš„å¼•ç”¨ï¼Œè€Œä¸éœ€è¦ä¿æŒå®ƒæ‰€æœ‰çš„å€™é€‰æ¥å—è€…çš„å¼•ç”¨ã€‚</li><li><strong>å¢å¼ºäº†ç»™å¯¹è±¡æŒ‡æ´¾è´£ä»»(Responsibility)çš„çµæ´»æ€§</strong>ã€‚å½“åœ¨å¯¹è±¡ä¸­åˆ†é…èŒè´£æ—¶ï¼ŒèŒè´£é“¾ç»™ä½ æ›´å¤šçš„çµæ´»æ€§ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨è¿è¡Œæ—¶åˆ»å¯¹è¯¥é“¾è¿›è¡ŒåŠ¨æ€çš„å¢åŠ æˆ–è€…ä¿®æ”¹æ¥å¢åŠ æˆ–è€…æ”¹å˜å¤„ç†ä¸€ä¸ªè¯·æ±‚çš„é‚£äº›èŒè´£ã€‚ä½ å¯ä»¥å°†è¿™ç§æœºåˆ¶ä¸é™æ€çš„ç‰¹ä¾‹åŒ–å¤„ç†å¯¹è±¡çš„ç»§æ‰¿æœºåˆ¶ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚</li></ul></li><li>ç¼ºç‚¹ï¼š<ul><li><strong>ä¸ä¿è¯è¢«æ¥å—ã€‚</strong> æ—¢ç„¶ä¸€ä¸ªè¯·æ±‚æ²¡æœ‰æ˜ç¡®çš„æ¥å—è€…ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ä¿è¯å®ƒä¸€å®šä¼šè¢«å¤„ç†â€”â€”è¯¥è¯·æ±‚å¯èƒ½ä¸€ç›´åœ¨é“¾å¯¹çš„æœ«ç«¯éƒ½å¾—ä¸åˆ°å¤„ç†ã€‚ä¸€ä¸ªè¯·æ±‚ä¹Ÿå¯èƒ½å› è¯¥é“¾æ²¡æœ‰è¢«æ­£ç¡®é…ç½®è€Œå¾—ä¸åˆ°å¤„ç†ã€‚</li></ul></li></ul><h2 id="8-å®ç°"><a class="markdownIt-Anchor" href="#8-å®ç°"></a> 8. å®ç°</h2><p>åœ¨èŒè´£é“¾æ¨¡å¼ä¸­è¦è€ƒè™‘çš„å®ç°é—®é¢˜ï¼š</p><ul><li><p><strong>å®ç°åç»§è€…é“¾</strong>ã€‚æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥å®ç°åç»§è€…é“¾ã€‚</p><ul><li>a) å®šä¹‰æ–°çš„é“¾æ¥(é€šå¸¸åœ¨Handlerä¸­å®šä¹‰ï¼Œä¹Ÿå¯ç”±ConcreteHandlersæ¥å®šä¹‰)ã€‚</li><li>b) ä½¿ç”¨å·²æœ‰çš„é“¾æ¥ã€‚</li></ul></li><li><p><strong>è¿æ¥åç»§è€…ã€‚</strong> å¦‚æœæ²¡æœ‰å·²æœ‰çš„å¼•ç”¨å¯å®šä¹‰ä¸€ä¸ªé“¾ï¼Œé‚£ä¹ˆä½ å¿…é¡»è‡ªå·±å¼•å…¥å®ƒä»¬ã€‚è¿™ç§æƒ…å†µä¸‹Handlerä¸ä»…å®šä¹‰è¯¥è¯·æ±‚çš„æ¥å£ï¼Œé€šå¸¸ä¹Ÿç»´æŠ¤åç»§é“¾æ¥(å¯ä»¥é€šè¿‡æ„é€ å™¨å®ç°)ã€‚</p></li><li><p><strong>è¡¨ç¤ºè¯·æ±‚</strong>ã€‚å¯ä»¥æœ‰ä¸åŒçš„æ–¹æ³•è¡¨ç¤ºè¯·æ±‚ã€‚æœ€ç®€å•çš„å½¢å¼ï¼Œè¯·æ±‚æ˜¯ä¸€ä¸ªç¡¬ç¼–ç çš„(Hard-coded)æ“ä½œè°ƒç”¨ã€‚è¿™ç§å½¢å¼æ–¹ä¾¿è€Œä¸”å®‰å…¨ã€‚ä½†ä½ åªèƒ½è½¬å‘Handlerç±»å®šä¹‰çš„å›ºå®šçš„ä¸€ç»„è¯·æ±‚ã€‚å¦ä¸€ç§é€‰æ‹©æ˜¯ä½¿ç”¨ä¸€ä¸ªå¤„ç†å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°é€šå¸¸ä»¥ä¸€ä¸ªè¯·æ±‚ç (å¦‚ä¸€ä¸ªæ•´å‹å¸¸æ•°æˆ–è€…ä¸€ä¸ªå­—ç¬¦ä¸²)ä¸ºå‚æ•°ã€‚è¿™ç§æ–¹æ³•æ”¯æŒè¯·æ±‚æ•°ç›®ä¸é™ã€‚å”¯ä¸€çš„è¦æ±‚æ˜¯å‘é€æ–¹å’Œæ¥å—æ–¹åœ¨è¯·æ±‚å¦‚ä½•ç¼–ç é—®é¢˜ä¸Šè¾¾æˆä¸€è‡´ã€‚</p></li></ul><h2 id="9-ç¤ºä¾‹ä»£ç "><a class="markdownIt-Anchor" href="#9-ç¤ºä¾‹ä»£ç "></a> 9. ç¤ºä¾‹ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// ChainResponsibility.h</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/5/8.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> BEHAVIORALPATTERNDESIGN_CHAINRESPONSIBILITY_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> BEHAVIORALPATTERNDESIGN_CHAINRESPONSIBILITY_H</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @brief å‚è€ƒè¿™ä¸ªä¾‹å­ï¼šhttps://www.runoob.com/design-pattern/chain-of-responsibility-pattern.html</span><br><span class="hljs-comment"> * æ¨¡æ‹Ÿåœºæ™¯ï¼šæŠŠæ‰“å°çš„æ¶ˆæ¯ä½œä¸ºè¯·æ±‚ï¼ŒæŠŠæ¶ˆæ¯ä¼ é€’ç»™Loggerï¼Œå„ä¸ªLoggeråˆ¤æ–­è¯¥æ¶ˆæ¯çº§åˆ«æ˜¯å¦ç¬¦åˆè‡ªèº«è¦æ±‚ï¼Œ</span><br><span class="hljs-comment"> * å¦‚æœç¬¦åˆåˆ™è¿›è¡Œå¤„ç†æ‰“å°ï¼Œå¦åˆ™äº¤ç»™ä¸‹ä¸€çº§ï¼ˆæ›´é«˜çº§ï¼‰çš„Logger</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_chain_responsibility</span><span class="hljs-params">()</span></span>;<br><br><span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MESSAGE_LEVEL</span> &#123;</span><br>    INFO,<br>    DEBUG,<br>    WARNING,<br>    ERROR,<br>&#125;;<br><br><span class="hljs-comment">// æŠ½è±¡æ—¥å¿—ï¼Œç›¸å½“äºæ˜¯ Handlerç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractLogger</span> &#123;</span><br><span class="hljs-keyword">protected</span>:<br>    AbstractLogger* next_logger;<br>    MESSAGE_LEVEL level;<br><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_next_logger</span><span class="hljs-params">(AbstractLogger* logger)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (logger != <span class="hljs-literal">nullptr</span>)<br>            next_logger = logger;<br>    &#125;<br>    <span class="hljs-built_in">AbstractLogger</span>(MESSAGE_LEVEL level, AbstractLogger* logger): <span class="hljs-built_in">level</span>(level), <span class="hljs-built_in">next_logger</span>(logger) &#123;<br><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print_message</span><span class="hljs-params">(MESSAGE_LEVEL info_level, string message)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (level &gt;= info_level) &#123;<br>            cout &lt;&lt; message &lt;&lt; endl;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (next_logger != <span class="hljs-literal">nullptr</span>)&#123;<br>            next_logger-&gt;<span class="hljs-built_in">print_message</span>(info_level,message);<br>        &#125;<br>    &#125;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InfoLogger</span> :</span> <span class="hljs-keyword">public</span> AbstractLogger &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">InfoLogger</span>(MESSAGE_LEVEL level, AbstractLogger* logger): <span class="hljs-built_in">AbstractLogger</span>(level, logger) &#123;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print_message</span><span class="hljs-params">(MESSAGE_LEVEL info_level, string message)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (level &gt;= info_level) &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;InfoLogger è¾“å‡ºæ¶ˆæ¯é¢œè‰²ä¸ºé»‘è‰²ï¼Œæ¶ˆæ¯ï¼š&quot;</span> &lt;&lt; message &lt;&lt; endl;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (next_logger != <span class="hljs-literal">nullptr</span>) &#123;<br>            next_logger-&gt;<span class="hljs-built_in">print_message</span>(info_level,message);<br>        &#125;<br>    &#125;<br>&#125;;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DebugLogger</span>:</span> <span class="hljs-keyword">public</span> AbstractLogger &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">DebugLogger</span>(MESSAGE_LEVEL level, AbstractLogger* logger): <span class="hljs-built_in">AbstractLogger</span>(level, logger) &#123;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print_message</span><span class="hljs-params">(MESSAGE_LEVEL info_level, string message)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (level &gt;= info_level) &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;DebugLogger è¾“å‡ºæ¶ˆæ¯é¢œè‰²ä¸ºç°è‰²ï¼Œæ¶ˆæ¯ï¼š&quot;</span> &lt;&lt; message &lt;&lt; endl;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (next_logger != <span class="hljs-literal">nullptr</span>)&#123;<br>            next_logger-&gt;<span class="hljs-built_in">print_message</span>(info_level,message);<br>        &#125;<br>    &#125;<br>&#125;;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WarningLogger</span> :</span> <span class="hljs-keyword">public</span> AbstractLogger &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">WarningLogger</span>(MESSAGE_LEVEL level, AbstractLogger* logger): <span class="hljs-built_in">AbstractLogger</span>(level, logger) &#123;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print_message</span><span class="hljs-params">(MESSAGE_LEVEL info_level, string message)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (level &gt;= info_level) &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;WarningLogger è¾“å‡ºæ¶ˆæ¯é¢œè‰²ä¸ºé»„è‰²ï¼Œæ¶ˆæ¯ï¼š&quot;</span> &lt;&lt; message &lt;&lt; endl;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (next_logger != <span class="hljs-literal">nullptr</span>)&#123;<br>            next_logger-&gt;<span class="hljs-built_in">print_message</span>(info_level,message);<br>        &#125;<br>    &#125;<br>&#125;;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ErrorLogger</span> :</span> <span class="hljs-keyword">public</span> AbstractLogger &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">ErrorLogger</span>(MESSAGE_LEVEL level, AbstractLogger* logger): <span class="hljs-built_in">AbstractLogger</span>(level, logger) &#123;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print_message</span><span class="hljs-params">(MESSAGE_LEVEL info_level, string message)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (level &gt;= info_level) &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;ErrorLogger è¾“å‡ºæ¶ˆæ¯é¢œè‰²ä¸ºçº¢è‰²ï¼Œæ¶ˆæ¯ï¼š&quot;</span> &lt;&lt; message &lt;&lt; endl;<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (next_logger != <span class="hljs-literal">nullptr</span>)&#123;<br>            next_logger-&gt;<span class="hljs-built_in">print_message</span>(info_level,message);<br>        &#125;<br>    &#125;<br>&#125;;<br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//BEHAVIORALPATTERNDESIGN_CHAINRESPONSIBILITY_H</span></span><br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// ChainResponsibility.cpp</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/5/8.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;ChainResponsibility.h&quot;</span></span><br><span class="hljs-function">AbstractLogger* <span class="hljs-title">get_logger</span><span class="hljs-params">()</span> </span>&#123;<br>    AbstractLogger* info_logger = <span class="hljs-keyword">new</span> <span class="hljs-built_in">InfoLogger</span>(MESSAGE_LEVEL::INFO, <span class="hljs-literal">nullptr</span>);<br>    AbstractLogger* debug_logger = <span class="hljs-keyword">new</span> <span class="hljs-built_in">DebugLogger</span>(MESSAGE_LEVEL::DEBUG, <span class="hljs-literal">nullptr</span>);<br>    AbstractLogger* warning_logger = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WarningLogger</span>(MESSAGE_LEVEL::WARNING, <span class="hljs-literal">nullptr</span>);<br>    AbstractLogger* error_logger = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ErrorLogger</span>(MESSAGE_LEVEL::ERROR, <span class="hljs-literal">nullptr</span>);<br>    info_logger-&gt;<span class="hljs-built_in">set_next_logger</span>(debug_logger);<br>    debug_logger-&gt;<span class="hljs-built_in">set_next_logger</span>(warning_logger);<br>    warning_logger-&gt;<span class="hljs-built_in">set_next_logger</span>(error_logger);<br>    <span class="hljs-keyword">return</span> info_logger;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_chain_responsibility</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯• Chain of Responsibiliy æ¨¡å¼â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br><br>    AbstractLogger* logger = <span class="hljs-built_in">get_logger</span>();<br>    logger-&gt;<span class="hljs-built_in">print_message</span>(MESSAGE_LEVEL::DEBUG, <span class="hljs-string">&quot;è°ƒè¯•å½“å‰æ•°æ®&quot;</span>);<br>    logger-&gt;<span class="hljs-built_in">print_message</span>(MESSAGE_LEVEL::INFO, <span class="hljs-string">&quot;è¾“å‡ºä¸€æ¡æ™®é€šä¿¡æ¯&quot;</span>);<br>    logger-&gt;<span class="hljs-built_in">print_message</span>(MESSAGE_LEVEL::ERROR, <span class="hljs-string">&quot;è¿è¡Œæ—¶æŠ¥é”™ï¼&quot;</span>);<br>    logger-&gt;<span class="hljs-built_in">print_message</span>(MESSAGE_LEVEL::WARNING, <span class="hljs-string">&quot;æœ‰ä¸€ä¸ªå˜é‡æ²¡æœ‰èµ‹åˆå€¼ï¼&quot;</span>);<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”ç»“æŸæµ‹è¯• Chain of Responsibiliy æ¨¡å¼â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="10-ç›¸å…³æ¨¡å¼"><a class="markdownIt-Anchor" href="#10-ç›¸å…³æ¨¡å¼"></a> 10. ç›¸å…³æ¨¡å¼</h2><p><strong>Composite</strong>æ¨¡å¼ï¼š è´£ä»»é“¾æ¨¡å¼é•¿ä¸Compositeæ¨¡å¼ä¸€èµ·ä½¿ç”¨ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ„ä»¶çš„çˆ¶æ„ä»¶å¯ä½œä¸ºå®ƒçš„åç»­ã€‚</p><h1 id="commandå‘½ä»¤å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼"><a class="markdownIt-Anchor" href="#commandå‘½ä»¤å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼"></a> Commandï¼ˆå‘½ä»¤ï¼‰â€”â€”å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼</h1><h2 id="1-æ„å›¾-2"><a class="markdownIt-Anchor" href="#1-æ„å›¾-2"></a> 1. æ„å›¾</h2><p>å°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿ä½ å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼Œå¯¹è¯·æ±‚æ’é˜Ÿæˆ–è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚</p><h2 id="2-åˆ«å"><a class="markdownIt-Anchor" href="#2-åˆ«å"></a> 2. åˆ«å</h2><p>åŠ¨ä½œï¼ˆactionï¼‰ï¼Œäº‹ç‰©ï¼ˆtransactionï¼‰</p><h2 id="3-åŠ¨æœº"><a class="markdownIt-Anchor" href="#3-åŠ¨æœº"></a> 3. åŠ¨æœº</h2><p>æœ‰æ—¶å¿…é¡»å‘æŸå¯¹è±¡æäº¤è¯·æ±‚ï¼Œä½†å¹¶ä¸çŸ¥é“å…³äºè¢«è¯·æ±‚çš„æ“ä½œæˆ–è¯·æ±‚çš„æ¥å—è€…çš„ä»»ä½•ä¿¡æ¯ã€‚</p><p>å‘½ä»¤æ¨¡å¼é€šè¿‡å°†è¯·æ±‚æœ¬èº«å˜æˆä¸€ä¸ªå¯¹è±¡æ¥ä½¿å·¥å…·ç®±çš„å¯¹è±¡å¯å‘æœªæŒ‡å®šçš„åº”ç”¨å¯¹è±¡æå‡ºè¯·æ±‚ã€‚è¿™ä¸ªå¯¹è±¡å¯è¢«å­˜å‚¨å¹¶å‘å…¶ä»–çš„å¯¹è±¡ä¸€æ ·è¢«ä¼ é€’ã€‚è¿™ä¸€æ¨¡å¼çš„å…³é”®æ˜¯ä¸€ä¸ªæŠ½è±¡çš„Commandç±»æˆ–è€…æ¥å£ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªæ‰§è¡Œæ“ä½œçš„æ¥å£ã€‚ å…¶æœ€ç®€å•çš„å½¢å¼æ˜¯ä¸€ä¸ªæŠ½è±¡çš„Executeæ“ä½œã€‚ å…·ä½“çš„Commandå®ç°å°†çœŸæ­£çš„æ¥å—è€…(Receiver)ä½œä¸ºå…¶ä¸€ä¸ªå®ä¾‹å˜é‡(ä½¿ç”¨å§”æ‰˜çš„æ–¹å¼)ã€‚å¹¶å®ç°Executeæ“ä½œï¼ŒæŒ‡å®šæ¥å—è€…é‡‡å–çš„åŠ¨ä½œã€‚è€Œæ¥å—è€…æœ‰æ‰§è¡Œè¯¥è¯·æ±‚æ‰€éœ€çš„å…·ä½“ä¿¡æ¯ã€‚</p><h2 id="4-é€‚ç”¨æ€§"><a class="markdownIt-Anchor" href="#4-é€‚ç”¨æ€§"></a> 4. é€‚ç”¨æ€§</h2><p>å½“ä½ æœ‰å¦‚ä¸‹éœ€æ±‚çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨Commandæ¨¡å¼ï¼š</p><ul><li>éœ€è¦æŠ½è±¡å‡ºå¾…æ‰§è¡Œçš„åŠ¨ä½œä»¥å‚æ•°åŒ–æŸå¯¹è±¡ã€‚ä½ å¯ç”¨è¿‡ç¨‹è¯­è¨€ä¸­çš„å›è°ƒ(callback)å‡½æ•°è¡¨è¾¾å¼è¿™ç§å‚æ•°åŒ–æœºåˆ¶ã€‚æ‰€è°“çš„å›è°ƒå‡½æ•°æ˜¯æŒ‡æŸå‡½æ•°å…ˆåœ¨æŸå¤„æ³¨å†Œï¼Œè€Œå®ƒå°†åœ¨ç¨åæŸä¸ªéœ€è¦çš„æ—¶å€™è¢«è°ƒç”¨ã€‚Commandæ¨¡å¼æ—¶å›è°ƒæœºåˆ¶çš„ä¸€ä¸ªé¢å‘å¯¹è±¡çš„ä»£æ›¿å“ã€‚</li><li>åœ¨ä¸åŒçš„æ—¶åˆ»æŒ‡å®šã€æ’åˆ—å’Œæ‰§è¡Œè¯·æ±‚ã€‚ä¸€ä¸ªCommandå¯¹è±¡å¯ä»¥æœ‰ä¸€ä¸ªä¸åˆå§‹è¯·æ±‚æ— å…³çš„ç”Ÿå­˜æœŸã€‚</li><li>æ”¯æŒå–æ¶ˆæ“ä½œ Commandçš„Executeæ“ä½œï¼Œå¯åœ¨å®æ–½æ“ä½œå‰å°†çŠ¶æ€å­˜å‚¨èµ·æ¥ï¼Œåœ¨å–æ¶ˆæ“ä½œæ—¶è¿™ä¸ªçŠ¶æ€ç”¨æ¥æ¶ˆé™¤è¯¥æ“ä½œçš„å½±å“ã€‚Commandæ¥å£å¿…é¡»æ·»åŠ ä¸€ä¸ªUnexecuteæ“ä½œï¼Œè¯¥æ“ä½œå–æ¶ˆä¸Šä¸€æ¬¡Executeè°ƒç”¨çš„æ•ˆæœã€‚æ‰§è¡Œçš„å‘½ä»¤è¢«å­˜å‚¨åœ¨ä¸€ä¸ªå†å²åˆ—è¡¨ä¸­ã€‚å¯é€šè¿‡å‘åå’Œå‘å‰éå†è¿™ä¸ªåˆ—è¡¨å¹¶åˆ†åˆ«è°ƒç”¨undoå’Œexecuteæ¥å®ç°é‡æ•°ä¸é™çš„â€œæ’¤é”€â€å’Œâ€œæ‰§è¡Œâ€ã€‚</li><li>æ”¯æŒä¿®æ”¹æ—¥å¿—ï¼Œè¿™æ ·å½“ç³»ç»Ÿå´©æºƒæ—¶ï¼Œè¿™äº›ä¿®æ”¹å¯ä»¥è¢«é‡åšä¸€é åœ¨Commandæ¥å£ä¸­æ·»åŠ ä¸­æ·»åŠ è£…è½½æ“ä½œå’Œå­˜å‚¨æ“ä½œï¼Œå¯ä»¥ç”¨æ¥ä¿æŒå˜åŠ¨çš„ä¸€ä¸ªä¸€è‡´çš„ä¿®æ”¹æ—¥å¿—ã€‚</li><li>ç”¨æ¥æ„å»ºåœ¨åŸè¯­æ“ä½œä¸Šçš„é«˜å±‚æ“ä½œæ„é€ ä¸€ä¸ªç³»ç»Ÿã€‚è¿™æ ·ä¸€ç§çš„ç»“æ„åœ¨æ”¯æŒ**äº‹åŠ¡(transaction)**çš„ä¿¡æ¯ç³»ç»Ÿä¸­å¾ˆå¸¸è§ã€‚</li></ul><h2 id="5-ç»“æ„"><a class="markdownIt-Anchor" href="#5-ç»“æ„"></a> 5. ç»“æ„</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205092130408.jpeg" alt="ç»“æ„å›¾" /></p><h2 id="6-å‚ä¸è€…"><a class="markdownIt-Anchor" href="#6-å‚ä¸è€…"></a> 6. å‚ä¸è€…</h2><ul><li>Command<ul><li>å£°æ˜æ‰§è¡Œæ“ä½œçš„æ¥å£</li></ul></li><li>ConcreteCommand<ul><li>å°†ä¸€ä¸ªæ¥å—è€…å¯¹è±¡ç»‘å®šäºä¸€ä¸ªåŠ¨ä½œ</li><li>è°ƒç”¨æ¥å—è€…ç›¸åº”çš„æ“ä½œï¼Œä»¥æ‰§è¡ŒExecute</li></ul></li><li>Client<ul><li>åˆ›å»ºä¸€ä¸ªå…·ä½“å‘½ä»¤å¯¹è±¡å¹¶è®¾å®šå®ƒçš„æ¥æ”¶è€…</li></ul></li><li>Invoker<ul><li>è¦æ±‚è¯¥å‘½ä»¤æ‰§è¡Œè¿™ä¸ªè¯·æ±‚</li></ul></li><li>Reveiver<ul><li>çŸ¥é“å¦‚ä½•å®æ–½å’Œæ‰§è¡Œä¸€ä¸ªè¯·æ±‚ç›¸å…³çš„æ“ä½œã€‚ä»»ä½•ç±»éƒ½å¯èƒ½ä½œä¸ºä¸€ä¸ªæ¥å—è€…</li></ul></li></ul><h2 id="7-åä½œ"><a class="markdownIt-Anchor" href="#7-åä½œ"></a> 7. åä½œ</h2><ul><li>Clientåˆ›å»ºä¸€ä¸ªConcreteCommandå¯¹è±¡å¹¶åˆ¶å®šå®ƒçš„Receiverå¯¹è±¡</li><li>æŸInvokerå¯¹è±¡å­˜å‚¨è¯¥ConcreteCommandå¯¹è±¡ã€‚</li><li>è¯¥Invokeré€šè¿‡è°ƒç”¨Commandå¯¹è±¡çš„executeæ“ä½œæ¥æäº¤ä¸€ä¸ªè¯·æ±‚ã€‚è‹¥è¯¥å‘½ä»¤æ˜¯å¯æ’¤é”€çš„ã€‚ConcreteCommandå°±åœ¨æ‰§è¡ŒExecuteæ“ä½œä¹‹å‰å­˜å‚¨å½“å‰çŠ¶æ€ä»¥ç”¨äºå–æ¶ˆè¯¥å‘½ä»¤ã€‚</li><li>ConcreteCommandå¯¹è±¡å¯¹è°ƒç”¨å®ƒçš„Receiverçš„ä¸€äº›æ“ä½œä»¥æ‰§è¡Œè¯¥è¯·æ±‚</li></ul><p>ä¸‹å›¾æ˜¯å±•ç¤ºäº†è¿™äº›å¯¹è±¡ä¹‹é—´çš„äº¤äº’çš„åºåˆ—å›¾ã€‚å®ƒè¯´æ˜äº†Commandæ˜¯å¦‚ä½•å°†è°ƒç”¨è€…å’Œæ¥å—è€…(ä»¥åŠå®ƒæ‰§è¡Œçš„è¯·æ±‚)è§£è€¦çš„ï¼š<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="å‘½ä»¤(Command)æ¨¡å¼">[2]</span></a></sup></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205092130258.png" alt="å›¾ç‰‡æ¥æºï¼šhttps://blog.csdn.net/qq_38636211/article/details/97755767?spm=1001.2014.3001.5502" /></p><h2 id="8-æ•ˆæœ"><a class="markdownIt-Anchor" href="#8-æ•ˆæœ"></a> 8. æ•ˆæœ</h2><p>Commandæ¨¡å¼æœ‰ä»¥ä¸‹çš„ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼š</p><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>Commandæ¨¡å¼å°†è°ƒç”¨æ“ä½œçš„å¯¹è±¡ä¸çŸ¥é“å¦‚ä½•å®ç°è¯¥æ“ä½œçš„å¯¹è±¡è§£è€¦ã€‚</li><li>ConcreteCommandæ˜¯å¤´ç­‰çš„å¯¹è±¡ã€‚å®ƒä»¬å¯åƒå…¶ä»–çš„å¯¹è±¡ä¸€æ ·è¢«æ“çºµå’Œæ‰©å±•</li><li>ä½ å¯ä»¥å°†å¤šä¸ªå‘½ä»¤å°è£…æˆä¸€ä¸ªå¤åˆçš„å‘½ä»¤ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¤åˆå‘½ä»¤æ˜¯Compositeæ¨¡å¼çš„ä¸€ä¸ªå®ä¾‹ã€‚</li><li>å¢åŠ æ–°çš„ConcreteCommandå¾ˆå®¹æ˜“ï¼Œå› ä¸ºè¿™ä¸ªæ— éœ€æ”¹å˜å·²æœ‰çš„ç±»ã€‚</li></ul><p><strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>ç±»çš„æ•°ç›®å¤§å¤§å¢åŠ  å®Œæˆä¸€ä¸ªç›®æ ‡éœ€è¦å¤§é‡çš„ç±»å’Œå¯¹è±¡ååŒåˆä½œã€‚åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜éœ€è¦å°å¿ƒæ­£ç¡®åœ°å¼€å‘è¿™äº›ç±»ã€‚</li><li>æå‡äº†å®ç°å’Œç»´æŠ¤çš„å·¥ä½œé‡ æ¯ä¸ªå•ç‹¬çš„å‘½ä»¤éƒ½æ˜¯ä¸€ä¸ªConcreteCommandç±»ï¼Œå®ƒå¢åŠ äº†å®ç°å’Œç»´æŠ¤çš„ç±»çš„æ•°é‡ã€‚</li></ul><h2 id="9-å®ç°"><a class="markdownIt-Anchor" href="#9-å®ç°"></a> 9. å®ç°</h2><p>å®ç°Commandæ¨¡å¼éœ€è¦è€ƒè™‘ä¸€ä¸‹é—®é¢˜ï¼š</p><ul><li><strong>ä¸€ä¸ªå‘½ä»¤å¯¹è±¡åº”è¯¥è¾¾åˆ°ä½•ç§çš„æ™ºèƒ½ç¨‹åº¦ã€‚</strong> å‘½ä»¤å¯¹è±¡çš„èƒ½åŠ›å¯å¤§å¯å°ã€‚ä¸€ä¸ªæç«¯æ˜¯å®ƒä»…ç¡®å®šä¸€ä¸ªæ¥å—è€…å’Œæ‰§è¡Œè¯¥è¯·æ±‚çš„åŠ¨ä½œã€‚å¦ä¸€æç«¯æ˜¯å®ƒè‡ªå·±å®ç°äº†æ‰€æœ‰åŠŸèƒ½ã€‚</li><li><strong>æ”¯æŒå–æ¶ˆ(undo)å’Œé‡åš(redo)</strong>ã€‚å¦‚æœCommandæä¾›æ–¹æ³•é€†è½¬(reverse)å®ƒä»¬æ“ä½œçš„æ‰§è¡Œ(ä¾‹å¦‚LightOnCommandçš„undo())ï¼Œå°±å¯ä»¥æ”¯æŒå–æ¶ˆå’Œé‡åš(ä¸¤æ¬¡æ’¤é”€å°±ç›¸å½“äºé‡åšå•Š! ä»…ä»…åªå­˜å‚¨ä¸€æ¬¡æ“ä½œæ—¶)åŠŸèƒ½ã€‚ä¸ºè¾¾åˆ°è¿™ä¸ªç›®çš„ConcreteCommandç±»å¯èƒ½éœ€è¦å­˜å‚¨é¢å¤–çš„çŠ¶æ€ä¿¡æ¯ã€‚</li><li><strong>é¿å…å–æ¶ˆæ“ä½œè¿‡ç¨‹ä¸­çš„é”™è¯¯ç´¯ç§¯</strong>ã€‚</li><li><strong>ä½¿ç”¨C++æ¨¡æ¿ã€‚</strong> å¯¹äºä¸èƒ½æ’¤é”€å’Œä¸éœ€è¦å‚æ•°çš„å‘½ä»¤ï¼Œå¯ä½¿ç”¨C++æ¨¡æ¿æ¥å®ç°ï¼Œè¿™æ ·å¯ä»¥é¿å…ä¸ºæ¯ä¸€ç§åŠ¨ä½œå’Œæ¥æ”¶è€…éƒ½åˆ›å»ºä¸€ä¸ªCommandå­ç±»ã€‚</li></ul><h2 id="10-ç¤ºä¾‹ä»£ç "><a class="markdownIt-Anchor" href="#10-ç¤ºä¾‹ä»£ç "></a> 10. ç¤ºä¾‹ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Command.h</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/5/8.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> BEHAVIORALPATTERNDESIGN_COMMAND_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> BEHAVIORALPATTERNDESIGN_COMMAND_H</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_command</span><span class="hljs-params">()</span></span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @brief å‚è€ƒï¼šhttp://c.biancheng.net/view/1380.html</span><br><span class="hljs-comment"> * æ¨¡æ‹Ÿåœºæ™¯ï¼šä¸€ä¸ªé¤é¦†å¯ä»¥å¯¹æä¾›å¤šä¸ªåŠŸèƒ½ï¼ˆæŠ½è±¡æˆå‘½ä»¤ï¼‰ï¼Œè€Œè¿™äº›åŠŸèƒ½/å‘½ä»¤å…·ä½“ç”±ç‰¹åˆ«çš„äººç‰©è´Ÿè´£ï¼Œ</span><br><span class="hljs-comment"> * ä¾‹å¦‚é¥­èœç”±å¨å¸ˆè´Ÿè´£ï¼Œæ”¶æ‹¾ç”±æœåŠ¡å‘˜è´Ÿè´£ï¼Œæ”¶é“¶ç”±æ”¶é“¶å‘˜è´Ÿè´£</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-comment">// å¨å¸ˆï¼Œç›¸å½“äº Receiver ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Chief</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">cook</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;å¤§å¨æ­£åœ¨çƒ§èœ...&quot;</span> &lt;&lt; endl;<br>        cout &lt;&lt; <span class="hljs-string">&quot;èœçƒ§å¥½äº†ï¼&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// æœåŠ¡å‘˜ï¼Œç›¸å½“äº Receiver ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Waiter</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">clean_table</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;æœåŠ¡å‘˜æ­£åœ¨æ¸…ç†æ¡Œé¢...&quot;</span> &lt;&lt; endl;<br>        cout &lt;&lt; <span class="hljs-string">&quot;æ¡Œé¢ç†å¥½äº†ï¼&quot;</span> &lt;&lt; endl;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">serve_meal</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;æœåŠ¡å‘˜æ­£åœ¨ä¸Šèœ...&quot;</span> &lt;&lt; endl;<br>    &#125;<br><br>&#125;;<br><br><span class="hljs-comment">// æ”¶é“¶å‘˜ï¼Œç›¸å½“äº Receiver ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cashier</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">checkout</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;æ”¶é“¶å‘˜ç»“è´¦&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// æœåŠ¡ï¼Œç›¸å½“äºæŠ½è±¡å‡ºæ¥çš„ Commandç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Service</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">serve</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;<br>&#125;;<br><br><span class="hljs-comment">// æä¾›é¤é£Ÿï¼Œè¿™æ˜¯ä¸€ä¸ªç»„åˆå‘½ä»¤ï¼Œå¨å¸ˆåšèœï¼Œç„¶åæœåŠ¡å‘˜ç«¯èœ</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProvideMeal</span> :</span> <span class="hljs-keyword">public</span> Service &#123;<br><span class="hljs-keyword">private</span>:<br>    Chief *chief;<br>    Waiter *waiter;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">ProvideMeal</span>(Chief *chief, Waiter *waiter) : <span class="hljs-built_in">chief</span>(chief), <span class="hljs-built_in">waiter</span>(waiter) &#123;<br><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">serve</span><span class="hljs-params">()</span> </span>&#123;<br>        chief-&gt;<span class="hljs-built_in">cook</span>();<br>        waiter-&gt;<span class="hljs-built_in">serve_meal</span>();<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// æ”¶æ‹¾ç¢—ç­·</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CleanUp</span> :</span> <span class="hljs-keyword">public</span> Service &#123;<br><span class="hljs-keyword">private</span>:<br>    Waiter *waiter;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">CleanUp</span>(Waiter *waiter) : <span class="hljs-built_in">waiter</span>(waiter) &#123;<br><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">serve</span><span class="hljs-params">()</span> </span>&#123;<br>        waiter-&gt;<span class="hljs-built_in">clean_table</span>();<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// æ”¶é“¶</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cashiering</span> :</span> <span class="hljs-keyword">public</span> Service &#123;<br><span class="hljs-keyword">private</span>:<br>    Cashier *cashier;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Cashiering</span>(Cashier *cashier) : <span class="hljs-built_in">cashier</span>(cashier) &#123;<br><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">serve</span><span class="hljs-params">()</span> </span>&#123;<br>        cashier-&gt;<span class="hljs-built_in">checkout</span>();<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// é¤é¦†ï¼Œç›¸å½“äº Invokerç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Restaurant</span> &#123;</span><br><span class="hljs-keyword">private</span>:<br>    Service *meal;<br>    Service *clean;<br>    Service *cash;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Restaurant</span>(Service *meal, Service *clean, Service *cash) : <span class="hljs-built_in">meal</span>(meal), <span class="hljs-built_in">clean</span>(clean), <span class="hljs-built_in">cash</span>(cash) &#123;<br><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">serve_client</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;é£Ÿå®¢è¿›å…¥é¤é¦†...&quot;</span> &lt;&lt; endl;<br>        meal-&gt;<span class="hljs-built_in">serve</span>();<br><br><br>        cout &lt;&lt; <span class="hljs-string">&quot;\né£Ÿå®¢ç”¨é£Ÿå®Œæ¯•...&quot;</span> &lt;&lt; endl;<br>        cash-&gt;<span class="hljs-built_in">serve</span>();<br><br>        cout &lt;&lt; <span class="hljs-string">&quot;\né£Ÿå®¢ç¦»å¼€é¤é¦†...&quot;</span> &lt;&lt; endl;<br>        clean-&gt;<span class="hljs-built_in">serve</span>();<br>    &#125;<br><br>&#125;;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//BEHAVIORALPATTERNDESIGN_COMMAND_H</span></span><br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Command.cpp</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/5/8.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;Command.h&quot;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_command</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯• Command  å‘½ä»¤æ¨¡å¼â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br><br>    Service *meal = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ProvideMeal</span>(<span class="hljs-keyword">new</span> Chief, <span class="hljs-keyword">new</span> Waiter);<br>    Service *clean = <span class="hljs-keyword">new</span> <span class="hljs-built_in">CleanUp</span>(<span class="hljs-keyword">new</span> Waiter);<br>    Service *cash = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Cashiering</span>(<span class="hljs-keyword">new</span> Cashier);<br><br>    <span class="hljs-function">Restaurant <span class="hljs-title">restaurant</span><span class="hljs-params">(meal, clean, cash)</span></span>;<br>    restaurant.<span class="hljs-built_in">serve_client</span>();<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯• Command å‘½ä»¤æ¨¡å¼â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="11-ç›¸å…³æ¨¡å¼"><a class="markdownIt-Anchor" href="#11-ç›¸å…³æ¨¡å¼"></a> 11. ç›¸å…³æ¨¡å¼</h2><ul><li><p><strong>Composite</strong>(ç»„åˆ)æ¨¡å¼ï¼š å¯ä»¥ä½¿ç”¨ç»„åˆæ¨¡å¼æ¥å®ç°å®å‘½ä»¤</p></li><li><p><strong>Memento</strong>(å¤‡å¿˜å½•)æ¨¡å¼ï¼š å¯ç”¨æ¥ä¿æŒæŸä¸ªçŠ¶æ€ï¼Œå‘½ä»¤ç”¨è¿™ä¸€çŠ¶æ€æ¥å–æ¶ˆå®ƒçš„æ•ˆæœã€‚</p></li><li><p><strong>Proxytype</strong>(åŸå‹)æ¨¡å¼ï¼š åœ¨è¢«æ”¾å…¥å†å²åˆ—è¡¨å‰å¿…é¡»è¢«æ‹·è´çš„å‘½ä»¤å¯ä»¥èµ·åˆ°ä¸€ç§åŸå‹çš„ä½œç”¨</p></li></ul><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://blog.csdn.net/qq_38636211/article/details/97762272">è´£ä»»é“¾(Chain of Responsibility)æ¨¡å¼_é¥­å›¢å°ç¥çš„åšå®¢-CSDNåšå®¢_è´£ä»»é“¾</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://blog.csdn.net/qq_38636211/article/details/97755767?spm=1001.2014.3001.5502">å‘½ä»¤(Command)æ¨¡å¼</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¼–ç¨‹æŠ€å·§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€é¢è¯•æ™ºåŠ›é¢˜ã€‘100åŒ¹é©¬ä¸­æ‰¾å‡ºæœ€å¿«çš„4åŒ¹</title>
    <link href="/2022/05/07/2022-05/2022-05-07%20%E3%80%90%E9%9D%A2%E8%AF%95%E6%99%BA%E5%8A%9B%E9%A2%98%E3%80%91/"/>
    <url>/2022/05/07/2022-05/2022-05-07%20%E3%80%90%E9%9D%A2%E8%AF%95%E6%99%BA%E5%8A%9B%E9%A2%98%E3%80%91/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>ä¹‹å‰è…¾è®¯é¢è¯•çš„æ—¶å€™ï¼Œå‡ºäº†ä¸€é“æ™ºåŠ›é¢˜ï¼Œè·Ÿèµ›é©¬ç›¸å…³çš„ï¼Œå¤§æ„å°±æ˜¯æ€»å…±100åŒ¹é©¬ï¼Œå…±æœ‰4æ¡èµ›é“ï¼Œè¯·é—®æœ€å°‘æ¯”èµ›å‡ æ¬¡å°±èƒ½é€‰å‡ºæœ€å¿«çš„4åŒ¹é©¬ï¼Œå‡è®¾æ¯”èµ›ä¸èƒ½è®¡æ—¶ï¼Œåªèƒ½æ¯”è¾ƒå¿«æ…¢ã€‚</p><p>è¿™ä¸å·§äº†å—ï¼Œæ­£å¥½æœ€è¿‘æˆ‘åœ¨çœ‹èµ›é©¬å¨˜2ï¼Œå¯¹èµ›é©¬ä¹Ÿæ˜¯ç•¥çŸ¥ä¸€äºŒï¼Œè¿™é¢˜ï¼Œæ‹¿ä¸‹ï¼</p><p>å’³å’³ï¼Œä¸å¥½æ„æ€ï¼Œå¥½åƒæ¤å…¥äº†ä¸€æ®µå¹¿å‘Šï¼ˆdogeï¼‰ã€‚ä¸è¿‡æ®‹é…·çš„ç°å®æ˜¯ï¼Œå½“æ—¶å®Œå…¨æ²¡æœ‰å¥½çš„æ€è·¯ï¼Œå°±æƒ³ç€ä¾æ¬¡é€‰å‡ºæœ€å¿«çš„é©¬ï¼Œç„¶åè¢«æœ€å¿«çš„é©¬æ·˜æ±°çš„å†æ¯”è¾ƒï¼Œé€‰å‡ºç¬¬äºŒå¿«çš„é©¬ï¼Œå®é™…å†™èµ·æ¥çš„æ—¶å€™æ€è·¯å°±ä¹±ç³Ÿç³Ÿçš„ï¼Œå¯èƒ½ä¹Ÿæ˜¯å› ä¸ºé¢è¯•ç´§å¼ çš„åŸå› å§ã€‚ä½†ç°åœ¨å›è¿‡ç¥æ¥ï¼Œå†·é™æ€è€ƒåˆ†æåï¼Œæ„Ÿè§‰è¿˜æ˜¯å¯ä»¥è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹æˆ‘çš„æ€è·¯ã€‚</p><h1 id="è§£é¢˜æ€è·¯"><a class="markdownIt-Anchor" href="#è§£é¢˜æ€è·¯"></a> è§£é¢˜æ€è·¯</h1><p>ç½‘ä¸Šç±»ä¼¼çš„å‚è€ƒæ–‡ç« æœ‰ï¼š</p><ul><li><p><a href="https://zhuanlan.zhihu.com/p/189771676">100åŒ¹é©¬ï¼Œ4ä¸ªèµ›é“ï¼Œæ‰¾å‡ºè·‘æœ€å¿«çš„4åŒ¹é©¬ã€‚</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/351556354">64åŒ¹é©¬ï¼Œ8ä¸ªèµ›é“ï¼Œæ‰¾å‡ºæœ€å¿«çš„4åŒ¹é©¬ï¼Œè¦æ¯”èµ›å¤šå°‘è½®ï¼Ÿï¼ˆå»¶ä¼¸åˆ°ä¸€èˆ¬æƒ…å†µï¼‰</a></p></li></ul><p>éƒ½æä¾›äº†ä¸é”™çš„æ€è·¯ï¼Œç„¶åæˆ‘ä¹Ÿæ˜¯è‡ªå·±å†å°è¯•è®¡ç®—äº†ä¸€ä¸‹ï¼Œæœ€åç®—å‡ºæ¥æœ€å°‘éœ€è¦36è½®ï¼Œå¯èƒ½ä¹Ÿä¸æ˜¯æœ€å‡†ç¡®çš„ï¼Œä¸‹é¢å°±ä»‹ç»ä¸€ä¸‹æˆ‘çš„æ€è·¯ã€‚</p><ol><li><p>é¦–å…ˆ100åŒ¹é©¬ï¼Œåˆ†æˆ25ç»„ï¼Œ<strong>æ¯”èµ›25æ¬¡</strong>ï¼Œæ¯”è¾ƒå‡ºæ¯ç»„çš„1234åã€‚ï¼ˆç»„å·è¡¨ç¤ºä¸º1ã€2ã€3 â€¦ 25 ï¼Œ 1-1 è¡¨ç¤ºç¬¬1ç»„çš„ç¬¬1åï¼‰</p></li><li><p>é€‰å‡ºæ¯ç»„çš„ç¬¬ä¸€åï¼Œé‚£ä¹ˆæ€»å…±æœ‰25åŒ¹é©¬ï¼Œåˆ†æˆ7ç»„ï¼Œå‰6ç»„éƒ½æ˜¯4åŒ¹é©¬ï¼Œæœ€åä¸€ç»„åªæœ‰ä¸€åŒ¹é©¬ï¼ˆç»„å·è¡¨ç¤ºä¸º Aã€Bã€Cã€Dã€Eã€Fã€Gï¼Œ ç”¨å­—æ¯è¡¨ç¤ºï¼ŒA-1 è¡¨ç¤ºç¬¬Aç»„çš„ç¬¬1åï¼ŒGç»„åªæœ‰ä¸€åŒ¹é©¬å°±æ˜¯25-1ï¼‰ï¼›<strong>å‰6ç»„æ¯”èµ›6æ¬¡</strong>ï¼Œåˆé€‰å‡ºæ¯ç»„1234å</p></li><li><p>A-1ã€B-1ã€C-1ã€D-1 æ¯”èµ›ä¸€æ¬¡ï¼Œç„¶åæ‹¿è¿™ä¸€æ¬¡çš„ç¬¬1åå’Œ E-1ã€F-1ã€G-1è¿›è¡Œæ¯”èµ›ï¼Œæ­¤æ—¶å°±èƒ½<strong>é€‰å‡ºæœ€å¿«çš„ä¸€åŒ¹é©¬</strong>ï¼Œ<strong>è‡³æ­¤å…±æ¯”èµ›äº† 25+6+2 = 33æ¬¡</strong></p></li><li><p>ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œä¸å¦¨è®¾ä¸Šä¸€æ­¥æ¯”èµ›ä¸­ï¼Œæœ€å¿«çš„æ˜¯A-1ï¼ˆå…¶å®é€‰A-1ã€B-1ã€C-1ã€D-1ã€E-1ã€F-1éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥æ›¿æ¢ã€‚è€Œå¦‚æœæœ€å¿«çš„æ˜¯G-1 ï¼Œä¼šå…·æœ‰ç‰¹æ®Šæ€§ï¼Œéœ€è¦å†æ¯”è¾ƒçš„é©¬çš„æ•°é‡æ›´å°‘ï¼ˆå› ä¸ºG-1ä¹‹å‰åªè·Ÿ3åŒ¹é©¬æ¯”èµ›è¿‡ï¼‰ï¼Œæ‰€ä»¥è¦è®¡ç®—æœ€å°‘çš„æ¯”èµ›æ¬¡æ•°ä¸èƒ½é€‰G-1ã€‚</p><ul><li>è¿›ä¸€æ­¥å‡è®¾ï¼Œä¸å¦¨è®¤ä¸ºä¸Šä¸€æ­¥ä¸­ä¸¤æ¬¡æ¯”èµ›çš„æ’åä¸º A-1ã€B-1ã€C-1ã€D-1 å’Œ A-1ã€E-1ã€F-1ã€G-1ï¼Œå› ä¸ºè°ƒæ¢é¡ºåºä¹Ÿä¸å½±å“ä¸‹é¢çš„è®¡ç®—</li></ul></li><li><p>å› ä¸ºA-1æ˜¯æœ€å¿«çš„é©¬ï¼Œè€Œç°åœ¨è¦é€‰å‡ºç¬¬2å¿«çš„é©¬ï¼Œé‚£ä¹ˆç¬¬2å¿«çš„é©¬å°±æœ‰å¯èƒ½å‡ºç°åœ¨è¢«A-1æ·˜æ±°çš„é©¬ä¸­ã€‚ä¸å¦¨è¿›ä¸€æ­¥å°†è®¾ï¼ŒAç»„æ¯”èµ›çš„ç»“æœä¸º  1-1 ã€2-1ã€3-1ã€4-1 ï¼Œå³ A-1 ä¸º 1-1ï¼Œä»¥æ­¤ç±»æ¨ B-1ä¸º5-1 ã€‚é‚£ä¹ˆç¬¬2å¿«çš„é©¬å¯èƒ½çš„é›†åˆä¸º { 1-2 ã€2-1/A-2ã€B-1ã€E-1  }  ï¼Œæ­¤æ—¶<strong>åªè¦å†æ¯”èµ›1æ¬¡</strong>ï¼Œ<strong>å°±èƒ½é€‰å‡ºç¬¬2å¿«çš„é©¬</strong>ã€‚</p></li><li><p>åœ¨ä¸Šä¸€æ­¥çš„æ¯”èµ›ç»“æœä¸­ï¼Œå¦‚æœ1-2æ˜¯ç¬¬ä¸€åï¼Œé‚£ä¹ˆåªè¦æ‹¿ç¬¬äºŒåå’Œ1-3æ¯”èµ›å°±èƒ½é€‰å‡ºç¬¬3å¿«çš„é©¬ï¼Œè€Œå¦‚æœ2-1ã€B-1ã€E-1 æ˜¯ç¬¬ä¸€åï¼Œéƒ½æ˜¯å†æ‹¿å‡º2åŒ¹é©¬å’Œç¬¬äºŒåæ¯”è¾ƒï¼ˆä¾‹å¦‚ï¼Œé€‰2-1ï¼Œåˆ™è¦æ¯”è¾ƒ 3-1/A-3å’Œ2-2ï¼›é€‰B-1å³ 5-1ï¼Œåˆ™è¦æ¯”è¾ƒ 6-1/B-2 å’Œ 5-2ï¼‰ï¼Œæ‰€ä»¥<strong>åªè¦å†æ¯”èµ›1æ¬¡</strong>ï¼Œ<strong>å°±èƒ½é€‰å‡ºç¬¬3å¿«çš„é©¬</strong>ã€‚</p></li><li><p>åŒç†ï¼Œåœ¨ä¸Šä¸€æ¬¡æ¯”èµ›ç»“æœçš„åŸºç¡€ä¸Šï¼Œæœ€å¤šå†é€‰å‡º2åŒ¹é©¬å’Œä¸Šæ¬¡æ¯”èµ›çš„ç¬¬äºŒå</p><p>æ¯”èµ›1æ¬¡ï¼Œå°±èƒ½é€‰å‡ºç¬¬4å¿«çš„é©¬ã€‚</p><ul><li>ä¾‹å¦‚ä¸Šæ¬¡æ¯”èµ›ç»“æœä¸º { 6-1/B-2ã€5-2ã€17-1/E-1 } ï¼Œé‚£ä¹ˆåªè¦ä» { 6-2ã€7-1/B-3ã€5-2 } é‡Œå†æ¯”ä¸€æ¬¡å³å¯ã€‚</li></ul></li><li><p>æœ€ç»ˆï¼Œæœ€å°‘éœ€è¦çš„æ¯”èµ›æ¬¡æ•°ä¸º 25+6+2+1+1+1 = 36 æ¬¡</p></li></ol><hr /><p>ä¸‹å›¾æ¼”ç¤ºäº†å…¶ä¸­ä¸€ç§å¯èƒ½çš„æ¯”èµ›æƒ…å†µï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205072105132.png" alt="ä¸€ç§å¯èƒ½æ¯”èµ›æƒ…å†µ" /></p><h1 id="å°ç»“"><a class="markdownIt-Anchor" href="#å°ç»“"></a> å°ç»“</h1><p>æœ€åå°ç»“ä¸€ä¸‹ï¼Œé‡åˆ°è¿™ç§æ™ºåŠ›é¢˜ï¼Œä¹Ÿä¸è¦è¿‡äºæ…Œå¼ å§ï¼Œæœ‰ä»€ä¹ˆæ€è·¯å°±è¡¨è¾¾å‡ºæ¥ï¼Œè™½ç„¶ä¸ä¸€å®šå‡†ç¡®ï¼Œ ä½†è¡¨è¾¾çš„æ—¶å€™è¦æ³¨æ„æ€æ€è·¯æ¸…æ™°ï¼Œä¸è¦å› ä¸ºæ„Ÿè§‰è¿™ä¸ªæ€è·¯ä¸å¯¹æˆ–è€…è‡ªå·±åšä¸å‡ºæ¥ï¼Œå°±è‡ªæš´è‡ªå¼ƒï¼Œåœ¨å¿ƒåº•å‘Šè¯‰è‡ªå·±è¿™æ¬¡ä¸è¡Œäº†ï¼Œé¢è¯•å˜›ï¼Œè¦ç¬‘ç€é¢~</p><p>æœ€åçš„æœ€åï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å»çœ‹çœ‹èµ›é©¬å¨˜2å§~</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205072114453.jpg" alt="" /></p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>é¢è¯•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ™ºåŠ›é¢˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€è®¾è®¡æ¨¡å¼ã€‘å¤–è§‚æ¨¡å¼ä¸ä»£ç†æ¨¡å¼</title>
    <link href="/2022/04/30/2022-04/2022-04-30%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E4%B8%8E%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
    <url>/2022/04/30/2022-04/2022-04-30%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F%E4%B8%8E%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="facadeå¤–è§‚å¯¹è±¡ç»“æ„æ¨¡å¼"><a class="markdownIt-Anchor" href="#facadeå¤–è§‚å¯¹è±¡ç»“æ„æ¨¡å¼"></a> Facadeï¼ˆå¤–è§‚ï¼‰â€”â€”å¯¹è±¡ç»“æ„æ¨¡å¼</h1><h2 id="1-æ„å›¾"><a class="markdownIt-Anchor" href="#1-æ„å›¾"></a> 1. æ„å›¾</h2><p>ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢ï¼ŒFacadeæ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨ã€‚</p><h2 id="2-åŠ¨æœº"><a class="markdownIt-Anchor" href="#2-åŠ¨æœº"></a> 2. åŠ¨æœº</h2><p>å°†ä¸€ä¸ªç³»ç»Ÿåˆ’åˆ†æˆè‹¥å¹²ä¸ªå­ç³»ç»Ÿæœ‰åˆ©äºé™ä½ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚ä¸€ä¸ªå¸¸è§çš„è®¾è®¡ç›®æ ‡æ˜¯ä½¿å­ç³»ç»Ÿé—´çš„é€šä¿¡å’Œç›¸äº’ä¾èµ–å…³ç³»è¾¾åˆ°æœ€å°ã€‚è¾¾åˆ°è¯¥ç›®æ ‡çš„é€”ç»ä¹‹ä¸€å°±æ˜¯å¼•å…¥ä¸€ä¸ªå¤–è§‚ï¼ˆFacadeï¼‰å¯¹è±¡ï¼Œä»–ä¸ºå­ç³»ç»Ÿä¸­è¾ƒä¸ºä¸€èˆ¬çš„è®¾æ–½æä¾›äº†ä¸€ä¸ªå•ä¸€è€Œç®€å•çš„ç•Œé¢ã€‚</p><h2 id="3-é€‚ç”¨æ€§"><a class="markdownIt-Anchor" href="#3-é€‚ç”¨æ€§"></a> 3. é€‚ç”¨æ€§</h2><p>ä»¥ä¸‹æƒ…å†µä½¿ç”¨Facadeæ¨¡å¼ï¼š</p><ul><li>å½“ä½ è¦ä¸ºä¸€ä¸ªå¤æ‚å­ç³»ç»Ÿæä¾›ä¸€ä¸ªç®€å•æ¥å£æ—¶ã€‚å­ç³»ç»Ÿå¾€å¾€å› ä¸ºä¸æ–­æ¼”åŒ–è€Œå˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œå¤§å¤šæ•°æ¨¡å¼ä½¿ç”¨æ—¶éƒ½ä¼šäº§ç”Ÿæ›´å¤šæ›´å°çš„ç±»ã€‚è¿™ä½¿å¾—å­ç³»ç»Ÿå…·æœ‰å¯å¤ç”¨æ€§ï¼Œä¹Ÿæ›´å®¹æ˜“å¯¹å­ç³»ç»Ÿè¿›è¡Œå®šåˆ¶ï¼Œä½†ä¹Ÿç»™é‚£äº›ä¸éœ€è¦å®šåˆ¶å­ç³»ç»Ÿçš„ç”¨æˆ·å¸¦æ¥ä¸€äº›ä½¿ç”¨ä¸Šçš„å›°éš¾ã€‚Facadeå¯ä»¥æä¾›ä¸€ä¸ªç®€å•çš„ç¼ºçœè§†å›¾ï¼Œè¿™ä¸€è§†å›¾å¯¹å¤§å¤šæ•°ç”¨æˆ·æ¥è¯´å·²ç»è¶³å¤Ÿï¼Œè€Œé‚£äº›éœ€è¦æ›´å¤šå¯å®šåˆ¶æ€§çš„ç”¨æˆ·å¯ä»¥è¶Šè¿‡Facadeå±‚ã€‚</li><li>å®¢æˆ·ç¨‹åºä¸æŠ½è±¡ç±»çš„å®ç°éƒ¨åˆ†ä¹‹é—´å­˜åœ¨ç€å¾ˆå¤§çš„ä¾èµ–æ€§ã€‚å¼•å…¥Facadeå°†è¿™ä¸ªå­ç³»ç»Ÿä¸å®¢æˆ·åŠå…¶ä»–çš„å­ç³»ç»Ÿåˆ†ç¦»ï¼Œå¯ä»¥æé«˜å­ç³»ç»Ÿçš„ç‹¬ç«‹æ€§å’Œå¯ç§»æ¤æ€§ã€‚</li><li>å½“ä½ éœ€è¦æ„å»ºä¸€ä¸ªå±‚æ¬¡ç»“æ„çš„ç³»ç»Ÿæ—¶ï¼Œä½¿ç”¨Facadeæ¨¡å¼å®šä¹‰å­ç³»ç»Ÿä¸­æ¯å±‚çš„å…¥å£ç‚¹ã€‚å¦‚æœå­ç³»ç»Ÿä¹‹é—´æ˜¯ç›¸äº’ä¾èµ–çš„ï¼Œå¯ä»¥è®©å®ƒä»¬ä»…é€šè¿‡Facadeè¿›è¡Œé€šä¿¡ï¼Œä»è€Œç®€åŒ–äº†å®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li></ul><h2 id="4-ç»“æ„"><a class="markdownIt-Anchor" href="#4-ç»“æ„"></a> 4. ç»“æ„</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204301544750.jpeg" alt="ç»“æ„å›¾" /></p><h2 id="5-å‚ä¸è€…"><a class="markdownIt-Anchor" href="#5-å‚ä¸è€…"></a> 5. å‚ä¸è€…</h2><ul><li>Facade<ul><li>çŸ¥é“å“ªäº›å­ç³»ç»Ÿç±»è´Ÿè´£å¤„ç†è¯·æ±‚</li><li>å°†å®¢æˆ·çš„è¯·æ±‚ä»£ç†ç»™é€‚å½“çš„å­ç³»ç»Ÿå¯¹è±¡</li></ul></li><li>Subsystem Class<ul><li>å®ç°å­ç³»ç»Ÿçš„åŠŸèƒ½</li><li>å¤„ç†ç”±Facadeå¯¹è±¡æŒ‡æ´¾çš„ä»»åŠ¡</li><li>æ²¡æœ‰Facadeçš„ä»»ä½•ç›¸å…³ä¿¡æ¯ï¼Œå³æ²¡æœ‰æŒ‡å‘Facadeçš„æŒ‡é’ˆ</li></ul></li></ul><h2 id="6-åä½œ"><a class="markdownIt-Anchor" href="#6-åä½œ"></a> 6. åä½œ</h2><ul><li>å®¢æˆ·ç¨‹åºé€šè¿‡å‘é€è¯·æ±‚ç»™Facadeçš„æ–¹å¼ä¸å­ç³»ç»Ÿé€šä¿¡ï¼ŒFacadeå°†è¿™äº›æ¶ˆæ¯è½¬å‘ç»™é€‚å½“çš„å­ç³»ç»Ÿå¯¹è±¡ã€‚å°½ç®¡æ˜¯å­ç³»ç»Ÿä¸­çš„æœ‰å…³å¯¹è±¡åœ¨åšå®é™…å·¥ä½œï¼Œä½†Facadeæ¨¡å¼æœ¬èº«ä¹Ÿå¿…é¡»å°†å®ƒçš„æ¥å£è½¬æ¢æˆå­ç³»ç»Ÿçš„æ¥å£ã€‚</li><li>ä½¿ç”¨Facadeçš„å®¢æˆ·ç¨‹åºä¸éœ€è¦ç›´æ¥è®¿é—®å­ç³»ç»Ÿå¯¹è±¡ã€‚</li></ul><h2 id="7-æ•ˆæœ"><a class="markdownIt-Anchor" href="#7-æ•ˆæœ"></a> 7. æ•ˆæœ</h2><p>Facadeæ¨¡å¼æœ‰ä¸‹é¢çš„ä¸€äº›æœ‰ç‚¹ï¼š</p><ul><li>å®ƒå¯¹å®¢æˆ·å±è”½å­ç³»ç»Ÿç»„ä»¶ï¼Œå› è€Œå‡å°‘äº†å®¢æˆ·å¤„ç†çš„å¯¹è±¡æ•°ç›®å¹¶ä½¿å¾—å­ç³»ç»Ÿä½¿ç”¨èµ·æ¥æ›´åŠ æ–¹ä¾¿</li><li>å®ƒå®ç°äº†å­ç³»ç»Ÿä¸å®¢æˆ·ä¹‹é—´çš„æ¾è€¦åˆå…³ç³»ï¼Œè€Œå­ç³»ç»Ÿå†…éƒ¨çš„åŠŸèƒ½ç»„ä»¶å¾€å¾€æ˜¯ç´§è€¦åˆçš„ã€‚æ¾è€¦åˆå…³ç³»ä½¿å¾—å­ç³»ç»Ÿçš„ç»„ä»¶å˜åŒ–ä¸ä¼šå½±å“åˆ°å®ƒçš„å®¢æˆ·ã€‚Facadeæ¨¡å¼æœ‰åŠ©äºå»ºç«‹å±‚æ¬¡ç»“æ„ç³»ç»Ÿï¼Œä¹Ÿæœ‰åŠ©äºå¯¹å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»åˆ†å±‚ã€‚Facadeæ¨¡å¼å¯ä»¥æ¶ˆé™¤å¤æ‚çš„å¾ªç¯ä¾èµ–å…³ç³»ã€‚åœ¨å¤§å‹è½¯ä»¶ç³»ç»Ÿä¸­é™ä½ç¼–è¯‘ä¾èµ–æ€§è‡³å…³é‡è¦ã€‚</li><li>å¦‚æœåº”ç”¨éœ€è¦ï¼Œå®ƒå¹¶ä¸é™åˆ¶ä»–ä»¬ä½¿ç”¨å­ç³»ç»Ÿç±»ï¼Œå› æ­¤ä½ å¯ä»¥åœ¨ç³»ç»Ÿæ˜“ç”¨æ€§å’Œé€šç”¨æ€§ä¹‹é—´åŠ ä»¥é€‰æ‹©ã€‚</li></ul><h2 id="8-ç¤ºä¾‹ä»£ç "><a class="markdownIt-Anchor" href="#8-ç¤ºä¾‹ä»£ç "></a> 8. ç¤ºä¾‹ä»£ç </h2><p>æµ‹è¯•æ¨¡æ‹Ÿåœºæ™¯ï¼ŒClient é€šè¿‡ Painter è¿™ä¸ª Facadeï¼Œæ¥ç»˜åˆ¶å›¾å½¢ï¼Œæ ¹æ®éœ€æ±‚æ”¹å˜å¤§å°å’Œå¡«å……é¢œè‰²ï¼Œéšè—å…·ä½“å®ç°ç»†èŠ‚åŒ…æ‹¬ å›¾å½¢Shapeï¼Œé¢œè‰²Colorï¼Œçº¿æ¡è¾¹æ¡†Lineã€‚ç±»å›¾å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸ºäº†ç®€åŒ–å®ç°ï¼Œæ‰€ä»¥è€ƒè™‘å„å­ç³»ç»Ÿä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204301544778.jpeg" alt="ç±»å›¾" /></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Facade.h</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/30.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unordered_map&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> STRUCTURALPATTERNDESIGN_FACADE_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> STRUCTURALPATTERNDESIGN_FACADE_H</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @brief æ¨¡æ‹Ÿåœºæ™¯ï¼ŒClient é€šè¿‡ Painter è¿™ä¸ª Facadeï¼Œæ¥ç»˜åˆ¶å›¾å½¢ï¼Œæ ¹æ®éœ€æ±‚æ”¹å˜å¤§å°å’Œå¡«å……é¢œè‰²</span><br><span class="hljs-comment"> * éšè—å…·ä½“å®ç°ç»†èŠ‚åŒ…æ‹¬ å›¾å½¢Shapeï¼Œé¢œè‰²Colorï¼Œçº¿æ¡è¾¹æ¡†Line</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-keyword">namespace</span> facade &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_facade</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Shape</span>&#123;</span><br>    <span class="hljs-keyword">public</span>:<br>        <span class="hljs-built_in">Shape</span>(<span class="hljs-keyword">int</span> size = <span class="hljs-number">0</span>) : <span class="hljs-built_in">size</span>(size) &#123;&#125;<br>        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_size</span><span class="hljs-params">(<span class="hljs-keyword">int</span> size)</span> </span>&#123;<br>            <span class="hljs-keyword">this</span>-&gt;size = size;<br>        &#125;<br>        <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">draw_shape</span><span class="hljs-params">()</span> </span>&#123;&#125;<br><br>    <span class="hljs-keyword">protected</span>:<br>        <span class="hljs-keyword">int</span> size;<br>    &#125;;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Rectangle</span> :</span> <span class="hljs-keyword">public</span> Shape&#123;<br>    <span class="hljs-keyword">public</span>:<br>        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">draw_shape</span><span class="hljs-params">()</span> </span>&#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;ç»˜åˆ¶ä¸€ä¸ªé•¿æ–¹å½¢ï¼Œsizeä¸º&quot;</span> &lt;&lt; size &lt;&lt; endl;<br>        &#125;<br>    &#125;;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Circle</span> :</span> <span class="hljs-keyword">public</span> Shape&#123;<br>    <span class="hljs-keyword">public</span>:<br>        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">draw_shape</span><span class="hljs-params">()</span> </span>&#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;ç»˜åˆ¶ä¸€ä¸ªåœ†å½¢ï¼Œsizeä¸º&quot;</span> &lt;&lt; size &lt;&lt; endl;<br>        &#125;<br>    &#125;;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Color</span> &#123;</span><br>    <span class="hljs-keyword">public</span>:<br>        <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">fill_color</span><span class="hljs-params">()</span> </span>&#123;&#125;<br>    &#125;;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Red</span> :</span> <span class="hljs-keyword">public</span> Color &#123;<br>        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">fill_color</span><span class="hljs-params">()</span> </span>&#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;å¡«å……çº¢è‰²&quot;</span> &lt;&lt; endl;<br>        &#125;<br>    &#125;;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Blue</span> :</span> <span class="hljs-keyword">public</span> Color &#123;<br>        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">fill_color</span><span class="hljs-params">()</span> </span>&#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;å¡«å……è“è‰²&quot;</span> &lt;&lt; endl;<br>        &#125;<br>    &#125;;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Line</span> &#123;</span><br>    <span class="hljs-keyword">public</span>:<br>        <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">draw_line</span><span class="hljs-params">()</span> </span>&#123;&#125;<br>    &#125;;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SolidLine</span> :</span> <span class="hljs-keyword">public</span> Line &#123;<br>    <span class="hljs-keyword">public</span>:<br>        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">draw_line</span><span class="hljs-params">()</span> </span>&#123;<br>           cout &lt;&lt; <span class="hljs-string">&quot;ç»˜åˆ¶å®çº¿è¾¹æ¡†&quot;</span> &lt;&lt; endl;<br>        &#125;<br>    &#125;;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DottedLine</span> :</span> <span class="hljs-keyword">public</span> Line &#123;<br>    <span class="hljs-keyword">public</span>:<br>        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">draw_line</span><span class="hljs-params">()</span> </span>&#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;ç»˜åˆ¶è™šçº¿è¾¹æ¡†&quot;</span> &lt;&lt; endl;<br>        &#125;<br>    &#125;;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Painter</span> &#123;</span><br>    <span class="hljs-keyword">public</span>:<br>        <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">ShapeType</span> &#123;</span><br>            Rectangle,<br>            Circle<br>        &#125;;<br>        <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">ColorType</span>&#123;</span><br>            Red,<br>            Blue<br>        &#125;;<br>        <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">LineType</span> &#123;</span><br>            SolidLine,<br>            DottedLine<br>        &#125;;<br><br>        <span class="hljs-built_in">Painter</span>() &#123;<br>            shape_map[Rectangle] = <span class="hljs-keyword">new</span> class Rectangle;<br>            shape_map[Circle] = <span class="hljs-keyword">new</span> class Circle;<br>            color_map[Red] = <span class="hljs-keyword">new</span> class Red;<br>            color_map[Blue] = <span class="hljs-keyword">new</span> class Blue;<br>            line_map[SolidLine] = <span class="hljs-keyword">new</span> class SolidLine;<br>            line_map[DottedLine] =  <span class="hljs-keyword">new</span> class DottedLine;<br>        &#125;<br>        ~<span class="hljs-built_in">Painter</span>() &#123;<br>            <span class="hljs-keyword">delete</span> shape_map[Rectangle];<br>            <span class="hljs-keyword">delete</span> shape_map[Circle];<br>            <span class="hljs-keyword">delete</span> color_map[Red];<br>            <span class="hljs-keyword">delete</span> color_map[Blue];<br>            <span class="hljs-keyword">delete</span> line_map[SolidLine];<br>            <span class="hljs-keyword">delete</span> line_map[DottedLine];<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">draw</span><span class="hljs-params">(ShapeType shape_type, <span class="hljs-keyword">int</span> size, ColorType color_type, LineType line_type)</span> </span>&#123;<br>            shape_map[shape_type]-&gt;<span class="hljs-built_in">set_size</span>(size);<br>            shape_map[shape_type]-&gt;<span class="hljs-built_in">draw_shape</span>();<br>            color_map[color_type]-&gt;<span class="hljs-built_in">fill_color</span>();<br>            line_map[line_type]-&gt;<span class="hljs-built_in">draw_line</span>();<br>        &#125;<br><br>    <span class="hljs-keyword">private</span>:<br>        unordered_map&lt;ShapeType, Shape*&gt; shape_map;<br>        unordered_map&lt;ColorType, Color*&gt; color_map;<br>        unordered_map&lt;LineType, Line*&gt;  line_map;<br>    &#125;;<br><br>&#125; <span class="hljs-comment">// namespace facade</span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//STRUCTURALPATTERNDESIGN_FACADE_H</span></span><br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Facade.cpp</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/30.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;Facade.h&quot;</span></span><br><br><span class="hljs-keyword">namespace</span> facade &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_facade</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯•å¤–è§‚/é—¨é¢æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br><br>        Painter p;<br>        p.<span class="hljs-built_in">draw</span>(Painter::Rectangle, <span class="hljs-number">2</span>, Painter::Red, Painter::SolidLine);<br>        p.<span class="hljs-built_in">draw</span>(Painter::Circle, <span class="hljs-number">3</span>, Painter::Blue, Painter::DottedLine);<br><br>        cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯•å¤–è§‚/é—¨é¢æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="9-ç›¸å…³æ¨¡å¼"><a class="markdownIt-Anchor" href="#9-ç›¸å…³æ¨¡å¼"></a> 9. ç›¸å…³æ¨¡å¼</h2><p>Abstract Factory æ¨¡å¼å¯ä»¥ä¸Facadeæ¨¡å¼ä¸€èµ·ä½¿ç”¨ä»¥æä¾›ä¸€ä¸ªæ¥å£ï¼Œè¿™ä¸€æ¥å£å¯ç”¨æ¥ä»¥ä¸€ç§å­ç³»ç»Ÿç‹¬ç«‹çš„æ–¹å¼åˆ›å»ºå­ç³»ç»Ÿå¯¹è±¡ã€‚Abstract Factoryä¹Ÿå¯ä»¥ä»£æ›¿Facadeæ¨¡å¼éšè—é‚£äº›ä¸å¹³å°ç›¸å…³çš„ç±»ã€‚</p><p>Mediatoræ¨¡å¼ä¸Facadeæ¨¡å¼çš„ç›¸ä¼¼ä¹‹å¤„æ˜¯ï¼Œå®ƒæŠ½è±¡äº†ä¸€äº›å·²æœ‰ç±»çš„åŠŸèƒ½ã€‚ç„¶è€Œï¼ŒMediatorç›®çš„æ˜¯å¯¹åŒäº‹ä¹‹é—´çš„ä»»æ„é€šè®¯è¿›è¡ŒæŠ½è±¡ï¼Œé€šå¸¸é›†ä¸­ä¸å±äºä»»ä½•å•ä¸ªå¯¹è±¡çš„åŠŸèƒ½ã€‚Mediatorçš„åŒäº‹å¯¹è±¡çŸ¥é“ä¸­ä»‹è€…å¹¶ä¸å®ƒé€šä¿¡ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¸å…¶ä»–åŒç±»å¯¹è±¡é€šä¿¡ã€‚ç›¸å¯¹è€Œè¨€ï¼ŒFacadeæ¨¡å¼ä»…å¯¹å­ç³»ç»Ÿå¯¹è±¡çš„æ¥å£è¿›è¡ŒæŠ½è±¡ï¼Œä»è€Œä½¿å®ƒä»¬æ›´å®¹æ˜“ä½¿ç”¨ï¼›å®ƒå¹¶å®šä¹‰ä¸åŠŸèƒ½ï¼Œå­ç³»ç»Ÿä¹Ÿä¸çŸ¥é“facadeçš„å­˜åœ¨</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œä»…éœ€è¦ä¸€ä¸ªFacadeå¯¹è±¡ï¼Œå› æ­¤Facadeå¯¹è±¡é€šå¸¸å±äºSingletonå¯¹è±¡ã€‚</p><h1 id="proxyä»£ç†å¯¹è±¡ç»“æ„æ¨¡å‹"><a class="markdownIt-Anchor" href="#proxyä»£ç†å¯¹è±¡ç»“æ„æ¨¡å‹"></a> Proxyï¼ˆä»£ç†ï¼‰â€”â€”å¯¹è±¡ç»“æ„æ¨¡å‹</h1><h2 id="1-æ„å›¾-2"><a class="markdownIt-Anchor" href="#1-æ„å›¾-2"></a> 1. æ„å›¾</h2><p>ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚</p><h2 id="2-åŠ¨æœº-2"><a class="markdownIt-Anchor" href="#2-åŠ¨æœº-2"></a> 2. åŠ¨æœº</h2><p>å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œè®¿é—®æ§åˆ¶çš„ä¸€ä¸ªåŸå› æ˜¯ä¸ºäº†åªæœ‰åœ¨æˆ‘ä»¬ç¡®å®éœ€è¦è¿™ä¸ªå¯¹è±¡æ—¶æ‰å¯¹å®ƒè¿›è¡Œåˆ›å»ºå’Œåˆå§‹åŒ–ã€‚</p><p>æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªå¯ä»¥åœ¨æ–‡æ¡£ä¸­åµŒå…¥å›¾å½¢å¯¹è±¡çš„æ–‡æ¡£ç¼–è¾‘å™¨ã€‚æœ‰äº›å›¾å½¢å¯¹è±¡çš„åˆ›å»ºå¼€é”€å¾ˆå¤§ã€‚ä½†æ˜¯æ‰“å¼€æ–‡æ¡£å¿…é¡»å¾ˆè¿…é€Ÿï¼Œå› æ­¤æˆ‘ä»¬æ‰“å¼€æ–‡æ¡£æ—¶åº”è¯¥é¿å…ä¸€æ¬¡æ€§åˆ›å»ºæ‰€æœ‰å¼€é”€å¾ˆå¤§çš„å¯¹è±¡ã€‚å› ä¸ºå¹¶éæ‰€æœ‰è¿™äº›å¯¹è±¡åœ¨æ–‡æ¡£ä¸­éƒ½åŒæ—¶å¯è§ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰å¿…è¦åŒæ—¶åˆ›å»ºè¿™äº›å¯¹è±¡ã€‚</p><p>è¿™ä¸€é™åˆ¶æ¡ä»¶æ„å‘³ç€ï¼Œå¯¹äºæ¯ä¸€ä¸ªå¼€é”€å¾ˆå¤§çš„å¯¹è±¡ï¼Œåº”è¯¥æ ¹æ®éœ€è¦è¿›è¡Œåˆ›å»ºï¼Œå½“ä¸€ä¸ªå›¾å½¢å˜ä¸ºå¯è§æ—¶ä¼šäº§ç”Ÿè¿™æ ·çš„éœ€è¦ã€‚ä½†æ˜¯åœ¨æ–‡æ¡£ä¸­æˆ‘ä»¬ç”¨ä»€ä¹ˆæ¥æ›¿ä»£è¿™ä¸ªå›¾åƒå‘¢ï¼Ÿæˆ‘ä»¬åˆå¦‚ä½•æ‰èƒ½éšè—æ ¹æ®éœ€è¦åˆ›å»ºå›¾åƒè¿™ä¸€äº‹å®ï¼Œä»è€Œä¸ä¼šä½¿å¾—ç¼–è¾‘å™¨çš„å®ç°å¤æ‚åŒ–å‘¢ï¼Ÿä¾‹å¦‚ï¼Œè¿™ç§ä¼˜åŒ–ä¸åº”è¯¥å½±å“ç»˜åˆ¶å’Œæ ¼å¼åŒ–çš„ä»£ç ã€‚</p><p>é—®é¢˜çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå³å›¾åƒProxyï¼Œæ›¿ä»£é‚£ä¸ªçœŸæ­£çš„å›¾åƒã€‚Proxyå¯ä»¥ä»£æ›¿ä¸€ä¸ªå›¾å½¢å¯¹è±¡ï¼Œå¹¶ä¸”åœ¨éœ€è¦æ—¶è´Ÿè´£å®ä¾‹åŒ–è¿™ä¸ªå›¾åƒå¯¹è±¡ã€‚</p><p>åªæœ‰å½“æ–‡æ¡£ç¼–è¾‘å™¨æ¿€æ´»å›¾åƒä»£ç†çš„Drawæ“ä½œä»¥æ˜¾ç¤ºè¿™ä¸ªå›¾åƒçš„æ—¶å€™ï¼Œå›¾åƒProxyæ‰åˆ›å»ºçœŸæ­£çš„å›¾åƒã€‚Proxyç›´æ¥å°†éšåçš„è¯·æ±‚è½¬å‘ç»™è¿™ä¸ªå›¾åƒå¯¹è±¡ã€‚å› æ­¤åœ¨åˆ›å»ºè¿™ä¸ªå›¾åƒä»¥åï¼Œå®ƒå¿…é¡»æœ‰ä¸€ä¸ªæŒ‡å‘è¿™ä¸ªå›¾åƒçš„å¼•ç”¨ã€‚</p><h2 id="3-é€‚ç”¨æ€§-2"><a class="markdownIt-Anchor" href="#3-é€‚ç”¨æ€§-2"></a> 3. é€‚ç”¨æ€§</h2><p>åœ¨éœ€è¦æ¯”è¾ƒé€šç”¨å’Œå¤æ‚çš„å¯¹è±¡æŒ‡é’ˆä»£æ›¿ç®€å•çš„æŒ‡é’ˆçš„æ—¶å€™ï¼Œä½¿ç”¨Proxyæ¨¡å¼ã€‚ä¸‹é¢æ˜¯ä¸€äº›å¯ä»¥ä½¿ç”¨Proxyæ¨¡å¼çš„å¸¸è§æƒ…å†µï¼š</p><ul><li>è¿œç¨‹ä»£ç†ï¼ˆRemote Proxyï¼‰ï¼šä¸ºä¸€ä¸ªå¯¹è±¡åœ¨ä¸åŒçš„åœ°å€ç©ºé—´æä¾›å±€éƒ¨ä»£è¡¨ã€‚</li><li>è™šä»£ç†ï¼ˆVirtual Proxyï¼‰ï¼šæ ¹æ®éœ€è¦åˆ›å»ºå¼€é”€å¾ˆå¤§çš„å¯¹è±¡ã€‚åœ¨åŠ¨æœºä¸€èŠ‚æè¿°çš„ImageProxyå°±æ˜¯è¿™æ ·ä¸€ç§ä»£ç†çš„ä¾‹å­ã€‚</li><li>ä¿æŠ¤ä»£ç†ï¼ˆProtection Proxyï¼‰ï¼šæ§åˆ¶åŸå§‹å¯¹è±¡çš„è®¿é—®ã€‚ä¿æŠ¤ä»£ç†ç”¨äºå¯¹è±¡åº”è¯¥æœ‰ä¸åŒçš„è®¿é—®æƒé™çš„æ—¶å€™ã€‚</li><li>æ™ºèƒ½æŒ‡é’ˆï¼ˆSmart Referenceï¼‰ï¼šå–ä»£äº†ç®€å•çš„æŒ‡é’ˆï¼Œå®ƒåœ¨è®¿é—®å¯¹è±¡æ—¶æ‰§è¡Œä¸€äº›é™„åŠ æ“ä½œï¼Œå®ƒçš„å…¸å‹ç”¨é€”åŒ…æ‹¬ï¼š<ul><li>å¯¹æŒ‡å‘å®é™…å¯¹è±¡çš„å¼•ç”¨æŠ€æœ¯ï¼Œè¿™æ ·å½“å¯¹è±¡æ²¡æœ‰å¼•ç”¨æ—¶ï¼Œå¯ä»¥è‡ªåŠ¨é‡Šæ”¾å®ƒã€‚</li><li>å½“ç¬¬ä¸€æ¬¡å¼•ç”¨ä¸€ä¸ªæŒä¹…å¯¹è±¡æ—¶ï¼Œå°†å®ƒè£…å…¥å†…å­˜ã€‚</li><li>åœ¨è®¿é—®ä¸€ä¸ªå®é™…å¯¹è±¡å‰ï¼Œæ£€æŸ¥æ˜¯å¦å·²ç»é”å®šäº†å®ƒï¼Œä»¥ç¡®ä¿å…¶ä»–å¯¹è±¡ä¸èƒ½æ”¹å˜å®ƒã€‚</li></ul></li></ul><h2 id="4-ç»“æ„-2"><a class="markdownIt-Anchor" href="#4-ç»“æ„-2"></a> 4. ç»“æ„</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204301546944.jpeg" alt="ç»“æ„å›¾" /></p><p>ä¸‹å›¾åˆ™æ˜¯è¿è¡Œæ—¶ä¸€ç§å¯èƒ½çš„ä»£ç†ç»“æ„çš„å¯¹è±¡å›¾ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204301546154.jpeg" alt="è¿è¡Œæ—¶å¯¹è±¡å›¾" /></p><h2 id="5-å‚ä¸è€…-2"><a class="markdownIt-Anchor" href="#5-å‚ä¸è€…-2"></a> 5. å‚ä¸è€…</h2><ul><li>Proxyï¼š<ul><li>ä¿å­˜ä¸€ä¸ªå¼•ç”¨ä½¿å¾—ä»£ç†å¯ä»¥è®¿é—®å®ä½“ã€‚è‹¥RealSubjectå’ŒSubjectçš„æ¥å£ç›¸åŒï¼ŒProxyä¼šå¼•ç”¨Subjectã€‚</li><li>æä¾›ä¸€ä¸ªä¸Subjectçš„æ¥å£ç›¸åŒçš„æ¥å£ï¼Œè¿™æ ·ä»£ç†å°±å¯ä»¥ç”¨æ¥æ›¿ä»£å®ä½“</li><li>æ§åˆ¶å¯¹å®ä½“çš„å­˜å–ï¼Œå¹¶å¯èƒ½è´Ÿè´£åˆ›å»ºå’Œåˆ é™¤å®ƒã€‚</li><li>â€”â€” å…¶ä»–åŠŸèƒ½ä¾èµ–äºä»£ç†çš„ç±»å‹ï¼š<ul><li>Remote Proxyè´Ÿè´£å¯¹è¯·æ±‚åŠå…¶å‚æ•°è¿›è¡Œç¼–ç ï¼Œå¹¶å‘ä¸åŒåœ°å€ç©ºé—´ä¸­çš„å®ä½“å‘é€å·²ç¼–ç çš„è¯·æ±‚</li><li>Virtual Proxyå¯ä»¥ç¼“å­˜å®ä½“çš„é™„åŠ ä¿¡æ¯ï¼Œä»¥ä¾¿å»¶è¿Ÿå¯¹å®ƒçš„è®¿é—®ã€‚</li><li>Protection Proxyæ£€æŸ¥è°ƒç”¨è€…æ˜¯å¦å…·æœ‰å®ç°ä¸€ä¸ªè¯·æ±‚æ‰€å¿…éœ€çš„è®¿é—®æƒé™ã€‚</li></ul></li></ul></li><li>Subject<ul><li>å®šä¹‰RealSubject å’Œ Proxyçš„å…±ç”¨æ¥å£ï¼Œè¿™æ ·å°±åœ¨ä»»ä½•ä½¿ç”¨RealSubjectçš„åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨Proxy</li></ul></li><li>RealSubject<ul><li>å®šä¹‰Proxyæ‰€ä»£è¡¨çš„å®ä½“</li></ul></li></ul><h2 id="6-åä½œ-2"><a class="markdownIt-Anchor" href="#6-åä½œ-2"></a> 6. åä½œ</h2><p>ä»£ç†æ ¹æ®å…¶ç§ç±»ï¼Œåœ¨é€‚å½“çš„æ—¶å€™å‘RealSubjectè½¬å‘è¯·æ±‚ã€‚</p><h2 id="7-æ•ˆæœ-2"><a class="markdownIt-Anchor" href="#7-æ•ˆæœ-2"></a> 7. æ•ˆæœ</h2><p>Proxyæ¨¡å¼åœ¨è®¿é—®å¯¹è±¡æ—¶å¼•å…¥ä¸€å®šç¨‹åº¦çš„é—´æ¥æ€§ã€‚æ ¹æ®ä»£ç†çš„ç±»å‹ï¼Œé™„åŠ çš„é—´æ¥æ€§æœ‰å¤šç§ç”¨é€”ï¼š</p><ul><li>Remote Proxyå¯ä»¥éšè—ä¸€ä¸ªå¯¹è±¡å­˜åœ¨äºä¸åŒåœ°å€ç©ºé—´çš„äº‹å®ä¸Šã€‚</li><li>Virtual Proxy å¯ä»¥è¿›è¡Œæœ€ä¼˜åŒ–ï¼Œä¾‹å¦‚æ ¹æ®è¦æ±‚åˆ›å»ºå¯¹è±¡ã€‚</li><li>Protection Proxy å’Œ Smart Reference éƒ½å…è®¸åœ¨è®¿é—®å¯¹è±¡æ—¶æœ‰ä¸€äº›é™„åŠ çš„å†…åŠ¡å¤„ç†ã€‚</li></ul><p>Proxyæ¨¡å¼è¿˜å¯ä»¥å¯¹ç”¨æˆ·éšè—å¦ä¸€ç§è¢«ç§°ä¸ºcopy-on-writeçš„ä¼˜åŒ–æ–¹å¼ï¼Œ è¯¥ä¼˜åŒ–ä¸æ ¹æ®éœ€è¦åˆ›å»ºå¯¹è±¡æœ‰å…³ã€‚</p><h2 id="8-å®ç°"><a class="markdownIt-Anchor" href="#8-å®ç°"></a> 8. å®ç°</h2><p>å¯¹äºC++ æ¥è¯´ï¼Œå¯ä»¥é‡è½½C++ ä¸­çš„å­˜å–è¿ç®—ç¬¦ã€‚ C++æ”¯æŒé‡è½½è¿ç®—ç¬¦ -&gt; ã€‚é‡è½½è¿™ä¸€è¿ç®—æ³•ä½¿ä½ å¯ä»¥åœ¨æ’¤é”€ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨æ—¶ï¼Œæ‰§è¡Œä¸€äº›é™„åŠ çš„æ“ä½œã€‚è¿™ä¸€ç‚¹å¯ä»¥ç”¨äºå®ç°æŸäº›ç§ç±»çš„ä»£ç†ï¼Œä»£ç†çš„ä½œç”¨å°±åƒæ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚</p><p>Proxyå¹¶ä¸æ˜¯æ€»æ˜¯éœ€è¦çŸ¥é“å®ä½“çš„ç±»å‹ã€‚è‹¥Proxyç±»èƒ½å¤Ÿå®Œå…¨é€šè¿‡ä¸€ä¸ªæŠ½è±¡æ¥å£å¤„ç†å®ƒçš„å®ä½“ï¼Œåˆ™æ— é¡»ä¸ºæ¯ä¸€ä¸ªRealSubjectç±»éƒ½ç”Ÿæˆä¸€ä¸ªProxyç±»ï¼ŒProxyç±»å¯ä»¥ç»Ÿä¸€å¤„ç†æ‰€æœ‰çš„RealSubjectç±»ã€‚ä½†æ˜¯å¦‚æœProxyè¦å®ä¾‹åŒ–RealSubjectï¼ˆä¾‹å¦‚åœ¨è™šä»£ç†ä¸­ï¼‰ï¼Œé‚£ä¹ˆä»–ä»¬å¿…é¡»è¦çŸ¥é“å…·ä½“çš„ç±»ã€‚</p><h2 id="9-ç¤ºä¾‹ä»£ç "><a class="markdownIt-Anchor" href="#9-ç¤ºä¾‹ä»£ç "></a> 9. ç¤ºä¾‹ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Proxxy.h</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/30.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> STRUCTURALPATTERNDESIGN_PROXXY_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> STRUCTURALPATTERNDESIGN_PROXXY_H</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @brief æ¨¡æ‹Ÿå®ç° Virtual Proxy</span><br><span class="hljs-comment"> * æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªå¯ä»¥åœ¨æ–‡æ¡£ä¸­åµŒå…¥å›¾å½¢å¯¹è±¡çš„æ–‡æ¡£ç¼–è¾‘å™¨ã€‚æœ‰äº›å›¾å½¢å¯¹è±¡çš„åˆ›å»ºå¼€é”€å¾ˆå¤§ã€‚</span><br><span class="hljs-comment"> * ä½†æ˜¯æ‰“å¼€æ–‡æ¡£å¿…é¡»å¾ˆè¿…é€Ÿï¼Œå› æ­¤æˆ‘ä»¬æ‰“å¼€æ–‡æ¡£æ—¶åº”è¯¥é¿å…ä¸€æ¬¡æ€§åˆ›å»ºæ‰€æœ‰å¼€é”€å¾ˆå¤§çš„å¯¹è±¡ã€‚</span><br><span class="hljs-comment"> * å› ä¸ºå¹¶éæ‰€æœ‰è¿™äº›å¯¹è±¡åœ¨æ–‡æ¡£ä¸­éƒ½åŒæ—¶å¯è§ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰å¿…è¦åŒæ—¶åˆ›å»ºè¿™äº›å¯¹è±¡ã€‚</span><br><span class="hljs-comment"> * åªæœ‰å½“æ–‡æ¡£ç¼–è¾‘å™¨æ¿€æ´»å›¾åƒä»£ç†çš„Drawæ“ä½œä»¥æ˜¾ç¤ºè¿™ä¸ªå›¾åƒçš„æ—¶å€™ï¼Œå›¾åƒProxyæ‰åˆ›å»ºçœŸæ­£çš„å›¾åƒã€‚</span><br><span class="hljs-comment"> * Proxyç›´æ¥å°†éšåçš„è¯·æ±‚è½¬å‘ç»™è¿™ä¸ªå›¾åƒå¯¹è±¡ã€‚å› æ­¤åœ¨åˆ›å»ºè¿™ä¸ªå›¾åƒä»¥åï¼Œå®ƒå¿…é¡»æœ‰ä¸€ä¸ªæŒ‡å‘è¿™ä¸ªå›¾åƒçš„å¼•ç”¨ã€‚</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_proxy</span><span class="hljs-params">()</span></span>;<br><br><span class="hljs-comment">// å›¾å½¢æ˜¾ç¤ºç›¸å…³æ¥å£</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Graphic</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">draw</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Image</span> :</span> <span class="hljs-keyword">public</span> Graphic&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Image</span> (string file_name) &#123;<br>        <span class="hljs-comment">// ä»ç£ç›˜åŠ è½½æ–‡ä»¶</span><br>        cout &lt;&lt; <span class="hljs-string">&quot;ä»ç£ç›˜åŠ è½½æ–‡ä»¶ï¼š&quot;</span> &lt;&lt; file_name &lt;&lt; endl;<br>        data = <span class="hljs-string">&quot;^_^&quot;</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">draw</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;ç»˜åˆ¶å›¾ç‰‡&quot;</span> &lt;&lt; data &lt;&lt; endl;<br>    &#125;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-comment">// å›¾ç‰‡çš„æ•°æ®è¡¨ç¤º</span><br>    string data;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ImageProxy</span> :</span> <span class="hljs-keyword">public</span> Graphic&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">ImageProxy</span>(string file_name) &#123;<br>        <span class="hljs-keyword">this</span>-&gt;file_name = file_name;<br>        image = <span class="hljs-literal">nullptr</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">draw</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-built_in">get_image</span>()-&gt;<span class="hljs-built_in">draw</span>();<br>    &#125;<br><span class="hljs-keyword">protected</span>:<br>    <span class="hljs-function">Image* <span class="hljs-title">get_image</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (image == <span class="hljs-literal">nullptr</span>) &#123;<br>            image = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Image</span>(file_name);<br>        &#125;<br>        <span class="hljs-keyword">return</span> image;<br>    &#125;<br><span class="hljs-keyword">private</span>:<br>    Image* image;<br>    string file_name;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TextDocumnet</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(Graphic* graphic)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>-&gt;graphic = graphic;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// ...</span><br>        <span class="hljs-comment">// å½“æµè§ˆåˆ°å›¾ç‰‡å½“å‰æ‰€åœ¨é¡µ</span><br>        graphic-&gt;<span class="hljs-built_in">draw</span>();<br>    &#125;<br><br><span class="hljs-keyword">private</span>:<br>    Graphic* graphic;<br>&#125;;<br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//STRUCTURALPATTERNDESIGN_PROXXY_H</span></span><br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Proxxy.cpp</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/30.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;Proxy.h&quot;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_proxy</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯•ä»£ç†æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br><br>    TextDocumnet doc;<br>    doc.<span class="hljs-built_in">insert</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">ImageProxy</span>(<span class="hljs-string">&quot;an image&quot;</span>));<br>    <span class="hljs-comment">// doc æ˜¾ç¤ºäº†ä¸€äº›åˆ«çš„ä¸œè¥¿</span><br>    <span class="hljs-comment">// doc éœ€è¦åŠ è½½å›¾ç‰‡æ—¶</span><br>    doc.<span class="hljs-built_in">show</span>();<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç»“æŸæµ‹è¯•ä»£ç†æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="10-ç›¸å…³æ¨¡å¼"><a class="markdownIt-Anchor" href="#10-ç›¸å…³æ¨¡å¼"></a> 10. ç›¸å…³æ¨¡å¼</h2><p>Adapterï¼šé€‚é…å™¨ä¸ºå®ƒæ‰€é€‚é…çš„å¯¹è±¡æä¾›äº†ä¸€ä¸ªä¸åŒçš„æ¥å£ã€‚ç›¸åï¼Œä»£ç†æä¾›äº†ä¸å®ƒçš„å®ä½“ç›¸åŒçš„æ¥å£ã€‚ç„¶è€Œï¼Œç”¨äºè®¿é—®ä¿æŠ¤çš„ä»£ç†å¯èƒ½ä¼šæ‹’ç»æ‰§è¡Œå®ä½“ä¼šæ‰§è¡Œçš„æ“ä½œã€‚å› æ­¤ï¼Œå®ƒçš„æ¥å£å®é™…ä¸Šå¯èƒ½åªæ˜¯å®ä½“æ¥å£çš„ä¸€ä¸ªå­é›†ã€‚</p><p>Decoratorï¼šå°½ç®¡è£…é¥°çš„å®ç°éƒ¨åˆ†ä¸ä»£ç†ç›¸ä¼¼ï¼Œä½†è£…é¥°çš„ç›®çš„ä¸ä¸€æ ·ã€‚è£…é¥°ä¸ºå¯¹è±¡æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªåŠŸèƒ½ï¼Œè€Œä»£ç†åˆ™æ§åˆ¶å¯¹å¯¹è±¡çš„è®¿é—®ã€‚</p><p>ä»£ç†çš„å®ç°å’Œè£…é¥°çš„å®ç°ç±»ä¼¼ï¼Œä½†åœ¨ç›¸ä¼¼çš„ç¨‹åº¦ä¸Šæœ‰æ‰€å·®åˆ«ã€‚Protection Proxyçš„å®ç°å¯èƒ½ä¸è£…é¥°çš„å®ç°å·®ä¸å¤šã€‚å¦å¤–ï¼ŒRemote Proxyä¸åŒ…å«å¯¹å®ä½“çš„ç›´æ¥å¼•ç”¨ï¼Œè€Œåªæ˜¯ä¸€ä¸ªé—´æ¥å¼•ç”¨ï¼Œå¦‚â€œä¸»æœºIDï¼Œä¸»æœºä¸Šçš„å±€éƒ¨åœ°å€â€ã€‚Virtual Proxyå¼€å§‹çš„æ—¶å€™ä½¿ç”¨ä¸€ä¸ªé—´æ¥å¼•ç”¨ï¼Œä¾‹å¦‚ä¸€ä¸ªæ–‡ä»¶åï¼Œä½†æœ€ç»ˆå°†è·å–å¹¶ä½¿ç”¨ä¸€ä¸ªç›´æ¥å¼•ç”¨ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¼–ç¨‹æŠ€å·§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€STLæºç åˆ†æã€‘åºåˆ—å¼å®¹å™¨ä¹‹vector</title>
    <link href="/2022/04/26/2022-04/2022-04-26%20%E3%80%90STL%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8%E4%B9%8Bvector/"/>
    <url>/2022/04/26/2022-04/2022-04-26%20%E3%80%90STL%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91%E5%BA%8F%E5%88%97%E5%BC%8F%E5%AE%B9%E5%99%A8%E4%B9%8Bvector/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>æœ¬æ–‡ä¸»è¦å†…å®¹å‚è€ƒï¼š<a href="https://mp.weixin.qq.com/s/NcrnwsB2gjq9h7W2hIZ6PQ">2 ä¸‡å­—+20 å›¾å¸¦ä½ æ‰‹æ’• STL åºåˆ—å¼å®¹å™¨æºç </a>ï¼ŒåŸæ–‡å†…å®¹éå¸¸è¯¦å°½å……å®ï¼Œå»ºè®®å¤§å®¶é˜…è¯»å­¦ä¹ ã€‚è€Œæœ¬æ–‡åˆ™æ˜¯æ‘˜å½•æ€»ç»“å…³é”®éƒ¨åˆ†ï¼Œé‡ç‚¹å…³æ³¨åŠ¨æ€æ‰©å®¹çš„æœºåˆ¶ï¼Œä»¥ä¾¿æ—¥åå¿«é€Ÿå›å¿†å…¶å®ç°é€»è¾‘ã€‚</p><h1 id="vectoråŸºæœ¬æ•°æ®ç»“æ„"><a class="markdownIt-Anchor" href="#vectoråŸºæœ¬æ•°æ®ç»“æ„"></a> vectoråŸºæœ¬æ•°æ®ç»“æ„</h1><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204261522995.png" alt="vector å®šä¹‰" /></p><p>é€šè¿‡æºç å¯ä»¥çœ‹åˆ°ï¼Œvectorä»£è¡¨ç€ç”¨æˆ·æ•°æ®çš„ä¸€æ®µç©ºé—´ï¼Œé‡Œé¢æœ‰ä¸‰ä¸ªé‡è¦çš„æˆå‘˜æŒ‡é’ˆï¼Œåˆ†åˆ«æŒ‡å‘æ‰€ç”¨ç©ºé—´çš„å¤´éƒ¨ï¼Œæ‰€ç”¨ç©ºé—´çš„å°¾éƒ¨ï¼Œä»¥åŠå¯ç”¨ç©ºé—´çš„å°¾éƒ¨ã€‚å¹¶ä¸”ï¼Œvectoræ‰€ç”¨çš„è¿­ä»£å™¨å°±æ˜¯æ™®é€šæŒ‡é’ˆã€‚</p><h1 id="vectorå…³é”®æ–¹æ³•æºç åˆ†æ"><a class="markdownIt-Anchor" href="#vectorå…³é”®æ–¹æ³•æºç åˆ†æ"></a> vectorå…³é”®æ–¹æ³•æºç åˆ†æ</h1><p>æ¥ä¸‹æ¥å¯¹vectorä¸­ä¸€äº›å…³é”®æ–¹æ³•è¿›è¡Œæºç åˆ†æã€‚</p><h2 id="reserve"><a class="markdownIt-Anchor" href="#reserve"></a> reserve</h2><p><code>reserve</code>æ–¹æ³•ç”¨äºè°ƒæ•´vectorå¯ç”¨ç©ºé—´çš„å¤§å°ï¼Œå¦‚æœè¾“å…¥å‚æ•°ï¼ˆè¦æ”¹å˜çš„å¤§å°ï¼‰å¤§äºå½“å‰å¯ç”¨ç©ºé—´çš„å®¹é‡ï¼Œé‚£ä¹ˆå°±ä¼šé‡æ–°åˆ†é…ç©ºé—´ï¼Œå†æŠŠåŸæ¥çš„æ•°æ®æ‹·è´åˆ°æ–°çš„ç©ºé—´ä¸Šã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204261522613.png" alt="reserveæºç " /></p><h2 id="resize"><a class="markdownIt-Anchor" href="#resize"></a> resize</h2><p><code>resize</code>æ–¹æ³•æ˜¯æ”¹å˜vectorå·²ä½¿ç”¨ç©ºé—´çš„å¤§å°ï¼Œå¦‚æœè¾“å…¥çš„å‚æ•°å°äºå½“å‰çš„sizeï¼Œå°±ä¼šæ¸…é™¤å¤šä½™çš„å…ƒç´ ï¼ˆè°ƒç”¨<code>erase</code>æ–¹æ³•ï¼‰ï¼›å¦åˆ™ï¼Œå°±æ‰§è¡Œ insert æ’å…¥æ–¹æ³•ï¼Œè€Œå¯¹ insert æ¥è¯´ï¼Œå¦‚æœå½“å‰å¯ç”¨ç©ºé—´ä¸º0ï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡Œæ‰©å®¹ï¼Œä¹Ÿå°±æ˜¯åˆ†é…ç”³è¯·æ–°çš„ç©ºé—´ï¼ŒæŠŠåŸæ¥çš„æ•°æ®æ‹·è´åˆ°æ–°çš„ç©ºé—´ä¸Šï¼Œå†æ‰§è¡Œæ’å…¥æ“ä½œã€‚</p><p>å› æ­¤å¯¹æ¯” <code>reserve</code> å’Œ <code>resize</code> æ–¹æ³•ï¼Œ<code>reserve</code> åªå¯èƒ½æ”¹å˜vectorå¯ç”¨ç©ºé—´çš„å¤§å°(capacity)ï¼Œä¸ä¼šæ”¹å˜ä½¿ç”¨ç©ºé—´çš„å¤§å°(size)ï¼›è€Œ<code>resize</code>æ–¹æ³•æ—¢å¯èƒ½æ”¹å˜ä½¿ç”¨ç©ºé—´çš„å¤§å°(size)ï¼Œä¹Ÿå¯èƒ½æ”¹å˜å¯ç”¨ç©ºé—´çš„å¤§å°(capacity)ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204261523596.png" alt="resizeæºç " /></p><h2 id="push_back"><a class="markdownIt-Anchor" href="#push_back"></a> push_back</h2><p><code>push_back</code> å°†å…ƒç´ æ’å…¥åˆ°vectorçš„å°¾éƒ¨ï¼Œå½“vectorç›®å‰è¿˜æœ‰å¯ç”¨ç©ºé—´æ—¶ï¼Œå°±åœ¨å¯¹åº”çš„ä½ç½®ä¸Šæ‰§è¡Œå…ƒç´ çš„æ„é€ å‡½æ•°ï¼›å¦‚æœæ²¡æœ‰å¯ç”¨ç©ºé—´ï¼Œåˆ™è°ƒç”¨<code>_M_insert_aux</code> æ’å…¥æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•é‡Œä¼šæ‰§è¡ŒåŠ¨æ€æ‰©å®¹ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204261525188.png" alt="push_backæºç " /></p><p><code>_M_insert_aux</code> æ–¹æ³•æºç å¦‚ä¸‹æ‰€ç¤ºï¼Œé™¤äº†<code>push_back</code> å¯èƒ½ä¼šè°ƒç”¨ï¼Œ<code>insert</code> æ–¹æ³•ä¹Ÿå¯èƒ½ä¼šè°ƒç”¨ï¼Œæ‰€ä»¥é¦–å…ˆè¿˜æ˜¯ä¼šå…ˆåˆ¤æ–­å½“å‰æ˜¯å¦è¿˜æœ‰å¯ç”¨ç©ºé—´ã€‚</p><p>å¦‚æœå½“å‰æ²¡æœ‰å¯ç”¨ç©ºé—´ï¼Œå°±ä¼šç”³è¯·åˆ†é…æ–°çš„ç©ºé—´å¤§å°ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<strong>å¦‚æœåŸæ¥çš„sizeä¸º0ï¼Œåˆ™æ–°ç”³è¯·çš„ç©ºé—´å¤§å°ä¸º1ï¼Œå¦åˆ™å°±ä¼šç”³è¯·2å€åŸæ¥çš„size</strong>ã€‚</p><p>ç„¶åæ‰§è¡Œæ‹·è´ç§»åŠ¨ï¼Œå°†å…ˆæ‹·è´<code>_M_start</code>åˆ°<code>__position</code>ä½ç½®çš„å…ƒç´ ï¼Œç„¶åå†<code>__position</code>ä½ç½®ä¸Šèµ‹å€¼æ’å…¥å…ƒç´ ï¼Œæœ€åå†æ‹·è´<code>__position</code>åˆ°<code>_M_finish</code>ä½ç½®çš„å…ƒç´ ã€‚</p><p>è¯´æ˜ä¸€ç‚¹ï¼Œå…¶ä¸­è°ƒç”¨çš„<code>uninitialized_copy</code>å‡½æ•°çš„å‰ç¼€uninitializedå«ä¹‰æ˜¯å¯¹åº”è¿­ä»£å™¨çš„ä½ç½®è¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œéœ€è¦è°ƒç”¨ç›¸åº”æ„é€ å‡½æ•°ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204261526804.png" alt="_M_insert_aux æºç " /></p><h2 id="erase"><a class="markdownIt-Anchor" href="#erase"></a> erase</h2><p><code>erase</code>å‡½æ•°ç”¨äºæ¸…é™¤æŸä¸ªä½ç½®ä¸Šæˆ–è€…æŸä¸€æ®µåŒºé—´ä¸Šçš„å…ƒç´ ï¼Œä¸»è¦å®ç°é€»è¾‘å°±æ˜¯ç”¨åæ®µå…ƒç´ è¦†ç›–åˆ é™¤åŒºé—´å†…çš„å…ƒç´ ã€‚ä¸»è¦è°ƒç”¨äº† <code>copy(first, last, result)</code> å‡½æ•°ï¼Œå…¶å¤§è‡´ä½œç”¨æ˜¯æŠŠ [first,last) æ•°æ®æ‹·è´åˆ°resultï¼ˆèµ·å§‹ä½ç½®ï¼‰ï¼Œä»å‰å¾€åæ‹·è´ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204261526218.png" alt="eraseæºç " /></p><p><code>erase</code>å‡½æ•°å›¾è§£å¦‚ä¸‹ï¼Œå¯ä»¥å¸®åŠ©æ›´å¥½åœ°ç†è§£ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204261527816.png" alt="eraseå‡½æ•°å›¾è§£" /></p><h2 id="insert"><a class="markdownIt-Anchor" href="#insert"></a> insert</h2><p>insertå‡½æ•°æœ‰å¤šä¸ªé‡è½½ï¼Œè¿™é‡Œé‡ç‚¹åˆ†æå…¶ä¸­ä¸€ä¸ªï¼Œ<code>void insert (iterator __pos, size_type __n, const _Tp&amp; __x)</code>ï¼Œå‡½æ•°ä½œç”¨ä¸ºä» pos ä½ç½®å¼€å§‹ï¼Œæ’å…¥ n ä¸ªå…ƒç´ ï¼Œå…ƒç´ åˆå€¼ä¸º xï¼ŒçœŸæ­£å®ç°é€»è¾‘åœ¨<code>_M_fill_insert</code>å‡½æ•°ä¸­ï¼Œæºç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204261528232.png" alt="insertæºç " /></p><p>é€šè¿‡æºç ï¼Œä¸éš¾å‘ç° vector çš„æ’å…¥å¤šä¸ªå…ƒç´ ï¼Œå¤§ä½“ä¸Šå¯ä»¥åˆ†ä¸º3ç§æƒ…å†µï¼š</p><ol><li>å¦‚æœ<strong>å¤‡ç”¨ç©ºé—´è¶³å¤Ÿ</strong>ä¸”æ’å…¥ç‚¹ä¹‹åçš„ç°æœ‰å…ƒç´ ä¸ªæ•° <strong>å¤šäº</strong> æ–°å¢å…ƒç´ ä¸ªæ•°ï¼›</li><li>å¦‚æœ<strong>å¤‡ç”¨ç©ºé—´è¶³å¤Ÿ</strong>ä¸”æ’å…¥ç‚¹ä¹‹åçš„ç°æœ‰å…ƒç´ ä¸ªæ•° <strong>å°‘äº</strong> æ–°å¢å…ƒç´ ä¸ªæ•°ï¼›</li><li>å¦‚æœ<strong>å¤‡ç”¨ç©ºé—´ä¸å¤Ÿ</strong>ã€‚</li></ol><p>ä¸‹é¢å°±ç”¨ä¸‰å¼ å›¾æ¥æè¿°è¿™ä¸‰ç§æƒ…å†µçš„æ‰§è¡Œé€»è¾‘ï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204261529054.jpeg" alt="æƒ…å†µ1 å›¾è§£" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204261529421.jpeg" alt="æƒ…å†µ2 å›¾è§£" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204261530582.jpeg" alt="æƒ…å†µ3 å›¾è§£" /></p><h2 id="æ³¨æ„ç‚¹"><a class="markdownIt-Anchor" href="#æ³¨æ„ç‚¹"></a> æ³¨æ„ç‚¹</h2><p>åœ¨è°ˆè®ºvectoræ—¶ï¼Œç»å¸¸ä¼šå¬åˆ°ä¸€ä¸ªåè¯ï¼Œå°±æ˜¯æ‰€è°“çš„<strong>è¿­ä»£å™¨å¤±æ•ˆé—®é¢˜</strong>ã€‚é€šè¿‡ä¸Šè¿°å›¾è§£å’Œåˆ†ææˆ‘ä»¬å°±æ˜ç™½äº†ï¼Œæ‰€è°“çš„è¿­ä»£å™¨å¤±æ•ˆé—®é¢˜æ˜¯ç”±äºå…ƒç´ ç©ºé—´é‡æ–°é…ç½®å¯¼è‡´ä¹‹å‰çš„è¿­ä»£å™¨è®¿é—®çš„å…ƒç´ ä¸åœ¨äº†ï¼Œæ€»ç»“æ¥è¯´æœ‰ä¸¤ç§æƒ…å†µï¼š</p><ul><li><p>ç”±äºæ’å…¥å…ƒç´ ï¼Œä½¿å¾—å®¹å™¨å…ƒç´ æ•´ä½“è¿ç§»å¯¼è‡´å­˜æ”¾åŸå®¹å™¨å…ƒç´ çš„ç©ºé—´ä¸å†æœ‰æ•ˆï¼Œä»è€Œä½¿å¾—æŒ‡å‘åŸç©ºé—´çš„è¿­ä»£å™¨å¤±æ•ˆã€‚</p><ul><li>è¿™é‡Œå…ƒç´ è¿ç§»ï¼Œæ—¢å¯èƒ½æ˜¯æŒ‡å®¹å™¨å†…å…ƒç´ çš„æ¬¡åºç§»åŠ¨ï¼Œä¹Ÿå¯èƒ½æ˜¯ç”±äºæŒ‡å‘äº†æ–°çš„åˆ†é…ç©ºé—´</li></ul></li><li><p>ç”±äºåˆ é™¤å…ƒç´ ï¼Œä½¿å¾—æŸäº›å…ƒç´ æ¬¡åºå‘ç”Ÿå˜åŒ–å¯¼è‡´åŸæœ¬æŒ‡å‘æŸå…ƒç´ çš„è¿­ä»£å™¨ä¸å†æŒ‡å‘æœŸæœ›æŒ‡å‘çš„å…ƒç´ ã€‚</p></li></ul><hr /><p>ä¹‹å‰ä¹Ÿè°ˆåˆ°ä¸€äº›å…³é”®çš„å‡½æ•°ï¼Œè¿™é‡Œå†è®°å½•è¯´æ˜ä¸€ä¸‹ï¼š</p><ul><li><p><code>copy(first, last, result)</code>ï¼šå°†[first, last) ä¹‹é—´çš„å…ƒç´ æ‹·è´åˆ° [result , result + (last-first))ä½ç½®</p><ul><li>è¯¥å…¨å±€ <code>copy</code> å‡½æ•°ï¼Œåº•å±‚ä¼šå»è°ƒç”¨ <code>memmove</code> ï¼Œè€Œ <code>memmove</code>ç”¨äºæ‹·è´å­—èŠ‚ï¼Œå¦‚æœç›®æ ‡åŒºåŸŸå’ŒæºåŒºåŸŸæœ‰é‡å çš„è¯ï¼Œ<code>memmove</code>èƒ½å¤Ÿä¿è¯æºä¸²åœ¨è¢«è¦†ç›–ä¹‹å‰å°†é‡å åŒºåŸŸçš„å­—èŠ‚æ‹·è´åˆ°ç›®æ ‡åŒºåŸŸä¸­ï¼Œä½†å¤åˆ¶åæºå†…å®¹ä¼šè¢«æ›´æ”¹ã€‚<ul><li>å¦‚æœå­˜åœ¨é‡å åŒºåŸŸçš„è¯ï¼Œä»å®ç°è§’åº¦æ¥è¯´ï¼Œå¦‚æœ first åœ¨ result ä¹‹å‰ï¼Œé‚£ä¹ˆå°±ä»åå¾€å‰æ‹·è´ï¼Œå¦‚æœ first åœ¨ result ä¹‹åï¼Œé‚£ä¹ˆä»å‰å¾€åæ‹·è´</li></ul></li><li>ä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿ result è¿­ä»£å™¨ä½ç½®å¤„äº first å’Œ last ä¹‹é—´ï¼Œä¹Ÿèƒ½å¤Ÿæ­£å¸¸å®ç°åŠŸèƒ½ï¼Œä¸ä¼šå‡ºç°æƒ³è±¡ä¸­è¿­ä»£å™¨å€¼è¢«è¦†ç›–çš„é—®é¢˜ã€‚</li></ul></li><li><p><code>uninitialized_copy(first, last, result)</code>ï¼šå…·ä½“ä½œç”¨æ˜¯å°† [first,last)å†…çš„å…ƒç´ æ‹·è´åˆ°[result , result + (last-first)) ï¼Œ<strong>ä»å‰å¾€åæ‹·è´</strong></p></li><li><p><code>copy_backward(first, last, result)</code>ï¼šå°† [first,last)å†…çš„å…ƒç´ æ‹·è´åˆ° [result , result + (last-first)) ï¼Œ<strong>ä»åå¾€å‰æ‹·è´</strong></p></li></ul><h1 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h1><p>è‡³æ­¤ vector å®¹å™¨å°±åˆ†æå¾—å·®ä¸å¤šäº†ï¼Œæé†’éœ€è¦æ³¨æ„çš„æ˜¯ï¼švector çš„æˆå‘˜å‡½æ•°éƒ½ä¸åšè¾¹ç•Œæ£€æŸ¥ (ä½†atæ–¹æ³•ä¼šæŠ›å¼‚å¸¸)ï¼Œä½¿ç”¨è€…è¦è‡ªå·±ç¡®ä¿è¿­ä»£å™¨å’Œç´¢å¼•å€¼çš„åˆæ³•æ€§ã€‚</p><p>æœ€åå†æ€»ç»“ä¸‹ vector çš„ä¼˜ç¼ºç‚¹ï¼š</p><ul><li><p><strong>ä¼˜ç‚¹</strong></p><ul><li><p>åœ¨å†…å­˜ä¸­æ˜¯åˆ†é…ä¸€å—è¿ç»­çš„å†…å­˜ç©ºé—´è¿›è¡Œå­˜å‚¨ï¼Œå¯ä»¥åƒæ•°ç»„ä¸€æ ·æ“ä½œï¼Œå¹¶ä¸”æ”¯æŒåŠ¨æ€æ‰©å®¹ã€‚</p></li><li><p>å…ƒç´ çš„éšæœºè®¿é—®æ–¹ä¾¿ï¼Œæ”¯æŒ[ ]ä¸‹æ ‡è®¿é—®å’Œ <a href="http://vector.at">vector.at</a>() æ“ä½œã€‚</p></li><li><p>èŠ‚çœç©ºé—´ï¼ˆå¯¹æ¯”å…¶ä»–å®¹å™¨ä½¿ç”¨ç©ºé—´è€Œè¨€ï¼‰ã€‚</p></li></ul></li><li><p><strong>ç¼ºç‚¹</strong></p><ul><li>ç”±äºå…¶é¡ºåºå­˜å‚¨çš„ç‰¹æ€§ï¼Œvector æ’å…¥åˆ é™¤æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ã€‚</li><li>åªèƒ½åœ¨æœ«ç«¯è¿›è¡Œ pop å’Œ pushã€‚</li><li>å½“åŠ¨æ€é•¿åº¦è¶…è¿‡é»˜è®¤åˆ†é…å¤§å°åï¼Œè¦æ•´ä½“é‡æ–°åˆ†é…ã€æ‹·è´å’Œé‡Šæ”¾ç©ºé—´ï¼Œå¼€é”€è¾ƒå¤§ã€‚</li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>C++</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>STL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€STLæºç åˆ†æã€‘è¿­ä»£å™¨</title>
    <link href="/2022/04/25/2022-04/2022-04-25%20%E3%80%90STL%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91%E8%BF%AD%E4%BB%A3%E5%99%A8/"/>
    <url>/2022/04/25/2022-04/2022-04-25%20%E3%80%90STL%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91%E8%BF%AD%E4%BB%A3%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>ä¹‹å‰åœ¨å·©å›ºC++åŸºç¡€æ—¶ï¼Œå­¦ä¹ äº†ä¾¯æ·è€å¸ˆçš„ã€ŠSTLæ³›å‹ç¼–ç¨‹ã€‹è¿™ä¸€è§†é¢‘è¯¾ç¨‹ï¼Œå½“æ—¶ä¹Ÿæ˜¯è¾¹çœ‹è¾¹è®°å½•ï¼Œä½†æ˜¯è®°å½•å¾—ä¹Ÿæ¯”è¾ƒæ¾æ•£ï¼Œçœ‹å®Œä¹‹åå¤§æ¦‚ä¹Ÿå°±æ˜¯æœ‰ç‚¹å°è±¡ï¼Œåˆ°ç°åœ¨åŸºæœ¬ä¸Šåˆæƒ³ä¸èµ·å¤ªå¤šäº†ã€‚ç„¶ååœ¨ç½‘ä¸Šçœ‹åˆ°äº†STLæºç åˆ†æçš„ç›¸å…³æ–‡ç« ï¼Œé˜…è¯»å­¦ä¹ ä¹‹åå¤§ä¸ºæ”¶ç›Šã€‚</p><p><strong>æœ¬æ–‡ä¸»è¦å†…å®¹å‚è€ƒ</strong>ï¼š<a href="https://mp.weixin.qq.com/s/srgj9KnxQrru_hMv-IVpWw">æ‰‹æ’• STL è¿­ä»£å™¨æºç ä¸ traits ç¼–ç¨‹æŠ€æ³•</a>ï¼Œå› ä¸ºåŸæ–‡å†…å®¹å¾ˆå……å®ï¼Œä¸€äº›å›¾ç”»å¾—å¾ˆç²¾å¦™ï¼Œæ‰€ä»¥ä¸ºäº†é¿å…é‡å¤é€ è½®å­ï¼Œä¹Ÿä¼šç›´æ¥å¼•ç”¨å…¶ä¸­çš„ä¸€äº›å›¾ç‰‡ã€æ–‡å­—ï¼Œå¦‚æœæœ‰é€ æˆä¾µæƒï¼Œè¯·åŠæ—¶å‘ŠçŸ¥ã€‚</p><p>æœ¬æ–‡å°†æ‘˜å½•æ€»ç»“å…¶ä¸­å…³é”®çš„çŸ¥è¯†ç‚¹ï¼Œä»¥ä¾¿æ—¥åå¤ä¹ æ—¶ï¼Œå¯ä»¥å¸®åŠ©è‡ªå·±å¿«é€Ÿæ‰¾åˆ°è¦ç‚¹ã€‚è€Œå¦‚æœæ­¤å‰æ²¡æœ‰å­¦ä¹ äº†è§£è¿‡STLç»„ä»¶çš„è¯ï¼Œå»ºè®®é˜…è¯»å­¦ä¹ åŸæ–‡ã€‚</p><h1 id="è¿­ä»£å™¨çš„ä½œç”¨æè¿°"><a class="markdownIt-Anchor" href="#è¿­ä»£å™¨çš„ä½œç”¨æè¿°"></a> è¿­ä»£å™¨çš„ä½œç”¨æè¿°</h1><p>åœ¨è®¾è®¡æ¨¡å¼ä¸­ï¼Œå…³äº iterator çš„æè¿°å¦‚ä¸‹ï¼š<strong>ä¸€ç§èƒ½å¤Ÿé¡ºåºè®¿é—®å®¹å™¨ä¸­æ¯ä¸ªå…ƒç´ çš„æ–¹æ³•ï¼Œä½¿ç”¨è¯¥æ–¹æ³•ä¸èƒ½æš´éœ²å®¹å™¨å†…éƒ¨çš„è¡¨è¾¾æ–¹å¼ã€‚è€Œç±»å‹èƒå–æŠ€æœ¯å°±æ˜¯ä¸ºäº†è¦è§£å†³å’Œ iterator æœ‰å…³çš„é—®é¢˜ã€‚</strong></p><p>é‚£ä¹ˆåœ¨STLç›¸å…³ç»„ä»¶ä¸­ï¼Œè¿­ä»£å™¨å°±æ˜¯å®¹å™¨å’Œç®—æ³•ä¹‹é—´çš„æ¡¥æ¢ï¼Œç®—æ³•é€šè¿‡è¿­ä»£å™¨æ¥è®¿é—®æ“ä½œå®¹å™¨ä¸­çš„æ•°æ®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204251621412.png" alt="è¿­ä»£å™¨ä¸å®¹å™¨å’Œç®—æ³•çš„äº¤äº’" /></p><h1 id="è¿­ä»£å™¨çš„è®¾è®¡å®ç°æ€è·¯"><a class="markdownIt-Anchor" href="#è¿­ä»£å™¨çš„è®¾è®¡å®ç°æ€è·¯"></a> è¿­ä»£å™¨çš„è®¾è®¡å®ç°æ€è·¯</h1><p>STLä¸­çš„è¿­ä»£å™¨ç±»ä¼¼ä¸€ç§æ™ºèƒ½æŒ‡é’ˆï¼Œæ‹¥æœ‰ä¸€èˆ¬æŒ‡é’ˆçš„ç‰¹æ€§â€”â€”èƒ½å¤Ÿå¯¹å…¶è¿›è¡Œ <code>*</code>å’Œ <code>-&gt;</code>æ“ä½œã€‚å…¶è®¾è®¡æ€è·¯å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204251622504.png" alt="è¿­ä»£å™¨è®¾è®¡æ€è·¯" /></p><p>å› ä¸ºè¿­ä»£å™¨éœ€è¦è·å–æ‰€æŒ‡å…ƒç´ å¯¹åº”çš„ç±»å‹ï¼Œæ‰€ä»¥é¦–å…ˆæƒ³åˆ°ä½¿ç”¨<strong>æ¨¡æ¿å‚æ•°è‡ªåŠ¨æ¨å¯¼</strong>çš„æ–¹æ³•ã€‚ä½†æ˜¯æ¨¡æ¿å‚æ•°æ¨å¯¼åªèƒ½æ¨å¯¼å‚æ•°ç±»å‹ï¼Œæ— æ³•æ¨å¯¼å‡½æ•°çš„è¿”å›å€¼ç±»å‹ã€‚</p><p>æ‰€ä»¥æƒ³åˆ°ç”¨<strong>å†…åµŒå‹åˆ«</strong>çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯åœ¨è¿­ä»£å™¨ç±»ï¼ˆclassï¼‰é‡Œé¢å®šä¹‰æ‰€æŒ‡çš„å…ƒç´ ç±»å‹ï¼ˆä½¿ç”¨typedefï¼‰ï¼Œé‚£ä¹ˆåœ¨éœ€è¦çš„æ—¶å€™ç›´æ¥ä½¿ç”¨å³å¯ã€‚</p><p>ä½†æ˜¯å­˜åœ¨çš„ä¸€ä¸ª<strong>éšæ™¦çš„é—®é¢˜</strong>ï¼šå®é™…ä¸Šå¹¶ä¸æ˜¯æ‰€æœ‰çš„è¿­ä»£å™¨éƒ½æ˜¯ <code>class type</code> ï¼ŒåŸç”ŸæŒ‡é’ˆä¹Ÿæ˜¯ä¸€ç§è¿­ä»£å™¨ï¼Œç”±äºåŸç”ŸæŒ‡é’ˆä¸æ˜¯ <code>class type</code> ï¼Œæ‰€ä»¥æ²¡æ³•ä¸ºå®ƒå®šä¹‰å†…åµŒå‹åˆ«ã€‚ç„¶åå°±æœ‰äº†<strong>æ¨¡æ¿åç‰¹åŒ–</strong>çš„è§£å†³æ€è·¯ï¼Œå…·ä½“å®ç°ä¸Šå°±æ˜¯å¼•å…¥ä¸­é—´ä¸€å±‚<strong>ç±»å‹èƒå–traits</strong>ï¼Œç”±è¯¥ç±»æ¨¡æ¿æ¥è·å–è¿­ä»£å™¨çš„å…ƒç´ ç±»å‹ï¼Œæºç ç›¸å…³å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204251625530.png" alt="iterator_traitsæºç " /></p><p class='note note-info'>å¦‚æœä¸å¼•å…¥ç±»å‹èƒå–traitsçš„è¯ï¼Œé‚£ä¹ˆä¸ºäº†æ”¯æŒåŸç”ŸæŒ‡é’ˆï¼Œæ¯ä¸ªè·Ÿè¿­ä»£å™¨æœ‰å…³çš„æ¨¡æ¿å‡½æ•°éƒ½éœ€è¦å®ç°å¯¹åŸç”ŸæŒ‡é’ˆçš„æ¨¡æ¿åç‰¹åŒ–ï¼Œä¸ºäº†èŠ‚çœè¿™ä¸€ä»£ç å¼€é”€ï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥ä¸­é—´å±‚iterator_traitsæ¥è·å–è¿­ä»£å™¨å…ƒç´ ç±»å‹ã€‚</p><p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼Œåœ¨STLä¸­è·å–è¿­ä»£å™¨å…ƒç´ ç±»å‹çš„è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204251623075.png" alt="è¿­ä»£å™¨è·å–å…ƒç´ ç±»å‹" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204251623099.png" alt="iterator_traitså®ç°åŸç†" /></p><h1 id="è¿­ä»£å™¨é‡Œå®šä¹‰çš„ç±»å‹"><a class="markdownIt-Anchor" href="#è¿­ä»£å™¨é‡Œå®šä¹‰çš„ç±»å‹"></a> è¿­ä»£å™¨é‡Œå®šä¹‰çš„ç±»å‹</h1><p>ä¸€èˆ¬è¿­ä»£å™¨é‡Œä¼šå®šä¹‰äº”ç§ç±»å‹ï¼š</p><ul><li><code>value_type</code>ï¼šè¿­ä»£å™¨æ‰€æŒ‡å¯¹è±¡çš„ç±»å‹ï¼ŒåŸç”ŸæŒ‡é’ˆä¹Ÿæ˜¯ä¸€ç§è¿­ä»£å™¨ï¼Œå¯¹äºåŸç”ŸæŒ‡é’ˆ int*ï¼Œint å³ä¸ºæŒ‡é’ˆæ‰€æŒ‡å¯¹è±¡çš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„ value_type ã€‚</li><li><code>difference_type</code>ï¼šç”¨æ¥è¡¨ç¤ºä¸¤ä¸ªè¿­ä»£å™¨ä¹‹é—´çš„è·ç¦»ï¼Œå¯¹äºåŸç”ŸæŒ‡é’ˆï¼ŒSTL ä»¥ C++ å†…å»ºçš„ ptrdiff_t ï¼ˆæ˜¯ long ç±»å‹çš„åˆ«åï¼‰ä½œä¸ºåŸç”ŸæŒ‡é’ˆçš„ difference_typeã€‚</li><li><code>reference_type</code>ï¼šæ˜¯æŒ‡è¿­ä»£å™¨æ‰€æŒ‡å¯¹è±¡çš„ç±»å‹çš„å¼•ç”¨ï¼Œreference_type ä¸€èˆ¬ç”¨åœ¨è¿­ä»£å™¨çš„ * è¿ç®—ç¬¦é‡è½½ä¸Šï¼Œå¦‚æœ value_type æ˜¯ Tï¼Œé‚£ä¹ˆå¯¹åº”çš„ reference_type å°±æ˜¯ T&amp;ï¼›å¦‚æœ value_type æ˜¯ const Tï¼Œé‚£ä¹ˆå¯¹åº”çš„reference_type å°±æ˜¯ const T&amp;ã€‚</li><li><code>pointer_type</code>ï¼šå°±æ˜¯ç›¸åº”çš„æŒ‡é’ˆç±»å‹ï¼Œå¯¹äºæŒ‡é’ˆæ¥è¯´ï¼Œæœ€å¸¸ç”¨çš„åŠŸèƒ½å°±æ˜¯ operator* å’Œ operator-&gt; ä¸¤ä¸ªè¿ç®—ç¬¦ã€‚</li><li><code>iterator_category</code>ï¼šçš„ä½œç”¨æ˜¯æ ‡è¯†è¿­ä»£å™¨çš„ç§»åŠ¨ç‰¹æ€§å’Œå¯ä»¥å¯¹è¿­ä»£å™¨æ‰§è¡Œçš„æ“ä½œï¼Œä» iterator_category ä¸Šï¼Œå¯å°†è¿­ä»£å™¨åˆ†ä¸º Input Iteratorã€Output Iteratorã€Forward Iteratorã€Bidirectional Iteratorã€Random Access Iterator äº”ç±»ï¼Œè¿™æ ·åˆ†å¯ä»¥å°½å¯èƒ½åœ°æé«˜æ•ˆç‡ã€‚</li></ul><p>ä¸‹å›¾æ˜¯æºç ä¸­å®šä¹‰çš„ <code>iterator</code>ï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204251628089.png" alt="iteratoræºç å®šä¹‰" /></p><h1 id="è¿­ä»£å™¨çš„åˆ†ç±»"><a class="markdownIt-Anchor" href="#è¿­ä»£å™¨çš„åˆ†ç±»"></a> è¿­ä»£å™¨çš„åˆ†ç±»</h1><p>åˆšåˆšåœ¨è¿­ä»£å™¨çš„<code>iterator_category</code> ä¸­ä¹Ÿè°ˆåˆ°äº†è¿­ä»£å™¨çš„åˆ†ç±»ï¼Œä¸»è¦æœ‰äº”ç§ï¼š</p><ul><li><p><code>Input Iterator</code>ï¼šæ­¤è¿­ä»£å™¨ä¸å…è®¸ä¿®æ”¹æ‰€æŒ‡çš„å¯¹è±¡ï¼Œæ˜¯<strong>åªè¯»</strong>çš„ã€‚æ”¯æŒ ==ã€!=ã€++ã€* ã€-&gt; ç­‰æ“ä½œã€‚ï¼ˆ*ã€-&gt; è¿”å›ç±»å‹å…·æœ‰constä¿®é¥°ï¼‰</p></li><li><p><code>Output Iterator</code>ï¼šå…è®¸ç®—æ³•åœ¨è¿™ç§è¿­ä»£å™¨æ‰€å½¢æˆçš„åŒºé—´ä¸Šè¿›è¡Œ<strong>åªå†™</strong>æ“ä½œã€‚æ”¯æŒ ++ã€* ç­‰æ“ä½œã€‚</p></li><li><p><code>Forward Iterator</code>ï¼šå…è®¸ç®—æ³•åœ¨è¿™ç§è¿­ä»£å™¨æ‰€å½¢æˆçš„åŒºé—´ä¸Šè¿›è¡Œè¯»å†™æ“ä½œï¼Œä½†åªèƒ½<strong>å•å‘ç§»åŠ¨</strong>ï¼Œæ¯æ¬¡åªèƒ½ç§»åŠ¨ä¸€æ­¥ã€‚æ”¯æŒ Input Iterator å’Œ Output Iterator çš„æ‰€æœ‰æ“ä½œã€‚</p></li><li><p><code>Bidirectional Iterator</code>ï¼šå…è®¸ç®—æ³•åœ¨è¿™ç§è¿­ä»£å™¨æ‰€å½¢æˆçš„åŒºé—´ä¸Šè¿›è¡Œè¯»å†™æ“ä½œï¼Œå¯<strong>åŒå‘ç§»åŠ¨</strong>ï¼Œæ¯æ¬¡åªèƒ½ç§»åŠ¨ä¸€æ­¥ã€‚æ”¯æŒ Forward Iterator çš„æ‰€æœ‰æ“ä½œï¼Œå¹¶å¦å¤–æ”¯æŒ â€“ æ“ä½œã€‚</p></li><li><p><code>Random Access Iterator</code>ï¼šåŒ…å«æŒ‡é’ˆçš„æ‰€æœ‰æ“ä½œï¼Œå¯è¿›è¡Œ<strong>éšæœºè®¿é—®</strong>ï¼Œéšæ„ç§»åŠ¨æŒ‡å®šçš„æ­¥æ•°ã€‚æ”¯æŒå‰é¢å››ç§ Iterator çš„æ‰€æœ‰æ“ä½œï¼Œå¹¶å¦å¤–æ”¯æŒ [n] æ“ä½œç¬¦ç­‰æ“ä½œã€‚</p></li></ul><h1 id="å°ç»“"><a class="markdownIt-Anchor" href="#å°ç»“"></a> å°ç»“</h1><p>æ ¹æ®å‚è€ƒæ–‡ç« ï¼š<a href="https://mp.weixin.qq.com/s/srgj9KnxQrru_hMv-IVpWw">æ‰‹æ’• STL è¿­ä»£å™¨æºç ä¸ traits ç¼–ç¨‹æŠ€æ³•</a>ï¼Œæ¢³ç†äº†STLç»„ä»¶ä¸­çš„è¿­ä»£å™¨å…³é”®çŸ¥è¯†ç‚¹ï¼Œæœ€åå†æ•´ç†ä¸€ä¸‹STLå…­å¤§ç»„ä»¶çš„äº¤äº’å…³ç³»ï¼š</p><p>containerï¼ˆå®¹å™¨ï¼‰ é€šè¿‡ allocatorï¼ˆåˆ†é…å™¨ï¼‰ å–å¾—æ•°æ®å‚¨å­˜ç©ºé—´ï¼Œalgorithmï¼ˆç®—æ³•ï¼‰é€šè¿‡ iteratorï¼ˆè¿­ä»£å™¨ï¼‰å­˜å– containerï¼ˆå®¹å™¨ï¼‰ å†…å®¹ï¼Œfunctorï¼ˆä»¿å‡½æ•°ï¼‰ å¯ä»¥ååŠ© algorithmï¼ˆç®—æ³•ï¼‰ å®Œæˆä¸åŒçš„ç­–ç•¥å˜åŒ–ï¼Œadapterï¼ˆé€‚é…å™¨ï¼‰ å¯ä»¥ä¿®é¥°æˆ–å¥—æ¥ functorï¼ˆä»¿å‡½æ•°ï¼‰ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>C++</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>STL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€è®¾è®¡æ¨¡å¼ã€‘é€‚é…å™¨æ¨¡å¼å’Œæ¡¥æ¥æ¨¡å¼</title>
    <link href="/2022/04/24/2022-04/2022-04-24%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E5%92%8C%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/"/>
    <url>/2022/04/24/2022-04/2022-04-24%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F%E5%92%8C%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="adapteré€‚é…å™¨ç±»å¯¹è±¡ç»“æ„å‹æ¨¡å¼"><a class="markdownIt-Anchor" href="#adapteré€‚é…å™¨ç±»å¯¹è±¡ç»“æ„å‹æ¨¡å¼"></a> Adapterï¼ˆé€‚é…å™¨ï¼‰â€”â€”ç±»å¯¹è±¡ç»“æ„å‹æ¨¡å¼</h1><h2 id="1-æ„å›¾"><a class="markdownIt-Anchor" href="#1-æ„å›¾"></a> 1. æ„å›¾</h2><p>å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ã€‚Adapteræ¨¡å¼ä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚</p><h2 id="2-åˆ«å"><a class="markdownIt-Anchor" href="#2-åˆ«å"></a> 2. åˆ«å</h2><p>åŒ…è£…å™¨(wrapper)</p><h2 id="3-åŠ¨æœº"><a class="markdownIt-Anchor" href="#3-åŠ¨æœº"></a> 3. åŠ¨æœº</h2><ul><li><p>æœ‰æ—¶ï¼Œä¸ºå¤ç”¨è€Œè®¾è®¡çš„å·¥å…·ç®±ç±»ä¸èƒ½å¤Ÿè¢«å¤ç”¨çš„åŸå› ä»…ä»…æ˜¯å› ä¸ºå®ƒçš„æ¥å£ä¸ä¸“ä¸šåº”ç”¨é¢†åŸŸæ‰€éœ€è¦çš„æ¥å£ä¸åŒ¹é…ï¼ˆåç§°ä¸ä¸€æ ·ï¼Œå‚æ•°ä¸ä¸€æ ·ç­‰ç­‰ï¼‰<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Head Firstè®¾è®¡æ¨¡å¼]èº«è¾¹çš„è®¾è®¡æ¨¡å¼â€“é€‚é…å™¨æ¨¡å¼">[1]</span></a></sup></p></li><li><p>æˆ‘ä»¬å¯ä»¥æ”¹å˜å·¥å…·ç®±ç±»ä½¿å®ƒå…¼å®¹ä¸“ä¸šé¢†åŸŸä¸­çš„ç±»çš„æ¥å£ï¼Œä½†å‰ææ˜¯å¿…é¡»æœ‰è¿™ä¸ªå·¥å…·ç®±çš„æºä»£ç ï¼Œç„¶è€Œ å³ä½¿æˆ‘ä»¬å¾—åˆ°äº†è¿™äº›æºä»£ç ï¼Œä¿®æ”¹å·¥å…·ç®±ä¹Ÿæ˜¯æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰çš„ï¼Œå› ä¸ºä¸åº”è¯¥ä»…ä»…ä¸ºäº†å®ç°ä¸€ä¸ªåº”ç”¨ï¼Œå·¥å…·ç®±å°±ä¸å¾—ä¸é‡‡ç”¨ä¸€äº›ä¸ç‰¹å®šé¢†åŸŸç›¸å…³çš„æ¥å£ã€‚</p></li><li><p>æˆ‘ä»¬å¯ä»¥ä¸ç”¨ä¸Šé¢çš„æ–¹æ³•ï¼Œè€Œå®šä¹‰ä¸€ä¸ªé€‚é…å™¨ç±»ï¼Œç”±ä»–æ¥é€‚é…å·¥å…·ç®±æ¥å£å’Œä¸“ä¸šåº”ç”¨çš„æ¥å£ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸¤ç§æ–¹æ³•åšè¿™ä»¶äº‹ï¼š</p><ul><li>ç»§æ‰¿ä¸“ä¸šåº”ç”¨ç±»çš„æ¥å£å’Œå·¥å…·ç®±ç±»çš„å®ç°ã€‚è¿™ç§æ–¹æ³•å¯¹åº”Adapteræ¨¡å¼çš„ç±»ç‰ˆæœ¬ï¼ˆå¤šç»§æ‰¿ï¼‰</li><li>å°†å·¥å…·ç®±ç±»çš„å®ç°ä½œä¸ºé€‚é…å™¨ç±»çš„ç»„æˆéƒ¨åˆ†ï¼Œå¹¶ä¸”ä½¿ç”¨å·¥å…·ç®±çš„æ¥å£å®ç°é€‚é…å™¨ç±»ã€‚è¿™ç§æ–¹æ³•å¯¹åº”Adapteræ¨¡å¼çš„å¯¹è±¡ç‰ˆæœ¬ã€‚</li></ul></li></ul><h2 id="4-é€‚ç”¨æ€§"><a class="markdownIt-Anchor" href="#4-é€‚ç”¨æ€§"></a> 4. é€‚ç”¨æ€§</h2><p>ä»¥ä¸‹æƒ…å†µä½¿ç”¨Adapteræ¨¡å¼ï¼š</p><ul><li>å¦‚æœä½ æƒ³ä½¿ç”¨ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç±»ï¼Œè€Œå®ƒçš„æ¥å£ä¸ç¬¦åˆä½ çš„éœ€æ±‚</li><li>ä½ æƒ³åˆ›å»ºä¸€ä¸ªå¯ä»¥å¤ç”¨çš„ç±»ï¼Œè¯¥ç±»å¯ä»¥ä¸å…¶ä»–ä¸ç›¸å…³çš„ç±»æˆ–ä¸å¯é¢„è§çš„ç±»ï¼ˆå³é‚£äº›æ¥å£å¯èƒ½ä¸ä¸€å®šå…¼å®¹çš„ç±»ï¼‰ååŒå·¥ä½œã€‚</li><li>ï¼ˆä»…é€‚ç”¨äºå¯¹è±¡Adapterï¼‰ä½ æƒ³ä½¿ç”¨ä¸€äº›å·²ç»å­˜åœ¨çš„å­ç±»ï¼Œä½†æ˜¯ä¸å¯èƒ½å¯¹æ¯ä¸€ä¸ªéƒ½è¿›è¡Œå­ç±»åŒ–ä»¥åŒ¹é…ä»–ä»¬çš„æ¥å£ã€‚å¯¹è±¡é€‚é…å™¨å¯ä»¥é€‚é…å®ƒçš„çˆ¶ç±»æ¥å£ã€‚</li></ul><h2 id="5-ç»“æ„"><a class="markdownIt-Anchor" href="#5-ç»“æ„"></a> 5. ç»“æ„</h2><p>ç±»é€‚é…å™¨ä½¿ç”¨å¤šé‡ç»§æ‰¿å¯¹ä¸€ä¸ªæ¥å£ä¸å¦ä¸€ä¸ªæ¥å£è¿›è¡ŒåŒ¹é…ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204241433783.jpeg" alt="ç±»é€‚é…å™¨ç¤ºæ„å›¾" /></p><p>å¯¹è±¡åŒ¹é…å™¨ä¾èµ–äºå¯¹è±¡ç»„åˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204241433025.jpeg" alt="å¯¹è±¡é€‚é…å™¨ç¤ºæ„å›¾" /></p><h2 id="6-å‚ä¸è€…"><a class="markdownIt-Anchor" href="#6-å‚ä¸è€…"></a> 6. å‚ä¸è€…</h2><ul><li>Target<ul><li>å®šä¹‰Clientä½¿ç”¨çš„ä¸ç‰¹å®šé¢†åŸŸç›¸å…³çš„æ¥å£</li></ul></li><li>Client<ul><li>ä¸ç¬¦åˆTargetæ¥å£çš„å¯¹è±¡ååŒ</li></ul></li><li>Adaptee<ul><li>å®šä¹‰ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æ¥å£ï¼Œä¸è¿™ä¸ªæ¥å£éœ€è¦é€‚é…</li></ul></li><li>Adapter<ul><li>å¯¹Adapteeçš„æ¥å£ä¸Targetæ¥å£è¿›è¡Œé€‚é…</li></ul></li></ul><h2 id="7-åä½œ"><a class="markdownIt-Anchor" href="#7-åä½œ"></a> 7. åä½œ</h2><p>Clientåœ¨Adapterå®ä¾‹ä¸Šè°ƒç”¨ä¸€äº›æ“ä½œã€‚æ¥ç€é€‚é…å™¨è°ƒç”¨Adapteeçš„æ“ä½œå®ç°è¿™ä¸ªè¯·æ±‚ã€‚</p><h2 id="8-æ•ˆæœ"><a class="markdownIt-Anchor" href="#8-æ•ˆæœ"></a> 8. æ•ˆæœ</h2><p>ç±»é€‚é…å™¨å’Œå¯¹è±¡é€‚é…å™¨æœ‰ä¸åŒçš„æƒè¡¡ã€‚ç±»é€‚é…çš„æƒè¡¡ä¸ºï¼š</p><ul><li>ç”¨ä¸€ä¸ªå…·ä½“çš„Adapterç±»å¯¹Adapteeå’ŒTargetè¿›è¡ŒåŒ¹é…ã€‚ç»“æœæ˜¯å½“æˆ‘ä»¬æƒ³è¦åŒ¹é…ä¸€ä¸ªç±»ä»¥åŠæ‰€æœ‰å®ƒçš„å­ç±»æ—¶ï¼Œç±»Adapterå°†ä¸èƒ½èƒœä»»å·¥ä½œã€‚</li><li>ä½¿å¾—Adapterå¯ä»¥é‡æ–°å®šä¹‰Adapteeçš„éƒ¨åˆ†è¡Œä¸ºï¼Œå› ä¸ºAdapteræ˜¯Adapteeçš„ä¸€ä¸ªå­ç±»ã€‚</li><li>ä»…ä»…å¼•å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸éœ€è¦é¢å¤–çš„æŒ‡é’ˆä»¥é—´æ¥å¾—åˆ°Adapteeã€‚</li></ul><p>å¯¹è±¡é€‚é…å™¨çš„æƒè¡¡ä¸ºï¼š</p><ul><li>å…è®¸ä¸€ä¸ªAdaterä¸å¤šä¸ªAdapteeï¼ˆå³Adapteeæœ¬èº«ä»¥åŠå®ƒçš„æ‰€æœ‰å­ç±»ï¼ˆå¦‚æœæœ‰å­ç±»çš„è¯ï¼‰åŒæ—¶å·¥ä½œã€‚Adapterä¹Ÿå¯ä»¥ä¸€æ¬¡ç»™æ‰€æœ‰çš„Adapteeæ·»åŠ åŠŸèƒ½ã€‚</li><li>ä½¿å¾—é‡å®šä¹‰Adapteeçš„è¡Œä¸ºæ¯”è¾ƒå›°éš¾ã€‚è¿™å°±éœ€è¦ç”ŸæˆAdapteeçš„å­ç±»å¹¶ä¸”ä½¿å¾—Adapterå¼•ç”¨è¿™ä¸ªå­ç±»è€Œä¸æ˜¯å¼•ç”¨Adapteeæœ¬èº«ã€‚</li></ul><h2 id="9-ç¤ºä¾‹ä»£ç "><a class="markdownIt-Anchor" href="#9-ç¤ºä¾‹ä»£ç "></a> 9. ç¤ºä¾‹ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Adapter.h</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/24.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> CREATIONPATTERNDESIGN_ADAPTER_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CREATIONPATTERNDESIGN_ADAPTER_H</span><br><br><span class="hljs-comment">// ä½¿ç”¨ç°å®ç”Ÿæ´»çš„æ¥å£è½¬æ¥å™¨çš„ä¾‹å­ï¼Œæ¥å±•ç¤ºä½¿ç”¨Adapteræ¨¡å¼</span><br><span class="hljs-comment">// mac ä¸Šåªæœ‰ typecæ¥å£ï¼Œè€Œå¤–è®¾é”®ç›˜æ˜¯USBæ¥å£ï¼Œé€šè¿‡è½¬æ¢å™¨å°† USBæ¥å£è½¬æ¢ä¸º typecæ¥å£è¾“å‡º</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_adapter</span><span class="hljs-params">()</span></span>;<br><br><span class="hljs-comment">// USBæ¥å£è¾“å‡º</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">USB</span>  &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">output_usb_data</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;USBæ¥å£ è¾“å‡ºæ•°æ® ... &quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// Typec æ¥å£è¾“å‡º</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Typec</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">output_typec_data</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;Typecæ¥å£ è¾“å‡ºæ•°æ® ... &quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// æ¥å£è½¬æ¥å™¨ï¼Œå°†USBè¾“å‡ºè½¬æ¢ä¸º Typecè¾“å‡º</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Adapter</span> :</span> <span class="hljs-keyword">public</span> Typec &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Adapter</span>(USB *usb) : <span class="hljs-built_in">usb</span>(usb) &#123;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">output_typec_data</span><span class="hljs-params">()</span> </span>&#123;<br>        usb-&gt;<span class="hljs-built_in">output_usb_data</span>();<br>        <span class="hljs-comment">// è¿›è¡Œè½¬æ¢å¤„ç†å·¥ä½œ</span><br>        cout &lt;&lt; <span class="hljs-string">&quot;æ­£åœ¨è§£æ usb è¾“å‡ºæ•°æ®ï¼Œè¿›è¡Œè½¬æ¢...&quot;</span> &lt;&lt; endl;<br><br>        cout &lt;&lt; <span class="hljs-string">&quot;Typecæ¥å£ è¾“å‡ºæ•°æ® ... &quot;</span> &lt;&lt; endl;<br>    &#125;<br><br><span class="hljs-keyword">private</span>:<br>    USB* usb;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mac</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">input_typec</span><span class="hljs-params">(Typec * typec)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (typec != <span class="hljs-literal">nullptr</span>) &#123;<br>            interface = typec;<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">work</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;Mac å¼€å§‹å·¥ä½œ...&quot;</span> &lt;&lt; endl;<br>        interface-&gt;<span class="hljs-built_in">output_typec_data</span>();<br>    &#125;<br><br><span class="hljs-keyword">private</span>:<br>    Typec *interface;<br>&#125;;<br><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//CREATIONPATTERNDESIGN_ADAPTER_H</span></span><br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Adapter.cpp</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/24.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;Adapter.h&quot;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_adapter</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯•é€‚é…å™¨æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>    Mac mac;<br>    USB keyboard;<br>    <span class="hljs-function">Adapter <span class="hljs-title">adapter</span><span class="hljs-params">(&amp;keyboard)</span></span>;<br>    mac.<span class="hljs-built_in">input_typec</span>(&amp;adapter);<br>    mac.<span class="hljs-built_in">work</span>();<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç»“æŸæµ‹è¯•é€‚é…å™¨æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="10-ç›¸å…³æ¨¡å¼"><a class="markdownIt-Anchor" href="#10-ç›¸å…³æ¨¡å¼"></a> 10. ç›¸å…³æ¨¡å¼</h2><p>æ¨¡å¼Bridgeçš„ç»“æœä¸å¯¹è±¡é€‚é…å™¨ç±»ä¼¼ï¼Œä½†æ˜¯Bridgeæ¨¡å¼çš„å‡ºå‘ç‚¹ä¸åŒï¼šBridgeçš„ç›®çš„æ˜¯å°†æ¥å£éƒ¨åˆ†å’Œå®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä»è€Œå¯ä»¥å¯¹å®ƒä»¬è¾ƒä¸ºå®¹æ˜“ä¹Ÿç›¸å¯¹ç‹¬ç«‹åœ°åŠ ä»¥æ”¹å˜ã€‚è€ŒAdapteråˆ™æ„å‘³ç€æ”¹å˜ä¸€ä¸ªå·²æœ‰å¯¹è±¡çš„æ¥å£ã€‚</p><p>Decoratoræ¨¡å¼å¢å¼ºäº†å…¶ä»–å¯¹è±¡çš„åŠŸèƒ½è€ŒåŒæ—¶åˆä¸æ”¹å˜å®ƒçš„æ¥å£ï¼Œå› æ­¤Decoratorå¯¹åº”ç”¨ç¨‹åºçš„é€æ˜æ€§æ¯”é€‚é…å™¨è¦å¥½ã€‚ç»“æœæ˜¯Decoratoræ”¯æŒé€’å½’ç»„åˆï¼Œè€Œçº¯ç²¹ä½¿ç”¨é€‚é…å™¨æ˜¯ä¸å¯èƒ½å®ç°è¿™ä¸€ç‚¹çš„ã€‚</p><p>æ¨¡å¼Proxyåœ¨ä¸æ”¹å˜å®ƒçš„æ¥å£çš„æ¡ä»¶ä¸‹ï¼Œä¸ºå¦ä¸€ä¸ªå¯¹è±¡å®šä¹‰äº†ä¸€ä¸ªä»£ç†ã€‚</p><h1 id="bridgeæ¡¥æ¥å¯¹è±¡ç»“æ„æ¨¡å‹"><a class="markdownIt-Anchor" href="#bridgeæ¡¥æ¥å¯¹è±¡ç»“æ„æ¨¡å‹"></a> Bridgeï¼ˆæ¡¥æ¥ï¼‰â€”â€”å¯¹è±¡ç»“æ„æ¨¡å‹</h1><h2 id="1-æ„å›¾-2"><a class="markdownIt-Anchor" href="#1-æ„å›¾-2"></a> 1. æ„å›¾</h2><p>å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–ã€‚</p><h2 id="2-åˆ«å-2"><a class="markdownIt-Anchor" href="#2-åˆ«å-2"></a> 2. åˆ«å</h2><p>Handle/Body</p><h2 id="3-åŠ¨æœº-2"><a class="markdownIt-Anchor" href="#3-åŠ¨æœº-2"></a> 3. åŠ¨æœº</h2><p>å½“ä¸€ä¸ªæŠ½è±¡å¯èƒ½æœ‰å¤šä¸ªå®ç°æ—¶ï¼Œé€šå¸¸ç”¨ç»§æ‰¿æ¥åè°ƒå®ƒä»¬ã€‚æŠ½è±¡ç±»å®šä¹‰å¯¹è¯¥æŠ½è±¡çš„æ¥å£ï¼Œè€Œå…·ä½“çš„å­ç±»åˆ™ç”¨ä¸åŒæ–¹å¼åŠ ä»¥å®ç°ã€‚ä½†æ˜¯æ­¤æ–¹æ³•æœ‰æ—¶ä¸å¤Ÿçµæ´»ã€‚ç»§æ‰¿æœºåˆ¶å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†å›ºå®šåœ¨ä¸€èµ·ï¼Œä½¿å¾—éš¾ä»¥å¯¹æŠ½è±¡éƒ¨åˆ†å’Œå®ç°éƒ¨åˆ†ç‹¬ç«‹çš„è¿›è¡Œä¿®æ”¹ã€æ‰©å……å’Œé‡ç”¨ã€‚æ¡¥æ¥æ¨¡å¼æŠŠä¾èµ–å…·ä½“å®ç°ï¼Œæå‡ä¸ºä¾èµ–æŠ½è±¡ï¼Œæ¥å®Œæˆå¯¹è±¡å’Œå˜åŒ–å› ç´ ä¹‹é—´çš„ä½è€¦åˆï¼Œæé«˜ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚æ¡¥æ¥æ¨¡å¼çš„ä¸»è¦ç›®çš„æ˜¯å°†ä¸€ä¸ªå¯¹è±¡çš„å˜åŒ–ä¸å…¶å®ƒå˜åŒ–éš”ç¦»å¼€ï¼Œè®©å½¼æ­¤ä¹‹é—´çš„è€¦åˆåº¦æœ€ä½ã€‚<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="C++è®¾è®¡æ¨¡å¼â€“æ¡¥æ¥æ¨¡å¼_kmcflyçš„åšå®¢-CSDNåšå®¢">[2]</span></a></sup></p><h2 id="4-é€‚ç”¨æ€§-2"><a class="markdownIt-Anchor" href="#4-é€‚ç”¨æ€§-2"></a> 4. é€‚ç”¨æ€§</h2><p>ä»¥ä¸‹æƒ…å†µä¸‹ä½¿ç”¨Bridgeæ¨¡å¼ï¼š</p><ul><li>ä½ ä¸å¸Œæœ›åœ¨æŠ½è±¡å’Œå®ƒçš„å®ç°éƒ¨åˆ†ä¹‹é—´æœ‰ä¸€ä¸ªå›ºå®šçš„ç»‘å®šå…³ç³»ã€‚ä¾‹å¦‚åœ¨ç¨‹åºè¿è¡Œæ—¶åˆ»å®ç°éƒ¨åˆ†åº”å¯ä»¥è¢«é€‰æ‹©æˆ–è€…åˆ‡æ¢ã€‚</li><li>ç±»çš„æŠ½è±¡ä»¥åŠå®ƒçš„å®ç°éƒ½åº”è¯¥å¯ä»¥é€šè¿‡ç”Ÿæˆå­ç±»æ–¹æ³•åŠ ä»¥æ‰©å……ã€‚è¿™æ—¶çš„æ¡¥æ¥æ¨¡å¼ä½¿ä½ å¯ä»¥å¯¹ä¸åŒçš„æŠ½è±¡æ¥å£å’Œå®ç°éƒ¨åˆ†è¿›è¡Œç»„åˆï¼Œå¹¶åˆ†åˆ«å¯¹å®ƒä»¬è¿›è¡Œæ‰©å……ã€‚</li><li>å¯¹ä¸€ä¸ªæŠ½è±¡çš„å®ç°éƒ¨åˆ†çš„ä¿®æ”¹åº”å¯¹å®¢æˆ·ä¸äº§ç”Ÿå½±å“ï¼Œå³å®¢æˆ·çš„ä»£ç ä¸å¿…é‡æ–°ç¼–è¯‘ã€‚</li><li>æƒ³å¯¹å®¢æˆ·å®Œå…¨éšè—æŠ½è±¡çš„å®ç°éƒ¨åˆ†ã€‚</li><li>æœ‰è®¸å¤šç±»è¦ç”Ÿæˆï¼Œç±»çš„å±‚æ¬¡ç»“æ„è¯´æ˜ä½ å¿…é¡»å¾—å°†ä¸€ä¸ªå¯¹è±¡åˆ†è§£æˆä¸¤ä¸ªéƒ¨åˆ†ã€‚</li><li>ä½ æƒ³åœ¨å¤šä¸ªå¯¹è±¡é—´å…±äº«å®ç°ï¼ˆå¯èƒ½ä½¿ç”¨å¼•ç”¨è®¡æ•°ï¼‰ï¼Œä½†åŒæ—¶è¦æ±‚å®¢æˆ·å¹¶ä¸çŸ¥é“è¿™ä¸€ç‚¹ã€‚</li></ul><h2 id="5-ç»“æ„-2"><a class="markdownIt-Anchor" href="#5-ç»“æ„-2"></a> 5. ç»“æ„</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204241435913.jpeg" alt="ç»“æ„å›¾" /></p><h2 id="6-å‚ä¸è€…-2"><a class="markdownIt-Anchor" href="#6-å‚ä¸è€…-2"></a> 6. å‚ä¸è€…</h2><ul><li>Abstraction<ul><li>å®šä¹‰æŠ½è±¡ç±»çš„æ¥å£</li><li>ç»´æŠ¤ä¸€ä¸ªæŒ‡å‘Implementorç±»å‹å¯¹è±¡çš„æŒ‡é’ˆ</li></ul></li><li>RefinedAbstraction<ul><li>æ‰©å……ç”±Abstractionå®šä¹‰çš„æ¥å£</li></ul></li><li>Implementor<ul><li>å®šä¹‰å®ç°ç±»çš„æ¥å£ï¼Œè¯¥æ¥å£ä¸ä¸€å®šè¦ä¸Abstractionçš„æ¥å£å®Œå…¨ä¸€è‡´ï¼Œäº‹å®ä¸Šè¿™ä¸¤ä¸ªæ¥å£å¯ä»¥å®Œå…¨ä¸åŒã€‚ä¸€èˆ¬æ¥è®²ï¼ŒImplementoræ¥å£ä»…æä¾›åŸºæœ¬æ“ä½œï¼Œè€ŒAbstractionåˆ™å®šä¹‰äº†åŸºäºè¿™äº›åŸºæœ¬æ“ä½œçš„è¾ƒé«˜å±‚æ¬¡çš„æ“ä½œ</li></ul></li><li>ConcreteImplementor<ul><li>å®ç°Implementoræ¥å£å¹¶å®šä¹‰å®ƒçš„å…·ä½“å®ç°</li></ul></li></ul><h2 id="7-åä½œ-2"><a class="markdownIt-Anchor" href="#7-åä½œ-2"></a> 7. åä½œ</h2><p>Abstraction å°† client çš„è¯·æ±‚è½¬å‘ç»™å®ƒçš„ Implementorå¯¹è±¡ã€‚</p><h2 id="8-æ•ˆæœ-2"><a class="markdownIt-Anchor" href="#8-æ•ˆæœ-2"></a> 8. æ•ˆæœ</h2><p>Bridgeæ¨¡å¼æœ‰ä»¥ä¸‹æœ‰ç‚¹ï¼š</p><ul><li><p>åˆ†ç¦»æ¥å£åŠå…¶å®ç°éƒ¨åˆ†</p><p>ã€‚ä¸€ä¸ªå®ç°æœªå¿…ä¸å˜åœ°ç»‘å®šåœ¨ä¸€ä¸ªæ¥å£ä¸Šã€‚æŠ½è±¡ç±»çš„å®ç°å¯ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡Œé…ç½®ï¼Œä¸€ä¸ªå¯¹è±¡ç”šè‡³å¯ä»¥åœ¨è¿è¡Œæ—¶æ”¹å˜å®ƒçš„å®ç°ã€‚</p><ul><li>å°†Abstractionä¸Implementoråˆ†ç¦»æœ‰åŠ©äºé™ä½å¯¹å®ç°éƒ¨åˆ†ç¼–è¯‘æ—¶çš„ä¾èµ–ï¼Œå½“æ”¹å˜ä¸€ä¸ªå®ç°ç±»æ—¶ï¼Œå¹¶ä¸éœ€è¦é‡æ–°ç¼–è¯‘Abstractionç±»å’Œå®ƒçš„å®¢æˆ·ç¨‹åºã€‚ä¸ºäº†ä¿è¯ä¸€ä¸ªç±»åº“çš„ä¸åŒç‰ˆæœ¬ä¹‹é—´çš„äºŒè¿›åˆ¶å…¼å®¹æ€§ï¼Œä¸€å®šè¦æœ‰è¿™ä¸ªæ€§è´¨ã€‚</li><li>å¦å¤–ï¼Œæ¥å£ä¸å®ç°åˆ†ç¦»æœ‰åŠ©äºåˆ†å±‚ï¼Œä»è€Œäº§ç”Ÿæ›´å¥½çš„ç»“æ„åŒ–ç³»ç»Ÿï¼Œç³»ç»Ÿçš„é«˜å±‚éƒ¨åˆ†ä»…éœ€çŸ¥é“Abstractionå’ŒImplementorã€‚</li></ul></li><li><p><strong>æé«˜å¯æ‰©å……æ€§</strong>ã€‚ä½ å¯ä»¥ç‹¬ç«‹åœ°å¯¹Abstractionå’ŒImplementorå±‚æ¬¡ç»“æ„è¿›è¡Œæ‰©å……ã€‚</p></li><li><p><strong>å®ç°ç»†èŠ‚å¯¹å®¢æˆ·é€æ˜</strong>ã€‚ä½ å¯ä»¥å¯¹å®¢æˆ·éšè—å®ç°ç»†èŠ‚ï¼Œä¾‹å¦‚å…±äº«Implementorå¯¹è±¡ä»¥åŠç›¸åº”çš„å¼•ç”¨è®¡æ•°æœºåˆ¶ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚</p></li></ul><h2 id="9-ç¤ºä¾‹ä»£ç -2"><a class="markdownIt-Anchor" href="#9-ç¤ºä¾‹ä»£ç -2"></a> 9. ç¤ºä¾‹ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Bridge.h</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/24.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> CREATIONPATTERNDESIGN_BRIDGE_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CREATIONPATTERNDESIGN_BRIDGE_H</span><br><br><span class="hljs-comment">// ç”¨å›¾å½¢ å’Œ é¢œè‰² è¿™ä¸€ç»å…¸ä¾‹å­æ¥æ¼”ç¤º Bridgeæ¨¡å¼</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_bridge</span><span class="hljs-params">()</span></span>;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Color</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">fill_color</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Shape</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Shape</span>(Color* color) : <span class="hljs-built_in">color</span>(color) &#123;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">draw_shape</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;<br><br><span class="hljs-keyword">protected</span>:<br>    Color* color;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Rectangle</span> :</span> <span class="hljs-keyword">public</span> Shape &#123;<br><span class="hljs-keyword">public</span>:<br><br>    <span class="hljs-built_in">Rectangle</span>(Color* color) : <span class="hljs-built_in">Shape</span>(color) &#123;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">draw_shape</span><span class="hljs-params">()</span> </span>&#123;<br>        color-&gt;<span class="hljs-built_in">fill_color</span>();<br>        cout &lt;&lt; <span class="hljs-string">&quot;ç»˜åˆ¶ä¸€ä¸ªæ­£æ–¹å½¢&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Circle</span> :</span> <span class="hljs-keyword">public</span> Shape &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Circle</span>(Color* color) : <span class="hljs-built_in">Shape</span>(color) &#123;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">draw_shape</span><span class="hljs-params">()</span> </span>&#123;<br>        color-&gt;<span class="hljs-built_in">fill_color</span>();<br>        cout &lt;&lt; <span class="hljs-string">&quot;ç»˜åˆ¶ä¸€ä¸ªåœ†å½¢&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedColor</span> :</span> <span class="hljs-keyword">public</span> Color &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">fill_color</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;å¡«å……èƒŒæ™¯é¢œè‰²ï¼šçº¢è‰²&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BlueColor</span> :</span> <span class="hljs-keyword">public</span> Color &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">fill_color</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;å¡«å……èƒŒæ™¯é¢œè‰²ï¼šè“è‰²&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//CREATIONPATTERNDESIGN_BRIDGE_H</span></span><br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Bridge.cpp</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/24.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;Bridge.h&quot;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_bridge</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯•æ¡¥æ¥æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>    Color * red = <span class="hljs-keyword">new</span> RedColor;<br>    Color * blue = <span class="hljs-keyword">new</span> BlueColor;<br>    Shape* red_rectangle = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Rectangle</span>(red);<br>    red_rectangle-&gt;<span class="hljs-built_in">draw_shape</span>();<br>    Shape* blue_circle = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Rectangle</span>(blue);<br>    blue_circle-&gt;<span class="hljs-built_in">draw_shape</span>();<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç»“æŸæµ‹è¯•æ¡¥æ¥æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="10-ç›¸å…³æ¨¡å¼-2"><a class="markdownIt-Anchor" href="#10-ç›¸å…³æ¨¡å¼-2"></a> 10. ç›¸å…³æ¨¡å¼</h2><p>Abstract Factory æ¨¡å¼å¯ä»¥ç”¨æ¥åˆ›å»ºå’Œé…ç½®ä¸€ä¸ªç‰¹å®šçš„Bridgeæ¨¡å¼ã€‚</p><p>Adapter æ¨¡å¼ç”¨æ¥å¸®åŠ©æ— å…³çš„ç±»ååŒå·¥ä½œï¼Œå®ƒé€šå¸¸åœ¨ç³»ç»Ÿè®¾è®¡å®Œæˆåæ‰ä¼šè¢«ä½¿ç”¨ã€‚ç„¶è€Œï¼ŒBridgeæ¨¡å¼åˆ™æ˜¯åœ¨ç³»ç»Ÿå¼€å§‹æ—¶å°±è¢«ä½¿ç”¨ï¼Œå®ƒä½¿å¾—æŠ½è±¡æ¥å£å’Œå®ç°éƒ¨åˆ†å¯ä»¥ç‹¬ç«‹è¿›è¡Œæ”¹å˜ã€‚</p><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.likecs.com/show-305350077.html">Head Firstè®¾è®¡æ¨¡å¼]èº«è¾¹çš„è®¾è®¡æ¨¡å¼â€“é€‚é…å™¨æ¨¡å¼</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://blog.csdn.net/u011244446/article/details/48680141">C++è®¾è®¡æ¨¡å¼â€“æ¡¥æ¥æ¨¡å¼_kmcflyçš„åšå®¢-CSDNåšå®¢</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¼–ç¨‹æŠ€å·§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€è®¾è®¡æ¨¡å¼ã€‘ç”Ÿæˆå™¨æ¨¡å¼ä¸å•ä¾‹æ¨¡å¼</title>
    <link href="/2022/04/17/2022-04/2022-04-17%20%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E7%94%9F%E6%88%90%E5%99%A8%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
    <url>/2022/04/17/2022-04/2022-04-17%20%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E7%94%9F%E6%88%90%E5%99%A8%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="builderç”Ÿæˆå™¨å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼"><a class="markdownIt-Anchor" href="#builderç”Ÿæˆå™¨å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼"></a> Builderï¼ˆç”Ÿæˆå™¨ï¼‰â€”â€”å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼</h1><h2 id="1-æ„å›¾"><a class="markdownIt-Anchor" href="#1-æ„å›¾"></a> 1. æ„å›¾</h2><p>å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥å™¨åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚</p><h2 id="2-åŠ¨æœº"><a class="markdownIt-Anchor" href="#2-åŠ¨æœº"></a> 2. åŠ¨æœº</h2><p>é¢ä¸´ç€â€œä¸€ä¸ªå¤æ‚å¯¹è±¡â€çš„åˆ›å»ºå·¥ä½œï¼Œå…¶é€šå¸¸ç”±å„ä¸ªéƒ¨åˆ†çš„å­å¯¹è±¡ç”¨ä¸€å®šçš„ç®—æ³•æ„æˆï¼Œç”±äºéœ€æ±‚å˜åŒ–ï¼Œè¿™ä¸ªå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨åˆ†ç»å¸¸å˜åŒ–ï¼Œä½†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·çš„ç®—æ³•å¾ˆç¨³å®šã€‚</p><h2 id="3-é€‚ç”¨æ€§"><a class="markdownIt-Anchor" href="#3-é€‚ç”¨æ€§"></a> 3. é€‚ç”¨æ€§</h2><p>åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ä½¿ç”¨Builderæ¨¡å¼ï¼š</p><ul><li>å½“åˆ›å»ºå¤æ‚å¯¹è±¡çš„ç®—æ³•åº”è¯¥ç‹¬ç«‹äºè¯¥å¯¹è±¡çš„ç»„æˆéƒ¨åˆ†ä»¥åŠå®ƒä»¬çš„è£…é…æ–¹å¼æ—¶</li><li>å½“æ„é€ è¿‡ç¨‹å¿…é¡»å…è®¸è¢«æ„é€ çš„å¯¹è±¡æœ‰ä¸åŒçš„è¡¨ç¤ºæ—¶</li></ul><h2 id="4-ç»“æ„"><a class="markdownIt-Anchor" href="#4-ç»“æ„"></a> 4. ç»“æ„</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204171447075.jpeg" alt="ç»“æ„ç¤ºæ„å›¾" /></p><h2 id="5-å‚ä¸è€…"><a class="markdownIt-Anchor" href="#5-å‚ä¸è€…"></a> 5. å‚ä¸è€…</h2><ul><li>Builder<ul><li>ä¸ºåˆ›å»ºä¸€ä¸ªProductå¯¹è±¡çš„å„ä¸ªéƒ¨ä»¶æŒ‡å®šæŠ½è±¡æ¥å£</li></ul></li><li>ConcreteBuilder<ul><li>å®ç°Builderçš„æ¥å£ä»¥æ„é€ å’Œè£…é…è¯¥äº§å“çš„å„ä¸ªéƒ¨ä»¶</li><li>å®šä¹‰å¹¶è·Ÿè¸ªå®ƒæ‰€åˆ›å»ºçš„è¡¨ç¤º</li><li>æä¾›ä¸€ä¸ªæ£€ç´¢äº§å“çš„æ¥å£</li></ul></li><li>Director<ul><li>æ„é€ ä¸€ä¸ªä½¿ç”¨Builderæ¥å£çš„å¯¹è±¡</li></ul></li><li>Product<ul><li>è¡¨ç¤ºè¢«æ„é€ çš„å¤æ‚å¯¹è±¡ã€‚ConcreteBuilderåˆ›å»ºè¯¥äº§å“çš„å†…éƒ¨è¡¨ç¤ºå¹¶å®šä¹‰å®ƒçš„è£…é…è¿‡ç¨‹</li><li>åŒ…å«å®šä¹‰ç»„æˆéƒ¨ä»¶çš„ç±»ï¼ŒåŒ…æ‹¬å°†è¿™äº›éƒ¨ä»¶è£…é…æˆæœ€ç»ˆäº§å“çš„æ¥å£</li></ul></li></ul><h2 id="6-åä½œ"><a class="markdownIt-Anchor" href="#6-åä½œ"></a> 6. åä½œ</h2><ul><li><p>å®¢æˆ·åˆ›å»ºDirectorå¯¹è±¡ï¼Œå¹¶ç”¨å®ƒæ‰€æƒ³è¦çš„Builderå¯¹è±¡è¿›è¡Œé…ç½®</p></li><li><p>ä¸€æ—¦ç”Ÿæˆäº†äº§å“éƒ¨ä»¶ï¼Œå¯¼å‘å™¨å°±ä¼šé€šçŸ¥ç”Ÿæˆå™¨</p></li><li><p>ç”Ÿæˆå™¨å¤„ç†å¯¼å‘å™¨çš„è¯·æ±‚ï¼Œå¹¶å°†éƒ¨ä»¶æ·»åŠ åˆ°è¯¥äº§å“ä¸­</p></li><li><p>å®¢æˆ·ä»ç”Ÿæˆå™¨ä¸­æ£€ç´¢äº§å“</p></li></ul><p>ä¸‹é¢çš„äº¤äº’å›¾è¯´æ˜äº†Builderå’ŒDirectoræ˜¯å¦‚ä½•ä¸ä¸€ä¸ªå®¢æˆ·åä½œçš„ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204171447454.jpeg" alt="äº¤äº’å›¾" /></p><h2 id="7-æ•ˆæœ"><a class="markdownIt-Anchor" href="#7-æ•ˆæœ"></a> 7. æ•ˆæœ</h2><ul><li><strong>å®ƒä½¿ä½ å¯ä»¥æ”¹å˜ä¸€ä¸ªäº§å“çš„å†…éƒ¨è¡¨ç¤º</strong>ã€‚Builderå¯¹è±¡æä¾›ç»™å¯¼å‘å™¨ä¸€ä¸ªæ„é€ äº§å“çš„æŠ½è±¡æ¥å£ã€‚è¯¥æ¥å£ä½¿å¾—ç”Ÿæˆå™¨å¯ä»¥éšè—è¿™ä¸ªäº§å“çš„è¡¨ç¤ºå’Œå†…éƒ¨ç»“æ„ã€‚å®ƒåŒæ—¶ä¹Ÿéšè—äº†è¯¥äº§å“æ˜¯å¦‚ä½•è£…é…çš„ã€‚å› ä¸ºäº§å“æ˜¯é€šè¿‡æŠ½è±¡æ¥å£æ„é€ çš„ï¼Œä½ åœ¨æ”¹å˜äº§å“çš„å†…éƒ¨è¡¨ç¤ºæ—¶æ‰€è¦åšçš„åªæ˜¯å®šä¹‰ä¸€ä¸ªæ–°çš„ç”Ÿæˆå™¨ã€‚</li><li><strong>å®ƒå°†æ„é€ ä»£ç å’Œè¡¨ç¤ºåˆ†å¼€</strong>ã€‚Builderæ¨¡å¼é€šè¿‡å°è£…ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„åˆ›å»ºå’Œè¡¨ç¤ºæ–¹å¼æé«˜äº†å¯¹è±¡çš„æ¨¡å—æ€§ã€‚å®¢æˆ·ä¸éœ€è¦çŸ¥é“å®šä¹‰äº§å“å†…éƒ¨ç»“æ„çš„ç±»çš„æ‰€æœ‰ä¿¡æ¯ï¼Œè¿™äº›ç±»æ˜¯ä¸å‡ºç°åœ¨Builderæ¥å£ä¸­çš„ã€‚</li><li><strong>å®ƒä½¿ä½ å¯å¯¹æ„é€ è¿‡ç¨‹è¿›è¡Œæ›´ç²¾ç»†çš„æ§åˆ¶</strong>ã€‚Builderæ¨¡å¼ä¸ä¸€ä¸‹å­å°±ç”Ÿæˆäº§å“çš„åˆ›å»ºæ¨¡å¼ä¸åŒï¼Œå®ƒæ˜¯åœ¨å¯¼å‘å™¨çš„æ§åˆ¶ä¸‹ä¸€æ­¥ä¸€æ­¥æ„é€ äº§å“çš„ã€‚</li></ul><h2 id="8-ç¤ºä¾‹ä»£ç "><a class="markdownIt-Anchor" href="#8-ç¤ºä¾‹ä»£ç "></a> 8. ç¤ºä¾‹ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Builder.h</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/17.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> CREATIONPATTERNDESIGN_BUILDER_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CREATIONPATTERNDESIGN_BUILDER_H</span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_builder</span><span class="hljs-params">()</span></span>;<br><br><span class="hljs-comment">// éœ€è¦æ„é€ çš„äº§å“ï¼Œè¿™é‡Œå°±æ˜¯ç”µè„‘ï¼Œç®€åŒ–å®ç°ï¼ŒæŠŠå…¶ä¸­éœ€è¦ç”Ÿäº§çš„é›¶éƒ¨ä»¶éƒ½ç”¨å­—ç¬¦ä¸²è¡¨ç¤º</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Computer</span> &#123;</span><br>    string cpu;<br>    string memory;<br>    string mainboard;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">show_info</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt;<span class="hljs-string">&quot;CPU:&quot;</span> &lt;&lt; cpu &lt;&lt; <span class="hljs-string">&quot; memory:&quot;</span> &lt;&lt; memory &lt;&lt; <span class="hljs-string">&quot; mainboard:&quot;</span> &lt;&lt; mainboard &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// Builderç±»ï¼Œå®šä¹‰ä¸€ç³»åˆ—ç”Ÿäº§é›¶éƒ¨ä»¶çš„æ¥å£</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComputerBuilder</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">build_computer</span><span class="hljs-params">()</span> </span>&#123;<br>        computer = <span class="hljs-keyword">new</span> Computer;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">build_cpu</span><span class="hljs-params">()</span> </span>&#123;&#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">build_mainboard</span><span class="hljs-params">()</span> </span>&#123;&#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">build_memory</span><span class="hljs-params">()</span> </span>&#123;&#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> Computer *<span class="hljs-title">get_computer</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (computer != <span class="hljs-literal">nullptr</span>) &#123;<br>            <span class="hljs-keyword">return</span> computer;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>    &#125;<br><br><span class="hljs-keyword">protected</span>:<br>    Computer *computer;<br>&#125;;<br><br><span class="hljs-comment">// å…·ä½“çš„Builderç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComputerBuilderA</span> :</span> <span class="hljs-keyword">public</span> ComputerBuilder &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">build_cpu</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (computer != <span class="hljs-literal">nullptr</span>) &#123;<br>            computer-&gt;cpu = <span class="hljs-string">&quot;Intel&quot;</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">build_mainboard</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (computer != <span class="hljs-literal">nullptr</span>) &#123;<br>            computer-&gt;mainboard = <span class="hljs-string">&quot;å¾®æ˜Ÿ&quot;</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">build_memory</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (computer != <span class="hljs-literal">nullptr</span>) &#123;<br>            computer-&gt;memory = <span class="hljs-string">&quot;ä¸‰æ˜Ÿ&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComputerBuilderB</span> :</span> <span class="hljs-keyword">public</span> ComputerBuilder &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">build_cpu</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (computer != <span class="hljs-literal">nullptr</span>) &#123;<br>            computer-&gt;cpu = <span class="hljs-string">&quot;AMD&quot;</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">build_mainboard</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (computer != <span class="hljs-literal">nullptr</span>) &#123;<br>            computer-&gt;mainboard = <span class="hljs-string">&quot;åç¡•&quot;</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">build_memory</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (computer != <span class="hljs-literal">nullptr</span>) &#123;<br>            computer-&gt;memory = <span class="hljs-string">&quot;è‡´é’›&quot;</span>;<br>        &#125;<br>    &#125;<br><br>&#125;;<br><br><span class="hljs-comment">// Directorç±»ï¼Œå³å€ŸåŠ©ä½¿ç”¨ Builderï¼Œæ¥æ§åˆ¶ç”µè„‘ç”Ÿäº§</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Factory</span> &#123;</span><br><span class="hljs-keyword">public</span> :<br>    <span class="hljs-built_in">Factory</span>(ComputerBuilder* builder) : <span class="hljs-built_in">builder</span>(builder) &#123;&#125;<br>    <span class="hljs-function">Computer* <span class="hljs-title">make_computer</span><span class="hljs-params">()</span>  </span>&#123;<br>        builder-&gt;<span class="hljs-built_in">build_computer</span>();<br>        builder-&gt;<span class="hljs-built_in">build_cpu</span>();<br>        builder-&gt;<span class="hljs-built_in">build_mainboard</span>();<br>        builder-&gt;<span class="hljs-built_in">build_memory</span>();<br>        <span class="hljs-keyword">return</span> builder-&gt;<span class="hljs-built_in">get_computer</span>();<br>    &#125;<br><span class="hljs-keyword">private</span>:<br>    ComputerBuilder *builder;<br><br>&#125;;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//CREATIONPATTERNDESIGN_BUILDER_H</span></span><br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Builder.cpp</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/17.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;Builder.h&quot;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_builder</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯•Builderæ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>    ComputerBuilder* cba = <span class="hljs-keyword">new</span> ComputerBuilderA;<br>    ComputerBuilder* cbb = <span class="hljs-keyword">new</span> ComputerBuilderB;<br>    <span class="hljs-function">Factory <span class="hljs-title">fa</span><span class="hljs-params">(cba)</span></span>;<br>    <span class="hljs-function">Factory <span class="hljs-title">fb</span><span class="hljs-params">(cbb)</span></span>;<br>    fa.<span class="hljs-built_in">make_computer</span>()-&gt;<span class="hljs-built_in">show_info</span>();<br>    fb.<span class="hljs-built_in">make_computer</span>()-&gt;<span class="hljs-built_in">show_info</span>();<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç»“æŸæµ‹è¯•Builderæ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="9-ç›¸å…³æ¨¡å¼"><a class="markdownIt-Anchor" href="#9-ç›¸å…³æ¨¡å¼"></a> 9. ç›¸å…³æ¨¡å¼</h2><p>Abstract Factoryä¸Builderç›¸ä¼¼ï¼Œå› ä¸ºå®ƒä¹Ÿå¯ä»¥åˆ›å»ºå¤æ‚å¯¹è±¡ã€‚ä¸»è¦åŒºåˆ«æ˜¯Builderæ¨¡å¼ç€é‡äºä¸€æ­¥æ­¥æ„é€ ä¸€ä¸ªå¤æ‚å¯¹è±¡ã€‚è€ŒAbstract Factory ç€é‡äºå¤šä¸ªç³»åˆ—çš„äº§å“å¯¹è±¡ï¼ˆç®€å•çš„æˆ–å¤æ‚çš„ï¼‰ã€‚Builderåœ¨æœ€åä¸€æ­¥è¿”å›äº§å“ï¼Œè€Œå¯¹äºAbstract Factory æ¥è¯´ï¼Œäº§å“æ˜¯ç«‹å³è¿”å›çš„ã€‚</p><p>Compositeæ¨¡å¼é€šå¸¸æ˜¯ç”¨Builderç”Ÿæˆçš„ã€‚</p><h1 id="singletonå•ä¾‹å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼"><a class="markdownIt-Anchor" href="#singletonå•ä¾‹å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼"></a> Singletonï¼ˆå•ä¾‹ï¼‰â€”â€”å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼</h1><h2 id="1-æ„å›¾-2"><a class="markdownIt-Anchor" href="#1-æ„å›¾-2"></a> 1. æ„å›¾</h2><p>ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹</p><h2 id="2-åŠ¨æœº-2"><a class="markdownIt-Anchor" href="#2-åŠ¨æœº-2"></a> 2. åŠ¨æœº</h2><p>å¯¹äºä¸€äº›ç±»æ¥è¯´ï¼Œåªæœ‰ä¸€ä¸ªå®ä¾‹æ˜¯å¾ˆé‡è¦çš„ã€‚ä¾‹å¦‚ï¼Œè™½ç„¶ç³»ç»Ÿä¸­å¯ä»¥æœ‰è®¸å¤šæ‰“å°æœºï¼Œä½†å´åªåº”è¯¥æœ‰ä¸€ä¸ªæ‰“å°å‡è„±æœº(printer spooler) ï¼Œåªåº”è¯¥æœ‰ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿå’Œä¸€ä¸ªçª—å£ç®¡ç†å™¨ã€‚ä¸€ä¸ªä¼šè®¡ç³»ç»Ÿåªèƒ½ä¸“ç”¨äºä¸€ä¸ªå…¬å¸ã€‚</p><p>æ€æ ·æ‰èƒ½ä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹å¹¶ä¸”è¿™ä¸ªå®ä¾‹æ˜“äºè¢«è®¿é—®å‘¢ï¼Ÿå…¨å±€å˜é‡ä½¿å¾—ä¸€ä¸ªå¯¹è±¡å¯ä»¥è¢«è®¿é—®ï¼Œä½†å®ƒä¸èƒ½é˜²æ­¢ä½ å®ä¾‹åŒ–å¤šä¸ªå¯¹è±¡ã€‚</p><p>ä¸€ä¸ªæ›´å¥½çš„åŠæ³•æ˜¯ï¼Œè®©ç±»è‡ªèº«è´Ÿè´£ä¿å­˜å®ƒçš„å”¯ä¸€å®ä¾‹ã€‚è¿™ä¸ªç±»å¯ä»¥ä¿è¯æ²¡æœ‰å…¶ä»–å®ä¾‹å¯ä»¥è¢«åˆ›å»ºï¼ˆé€šè¿‡æˆªå–åˆ›å»ºæ–°å¯¹è±¡çš„è¯·æ±‚ï¼‰ï¼Œå¹¶ä¸”å®ƒå¯ä»¥æä¾›ä¸€ä¸ªè®¿é—®è¯¥å®ä¾‹çš„æ–¹æ³•ã€‚è¿™å°±æ˜¯Singletonæ¨¡å¼ã€‚</p><h2 id="3-é€‚ç”¨æ€§-2"><a class="markdownIt-Anchor" href="#3-é€‚ç”¨æ€§-2"></a> 3. é€‚ç”¨æ€§</h2><p>åœ¨ä¸‹é¢çš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Singletonæ¨¡å¼ï¼š</p><ul><li>å½“ç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹è€Œä¸”å®¢æˆ·å¯ä»¥ä»ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„è®¿é—®ç‚¹è®¿é—®å®ƒæ—¶ã€‚</li><li>å½“è¿™ä¸ªå”¯ä¸€å®ä¾‹åº”è¯¥æ˜¯é€šè¿‡å­ç±»åŒ–å¯æ‰©å±•çš„ï¼Œå¹¶ä¸”å®¢æˆ·åº”è¯¥æ— åºæ›´æ”¹ä»£ç å°±èƒ½ä½¿ç”¨ä¸€ä¸ªæ‰©å±•çš„å®ä¾‹æ—¶ã€‚</li></ul><h2 id="4-ç»“æ„-2"><a class="markdownIt-Anchor" href="#4-ç»“æ„-2"></a> 4. ç»“æ„</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204171449058.jpeg" alt="ç»“æ„ç¤ºæ„å›¾" /></p><h2 id="5-å‚ä¸è€…-2"><a class="markdownIt-Anchor" href="#5-å‚ä¸è€…-2"></a> 5. å‚ä¸è€…</h2><ul><li>Singleton<ul><li>å®šä¹‰ä¸€ä¸ªInstanceæ“ä½œï¼Œå…è®¸å®¢æˆ·è®¿é—®å®ƒçš„å”¯ä¸€å®ä¾‹ã€‚Instanceæ˜¯ä¸€ä¸ªç±»æ“ä½œï¼ˆå¯ä»¥æ˜¯C++ä¸­çš„ä¸€ä¸ªé™æ€æˆå‘˜å‡½æ•°ï¼‰</li><li>å¯èƒ½è´Ÿè´£åˆ›å»ºå®ƒè‡ªå·±çš„å”¯ä¸€å®ä¾‹</li></ul></li></ul><h2 id="6-åä½œ-2"><a class="markdownIt-Anchor" href="#6-åä½œ-2"></a> 6. åä½œ</h2><ul><li>å®¢æˆ·åªèƒ½é€šè¿‡Singletonçš„Instanceæ“ä½œè®¿é—®ä¸€ä¸ªSingletonçš„å®ä¾‹</li></ul><h2 id="7-æ•ˆæœ-2"><a class="markdownIt-Anchor" href="#7-æ•ˆæœ-2"></a> 7. æ•ˆæœ</h2><p>Singletonæ¨¡å¼æœ‰è®¸å¤šä¼˜ç‚¹ï¼š</p><ul><li><strong>å¯¹å”¯ä¸€å®ä¾‹çš„å—æ§è®¿é—®</strong>ã€‚å› ä¸ºSingletonç±»å°è£…å®ƒçš„å”¯ä¸€å®ä¾‹ï¼Œæ‰€ä»¥å®ƒå¯ä»¥ä¸¥æ ¼åœ°æ§åˆ¶å®¢æˆ·æ€æ ·ä»¥åŠä½•æ—¶è®¿é—®å®ƒã€‚</li><li><strong>ç¼©å°å‘½åç©ºé—´</strong>ã€‚Singletonæ¨¡å¼æ˜¯å¯¹å…¨å±€å˜é‡çš„ä¸€ç§ æ”¹è¿›ï¼Œå®ƒé¿å…äº†é‚£äº›å­˜å‚¨å”¯ä¸€å®ä¾‹çš„å…¨å±€å˜é‡æ±¡æŸ“å‘½åç©ºé—´</li><li><strong>å…è®¸å¯¹æ“ä½œå’Œè¡¨ç¤ºçš„ç²¾åŒ–</strong>ã€‚Singletonç±»å¯ä»¥æœ‰å­ç±»ï¼Œè€Œä¸”ç”¨è¿™ä¸ªæ‰©å±•ç±»çš„å®ä¾‹æ¥é…ç½®ä¸€ä¸ªåº”ç”¨æ˜¯å¾ˆå®¹æ˜“çš„ã€‚ä½ å¯ä»¥ç”¨ä½ æ‰€éœ€è¦çš„ç±»çš„å®ä¾‹åœ¨è¿è¡Œæ—¶é…ç½®åº”ç”¨</li><li><strong>å…è®¸å¯å˜æ•°ç›®çš„å®ä¾‹</strong>ã€‚è¿™ä¸ªæ¨¡å¼ä½¿å¾—ä½ æ˜“äºæ”¹å˜ä½ çš„æƒ³æ³•ï¼Œå¹¶å…è®¸Singletonç±»çš„å¤šä¸ªå®ä¾‹ã€‚</li></ul><h2 id="8-å®ç°"><a class="markdownIt-Anchor" href="#8-å®ç°"></a> 8. å®ç°</h2><p>ä¸‹é¢æ˜¯ä½¿ç”¨Singletonæ¨¡å¼æ—¶éœ€è¦è€ƒè™‘çš„å®ç°é—®é¢˜ã€‚</p><ul><li>ä¿è¯ä¸€ä¸ªå”¯ä¸€çš„å®ä¾‹ã€‚åœ¨C++ä¸­å¯ä»¥ç”¨Singletonç±»çš„é™æ€æˆå‘˜å‡½æ•°Instanceæ¥å®šä¹‰è¿™ä¸ªç±»æ“ä½œ</li><li>Instanceå¯ä»¥ä½¿ç”¨æƒ°æ€§ï¼ˆlazyï¼‰åˆå§‹åŒ–ï¼Œå³åªæœ‰ç¬¬ä¸€æ¬¡è¢«è®¿é—®æ—¶æ‰åˆ›å»ºå®ä¾‹</li><li>åˆ›å»ºSingletonç±»çš„å­ç±»ã€‚æœ€ç®€å•çš„æŠ€æœ¯æ˜¯åœ¨Singletonçš„Instanceæ“ä½œä¸­å†³å®šä½ æƒ³ä½¿ç”¨çš„æ˜¯å“ªä¸€ä¸ªå•ä¾‹ã€‚å¦ä¸€ä¸ªé€‰æ‹©Singletonçš„å­ç±»çš„æ–¹æ³•æ˜¯å°†Instanceçš„å®ç°ä»çˆ¶ç±»ä¸­åˆ†ç¦»å‡ºæ¥å¹¶å°†å®ƒæ”¾å…¥å­ç±»ã€‚<ul><li>ä¸€ä¸ªæ›´çµæ´»çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªå•ä¾‹æ³¨å†Œè¡¨ï¼ˆregistry of singletonï¼‰ã€‚å¯èƒ½çš„Singletonç±»çš„é›†åˆä¸æ˜¯ç”±Instanceå®šä¹‰çš„ï¼ŒSingletonç±»å¯ä»¥æ ¹æ®åå­—åœ¨ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„æ³¨å†Œè¡¨ä¸­æ³¨å†Œå®ƒä»¬çš„å•ä¾‹å®ä¾‹ã€‚è¿™ä¸ªæ³¨å†Œè¡¨å¯ä»¥åœ¨å­—ç¬¦ä¸²åå­—å’Œå•ä¾‹ä¹‹é—´å»ºç«‹æ˜ å°„ã€‚å½“Instanceéœ€è¦ä¸€ä¸ªå•ä¾‹æ—¶ï¼Œå®ƒå‚è€ƒæ³¨å†Œè¡¨ï¼Œæ ¹æ®åå­—è¯·æ±‚å•ä¾‹ã€‚</li></ul></li></ul><h2 id="9-ç¤ºä¾‹ä»£ç "><a class="markdownIt-Anchor" href="#9-ç¤ºä¾‹ä»£ç "></a> 9. ç¤ºä¾‹ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Singleton.h</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/17.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> CREATIONPATTERNDESIGN_SINGLETON_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CREATIONPATTERNDESIGN_SINGLETON_H</span><br><br><span class="hljs-comment">// æœ€ç®€å•çš„å•ä¾‹å®ç°æ–¹å¼ï¼Œä½¿ç”¨å±€éƒ¨é™æ€å˜é‡ï¼Œæƒ°æ€§åˆ†é…ï¼ˆæ‡’æ±‰ï¼‰ï¼Œå¹¶ä¸”åœ¨C++11ä¹‹åèƒ½å¤Ÿä¿è¯çº¿ç¨‹å®‰å…¨</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> Singleton* <span class="hljs-title">get_instance</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">static</span> Singleton instance;<br>        <span class="hljs-keyword">return</span> &amp;instance;<br>    &#125;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-built_in">Singleton</span>() &#123;&#125;<br>    ~<span class="hljs-built_in">Singleton</span>() &#123;&#125;<br>    <span class="hljs-built_in">Singleton</span>(<span class="hljs-keyword">const</span> Singleton&amp; singleton) = <span class="hljs-keyword">delete</span>;<br>    Singleton <span class="hljs-keyword">operator</span>= (<span class="hljs-keyword">const</span> Singleton&amp; singleton) = <span class="hljs-keyword">delete</span>;<br>&#125;;<br><br><span class="hljs-comment">// æ‡’æ±‰ï¼ŒåŒé‡æ£€æŸ¥é”</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton2</span>&#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> Singleton2* <span class="hljs-title">get_instance</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">nullptr</span>) &#123;<br>            <span class="hljs-function">std::lock_guard&lt;std::mutex&gt; <span class="hljs-title">lock</span><span class="hljs-params">(mutex)</span></span>;<br>            <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">nullptr</span>) &#123;<br>                instance = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Singleton2</span>();<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br><br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-keyword">static</span> Singleton2* instance;<br>    <span class="hljs-keyword">static</span> std::mutex mutex;<br><br>    <span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªå†…éƒ¨åƒåœ¾å›æ”¶ç±»</span><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GC</span> &#123;</span><br>    <span class="hljs-keyword">public</span>:<br>        ~<span class="hljs-built_in">GC</span>() &#123;<br>            <span class="hljs-keyword">if</span>(Singleton2::instance != <span class="hljs-literal">nullptr</span>) &#123;<br>                <span class="hljs-keyword">delete</span> Singleton2::instance;<br>                Singleton2::instance = <span class="hljs-literal">nullptr</span>;<br>            &#125;<br>        &#125;<br>    &#125;;<br>    <span class="hljs-keyword">static</span> GC gc;<br>&#125;;<br>Singleton2* Singleton2::instance = <span class="hljs-literal">nullptr</span>;<br>Singleton2::GC Singleton2::gc;<br>std::mutex Singleton2::mutex;<br><br><br><span class="hljs-comment">// é¥¿æ±‰</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Singleton3</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> Singleton3* <span class="hljs-title">get_instance</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> &amp;instance;<br>    &#125;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-built_in">Singleton3</span>() &#123;&#125;<br>    ~<span class="hljs-built_in">Singleton3</span>() &#123;&#125;<br>    <span class="hljs-built_in">Singleton3</span>(<span class="hljs-keyword">const</span> Singleton3&amp; singleton) = <span class="hljs-keyword">delete</span>;<br>    Singleton3 <span class="hljs-keyword">operator</span>= (<span class="hljs-keyword">const</span> Singleton3&amp; singleton) = <span class="hljs-keyword">delete</span>;<br>    <span class="hljs-keyword">static</span> Singleton3 instance;<br>&#125;;<br>Singleton3 Singleton3::instance;<br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//CREATIONPATTERNDESIGN_SINGLETON_H</span></span><br><br></code></pre></td></tr></table></figure><h2 id="10-ç›¸å…³æ¨¡å¼"><a class="markdownIt-Anchor" href="#10-ç›¸å…³æ¨¡å¼"></a> 10. ç›¸å…³æ¨¡å¼</h2><p>å¾ˆå¤šæ¨¡å¼éƒ½å¯ä»¥ç”¨Singletonæ¨¡å¼å®ç°ï¼Œæ¯”å¦‚Abstract Factoryï¼ŒBuilderï¼ŒPrototypeã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¼–ç¨‹æŠ€å·§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C++å†…å­˜ç®¡ç†æ€»ç»“</title>
    <link href="/2022/04/16/2022-04-16%20C++%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93/"/>
    <url>/2022/04/16/2022-04-16%20C++%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>ä¹‹å‰çœ‹å®Œå­¦ä¹ äº†ä¾¯æ·è€å¸ˆã€Šå†…å­˜ç®¡ç†ã€‹è¿™é—¨è§†é¢‘è¯¾ç¨‹ï¼Œä¸ºäº†åŠ æ·±å°è±¡ä»¥åŠæ—¥åå›é¡¾å¤ä¹ ï¼Œç‰¹æ­¤åšä¸ªæ€»ç»“ã€‚</p><p>æœ¬æ–‡ä¼šåˆ†æˆå››éƒ¨åˆ†å†…å®¹ï¼š</p><ul><li>ç¬¬ä¸€éƒ¨åˆ†ä»‹ç»C++ å†…å­˜ç®¡ç†ä¸­çš„ memory primitivesï¼ˆä¸€äº›åŸºæœ¬çŸ¥è¯†ç‚¹ï¼‰ï¼Œå¯¹åº”å¯¹åº”ã€Šå†…å­˜ç®¡ç†ã€‹è§†é¢‘è¯¾ç¨‹ç¬¬ä¸€è®²ï¼›</li><li>ç¬¬äºŒéƒ¨åˆ†ä»‹ç»SGI STLä¸­åˆ†é…å™¨çš„å®ç°ï¼Œå¯¹åº”ã€Šå†…å­˜ç®¡ç†ã€‹è§†é¢‘è¯¾ç¨‹ç¬¬äºŒè®²ï¼Œå¹¶ä¸”ä¸»è¦å†…å®¹å°†å‚è€ƒæ–‡ç«  <a href="https://mp.weixin.qq.com/s/1rLCzJtspYzAxa0g6-BFCA">5 åƒå­—é•¿æ–‡+ 30 å¼ å›¾è§£ | é™ªä½ æ‰‹æ’• STL ç©ºé—´é…ç½®å™¨æºç </a><sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="5 åƒå­—é•¿æ–‡+ 30 å¼ å›¾è§£ | é™ªä½ æ‰‹æ’• STL ç©ºé—´é…ç½®å™¨æºç ">[1]</span></a></sup>ï¼›</li><li>ç¬¬ä¸‰éƒ¨åˆ†ä»‹ç» VC6 mallocåº•å±‚å®ç°ï¼Œå¯¹åº”ã€Šå†…å­˜ç®¡ç†ã€‹è¯¾ç¨‹å†…å®¹ç¬¬ä¸‰è®²ï¼›</li><li>ç¬¬å››éƒ¨åˆ†ä»‹ç» Loki ï¼ˆ<em>ã€ŠModern C++ Designã€‹é…å¥—å‘è¡Œçš„ä¸€ä¸ª C++ ä»£ç åº“</em>ï¼‰ä¸­çš„å†…å­˜ç®¡ç†å®ç°ï¼Œå¯¹åº”ã€Šå†…å­˜ç®¡ç†ã€‹è¯¾ç¨‹ç¬¬å››è®²ã€‚</li></ul><blockquote><p>è¯´æ˜ï¼šæ–‡ä¸­ä¼šæœ‰ä¸å°‘å›¾ç‰‡å’Œå†…å®¹æ‘˜è‡ªè¯¾ç¨‹è¯¾ä»¶æˆ–è€…å‚è€ƒæ–‡ç« ï¼Œå¦‚æœæœ‰é€ æˆä¾µæƒè¯·å‘ŠçŸ¥åˆ é™¤ã€‚</p></blockquote><h1 id="memory-primitivesåŸºæœ¬çŸ¥è¯†ç‚¹"><a class="markdownIt-Anchor" href="#memory-primitivesåŸºæœ¬çŸ¥è¯†ç‚¹"></a> Memory Primitivesï¼ˆåŸºæœ¬çŸ¥è¯†ç‚¹ï¼‰</h1><h2 id="1ä½¿ç”¨memoryçš„é€”ç»"><a class="markdownIt-Anchor" href="#1ä½¿ç”¨memoryçš„é€”ç»"></a> 1.ä½¿ç”¨memoryçš„é€”ç»</h2><p>å¯¹äºC++ åº”ç”¨ç¨‹åºï¼Œä½¿ç”¨memoryçš„é€”ç»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥ä½¿ç”¨æœ€ä¸Šå±‚çš„ C++ Libraryï¼ˆæ¯”å¦‚STLä¸­çš„allocatoråˆ†é…å™¨ï¼‰ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨C++ primitivesï¼ˆä¸»è¦æŒ‡newè¡¨è¾¾å¼ï¼Œarray newï¼Œoperator newå’Œå¯¹åº”çš„deleteç­‰ï¼‰ï¼Œå†å¾€ä¸‹å°±æ˜¯ CRTï¼ˆCè¯­è¨€è¿è¡Œåº“ï¼ŒåŒ…å«malloc/freeçš„å®ç°ï¼‰ï¼Œæœ€åº•å±‚å°±æ˜¯æ“ä½œç³»ç»Ÿå±‚é¢æä¾›çš„APIï¼ˆå›¾ä¸­ç»™å‡ºçš„æ˜¯Windowsæä¾›çš„APIï¼‰ã€‚</p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102251849.png" alt="" style="zoom:50%;" /></center><hr /><p>è¿›ä¸€æ­¥çš„ï¼Œè‡ªåº•å‘ä¸Šå¯ä»¥å°†å†…å­˜ç®¡ç†åˆ†ä¸ºä¸‰ä¸ªå±‚æ¬¡<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="C++æ€§èƒ½ä¼˜åŒ–ï¼ˆå…«ï¼‰â€”â€”å†…å­˜åˆ†é…æœºåˆ¶">[2]</span></a></sup>ï¼š</p><ol><li><p>æ“ä½œç³»ç»Ÿå†…æ ¸çš„å†…å­˜ç®¡ç†</p><ul><li>ä¾‹å¦‚è™šå­˜é¡µå¼å­˜å‚¨ï¼Œåœ°å€æ˜ å°„ç­‰çŸ¥è¯†ï¼Œå¯ä»¥å‚è€ƒ <a href="kingofdark.top/2022/06/11/2022-06/2022-06-11%20%E3%80%90%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E3%80%91%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98">æ“ä½œç³»ç»Ÿä¹‹å†…å­˜ç®¡ç†</a>ã€‚</li></ul></li><li><p>glibcå±‚ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨ç»´æŠ¤çš„å†…å­˜ç®¡ç†ç®—æ³•</p><ul><li><p>è¿™é‡Œçš„å†…å­˜ç®¡ç†ç®—æ³•ä¸»è¦æ˜¯æŒ‡mallocçš„å®ç°ç®—æ³•ï¼Œä¾‹å¦‚Linuxä¸­é‡‡ç”¨çš„ptmallocç®—æ³•ï¼Œå…¶å®ç°é€šè¿‡ä½¿ç”¨brkã€sbrkã€mmapç­‰ç³»ç»Ÿè°ƒç”¨ï¼›è€Œåœ¨Windowsä¸­ï¼Œå…¶mallocå®ç°ä¸ºï¼Œä¾æ®ç”³è¯·çš„ç©ºé—´å¤§å°ï¼Œå¤§ç©ºé—´è°ƒç”¨os APIï¼ˆHeapAlloc()ï¼‰ï¼Œå°ç©ºé—´ä½¿ç”¨SBH(å°äºç­‰äº1K)ï¼Œè¿™ä¹Ÿæ˜¯åæ–‡ <a href="https://kingofdark.top/2022/04/16/2022-04-16%20C++%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%80%BB%E7%BB%93/#vc6-malloc%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0">VC6 mallocåº•å±‚å®ç°</a> è¦å…·ä½“ä»‹ç»çš„å†…å®¹ã€‚</p></li><li><p>æ³¨æ„è¿™é‡Œçš„mallocåªæ˜¯åˆ†é…ä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼Œå¹¶æ²¡æœ‰åˆ†é…å®é™…ç‰©ç†åœ°å€ï¼Œåªæœ‰å½“ç”¨æˆ·ä½¿ç”¨å†…å­˜æ—¶ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸æ‰ä¼šåˆ†é…å…·ä½“çš„ç‰©ç†åœ°å€ç»™ç”¨æˆ·ä½¿ç”¨<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="mallocèƒŒåçš„ç³»ç»ŸçŸ¥è¯†">[3]</span></a></sup>ã€‚</p></li></ul></li><li><p>åº”ç”¨ç¨‹åºä»glibcåŠ¨æ€åˆ†é…å†…å­˜åï¼Œæ ¹æ®åº”ç”¨ç¨‹åºæœ¬èº«çš„ç¨‹åºç‰¹æ€§è¿›è¡Œä¼˜åŒ–</p><ul><li><p>æ¯”å¦‚ä½¿ç”¨å¼•ç”¨è®¡æ•°std::shared_ptrï¼Œå†…å­˜æ± æ–¹å¼ç­‰ç­‰ã€‚</p></li><li><p>ä¸‹ä¸€ç« èŠ‚ä»‹ç»çš„STLåˆ†é…å™¨å°±é‡‡ç”¨äº†å†…å­˜æ± çš„æ–¹å¼ï¼Œ å°±å±äºè¿™ä¸€å±‚æ¬¡çš„å†…å­˜ç®¡ç†ã€‚</p></li></ul></li></ol><h2 id="2c-memory-primitiveså†…å­˜ç›¸å…³çš„åŸºæœ¬ç»„ä»¶åŸè¯­"><a class="markdownIt-Anchor" href="#2c-memory-primitiveså†…å­˜ç›¸å…³çš„åŸºæœ¬ç»„ä»¶åŸè¯­"></a> 2.C++ memory primitivesï¼ˆå†…å­˜ç›¸å…³çš„åŸºæœ¬ç»„ä»¶/åŸè¯­ï¼‰</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102251209.png" alt="C++å†…å­˜ç®¡ç†åŸºæœ¬åŸè¯­" /></p><h2 id="3new-expression-ä¸-delete-expression"><a class="markdownIt-Anchor" href="#3new-expression-ä¸-delete-expression"></a> 3.new expression ä¸ delete expression</h2><ul><li><p>new expression çš„æ“ä½œå¯ä»¥æ‹†è§£ä¸ºä¸‰æ­¥ï¼šç¬¬ä¸€æ­¥é€šè¿‡ <code>operator new</code>å‡½æ•°ç”³è¯·å†…å­˜ç©ºé—´ï¼Œç¬¬äºŒæ­¥å¯¹è¿”å›çš„æŒ‡é’ˆè¿›è¡Œè½¬å‹ï¼Œç¬¬ä¸‰æ­¥è°ƒç”¨æ„é€ å‡½æ•° ã€‚ï¼ˆå¦‚æœç®€åŒ–çš„è¯ï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯ä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥ç”³è¯·å†…å­˜ç©ºé—´ï¼Œç¬¬äºŒæ­¥åœ¨ç”³è¯·åˆ°çš„å†…å­˜ç©ºé—´ä¸Šæ‰§è¡Œæ„é€ å‡½æ•°ï¼‰</p><ul><li>åœ¨<code>operator new</code> å‡½æ•°ä¸­ï¼Œå®é™…ä¸Šä¼šå»è°ƒç”¨<code>malloc</code>å‡½æ•°ç”³è¯·å†…å­˜ç©ºé—´ï¼›<code>operator new</code>  çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œç”¨äºä¿è¯ä¸æŠ›å‡ºå¼‚å¸¸</li><li><code>_callnewh</code>ï¼šå½“mallocå¤±è´¥ä¹‹åï¼Œå°±ä¼šè°ƒç”¨ç”¨æˆ·è®¾å®šçš„new handlerå‡½æ•°ï¼ˆé€šè¿‡<code>set_new_handler</code>è¿›è¡Œè®¾ç½®ï¼‰ã€‚æ‰€ä»¥åº”è¯¥åœ¨new_handlerå‡½æ•°ä¸­å»å°è¯•é‡Šæ”¾å†…å­˜ï¼Œä»¥ä¾¿ä¸‹æ¬¡è¿›å…¥å¾ªç¯æ—¶ï¼Œmallocå¯ä»¥åˆ†é…æˆåŠŸã€‚</li></ul></li><li><p>delete expression çš„æ“ä½œä¹Ÿå¯ä»¥æ‹†è§£ä¸ºä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥å…ˆæ˜¯è°ƒç”¨ææ„å‡½æ•°ï¼Œç¬¬äºŒæ­¥æ˜¯é‡Šæ”¾å¯¹åº”çš„å†…å­˜ç©ºé—´ï¼ˆå®é™…ä¸Šå¤±å»è°ƒç”¨<code>free</code>å‡½æ•°ï¼‰</p></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102251342.png" alt="new expression" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102252544.png" alt="delete expression" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102252302.png" alt="new handleræœºåˆ¶" /></p><h2 id="4array-new-ä¸-delete"><a class="markdownIt-Anchor" href="#4array-new-ä¸-delete"></a> 4.array new ä¸ delete[]</h2><p>éœ€è¦æ³¨æ„çš„æ˜¯new [] å’Œ delete[] åº”è¯¥é…åˆä½¿ç”¨ã€‚å¦‚ä¸‹å›¾ç»™å‡ºçš„ä¾‹å­ï¼Œ<code>Demo</code>æ˜¯ä¸€ä¸ªåŒ…å«ä¸‰ä¸ª<code>int</code>å˜é‡çš„ç±»ï¼Œ<code>new Demo[3]</code> çš„å†…å­˜ç»“æ„å¦‚å³ä¾§æ‰€ç¤ºï¼š</p><ul><li>æœ€ä¸Šæ–¹å’Œæœ€ä¸‹æ–¹çš„ <code>61h</code> è¡¨ç¤ºçš„æ˜¯cookieï¼ˆmallocåœ¨ç”³è¯·å†…å­˜ä¼šé™„åŠ çš„ä¿¡æ¯ï¼Œç”¨æ¥è®°å½•æ­¤æ¬¡ç”³è¯·å†…å­˜ç©ºé—´çš„å¤§å°ï¼Œæ­£æ˜¯å› ä¸ºæœ‰è¿™ä¸ªcookieçš„ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨è°ƒç”¨freeçš„æ—¶å€™æ‰ä¸éœ€è¦ä¼ å…¥â€œé‡Šæ”¾ç©ºé—´å¤§å°â€è¿™ä¸€å‚æ•°ï¼‰ã€‚</li><li>ä¸­é—´æ©™è‰²éƒ¨åˆ†ï¼Œè¡¨ç¤ºçš„æ˜¯åœ¨Debugè°ƒè¯•æ¨¡å¼ä¸‹ï¼Œmallocåœ¨ç”³è¯·æ—¶é™„åŠ çš„ä¸€äº›æ•°æ®ä¿¡æ¯ï¼ˆæ¯”å¦‚è®°å½•è¿™æ˜¯ä»å“ªä¸ªæ–‡ä»¶çš„å“ªä¸€è¡Œå‘å‡ºçš„è¯·æ±‚ï¼‰ï¼›å¦‚æœä¸æ˜¯debugæ¨¡å¼ä¸‹ï¼Œåº”è¯¥æ˜¯ä¸ä¼šåŒ…å«è¿™éƒ¨åˆ†é¢å¤–ä¿¡æ¯</li><li>ä¸‹é¢çš„æ•°å­—â€œ3â€å°±æ˜¯è®°å½•æ­¤æ¬¡åˆ†é…æ•°ç»„å…ƒç´ çš„ä¸ªæ•°ï¼Œç”¨æ¥æŒ‡ç¤ºåº”è¯¥è°ƒç”¨å¤šå°‘æ¬¡æ„é€ /ææ„<ul><li>å¦‚æœç”³è¯·å…ƒç´ çš„ç±»å‹æ²¡æœ‰ non-trivial dtorï¼ˆé‡è¦çš„ææ„å‡½æ•°ï¼‰ï¼ŒåŒé‡å¦å®šå¥ï¼Œä¹Ÿå°±æ˜¯å½“å…ƒç´ ç±»å‹çš„ææ„å‡½æ•°æ˜¯trivialï¼ˆä¸é‡è¦çš„ï¼‰æ—¶å€™ï¼Œå°±ä¸ä¼šè®°å½•â€œ3â€ï¼Œæ¯”å¦‚è¯´ç”³è¯·çš„æ˜¯ <code>int</code> åŸºæœ¬ç±»å‹ï¼Œè¯¥ç±»å‹æ²¡æœ‰å¯¹åº”çš„ææ„å‡½æ•°ï¼Œç›´æ¥å›æ”¶å†…å­˜å³å¯</li></ul></li><li>å†ä¸‹é¢æ¯3ä¸ª <code>int</code> ç»„æˆä¸€ä¸ª <code>Demo</code> å¯¹è±¡</li><li><code>no man land</code>ï¼šæ— äººåŒºï¼Œç”¨äºéš”ç¦»æ•°æ®ï¼Œå¦‚æœè¿™ä¸€å—å†…å­˜è¢«ä¿®æ”¹äº†ï¼Œè¡¨ç¤ºè¶Šç•Œè®¿é—®å‡ºé”™äº†</li><li><code>Pad</code>ï¼šè¿™ä¸ªæ˜¯mallocç”³è¯·å†…å­˜æ—¶å¯¹é½éœ€è¦å¡«å……çš„ç©ºé—´</li></ul><p>æ³¨æ„ï¼Œnewä¹‹åå¾—åˆ°çš„<code>p</code>æŒ‡å‘çš„åœ°å€ä¸Šå…ƒç´ é¦–åœ°å€0x00481c34ï¼Œè€Œ<code>delete []p</code>ä¼ å…¥pçš„åœ°å€æŒ‡å‘çš„èµ·å§‹ä½ç½®æ˜¯â€œ3â€å¯¹åº”çš„åœ°å€0x00481c30ï¼Œä»¥ä¾¿äºçŸ¥é“éœ€è¦ææ„å¤šå°‘æ¬¡ã€‚å› æ­¤å¦‚æœä¸å†™[ ]ï¼Œè°ƒç”¨çš„æ˜¯ <code>delete p</code> å°±ä¼šåœ¨<strong>è¿è¡Œæ—¶æŠ¥é”™ï¼Œå› ä¸ºè¿™æ ·ä¼šæŒ‰ç…§æ²¡æœ‰â€œ3â€çš„æƒ…å†µå»è§£è¯»ç©ºé—´å¸ƒå±€</strong>ï¼Œè€Œè¿™å°±å¯èƒ½å¯¼è‡´è§£æå¾—åˆ°çš„è¦é‡Šæ”¾çš„å†…å­˜åœ°å€å’Œå¤§å°ä¸æ­£ç¡®ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102252390.png" alt="array new" /></p><h2 id="5placement-new"><a class="markdownIt-Anchor" href="#5placement-new"></a> 5.placement new</h2><p><code>placement new</code> å®é™…ä¸Šæ²¡æœ‰åˆ†é…å†…å­˜ï¼Œä¼šå»æ‰§è¡Œé‡è½½çš„<code>operator new(size_t, void*)</code>ï¼Œåªæ˜¯æŠŠä¼ è¿›æ¥çš„æŒ‡é’ˆç›´æ¥è¿”å›ï¼Œæ‰€ä»¥ç›¸å½“äºåªæ˜¯è°ƒç”¨äº†æ„é€ å‡½æ•°ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102253169.png" alt="placement new" /></p><p>æ³¨æ„ï¼Œå¯ä»¥è‡ªå·±å†é‡è½½operator newï¼Œå¼•å…¥æ›´å¤šçš„å‚æ•°ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Complex</span>&#123;</span><br>    <span class="hljs-comment">// ç±»çš„å…¶ä»–ä¸€äº›å˜é‡æˆ–å‡½æ•° ...</span><br>    <span class="hljs-comment">// é‡è½½ operator new</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span>* <span class="hljs-keyword">operator</span> <span class="hljs-title">new</span><span class="hljs-params">(<span class="hljs-keyword">size_t</span>, <span class="hljs-keyword">void</span>* p, <span class="hljs-keyword">int</span> num)</span> </span>&#123;<br>        <span class="hljs-comment">// do something...</span><br>        <span class="hljs-keyword">return</span> p;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// ä½¿ç”¨å½¢å¼</span><br><span class="hljs-keyword">char</span>* buf = <span class="hljs-keyword">new</span> <span class="hljs-keyword">char</span>[<span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(Complex)*<span class="hljs-number">3</span>];<br>Complex* pc = <span class="hljs-built_in"><span class="hljs-keyword">new</span></span>(buf,<span class="hljs-number">3</span>) <span class="hljs-built_in">Complex</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>);        <span class="hljs-comment">// new() ä¼ å…¥äº†ä¸¤ä¸ªå‚æ•°</span><br></code></pre></td></tr></table></figure><h2 id="6åˆ†é…å†…å­˜çš„é€”å¾„"><a class="markdownIt-Anchor" href="#6åˆ†é…å†…å­˜çš„é€”å¾„"></a> 6.åˆ†é…å†…å­˜çš„é€”å¾„</h2><p>ä¸‹é¢ä¸¤å¼ å›¾åˆ†åˆ«å±•ç¤ºäº†C++æ™®é€šç¨‹åºå’ŒSTLå®¹å™¨é‡Œåˆ†é…å†…å­˜çš„é€”å¾„ï¼š</p><ul><li><p>å¯¹äºC++æ™®é€šç¨‹åºæ¥è¯´ï¼Œæœ€å¤šè¿˜æ˜¯ä½¿ç”¨ new expression æ¥åŠ¨æ€åˆ†é…å†…å­˜ï¼Œè€Œ new expression æ˜¯ä¸å¯æ”¹å˜çš„ï¼Œä¸å¯é‡è½½çš„ï¼Œä¼šè¢«ç¼–è¯‘å™¨è½¬æ¢æˆå»è°ƒç”¨ <code>operator new</code></p><p>å’Œ <code>placement new</code> ä¸¤æ­¥</p><ul><li><p>å¦‚æœè¯¥ç±»è‡ªèº«æœ‰é‡è½½<code>operator new</code>å‡½æ•°ï¼Œåˆ™ä¼šå»è°ƒç”¨é‡è½½çš„å‡½æ•°</p></li><li><p>å¦‚æœç±»è‡ªèº«æ²¡æœ‰é‡è½½ï¼Œå°±ä¼šå»è°ƒç”¨å…¨å±€çš„ <code>operator new</code>å‡½æ•°ï¼Œè¯¥å…¨å±€å‡½æ•°çš„å®ç°å°±æ˜¯å†å»è°ƒç”¨<code>malloc</code>å‡½æ•°ã€‚</p><ul><li>æ³¨æ„ï¼šå…¨å±€çš„<code>operator new</code> ä¹Ÿæ˜¯èƒ½å¤Ÿé‡è½½çš„ï¼Œä½†æ˜¯<strong>ä¼šå½±å“å…¨å±€çš„å†…å­˜åˆ†é…</strong>ï¼Œå› ä¸ºæ‰€æœ‰æ²¡æœ‰é‡è½½<strong>ç±»æˆå‘˜å‡½æ•°</strong><code>operator new</code>çš„ç±»ï¼Œéƒ½ä¼šè°ƒç”¨è¯¥<strong>å…¨å±€</strong><code>operator new</code>æ¥åˆ†é…å†…å­˜ã€‚</li></ul></li></ul></li><li><p>å¯¹äºC++ STL å®¹å™¨æ¥è¯´ï¼Œå®¹å™¨å†…å…ƒç´ çš„å†…å­˜åˆ†é…æ˜¯é€šè¿‡åˆ†é…å™¨<code>allocator</code>æ¥å®ç°ï¼Œ<code>allocator</code>æœ‰å¤šç§å®ç°æ–¹å¼ï¼Œåƒæ˜¯<code>new_allocator</code> å°±æ˜¯ç®€å•å¯¹å…¨å±€<code>operator new</code> è¿›è¡Œå°è£…ï¼Œè€Œ<code>pool_alloc</code>åˆ™æ˜¯é‡‡ç”¨äº†å†…å­˜æ± ç®¡ç†çš„æ¨¡å¼ï¼Œè¿™ä¹Ÿæ˜¯åæ–‡è¦é‡ç‚¹ä»‹ç»çš„å†…å®¹ã€‚</p></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102253262.png" alt="" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102253759.png" alt="" /></p><h1 id="stlä¹‹åˆ†é…å™¨"><a class="markdownIt-Anchor" href="#stlä¹‹åˆ†é…å™¨"></a> STLä¹‹åˆ†é…å™¨</h1><p><a href="https://mp.weixin.qq.com/s/1rLCzJtspYzAxa0g6-BFCA">5 åƒå­—é•¿æ–‡+ 30 å¼ å›¾è§£ | é™ªä½ æ‰‹æ’• STL ç©ºé—´é…ç½®å™¨æºç </a></p><p>åŸæ–‡å…¶å®å·²ç»ä»‹ç»å¾—å¾ˆè¯¦ç»†äº†ï¼Œå› æ­¤è¿™é‡Œå°†é…åˆã€Šå†…å­˜ç®¡ç†ã€‹è§†é¢‘è¯¾ç¨‹å¯¹è¿™è¿™éƒ¨åˆ†çš„è®²è§£ï¼Œå¯¹åŸæ–‡åšä¸€å®šçš„è¡¥å……ï¼Œå‡ç»ƒå‡ºæœ€æ ¸å¿ƒçš„éƒ¨åˆ†ã€‚</p><blockquote><p>æ³¨æ„ï¼šå‚è€ƒçš„è¿™ç¯‡æ–‡ç« æ˜¯è®²è§£SGI STLä¸­åˆ†é…å™¨å®ç°ï¼Œè€Œã€Šå†…å­˜ç®¡ç†ã€‹ä¸­ä»‹ç»çš„æ˜¯ G2.9 std::allocçš„å®ç°ï¼Œä½†å…¶å®åŸç†æ˜¯ç±»ä¼¼çš„ï¼Œæ ‡å‡†åº“çš„å®ç°ä¹Ÿæ˜¯å‚è€ƒäº†SGI STLçš„å®ç°ï¼Œ G2.9 std::alloc å°±å¯¹åº”äº SGI STLä¸­çš„ç¬¬äºŒçº§åˆ†é…å™¨ï¼Œéƒ½æ˜¯è¿ç”¨å†…å­˜æ± çš„æ€æƒ³ã€‚</p></blockquote><p>ä¸Šæ–‡ä¹Ÿæœ‰æåˆ°ï¼Œ new å’Œ delete éƒ½åŒ…å«ä¸¤é˜¶æ®µæ“ä½œï¼š</p><ul><li>å¯¹äº <code>new</code> æ¥è¯´ï¼Œç¼–è¯‘å™¨ä¼šå…ˆè°ƒç”¨ <code>::operator new</code> åˆ†é…å†…å­˜ï¼›ç„¶åè°ƒç”¨ <code>Obj::Obj()</code> æ„é€ å¯¹è±¡å†…å®¹ã€‚</li><li>å¯¹äº <code>delete</code> æ¥è¯´ï¼Œç¼–è¯‘å™¨ä¼šå…ˆè°ƒç”¨ <code>Obj::~Obj()</code> ææ„å¯¹è±¡ï¼›ç„¶åè°ƒç”¨  <code>::operator delete</code> é‡Šæ”¾ç©ºé—´ã€‚</li></ul><p>åŒæ ·ï¼ŒSTL allocator ä¹Ÿå°†è¿™ä¸¤ä¸ªé˜¶æ®µæ“ä½œåŒºåˆ†å¼€æ¥ï¼š</p><ul><li>å†…å­˜é…ç½®ç”± <code>alloc::allocate()</code> è´Ÿè´£ï¼›å†…å­˜é‡Šæ”¾ç”± <code>alloc::deallocate()</code> è´Ÿè´£ï¼›</li><li>å¯¹è±¡æ„é€ ç”± <code>::construct()</code> è´Ÿè´£ï¼›å¯¹è±¡é‡Šæ”¾ç”± <code>::destroy()</code> è´Ÿè´£ã€‚</li></ul><p>SGI STLä¸­å®šä¹‰çš„æ¡†æ¶ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆå›¾ç‰‡æ¥æºå‚è€ƒæ–‡ç« <sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="5 åƒå­—é•¿æ–‡+ 30 å¼ å›¾è§£ | é™ªä½ æ‰‹æ’• STL ç©ºé—´é…ç½®å™¨æºç ">[1]</span></a></sup>ï¼‰ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102300626.png" alt="STLåˆ†é…å™¨ç›¸å…³å¤´æ–‡ä»¶" /></p><p>å¯¹è±¡æ„é€ å’Œææ„ä¹‹åçš„å†…å­˜ç®¡ç†è¯¸é¡¹äº‹å®œï¼Œç”± &lt;stl_alloc.h&gt; ä¸€å¾‹è´Ÿè´£ã€‚SGI å¯¹æ­¤çš„è®¾è®¡åŸåˆ™å¦‚ä¸‹ï¼š</p><ul><li>å‘ system heap è¦æ±‚ç©ºé—´</li><li>è€ƒè™‘å¤šçº¿ç¨‹ (multi-threads) çŠ¶æ€</li><li>è€ƒè™‘å†…å­˜ä¸è¶³æ—¶çš„åº”å˜æªæ–½</li><li>è€ƒè™‘è¿‡å¤šâ€œå°å‹åŒºå—â€å¯èƒ½é€ æˆçš„å†…å­˜ç¢ç‰‡ (fragment) é—®é¢˜</li></ul><p>è€ƒè™‘åˆ°å°å‹åŒºå—å¯èƒ½é€ æˆçš„å†…å­˜ç ´ç¢é—®é¢˜ï¼ŒSGI ä¸ºæ­¤è®¾è®¡äº†åŒå±‚çº§é…ç½®å™¨ã€‚å½“é…ç½®åŒºå—è¶…è¿‡ 128bytes æ—¶ï¼Œç§°ä¸ºè¶³å¤Ÿå¤§ï¼Œä½¿ç”¨ç¬¬ä¸€çº§é…ç½®å™¨ï¼Œç›´æ¥ä½¿ç”¨ malloc() å’Œ free()ã€‚</p><p>å½“é…ç½®åŒºå—ä¸å¤§äº 128bytes æ—¶ï¼Œä¸ºäº†é™ä½é¢å¤–è´Ÿæ‹…ï¼Œç›´æ¥ä½¿ç”¨ç¬¬äºŒçº§é…ç½®å™¨ï¼Œé‡‡ç”¨å¤æ‚çš„ memory pool å¤„ç†æ–¹å¼ã€‚</p><p>æ— è®ºä½¿ç”¨ç¬¬ä¸€çº§é…æ¥å™¨ï¼ˆ<code>__malloc_alloc_template</code>ï¼‰æˆ–æ˜¯ç¬¬äºŒçº§é…æ¥å™¨ï¼ˆ<code>__default_alloc_template</code>ï¼‰ï¼Œalloc éƒ½ä¸ºå…¶åŒ…è£…äº†æ¥å£ï¼Œä½¿å…¶èƒ½å¤Ÿç¬¦åˆ STL æ ‡å‡†ã€‚</p><p>å¯ä»¥å‚è€ƒä¸‹å›¾çš„è¯´æ˜ï¼ˆå›¾ç‰‡æ¥æºå‚è€ƒæ–‡ç« <sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="5 åƒå­—é•¿æ–‡+ 30 å¼ å›¾è§£ | é™ªä½ æ‰‹æ’• STL ç©ºé—´é…ç½®å™¨æºç ">[1]</span></a></sup>ï¼‰ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102300137.png" alt="" /></p><h2 id="alloc-ç¬¬ä¸€çº§åˆ†é…å™¨"><a class="markdownIt-Anchor" href="#alloc-ç¬¬ä¸€çº§åˆ†é…å™¨"></a> alloc ç¬¬ä¸€çº§åˆ†é…å™¨</h2><p>ï¼ˆ1ï¼‰ç¬¬ä¸€çº§é…ç½®å™¨ä»¥ malloc(), free(), realloc() ç­‰ C å‡½æ•°æ‰§è¡Œå®é™…çš„å†…å­˜é…ç½®ã€é‡Šæ”¾å’Œé‡é…ç½®æ“ä½œï¼Œå¹¶å®ç°ç±»ä¼¼ C++ new-handler çš„æœºåˆ¶ï¼ˆå› ä¸ºå®ƒå¹¶éä½¿ç”¨ ::operator new æ¥é…ç½®å†…å­˜ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥ä½¿ç”¨C++ new-handler æœºåˆ¶ï¼‰ã€‚</p><p>ï¼ˆ2ï¼‰SGI ç¬¬ä¸€çº§é…ç½®å™¨çš„ allocate() å’Œ reallocate() éƒ½æ˜¯åœ¨è°ƒç”¨malloc() å’Œ realloc() ä¸æˆåŠŸåï¼Œæ”¹è°ƒç”¨ oom_malloc() å’Œoom_realloc()ã€‚</p><p>ï¼ˆ3ï¼‰oom_malloc() å’Œ oom_realloc() çš„å®ç°è·ŸC++ new_handlerçš„å®ç°æ˜¯ç±»ä¼¼çš„ï¼Œä¸‹å›¾æ˜¯å®ç°æºç ï¼Œéƒ½æ˜¯åœ¨ä¸æ–­å¾ªç¯è°ƒç”¨â€œå†…å­˜ä¸è¶³å¤„ç†ä¾‹ç¨‹â€ï¼ŒæœŸæœ›æŸæ¬¡è°ƒç”¨åï¼Œè·å¾—è¶³å¤Ÿçš„å†…å­˜è€Œåœ†æ»¡å®Œæˆä»»åŠ¡ï¼Œä½†å¦‚æœç”¨æˆ·å¹¶æ²¡æœ‰æŒ‡å®šâ€œå†…å­˜ä¸è¶³å¤„ç†ç¨‹åºâ€ï¼Œè¿™ä¸ªæ—¶å€™ä¾¿æ— åŠ›ä¹å¤©ï¼ŒçœŸçš„æ˜¯æ²¡å†…å­˜äº†ï¼ŒSTL ä¾¿æŠ›å‡ºå¼‚å¸¸ï¼Œæˆ–è°ƒç”¨exit(1) ç»ˆæ­¢ç¨‹åºã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102301185.png" alt="ç¬¬ä¸€çº§åˆ†é…å™¨oom_allocä¸oom_reallocæºç " /></p><p>ä¸‹å›¾åˆ™æ˜¯<code>operator new</code>ä¸­çš„å®ç°ï¼Œå¯ä»¥çœ‹åˆ°new_handleræœºåˆ¶çš„å®ç°è·Ÿç¬¬ä¸€çº§åˆ†é…å™¨çš„å®ç°æ˜¯å¾ˆç›¸è¿‘çš„ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102302209.png" alt="operator newæºç " /></p><h2 id="alloc-ç¬¬äºŒçº§åˆ†é…å™¨"><a class="markdownIt-Anchor" href="#alloc-ç¬¬äºŒçº§åˆ†é…å™¨"></a> alloc ç¬¬äºŒçº§åˆ†é…å™¨</h2><p>é¦–å…ˆæ¥è°ˆè°ˆä¸ºä»€ä¹ˆåˆ’åˆ†å‡ºç¬¬äºŒçº§åˆ†é…å™¨ï¼Œå¹¶ç”¨å¤æ‚çš„å†…å­˜æ± æœºåˆ¶æ¥è¿›è¡Œç®¡ç†ã€‚è¿™æ˜¯å› ä¸ºmallocå®é™…åˆ†é…çš„ç©ºé—´æ˜¯å¤§äºç”³è¯·çš„ç©ºé—´å¤§å°çš„ï¼Œå³ä¼šæœ‰cookieä¿¡æ¯æ¥è®°å½•æ­¤æ¬¡åˆ†é…çš„å†…å­˜å¤§å°ï¼ˆç”¨æˆ·å¯¹æ­¤æ— æ„ŸçŸ¥ï¼‰ï¼Œæ­£æ˜¯å› ä¸ºæºå¸¦äº†è¿™ä»½cookieä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨freeå›æ”¶çš„æ—¶å€™æ‰ä¸éœ€è¦æ˜¾å¼ä¼ å…¥éœ€è¦å›æ”¶çš„å¤§å°ã€‚</p><p>é‚£ä¹ˆè¿™å°±å®¹æ˜“å¯¼è‡´å†…å­˜é¢å¤–å¼€é”€çš„é—®é¢˜ï¼Œä¾‹å¦‚æ¯æ¬¡mallocæˆ‘åªéœ€è¦ç”³è¯·4å­—èŠ‚å¤§å°ï¼Œä½†å®é™…ä¸Šå´å› ä¸ºå¸¦æœ‰cookieä¿¡æ¯ï¼Œå®é™…å ç”¨äº†12ä¸ªå­—èŠ‚ï¼ˆä¸Šä¸‹éƒ½è®°å½•4å­—èŠ‚æ•°æ®ï¼‰ï¼Œæ˜¾ç„¶ç©ºé—´åˆ©ç”¨ç‡å¾ˆä½ã€‚å› æ­¤æ‰æœ‰äº†å†…å­˜æ± çš„ç®¡ç†æ‰‹æ®µï¼Œä¸€æ¬¡åˆ†é…å¤§é‡çš„ç©ºé—´ï¼Œç„¶åå†åˆ‡å‰²æˆä¸€ä¸ªä¸ªå°ä»½ç»™ç”¨æˆ·ä½¿ç”¨ï¼Œè¿™æ ·ç©ºé—´åˆ©ç”¨ç‡å°±æé«˜äº†ã€‚</p><hr /><p>æ¥ä¸‹æ¥è°ˆè°ˆå†…å­˜æ± çš„è¿ä½œæ¨¡å¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ç®€å•æè¿°ä¸€ä¸‹å°±æ˜¯æœ‰16æ¡ç©ºé—²é“¾è¡¨ï¼Œæ¯æ¡é“¾è¡¨è´Ÿè´£åˆ†é…ä»¥8å­—èŠ‚ä¸ºå€æ•°çš„å†…å­˜å¤§å°ï¼Œä¾‹å¦‚ä¸‹æ ‡ä¸º0è´Ÿè´£8å­—èŠ‚å¤§å°ï¼Œä¸‹æ ‡ä¸º3çš„è´Ÿè´£32å­—èŠ‚å¤§å°ã€‚æ¯æ¡é“¾è¡¨ä¸ŠæŒ‚ç€å¤šä¸ªç©ºé—²åŒºå—ï¼Œæ¯ä¸ªç©ºé—²åŒºå—ç”¨embeded pointerçš„æ–¹å¼è¿æ¥èµ·æ¥ï¼ˆå°±æ˜¯æŠŠç©ºé—²åŒºå—çš„å‰4ä¸ªå­—èŠ‚ç”¨æ¥è®°å½•ä¸‹ä¸€ä¸ªç©ºé—²åŒºå—çš„ä½ç½®ï¼Œè¿™æ ·å°±é¿å…ç”³è¯·é¢å¤–çš„æŒ‡é’ˆç©ºé—´ã€‚è¿›è¡Œå†…å­˜åŒºå—çš„åˆ†é…å’Œå›æ”¶ï¼Œä¹Ÿå°±æ˜¯å¯¹é“¾è¡¨è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œä¾‹å¦‚è¯·æ±‚25~32å­—èŠ‚å¤§å°çš„åŒºå—ï¼Œå°±ç”±ä¸‹æ ‡ä¸º3çš„é“¾è¡¨è´Ÿè´£åˆ†é…ï¼Œæ‹¿å‡ºé“¾è¡¨çš„ç¬¬ä¸€ä¸ªç©ºé—²åŒºå—ç»™ç”¨æˆ·ï¼Œç©ºé—²é“¾è¡¨å†æŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²åŒºå—ï¼›å›æ”¶çš„æ—¶å€™ï¼Œå†æŒ‚åˆ°å¯¹åº”é“¾è¡¨ä¸Šï¼Œä½œä¸ºç¬¬ä¸€ä¸ªç©ºé—²åŒºå—ã€‚<img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102303499.png" alt="std::allocè¿è¡Œæ¨¡å¼" /></p><p>å¤§è‡´äº†è§£è¿è¡Œæ¨¡å¼åï¼Œå†æ¥çœ‹çœ‹å…³é”®çš„æ•°æ®ç»“æ„ï¼š</p><ul><li><code>union _Obj</code>å°±æ˜¯ç”¨æ¥å®ç°åµŒå…¥å¼æŒ‡é’ˆï¼Œ<code>_M_free_list_link</code>æŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²åŒºå—çš„åœ°å€ï¼Œ<code>_M_client_data</code>åˆ™è¡¨ç¤ºå½“å‰<code>_Obj</code>çš„å†…å­˜åœ°å€ã€‚</li><li><code>_S_free_list</code>å°±æ˜¯éœ€è¦ç»´æŠ¤çš„ç©ºé—²é“¾è¡¨</li><li><code>_S_start_free</code>å’Œ<code>_S_end_free</code>ä¸¤ä¸ªæŒ‡é’ˆç»´æŠ¤çš„æ˜¯å½“å‰å†…å­˜æ± çš„å¤§å°ï¼Œä½†æŸæ¡ç©ºé—²é“¾è¡¨ä¸Šæ²¡æœ‰ç©ºé—²åŒºå—çš„æ—¶å€™ï¼Œå°±ä¼šä»å†…å­˜æ± ä¸­è·å–åŒºå—ã€‚è€Œå†…å­˜æ± çš„å†…å­˜æ˜¯é€šè¿‡mallocåˆ†é…å¾—åˆ°çš„ã€‚<code>_S_heap_size</code>å˜é‡ç»´æŠ¤çš„æ˜¯å½“å‰å·²ç»ç´¯è®¡ç”³è¯·çš„å†…å­˜å¤§å°ï¼Œç”¨äºmallocç”³è¯·ç©ºé—´ã€‚</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102303912.png" alt="å…³é”®æ•°æ®ç»“æ„" /></p><hr /><p>ç»§ç»­æ·±å…¥ï¼Œæ¥çœ‹çœ‹æ ¸å¿ƒå‡½æ•°çš„æºç å®ç°ã€‚å†…å­˜åˆ†é…ä¸»è¦ç”±<code>allocate</code>å‡½æ•°è´Ÿè´£ï¼Œå†…å­˜å›æ”¶ä¸»è¦æ˜¯<code>deallocate</code>å‡½æ•°è´Ÿè´£ã€‚<code>deallocate</code>çš„å®ç°æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯å°†å›æ”¶çš„å†…å­˜å—æ ¹æ®å…¶å¤§å°ï¼Œæ”¾åˆ°å¯¹åº”çš„ç©ºé—²é“¾è¡¨ä¸Šã€‚æ‰€ä»¥è¿™é‡Œå°†ä¸»è¦ä»‹ç»<code>allocate</code>å‡½æ•°å®ç°ã€‚</p><p>ä¸‹é¢æ˜¯<code>allocate</code>å‡½æ•°çš„æºç ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœç”³è¯·çš„å†…å­˜å¤§å°å¤§äº128å­—èŠ‚ï¼Œå°±ä¼šè½¬å»è°ƒç”¨ç¬¬ä¸€çº§åˆ†é…å™¨ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥è°ƒç”¨mallocã€‚å¦‚æœå°äºç­‰äº128å­—èŠ‚ï¼Œåˆ™æ ¹æ®å…¶å¤§å°æ‰¾åˆ°å¯¹åº”åˆé€‚å¤§å°çš„ç©ºé—²é“¾è¡¨ï¼Œå¦‚æœå¯¹åº”ç©ºé—²é“¾è¡¨æœ‰ç©ºé—²çš„å†…å­˜å—åˆ™å¯ç›´æ¥åˆ†é…ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™è°ƒç”¨<code>_S_refill</code>å‡½æ•°è¿›è¡Œè·å–ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102303724.png" alt="ç¬¬äºŒçº§åˆ†é…å™¨allocateæºç " /></p><hr /><p><code>_S_refill</code> å‡½æ•°æºç å®ç°å¦‚ä¸‹å›¾ï¼Œå…¶ä¸­åˆä¸»è¦è°ƒç”¨<code>_S_chunk_alloc</code>æ¥è·å–ç©ºé—²å†…å­˜å—ï¼Œé»˜è®¤ä¼šç”³è¯·20å—ç©ºé—²åŒºå—ï¼Œä½†å¦‚æœåªå–å¾—äº†ä¸€ä¸ªï¼Œåˆ™ç›´æ¥è¿”å›ç»™ç”¨æˆ·ä½¿ç”¨ã€‚å¦‚æœè¿”å›çš„å—æ•°å¤§äº1ï¼Œé™¤äº†éœ€è¦åˆ†é…1å—ä¸ªç”¨æˆ·ä½¿ç”¨ï¼Œå‰©ä½™çš„ç©ºé—²åŒºå—è¦æŒ‚åˆ°ç®¡ç†å¯¹åº”å¤§å°çš„ç©ºé—²é“¾è¡¨ä¸Šï¼Œåœ¨å®ç°å°±åˆ©ç”¨äº†embedded pointerã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102304065.png" alt="ç¬¬äºŒçº§åˆ†é…å™¨_S_refillæºç " /></p><hr /><p>æœ€åæ¥çœ‹<code>_S_chunk_alloc</code> çš„æºç å®ç°ï¼Œ<strong>é•¿å›¾è­¦å‘Šï¼</strong></p><p>ä¾ç…§ä»£ç é€»è¾‘æ¥çœ‹ï¼Œç»“æ„ä¸º3ä¸ªif elseï¼š</p><ul><li>å¦‚æœå½“å‰å†…å­˜æ± å‰©ä½™ç©ºé—´æ»¡è¶³ç”³è¯·çš„ç©ºé—´å¤§å°ï¼Œé‚£ä¹ˆç›´æ¥ä»å†…å­˜æ± ä¸­è¿›è¡Œåˆ†é…ï¼Œç„¶åå‡å°å†…å­˜æ± å¤§å°ï¼ˆè°ƒæ•´ç›¸åº”çš„æŒ‡é’ˆï¼‰</li><li>å¦‚æœå½“å‰å†…å­˜æ± å‰©ä½™ç©ºé—´ä¸èƒ½å¤Ÿç”³è¯·çš„ç©ºé—´å¤§å°ï¼Œä½†æ˜¯è‡³å°‘å¯ä»¥æä¾›ä¸€ä¸ªä»¥ä¸Šçš„åŒºå—ï¼Œé‚£ä¹ˆèƒ½å¤Ÿæä¾›å¤šå°‘å—å°±è¿”å›å¤šå°‘å—ï¼Œç„¶åå‡å°å†…å­˜æ± å¤§å°</li><li>å¦‚æœå½“å‰å†…å­˜æ± å‰©ä½™ç©ºé—´è¿ä¸€ä¸ªåŒºå—çš„å¤§å°éƒ½æ— æ³•æä¾›ï¼Œé‚£ä¹ˆé¦–å…ˆå°†å½“å‰å†…å­˜æ± å‰©ä½™ç©ºé—´åˆ†é…ç»™ç®¡ç†å¯¹åº”å¤§å°çš„ç©ºé—²é“¾è¡¨ä¸Šï¼Œç„¶åä½¿ç”¨mallocç”³è¯·å¤§å—ç©ºé—´ã€‚<ul><li>è¿™é‡Œæ–°ç”³è¯·çš„ç©ºé—´å¤§å°çš„è®¡ç®—ç‰¹åˆ«æ³¨æ„ä¸€ä¸‹ï¼Œ<code>size_t __bytes_to_get = 2 * __total_bytes + _S_round_up(_S_heap_size &gt;&gt; 4);</code> æ˜¯2å€åŸæœ‰çš„éœ€æ±‚é‡å†åŠ ä¸Šä¸€ä¸ª<code>_S_round_up</code>è¿½åŠ é‡ï¼Œé™¤äº†åˆ†é…ç»™ç”¨æˆ·çš„20ä¸ªåŒºå—ï¼Œå‰©ä½™ä½œä¸ºå†…å­˜æ± å®¹é‡ï¼Œä»¥ä¾›ä¸‹æ¬¡åˆ†é…ã€‚å¯ä»¥æ¨æµ‹æ˜¯å› ä¸ºè®¡ç®—æœºåœ¨ç”³è¯·åˆ†é…çš„æ‰€éœ€çš„ç©ºé—´æ€»æ˜¯è¶Šè¦è¶Šå¤§ï¼Œä¸ºäº†åŠ å¿«åˆ†é…å°±æœ‰äº†ä¸ªè¿½åŠ é‡ï¼Œè€Œå…¶ä¸­çš„æ•°å€¼å¯èƒ½æ˜¯å¯¹åº”å›¢é˜Ÿçš„ç»éªŒå€¼</li><li>å¦‚æœmallocç”³è¯·æˆåŠŸï¼Œé‚£å°±é€’å½’çš„è°ƒç”¨è‡ªèº«ï¼Œå†æ¬¡åˆ†é…ï¼Œå› æ­¤æ­¤æ—¶æœ‰è¶³å¤Ÿçš„å†…å­˜æ± å¤§å°äº†ã€‚</li><li>å¦‚æœmallocåˆ†é…å¤±è´¥äº†ï¼Œè¡¨æ˜å½“å‰ç³»ç»Ÿå·²ç»æ²¡æœ‰å¤šä½™çš„å†…å­˜ï¼Œé‚£å°±ä»è¾ƒå¤§çš„ç©ºé—²é“¾è¡¨é‡Œåˆ†é…ä¸€å—ä½œä¸ºå†…å­˜æ± å®¹é‡ï¼ˆä»å·¦å¾€å³æ‰¾ï¼Œæ‰¾åˆ°æœ€å°èƒ½å¤Ÿæ»¡è¶³åˆ†é…çš„ç©ºé—²åŒºå—å¤§å°ï¼‰ï¼Œç„¶åå†é€’å½’è°ƒç”¨è‡ªèº«è¿›è¡Œåˆ†é…ã€‚ã€‚</li><li>å¦‚æœç©ºé—²é“¾è¡¨é‡Œä¹Ÿæ²¡æœ‰èƒ½å¤Ÿåˆ†é…çš„ç©ºé—²åŒºå—ï¼Œé‚£ä¹ˆè½¬å»è°ƒç”¨ç¬¬ä¸€çº§åˆ†é…å™¨è¿›è¡Œåˆ†é…ã€‚ç¬¬ä¸€çº§åˆ†é…å™¨è¿˜æ˜¯å›å»è°ƒç”¨mallocï¼Œè€Œå®ƒmallocå¤±è´¥çš„è¯ï¼Œä¼šæœ‰oom_malloc() å¤„ç†æœºåˆ¶ï¼Œä¼šå°è¯•å»è§£å†³å†…å­˜ä¸è¶³çš„é—®é¢˜ï¼ˆä¾‹å¦‚é‡Šæ”¾ä¸€äº›å†…å­˜ï¼‰ï¼Œå¦‚æœæ— æ³•è§£å†³ï¼Œé‚£å°±çœŸçš„å±±ç©·æ°´å°½ï¼Œç¨‹åºç»ˆæ­¢é€€å‡ºã€‚</li></ul></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102304519.png" alt="ç¬¬äºŒçº§åˆ†é…å™¨_S_chunk_allocæºç " /></p><h2 id="å°ç»“"><a class="markdownIt-Anchor" href="#å°ç»“"></a> å°ç»“</h2><p>åœ¨ä¾¯æ·è€å¸ˆçš„è§†é¢‘è¯¾ç¨‹ä¸­ï¼Œè¿˜æåˆ°äº†ä¸¤ç‚¹ï¼š</p><ul><li>ç¬¬äºŒçº§åˆ†é…å™¨æŒæœ‰çš„å†…å­˜æ± æ˜¯è¶Šæ¥è¶Šå¤§çš„ï¼Œå¹¶ä¸”åœ¨ç¨‹åºè¿è¡Œæ—¶ä¸ä¼šå½’è¿˜ç»™æ“ä½œç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœé«˜å³°æœŸåˆ†é…äº†100MBå†…å­˜ï¼Œé‚£ä¹ˆè¯¥å†…å­˜æ± å«æœ‰çš„ç©ºé—²åŒºå—æ€»å’Œå°±ä¸€ç›´æ˜¯100MBï¼Œå°±ç®—ç”¨æˆ·å½’è¿˜äº†ï¼Œåˆ†é…å™¨è¿˜ä¼šä¸€ç›´æŒæœ‰ä»¥ä¾›ä¸‹æ¬¡åˆ†é…ï¼Œè¿™å°±å¯èƒ½é€ æˆå†…å­˜æµªè´¹çš„é—®é¢˜ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆä¸ä¸ºåˆ†é…å™¨è®¾è®¡å†…å­˜å½’è¿˜çš„ç›¸å…³æœºåˆ¶å‘¢ï¼Ÿ<ul><li>è¿™ä¸»è¦æ˜¯å› ä¸º<strong>å®ç°éš¾åº¦æé«˜</strong>ï¼Œè·Ÿåˆ†é…å®ç°çš„æœºåˆ¶ç›¸å…³ï¼Œå› ä¸ºæ˜¯ä»¥é“¾è¡¨çš„å½¢å¼è¿æ¥ç©ºé—²åŒºå—ï¼Œå½“å¤šæ¬¡åˆ†é…å’Œå½’è¿˜ä¹‹åï¼Œå°±å¾ˆéš¾æ‰¾åˆ°ç›¸é‚»çš„å†…å­˜å—ã€‚å¹¶ä¸”é“¾è¡¨çš„é•¿åº¦ä¹Ÿä¸æ˜¯å›ºå®šçš„ï¼Œåœ¨ä½¿ç”¨é«˜å³°æœŸå¯èƒ½ä¼šå˜å¾—å¾ˆé•¿ã€‚</li></ul></li><li>å¦ä¸€ç‚¹æ˜¯åœ¨<code>_S_chunk_alloc</code>å‡½æ•°å®ç°ä¸­ï¼Œå½“å†…å­˜æ± å¤§å°ä¸å¤Ÿï¼Œå»ä½¿ç”¨mallocç”³è¯·å†…å­˜ï¼Œè€Œå¦‚æœmallocç”³è¯·å†…å­˜å¤±è´¥äº†ï¼Œå°±ä¼šå»æ‰¾å…¶å®ƒè¾ƒå¤§ç©ºé—²é“¾è¡¨ä¸Šçš„åŒºå—ã€‚è¿™é‡Œæœ‰å¯èƒ½æ˜¯å› ä¸ºç”³è¯·çš„å†…å­˜è¿‡å¤§å¯¼è‡´çš„ï¼Œå¦‚æœèƒ½å¤Ÿå‡å°ç”³è¯·é‡ï¼Œå°±å¯ä»¥è¿›è¡Œåˆ†é…äº†ï¼Œä¾‹å¦‚å½“å‰éœ€è¦çš„ä¸€å—å¤§å°æ˜¯8Bï¼Œé‚£ä¹ˆè®¡ç®—å¾—åˆ°éœ€è¦ç”³è¯·2 * 20 * 8=320Bï¼ˆå‡è®¾å½“å‰æ²¡æœ‰RoundUpè¿½åŠ é‡ï¼‰ï¼Œè€Œå½“å‰ç©ºé—²å†…å­˜åªæœ‰200Bï¼Œæ‰€ä»¥mallocåˆ†é…å¤±è´¥ï¼Œå½“å¦‚æœæˆ‘ä»¬ç”³è¯·160B å°±èƒ½æˆåŠŸï¼Œä»ç„¶å¯ä»¥ä¸ºç”¨æˆ·æä¾›ç©ºé—²åŒºå—ã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¸è¿™ä¹ˆåšå‘¢ï¼Ÿ<ul><li>è¿™ä¸»è¦æ˜¯è€ƒè™‘åˆ°<strong>åœ¨å¤šç¨‹åºç¯å¢ƒä¸‹ï¼Œéœ€è¦ç»™å…¶ä»–ç¨‹åºé¢„ç•™å†…å­˜</strong>ã€‚å¦‚æœé‡‡ç”¨åˆšåˆšè¯´çš„é‚£ç§åšæ³•ï¼Œç›¸å½“äºå½“å‰ç¨‹åºä¼šæœ€å¤§ç¨‹åº¦çš„å ç”¨å†…å­˜ï¼Œé‚£ä¹ˆç•™ç»™å…¶ä»–ç¨‹åºçš„å¯ç”¨å†…å­˜å°±å˜å°‘äº†ï¼Œå°±å¯èƒ½ä¼šç»™å…¶ä»–ç¨‹åºçš„è¿è¡Œé€ æˆéº»çƒ¦ã€‚</li></ul></li></ul><p>æœ€åå†æ¥ä¸€å¼ SGI STLåˆ†é…å™¨è¿›è¡Œå†…å­˜åˆ†é…çš„å®Œæ•´æµç¨‹å›¾ï¼Œæ›´å¤šç»†èŠ‚é€»è¾‘å¤§å®¶å¯ä»¥å†å»çœ‹æºç ï¼Œæˆ–è€…å†çœ‹çœ‹æä¾›çš„å‚è€ƒæ–‡ç« å’Œä¾¯æ·è€å¸ˆçš„è§†é¢‘è¯¾ç¨‹ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202205102305633.jpeg" alt="ç¬¬äºŒçº§åˆ†é…å™¨å†…å­˜åˆ†é…æµç¨‹å›¾" /></p><h1 id="vc6-mallocåº•å±‚å®ç°"><a class="markdownIt-Anchor" href="#vc6-mallocåº•å±‚å®ç°"></a> VC6 mallocåº•å±‚å®ç°</h1><h1 id="lokiå†…å­˜ç®¡ç†"><a class="markdownIt-Anchor" href="#lokiå†…å­˜ç®¡ç†"></a> Lokiå†…å­˜ç®¡ç†</h1><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://mp.weixin.qq.com/s/1rLCzJtspYzAxa0g6-BFCA">5 åƒå­—é•¿æ–‡+ 30 å¼ å›¾è§£ | é™ªä½ æ‰‹æ’• STL ç©ºé—´é…ç½®å™¨æºç </a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://blog.51cto.com/quantfabric/2567655">C++æ€§èƒ½ä¼˜åŒ–ï¼ˆå…«ï¼‰â€”â€”å†…å­˜åˆ†é…æœºåˆ¶</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://wwwofai.com/article/18070">mallocèƒŒåçš„ç³»ç»ŸçŸ¥è¯†</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>C++</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>å†…å­˜ç®¡ç†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C++è¸©å‘è®°å½•ä¹‹éšå¼ç±»å‹è½¬æ¢</title>
    <link href="/2022/04/10/2022-04/2022-04-10%20C++%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95%E4%B9%8B%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2/"/>
    <url>/2022/04/10/2022-04/2022-04-10%20C++%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95%E4%B9%8B%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>ç›´æ¥ä»é—®é¢˜å¼•å…¥å§ï¼Œè¯·é—®ä¸‹é¢è¿™æ®µä»£ç çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs C++">string s = <span class="hljs-string">&quot;Hello&quot;</span>;<br><span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>;<br>cout &lt;&lt; i - s.<span class="hljs-built_in">length</span>() &lt;&lt; endl;<br></code></pre></td></tr></table></figure><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204111248357.jpg" alt="" style="zoom:33%;" /></center><h1 id="éšå¼ç±»å‹è½¬æ¢"><a class="markdownIt-Anchor" href="#éšå¼ç±»å‹è½¬æ¢"></a> éšå¼ç±»å‹è½¬æ¢</h1><p>å¦‚æœä½ æƒ³å½“ç„¶åœ°è®¤ä¸ºä¸Šé¢çš„è¾“å‡ºæ˜¯-4ï¼Œé‚£ä¹ˆæ˜¾ç„¶ä½ æ²¡æœ‰ä»”ç»†åœ°çœ‹è¿‡æœ¬æ–‡çš„æ ‡é¢˜ï¼ˆç¬‘ï¼‰ï¼Œè¦ä¹ˆå°±æ˜¯ä½ å’Œæˆ‘ä¸€æ ·ï¼Œç«å€™è¿˜æ²¡æœ‰åˆ°å®¶ã€‚é‚£ä¹ˆè¾“å‡ºç»“æœåˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè§ä¸‹å›¾ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204101711581.png" alt="å¥‡æ€ªçš„è¾“å‡ºç»“æœ" /></p><p>ä»€ä¹ˆï¼ï¼Ÿå±…ç„¶è¾“å‡ºçš„æ˜¯18446744073709551613è¿™ä¹ˆä¸€ä¸ªå¤§æ•°å­—ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p><p>å…¶å®è¿™é‡ŒåŒ…å«äº†ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼Œç¬¬ä¸€ï¼Œå°±æ˜¯<code>string</code>çš„<code>length()</code> æ–¹æ³•è¿”å›å€¼ç±»å‹æ˜¯<code>unsigned long</code>ï¼Œå…¶å®å½“ä½ çœ‹åˆ°è¾“å‡ºè¿™ä¹ˆå¤§çš„ä¸€ä¸ªæ•°å­—æ—¶ï¼Œå°±ä¸éš¾çŒœæƒ³åˆ°è·Ÿunsigned longç±»å‹ç›¸å…³ã€‚ç¬¬äºŒï¼Œå°±æ˜¯C++ä¸­çš„éšå¼ç±»å‹è½¬æ¢ï¼Œä¸Šè¿° <code>i - s.length()</code> çš„è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œ<code>i</code> æ˜¯<code>int</code>ç±»å‹ï¼Œè€Œ <code>s.length()</code> æ˜¯ <code>unsigned long</code> ç±»å‹ï¼Œä¸¤è€…çš„ç±»å‹ä¸ä¸€è‡´ï¼Œæ‰€ä»¥ä¼šå‘ç”Ÿéšå¼ç±»å‹è½¬æ¢ï¼Œä¹Ÿå°±æ˜¯æŠŠ<code>int</code> ç±»å‹è‡ªåŠ¨è½¬æ¢ä¸º <code>unsigned long</code> ç±»å‹ã€‚</p><p><code>i</code> è½¬æ¢ä¸º<code>unsigned long</code> ç±»å‹åï¼Œæ•°å€¼ä¸º1ï¼Œè€Œ <code>s.length()</code> æ•°å€¼ä¸º5ï¼Œå› æ­¤ç›¸å‡ä¼šå‘ç”Ÿä¸‹æº¢ï¼Œä½†å› ä¸ºæ˜¯<code>unsigned long</code> ç±»å‹ï¼Œæ‰€ä»¥è¾“å‡ºä¸€ä¸ªå¤§æ­£æ•´æ•°ã€‚å¦‚æœå°†ç»“æœè½¬æ¢æˆ<code>long</code>ç±»å‹ï¼Œå°±å¯ä»¥çœ‹åˆ°é¢„æœŸè¾“å‡ºçš„äº†ã€‚ä¸‹é¢çš„ä»£ç å’Œè¾“å‡ºç»“æœï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£è¿™ä¸€è¿‡ç¨‹ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;string&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">// è¾“å‡ºäºŒè¿›åˆ¶è¡¨ç¤º</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> num)</span> </span>&#123;<br>    cout &lt;&lt;  <span class="hljs-string">&quot;binary:&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">63</span>;i&gt;=<span class="hljs-number">0</span>;i--) &#123;<br>        cout &lt;&lt; ((num &gt;&gt; i ) &amp; <span class="hljs-number">1</span>);<br>    &#125;<br>    cout &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    string s = <span class="hljs-string">&quot;Hello&quot;</span>;<br>    <span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>;<br>    <br>    cout &lt;&lt; <span class="hljs-string">&quot;i\t\t\t&quot;</span>;<br>    <span class="hljs-built_in">print</span>(i);<br><br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> u_i = <span class="hljs-keyword">static_cast</span>&lt;<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span>&gt;(i);<br>    cout &lt;&lt; <span class="hljs-string">&quot;u_i\t\t\t&quot;</span>;<br>    <span class="hljs-built_in">print</span>(u_i);<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;s.length()\t&quot;</span>;<br>    <span class="hljs-built_in">print</span>(s.<span class="hljs-built_in">length</span>());<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;i - s.length() : &quot;</span>;<br>    <span class="hljs-built_in">print</span>(i-s.<span class="hljs-built_in">length</span>());<br>    cout &lt;&lt; <span class="hljs-string">&quot;i - s.length() : &quot;</span> &lt;&lt; i - s.<span class="hljs-built_in">length</span>() &lt;&lt; endl;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204101737594.png" alt="è¾“å‡ºç»“æœ" /></p><p class='note note-info'>  <font size=3>    é¡ºå¸¦ä¸€æï¼Œint ç±»å‹å¾€ unsigned long è½¬æ¢æ—¶ï¼Œå¯¹äºæ­£æ•°ï¼Œé«˜ä½è¡¥0ï¼Œå¯¹äºè´Ÿæ•°é«˜ä½è¡¥1ã€‚  </font></p><hr /><p>æ¥ä¸‹æ¥æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œçœ‹çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼Œæœ€ç»ˆçš„ <code>id</code> ä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202309251928222.png" alt="" /></p><p>è¿™é‡Œä¹Ÿä¸å–å…³å­äº†ï¼Œæœ€åä¼šè¾“å‡º -1ï¼Œè€Œä¸æ˜¯é¢„æœŸçš„ INT64_MAX / 2 çš„å€¼ã€‚é‚£ä¹ˆè¿™é‡Œå…¶å®ä¹Ÿæ˜¯å­˜åœ¨ä¸€ä¸ªç±»å‹è½¬æ¢çš„é—®é¢˜ï¼Œéœ€è¦æ„è¯†åˆ°å­—é¢é‡ 1 ï¼Œå®ƒçš„ç±»å‹å®é™…ä¸Šæ˜¯ <code>int</code>ï¼Œå› æ­¤åœ¨ <code>MGet</code> å‡½æ•°æ¨¡æ¿è¯†åˆ« Value ç±»å‹çš„æ—¶å€™ä¼šè¯†åˆ«æˆ <code>int</code>ï¼Œå› æ­¤åœ¨å‡½æ•°è¿”å›æ—¶ä¼šåšä¸€æ¬¡å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ˆ<code>int64_t</code> è½¬æ¢æˆ <code>int</code>ï¼Œè¿›è¡Œæˆªæ–­ï¼‰ï¼Œ ç„¶åå†èµ‹å€¼ç»™ <code>id</code> æ—¶åˆåšäº†ä¸€æ¬¡éšå¼ç±»å‹è½¬æ¢ã€‚é‚£ä¹ˆç¬¬ä¸€æ¬¡å¼ºåˆ¶ç±»å‹è½¬æ¢çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯å‡½æ•°è¿”å›å€¼å°±æ˜¯ -1ï¼Œå› ä¸º INT64_MAX / 2 ä½32ä½å…¨æ˜¯ 1ï¼Œå‘ä¸‹è½¬å‹æˆ <code>int</code> åï¼Œå¯¹åº”çš„æ•°å€¼å°±æ˜¯ -1ï¼Œè€Œ <code>int</code> å‘ä¸Šè½¬å‹åˆ° <code>int64_t</code>ï¼Œé«˜ä½è¡¥1ï¼Œå› æ­¤æœ€ç»ˆçš„æ•°å€¼è¿˜æ˜¯è¡¨ç¤º -1ã€‚</p><h1 id="å°ç»“"><a class="markdownIt-Anchor" href="#å°ç»“"></a> å°ç»“</h1><p>æœ€åå°ç»“ä¸€ä¸‹ï¼ŒC++åšä¸ºå¼ºç±»å‹è¯­è¨€ï¼Œè¦æ±‚ç¼–è¯‘æœŸçš„ç±»å‹å£°æ˜ä¸æ£€æŸ¥ï¼Œè¦æ±‚è¡¨è¾¾å¼ä¸­å„æ“ä½œæ•°çš„ç±»å‹ï¼ˆåŒ…æ‹¬èµ‹å€¼æ“ä½œçš„å·¦å€¼å’Œå³å€¼ï¼Œä»¥åŠå½¢å‚å’Œå®å‚ï¼‰å…·æœ‰ä¸€è‡´æ€§ï¼Œä½†åŒæ—¶ä¹Ÿå…è®¸ä¸€å®šçš„çµæ´»æ€§ï¼Œå…è®¸ç±»å‹åœ¨ä¸€å®šç¨‹åº¦ä¸Šçš„å…¼å®¹ï¼Œä¹Ÿå°±æ˜¯å…è®¸ç±»å‹éµå¾ªä¸€å®šè§„åˆ™ä¸‹çš„éšå¼è½¬æ¢å’Œå¼ºåˆ¶è½¬æ¢<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="C++ç±»å‹è½¬æ¢è§„åˆ™ã€ä½•æ—¶å‘ç”Ÿéšå¼ç±»å‹è½¬æ¢åŠå¼ºåˆ¶ç±»å‹è½¬æ¢é€‚ç”¨åœºåˆ">[3]</span></a></sup>ã€‚</p><p>ä¸€äº›å¸¸è§å‘ç”Ÿéšå¼è½¬æ¢çš„æ—¶æœºæœ‰ï¼š</p><ul><li>åœ¨æ··åˆç±»å‹çš„è¡¨è¾¾å¼ä¸­ï¼Œå…¶æ“ä½œæ•°è¢«è½¬æ¢ä¸ºç›¸åŒçš„ç±»å‹ã€‚ä¸€èˆ¬ä¸ºä½ç²¾åº¦è½¬é«˜ç²¾åº¦ï¼Œå°±æ¯”å¦‚ä¸Šé¢æåˆ°çš„ int è½¬ unsigned longã€‚</li><li>ç”¨ä½œæ¡ä»¶çš„è¡¨è¾¾å¼è¢«è½¬æ¢ä¸º bool ç±»å‹ã€‚</li><li>ç”¨ä¸€è¡¨è¾¾å¼åˆå§‹åŒ–æŸä¸ªå˜é‡ï¼Œæˆ–å°†ä¸€è¡¨è¾¾å¼èµ‹å€¼ç»™æŸä¸ªå˜é‡ï¼Œåˆ™è¯¥è¡¨è¾¾å¼è¢«è½¬æ¢ä¸ºè¯¥å˜é‡çš„ç±»å‹ã€‚</li><li>åœ¨å‡½æ•°è°ƒç”¨ä¸­ä¹Ÿå¯èƒ½å‘ç”Ÿéšå¼ç±»å‹è½¬æ¢ã€‚</li></ul><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://blog.csdn.net/luolaihua2018/article/details/111996610">C++ç±»å‹è½¬æ¢ï¼šéšå¼è½¬æ¢å’Œæ˜¾å¼è½¬æ¢</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.cnblogs.com/apocelipes/p/14415033.html">å½»åº•ç†è§£c++çš„éšå¼ç±»å‹è½¬æ¢ </a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.163.com/dy/article/GSUJ68H50552BFRV.html">C++ç±»å‹è½¬æ¢è§„åˆ™ã€ä½•æ—¶å‘ç”Ÿéšå¼ç±»å‹è½¬æ¢åŠå¼ºåˆ¶ç±»å‹è½¬æ¢é€‚ç”¨åœºåˆ</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>C++</category>
      
      <category>ä»£ç è¿·æƒ‘è¡Œä¸ºå¤§èµ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€è®¾è®¡æ¨¡å¼ã€‘å·¥å‚æ–¹æ³•å’ŒåŸå‹æ¨¡å¼</title>
    <link href="/2022/04/09/2022-04/2022-04-09%20%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E5%92%8C%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/"/>
    <url>/2022/04/09/2022-04/2022-04-09%20%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E5%92%8C%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="factory-method-å·¥å‚æ–¹æ³•-å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼"><a class="markdownIt-Anchor" href="#factory-method-å·¥å‚æ–¹æ³•-å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼"></a> Factory Method å·¥å‚æ–¹æ³• â€”â€” å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼</h1><h2 id="1-æ„å›¾"><a class="markdownIt-Anchor" href="#1-æ„å›¾"></a> 1. æ„å›¾</h2><p>å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªç±»ã€‚Factory Methodæ˜¯ä¸€ä¸ªç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°å…¶å­ç±»ã€‚</p><h2 id="2-åˆ«å"><a class="markdownIt-Anchor" href="#2-åˆ«å"></a> 2. åˆ«å</h2><p>è™šæ„é€ å™¨ï¼ˆvirtual constructorï¼‰</p><h2 id="3-åŠ¨æœº"><a class="markdownIt-Anchor" href="#3-åŠ¨æœº"></a> 3. åŠ¨æœº</h2><p>è€ƒè™‘è¿™æ ·ä¸€ä¸ªåº”ç”¨æ¡†æ¶ï¼Œå®ƒå¯ä»¥å‘ç”¨æˆ·æ˜¾ç¤ºå¤šä¸ªæ–‡æ¡£ã€‚åœ¨è¿™ä¸ªæ¡†æ¶ä¸­ï¼Œä¸¤ä¸ªä¸»è¦çš„æŠ½è±¡æ˜¯Applicationå’ŒDocumentã€‚è¿™ä¸¤ä¸ªç±»éƒ½æ˜¯æŠ½è±¡çš„ï¼Œå®¢æˆ·å¿…é¡»é€šè¿‡ä»–ä»¬çš„å­ç±»æ¥åšä»¥åº”ç”¨ç›¸å…³çš„å®ç°ã€‚ä¾‹å¦‚ï¼Œä¸ºåˆ›å»ºä¸€ä¸ªç»˜å›¾åº”ç”¨ï¼Œæˆ‘ä»¬å®šä¹‰ç±»DrawingApplicationå’ŒDrawingDocumentã€‚Applicationè´Ÿè´£ç®¡ç†Documentå¹¶æ ¹æ®éœ€è¦åˆ›å»ºä»–ä»¬â€”â€”ä¾‹å¦‚ï¼Œç”¨æˆ·ä»èœå•ä¸­é€‰æ‹©openæˆ–è€…newçš„æ—¶å€™ã€‚</p><p>å› ä¸ºè¢«å®ä¾‹åŒ–çš„ç‰¹å®šDocumentå­ç±»æ˜¯ä¸ç‰¹å®šåº”ç”¨ç›¸å…³çš„ï¼Œæ‰€ä»¥Applicationç±»ä¸å¯èƒ½é¢„æµ‹åˆ°å“ªä¸€ä¸ªDocumentå­ç±»å°†è¢«å®ä¾‹åŒ–â€”â€”Applicationä»…ä»…çŸ¥é“ä¸€ä¸ªæ–°çš„æ–‡æ¡£è¢«åˆ›å»ºï¼Œè€Œä¸çŸ¥é“å“ªä¸€ç§Documentè¢«åˆ›å»ºã€‚è¿™å°±äº§ç”Ÿäº†ä¸€ä¸ªå°´å°¬çš„å±€é¢ï¼šæ¡†æ¶å¿…é¡»è¢«å®ä¾‹åŒ–ï¼Œä½†æ˜¯ä»–åªçŸ¥é“ä¸èƒ½è¢«å®ä¾‹åŒ–çš„æŠ½è±¡ç±»ã€‚</p><p>Factory Method æ¨¡å¼æä¾›äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚å®ƒå°è£…äº†å“ªä¸ªDocumentå­ç±»å°†åˆ›å»ºçš„ä¿¡æ¯å¹¶å°†è¿™äº›ä¿¡æ¯ä»è¯¥æ¡†æ¶ä¸­åˆ†ç¦»å‡ºæ¥ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204091429416.jpeg" alt="Factory Method è§£å†³æ–¹æ¡ˆ" /></p><h2 id="4-é€‚ç”¨æ€§"><a class="markdownIt-Anchor" href="#4-é€‚ç”¨æ€§"></a> 4. é€‚ç”¨æ€§</h2><p>åœ¨ä¸‹åˆ—æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Factory Methodæ¨¡å¼ï¼š</p><ul><li>å½“ä¸€ä¸ªç±»ä¸çŸ¥é“å®ƒæ‰€å¿…é¡»åˆ›å»ºçš„å¯¹è±¡çš„ç±»çš„æ—¶å€™ã€‚</li><li>å½“ä¸€ä¸ªç±»å¸Œæœ›ç”±å®ƒçš„å­ç±»æ¥æŒ‡å®šå®ƒæ‰€åˆ›å»ºçš„å¯¹è±¡çš„æ—¶å€™ã€‚</li><li>å½“ç±»åˆ›å»ºå¯¹è±¡çš„èŒè´£å§”æ‰˜ç»™å¤šä¸ªå¸®åŠ©å­ç±»ä¸­çš„æŸä¸€ä¸ªï¼Œå¹¶ä¸”ä½ å¸Œæœ›å°†å“ªä¸€ä¸ªå¸®åŠ©å­ç±»æ˜¯ä»£ç†è€…è¿™ä¸€ä¿¡æ¯å±€éƒ¨åŒ–çš„æ—¶å€™ã€‚</li></ul><h2 id="5-ç»“æ„"><a class="markdownIt-Anchor" href="#5-ç»“æ„"></a> 5. ç»“æ„</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204091430163.jpeg" alt="Factory Method ç»“æ„å›¾" /></p><h2 id="6-å‚ä¸è€…"><a class="markdownIt-Anchor" href="#6-å‚ä¸è€…"></a> 6. å‚ä¸è€…</h2><ul><li>Productï¼ˆDocumentï¼‰<ul><li>å®šä¹‰å·¥å‚æ–¹æ³•æ‰€åˆ›å»ºçš„å¯¹è±¡çš„æ¥å£</li></ul></li><li>ConcreteProductï¼ˆMyDocumentï¼‰<ul><li>å®ç°Productæ¥å£</li></ul></li><li>Creatorï¼ˆApplicationï¼‰<ul><li>å£°æ˜å·¥å‚æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªProductç±»å‹çš„å¯¹è±¡ã€‚Creatorä¹Ÿå¯ä»¥å®šä¹‰ä¸€ä¸ªå·¥å‚æ–¹æ³•çš„ç¼ºçœå®ç°ï¼Œå®ƒè¿”å›ä¸€ä¸ªç¼ºçœçš„ConcreteProductå¯¹è±¡</li><li>å¯ä»¥è°ƒç”¨å·¥å‚æ–¹æ³•ä»¥åˆ›å»ºä¸€ä¸ªProductå¯¹è±¡</li></ul></li><li>ConcreteCreatorï¼ˆMyApplicationï¼‰<ul><li>é‡å®šä¹‰å·¥å‚æ–¹æ³•ä»¥è¿”å›ä¸€ä¸ªConcreteProductå®ä¾‹ã€‚</li></ul></li></ul><h2 id="7-åä½œ"><a class="markdownIt-Anchor" href="#7-åä½œ"></a> 7. åä½œ</h2><p>Creatorä¾èµ–äºå®ƒçš„å­ç±»æ¥å®šä¹‰å·¥å‚æ–¹æ³•ï¼Œæ‰€ä»¥å®ƒè¿”å›ä¸€ä¸ªé€‚å½“çš„ConcreteProductå®ä¾‹ã€‚</p><h2 id="8-æ•ˆæœ"><a class="markdownIt-Anchor" href="#8-æ•ˆæœ"></a> 8. æ•ˆæœ</h2><p>å·¥å‚æ–¹æ³•ä¸å†å°†ä¸ç‰¹å®šåº”ç”¨æœ‰å…³çš„ç±»ç»‘å®šåˆ°ä½ çš„ä»£ç ä¸­ã€‚ä»£ç ä»…å¤„ç†Productæ¥å£ï¼Œå› æ­¤ä»–å¯ä»¥ä¸ç”¨æˆ·å®šä¹‰çš„ä»»ä½•ConcreteProductç±»ä¸€èµ·ä½¿ç”¨ã€‚</p><p>å·¥å‚æ–¹æ³•çš„ä¸€ä¸ªæ½œåœ¨ç¼ºç‚¹åœ¨äºï¼Œå®¢æˆ·å¯èƒ½ä»…ä»…ä¸ºäº†åˆ›å»ºä¸€ä¸ªç‰¹å®šçš„ConcreteProductå¯¹è±¡ï¼Œå°±ä¸å¾—ä¸åˆ›å»ºCreatorçš„å­ç±»ã€‚å½“Creatorå­ç±»ä¸æ˜¯å¿…éœ€çš„æ—¶å€™ï¼Œå®¢æˆ·ç°åœ¨å¿…ç„¶è¦å¤„ç†ç±»æ¼”åŒ–çš„å…¶ä»–æ–¹é¢ã€‚</p><h2 id="9-å®ç°"><a class="markdownIt-Anchor" href="#9-å®ç°"></a> 9. å®ç°</h2><p>å½“åº”ç”¨Factory Methodæ¨¡å¼æ—¶è¦è€ƒè™‘ä¸‹é¢ä¸€äº›é—®é¢˜ï¼š</p><p>1ï¼‰ä¸»è¦æœ‰ä¸¤ç§ä¸åŒçš„æƒ…å†µã€‚â‘  Creatorç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»å¹¶ä¸”ä¸æä¾›å®ƒæ‰€å£°æ˜çš„å·¥å‚æ–¹æ³•çš„å®ç°ã€‚â‘¡ Creatoræ˜¯ä¸€ä¸ªå…·ä½“çš„ç±»è€Œä¸”ä¸ºå·¥å‚æ–¹æ³•æä¾›ä¸€ä¸ªç¼ºçœçš„å®ç°ã€‚</p><p>2ï¼‰å‚æ•°åŒ–å·¥å‚æ–¹æ³•ã€‚è¯¥æ¨¡å¼çš„å¦ä¸€ç§æƒ…å†µä½¿å¾—å·¥å‚æ–¹æ³•å¯ä»¥åˆ›å»ºå¤šç§äº§å“ã€‚å·¥å‚æ–¹æ³•é‡‡ç”¨ä¸€ä¸ªå‚æ•°æ¥æ ‡è¯†è¦è¢«åˆ›å»ºçš„å¯¹è±¡ç§ç±»ã€‚</p><p>3ï¼‰ç‰¹å®šè¯­è¨€çš„å˜åŒ–å’Œé—®é¢˜ã€‚</p><p>4ï¼‰ä½¿ç”¨æ¨¡æ¿ä»¥é¿å…åˆ›å»ºå­ç±»ã€‚å·¥å‚æ–¹æ³•å¦ä¸€ä¸ªæ½œåœ¨çš„é—®é¢˜æ˜¯å®ƒä»¬å¯èƒ½ä»…ä¸ºäº†åˆ›å»ºé€‚å½“çš„Productå¯¹è±¡è€Œè¿«ä½¿ä½ åˆ›å»ºCreatorå­ç±»ã€‚åœ¨C++ä¸­å¦ä¸€ä¸ªè§£å†³åŠæ³•æ˜¯æä¾›Creatorçš„ä¸€ä¸ªæ¨¡æ¿å­ç±»ï¼Œä»–ä½¿ç”¨Productç±»ä½œä¸ºæ¨¡æ¿å‚æ•°ã€‚</p><p>5ï¼‰å‘½åçº¦å®šã€‚ä½¿ç”¨å‘½åçº¦å®šæ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œä»–å¯ä»¥æ¸…æ¥šåœ°è¯´æ˜ä½ æ­£åœ¨ä½¿ç”¨å·¥å‚æ–¹æ³•ã€‚</p><h2 id="10-ç¤ºä¾‹ä»£ç "><a class="markdownIt-Anchor" href="#10-ç¤ºä¾‹ä»£ç "></a> 10. ç¤ºä¾‹ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// FactoryMethod.h</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/9.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stack&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> CREATIONPATTERNDESIGN_FACTORYMETHOD_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CREATIONPATTERNDESIGN_FACTORYMETHOD_H</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_factory_method</span><span class="hljs-params">()</span></span>;<br><br><span class="hljs-comment">// æ–‡æ¡£ï¼ŒæŠ½è±¡çš„ä¸€ä¸ªäº§å“ç±» Product ï¼Œæä¾›é»˜è®¤å®ç°</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Document</span>&#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Open</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">is_open</span>()) &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;æ–‡æ¡£å·²ç»æ‰“å¼€äº†ï¼&quot;</span> &lt;&lt; endl;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            status = <span class="hljs-number">1</span>;<br>            cout &lt;&lt; <span class="hljs-string">&quot;æ‰“å¼€è¯¥æ–‡æ¡£ï¼Œç°åœ¨å¯ä»¥ç¼–è¾‘&quot;</span> &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Close</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">is_open</span>()) &#123;<br>            status = <span class="hljs-number">0</span>;<br>            cout &lt;&lt; <span class="hljs-string">&quot;æ–‡æ¡£å·²å…³é—­&quot;</span> &lt;&lt; endl;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;è¯¥æ–‡æ¡£æ²¡æœ‰è¢«æ‰“å¼€ï¼&quot;</span> &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Save</span><span class="hljs-params">(string text)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">is_open</span>()) &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;æ²¡æœ‰æ‰“å¼€è¯¥æ–‡æ¡£ï¼Œæ— æ³•ä¿å­˜!&quot;</span>  &lt;&lt; endl;<br>            <span class="hljs-keyword">return</span> ;<br>        &#125;<br>        prev_context.<span class="hljs-built_in">push</span>(cur_context);<br>        cur_context = text;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Revert</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">is_open</span>()) &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;æ²¡æœ‰æ‰“å¼€è¯¥æ–‡æ¡£ï¼Œæ— æ³•å›é€€!&quot;</span>  &lt;&lt; endl;<br>            <span class="hljs-keyword">return</span> ;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (!prev_context.<span class="hljs-built_in">empty</span>()) &#123;<br>            cur_context = prev_context.<span class="hljs-built_in">top</span>();<br>            prev_context.<span class="hljs-built_in">pop</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Show</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">is_open</span>()) &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;æ²¡æœ‰æ‰“å¼€è¯¥æ–‡æ¡£ï¼Œæ— æ³•æ˜¾ç¤ºå†…å®¹!&quot;</span>  &lt;&lt; endl;<br>            <span class="hljs-keyword">return</span> ;<br>        &#125;<br>        cout &lt;&lt; <span class="hljs-string">&quot;å½“å‰æ–‡æ¡£å†…å®¹ä¸ºï¼š&quot;</span> &lt;&lt; cur_context &lt;&lt; endl;<br>    &#125;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-comment">// æ–‡æ¡£å½“å‰çš„çŠ¶æ€ 0è¡¨ç¤ºå…³é—­ï¼Œ1è¡¨ç¤ºæ‰“å¼€ï¼Œ2è¡¨ç¤ºæœ‰ä¿®æ”¹</span><br>    <span class="hljs-keyword">int</span> status;<br>    <span class="hljs-comment">// æ–‡æ¡£çš„å½“å‰å†…å®¹</span><br>    string cur_context;<br>    <span class="hljs-comment">// æ–‡æ¡£ä¿®æ”¹ä¹‹å‰çš„å†…å®¹</span><br>    stack&lt;string&gt; prev_context;<br><br><span class="hljs-keyword">protected</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">is_open</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> status != <span class="hljs-number">0</span>;<br>    &#125;<br><br>&#125;;<br><br><span class="hljs-comment">// å…·ä½“çš„äº§å“ç±»ï¼Œå¯¹æ–‡æ¡£ Documentçš„ä¸€ä¸ªå­ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyDocument</span> :</span> <span class="hljs-keyword">public</span> Document &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Show</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">is_open</span>()) &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;æ²¡æœ‰æ‰“å¼€è¯¥æ–‡æ¡£ï¼Œæ— æ³•æ˜¾ç¤ºå†…å®¹!&quot;</span>  &lt;&lt; endl;<br>            <span class="hljs-keyword">return</span> ;<br>        &#125;<br>        cout &lt;&lt; <span class="hljs-string">&quot;====æ–‡æ¡£å­—ä½“æ˜¯å½©è‰²çš„====&quot;</span> &lt;&lt; endl;<br>        Document::<span class="hljs-built_in">Show</span>();<br>        cout &lt;&lt; <span class="hljs-string">&quot;==== EOF ====&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Application</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// å·¥å‚æ–¹æ³•</span><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> Document* <span class="hljs-title">CreateDocument</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OpenDocument</span><span class="hljs-params">(Document* document)</span> </span>&#123;<br>        document-&gt;<span class="hljs-built_in">Open</span>();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">CloseDocument</span><span class="hljs-params">(Document* document)</span> </span>&#123;<br>        document-&gt;<span class="hljs-built_in">Close</span>();<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// å­ç±»å®ç°å·¥å‚æ–¹æ³•ï¼Œè¿”å›å…·ä½“çš„Document</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyApplication</span> :</span> <span class="hljs-keyword">public</span> Application &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> Document* <span class="hljs-title">CreateDocument</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MyDocument;<br>    &#125;<br>&#125;;<br><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//CREATIONPATTERNDESIGN_FACTORYMETHOD_H</span></span><br><br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// FactoryMethod.cpp</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/9.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;FactoryMethod.h&quot;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_factory_method</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯•å·¥å‚æ–¹æ³•æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br><br>    Application* application = <span class="hljs-keyword">new</span> MyApplication;<br>    Document* doc = application-&gt;<span class="hljs-built_in">CreateDocument</span>();<br>    doc-&gt;<span class="hljs-built_in">Show</span>();<br>    application-&gt;<span class="hljs-built_in">OpenDocument</span>(doc);<br>    doc-&gt;<span class="hljs-built_in">Save</span>(<span class="hljs-string">&quot;hello world&quot;</span>);<br>    doc-&gt;<span class="hljs-built_in">Show</span>();<br>    doc-&gt;<span class="hljs-built_in">Save</span>(<span class="hljs-string">&quot;say bye&quot;</span>);<br>    doc-&gt;<span class="hljs-built_in">Save</span>(<span class="hljs-string">&quot;hello&quot;</span>);<br>    doc-&gt;<span class="hljs-built_in">Revert</span>();<br>    doc-&gt;<span class="hljs-built_in">Show</span>();<br>    application-&gt;<span class="hljs-built_in">CloseDocument</span>(doc);<br>    <span class="hljs-keyword">delete</span> doc;<br>    <span class="hljs-keyword">delete</span> application;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç»“æŸæµ‹è¯•å·¥å‚æ–¹æ³•æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="11-ç›¸å…³æ¨¡å¼"><a class="markdownIt-Anchor" href="#11-ç›¸å…³æ¨¡å¼"></a> 11. ç›¸å…³æ¨¡å¼</h2><p>Abstract Factoryç»å¸¸ç”¨å·¥å‚æ–¹æ³•æ¥å®ç°ã€‚</p><p>å·¥å‚æ–¹æ³•é€šå¸¸åœ¨ Template Methodä¸­è¢«è°ƒç”¨ã€‚</p><p>Prototypeä¸éœ€è¦åˆ›å»ºCreatorçš„å­ç±»ã€‚ä½†æ˜¯å®ƒä»¬é€šå¸¸è¦æ±‚ä¸€ä¸ªé’ˆå¯¹Productç±»çš„Initializeæ“ä½œã€‚Creatorä½¿ç”¨Initializeæ¥åˆå§‹åŒ–å¯¹è±¡ï¼Œè€ŒFactory Methodä¸éœ€è¦è¿™æ ·çš„æ“ä½œã€‚</p><h1 id="prototype-åŸå‹-å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼"><a class="markdownIt-Anchor" href="#prototype-åŸå‹-å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼"></a> Prototype åŸå‹ â€”â€” å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼</h1><h2 id="1-æ„å›¾-2"><a class="markdownIt-Anchor" href="#1-æ„å›¾-2"></a> 1. æ„å›¾</h2><p>ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚</p><h2 id="2-é€‚ç”¨æ€§"><a class="markdownIt-Anchor" href="#2-é€‚ç”¨æ€§"></a> 2. é€‚ç”¨æ€§</h2><p>åœ¨ä»¥ä¸‹æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨Prototypeæ¨¡å¼ï¼š</p><ul><li>å½“ä¸€ä¸ªç³»ç»Ÿåº”è¯¥ç‹¬ç«‹äºå®ƒçš„äº§å“åˆ›å»ºã€æ„æˆå’Œè¡¨ç¤ºæ—¶ã€‚</li><li>å½“è¦å®ä¾‹åŒ–çš„ç±»æ˜¯åœ¨è¿è¡Œæ—¶æŒ‡å®šæ—¶ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡åŠ¨æ€è£…è½½ã€‚</li><li>ä¸ºäº†é¿å…åˆ›å»ºä¸€ä¸ªä¸äº§å“ç±»å±‚æ¬¡å¹³è¡Œçš„å·¥å‚ç±»å±‚æ¬¡æ—¶</li><li>å½“ä¸€ä¸ªç±»çš„å®ä¾‹åªèƒ½æœ‰å‡ ä¸ªä¸åŒçŠ¶æ€ç»„åˆä¸­çš„ä¸€ç§æ—¶ã€‚å»ºç«‹ç›¸åº”æ•°ç›®çš„åŸå‹å¹¶å…‹éš†ä»–ä»¬å¯èƒ½æ¯”æ¯æ¬¡éƒ½ç”¨åˆé€‚çš„çŠ¶æ€æ‰‹å·¥å®ä¾‹åŒ–è¯¥ç±»æ›´æ–¹ä¾¿ä¸€äº›ã€‚</li></ul><h2 id="3-ç»“æ„"><a class="markdownIt-Anchor" href="#3-ç»“æ„"></a> 3. ç»“æ„</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204091432650.jpeg" alt="Prototypeç»“æ„å›¾" /></p><h2 id="4-å‚ä¸è€…"><a class="markdownIt-Anchor" href="#4-å‚ä¸è€…"></a> 4. å‚ä¸è€…</h2><ul><li>Prototype<ul><li>å£°æ˜ä¸€ä¸ªå…‹éš†è‡ªèº«çš„æ¥å£</li></ul></li><li>ConcretePrototye<ul><li>å®ç°ä¸€ä¸ªå…‹éš†è‡ªèº«çš„æ“ä½œ</li></ul></li><li>Client<ul><li>è®©ä¸€ä¸ªåŸå‹å…‹éš†è‡ªèº«è€Œåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡</li></ul></li></ul><h2 id="5-åä½œ"><a class="markdownIt-Anchor" href="#5-åä½œ"></a> 5. åä½œ</h2><p>å®¢æˆ·è¯·æ±‚ä¸€ä¸ªåŸå‹å…‹éš†è‡ªèº«</p><h2 id="6-æ•ˆæœ"><a class="markdownIt-Anchor" href="#6-æ•ˆæœ"></a> 6. æ•ˆæœ</h2><p>Prototype æœ‰è®¸å¤šä¸ Abstract Factoryå’ŒBuilder ä¸€æ ·çš„æ•ˆæœï¼šå®ƒå¯¹å®¢æˆ·éšè—äº†å…·ä½“çš„äº§å“ç±»ï¼Œå› æ­¤å‡å°‘äº†å®¢æˆ·çŸ¥é“çš„åå­—å’Œæ•°ç›®ã€‚æ­¤å¤–ï¼Œè¿™äº›æ¨¡å¼ä½¿å®¢æˆ·æ— éœ€æ”¹å˜å³å¯ä½¿ç”¨ä¸ç‰¹å®šåº”ç”¨ç›¸å…³çš„ç±»ã€‚</p><p>ä¸‹é¢åˆ—å‡ºPrototypeæ¨¡å¼çš„å¦å¤–ä¸€äº›ä¼˜ç‚¹ï¼š</p><p>1ï¼‰<strong>è¿è¡Œæ—¶å¢åŠ å’Œåˆ é™¤äº§å“</strong>ã€‚Prototypeå…è®¸åªé€šè¿‡å®¢æˆ·æ³¨å†ŒåŸå‹å®ä¾‹å°±å°†ä¸€ä¸ªæ–°çš„å…·ä½“äº§å“ç±»å¹¶å…¥ç³»ç»Ÿã€‚å®ƒæ¯”å…¶ä»–åˆ›å»ºå‹æ¨¡å¼æ›´ä¸ºçµæ´»ï¼Œå› ä¸ºå®¢æˆ·å¯ä»¥åœ¨è¿è¡Œæ—¶å»ºç«‹å’Œåˆ é™¤åŸå‹ã€‚</p><p>2ï¼‰<strong>æ”¹å˜å€¼ä»¥æŒ‡å®šæ–°å¯¹è±¡</strong>ã€‚é«˜åº¦åŠ¨æ€çš„ç³»ç»Ÿå…è®¸ä½ é€šè¿‡å¯¹è±¡ç»„åˆå®šä¹‰æ–°çš„è¡Œä¸ºâ€”â€”ä¾‹å¦‚ï¼Œé€šè¿‡ä¸ºä¸€ä¸ªå¯¹è±¡å˜é‡æŒ‡å®šå€¼â€”â€”å¹¶ä¸”ä¸å®šä¹‰æ–°çš„ç±»ã€‚ä½ é€šè¿‡å®ä¾‹åŒ–å·²æœ‰ç±»å¹¶ä¸”å°†è¿™äº›å®ä¾‹æ³¨å†Œä¸ºå®¢æˆ·å¯¹è±¡çš„åŸå‹ï¼Œå°±å¯ä»¥æœ‰æ•ˆå®šä¹‰æ–°ç±»åˆ«çš„å¯¹è±¡ã€‚</p><p>3ï¼‰<strong>æ”¹å˜ç»“æ„ä»¥æŒ‡å®šæ–°å¯¹è±¡</strong>ã€‚</p><p>4ï¼‰<strong>å‡å°‘å­ç±»çš„æ„é€ </strong>ã€‚</p><p>5ï¼‰<strong>ç”¨ç±»åŠ¨æ€é…ç½®åº”ç”¨</strong>ã€‚ä¸€ä¸ªå¸Œæœ›åŠ¨æ€è½½å…¥ç±»çš„å®ä¾‹çš„åº”ç”¨ä¸èƒ½é™æ€å¼•ç”¨ç±»çš„æ„é€ å™¨ï¼Œè€Œåº”è¯¥ç”±è¿è¡Œç¯å¢ƒåœ¨è½½å…¥æ—¶è‡ªåŠ¨åˆ›å»ºæ¯ä¸ªç±»çš„å®ä¾‹ï¼Œå¹¶ç”¨åŸå‹ç®¡ç†å™¨æ¥æ³¨å†Œè¿™ä¸ªå®ä¾‹ã€‚</p><p>Prototypeçš„ä¸»è¦ç¼ºé™·æ˜¯æ¯ä¸€ä¸ªPrototypeçš„å­ç±»éƒ½å¿…é¡»å®ç°Cloneæ“ä½œï¼Œè¿™å¯èƒ½å¾ˆå›°éš¾ã€‚</p><h2 id="7-å®ç°"><a class="markdownIt-Anchor" href="#7-å®ç°"></a> 7. å®ç°</h2><p>å½“å®ç°åŸå‹æ—¶ï¼Œè¦è€ƒè™‘ä¸‹é¢ä¸€äº›é—®é¢˜ï¼š</p><p>1ï¼‰<strong>ä½¿ç”¨ä¸€ä¸ªåŸå‹ç®¡ç†å™¨</strong>ã€‚å½“ä¸€ä¸ªç³»ç»Ÿä¸­åŸå‹æ•°ç›®ä¸å›ºå®šæ—¶ï¼ˆä¹Ÿå°±è¯´ï¼Œä»–ä»¬å¯ä»¥åŠ¨æ€åˆ›å»ºå’Œé”€æ¯ï¼‰ï¼Œè¦ä¿æŒä¸€ä¸ªå¯ç”¨åŸå‹çš„æ³¨å†Œè¡¨ã€‚å®¢æˆ·ä¸ä¼šè‡ªå·±ç®¡ç†åŸå‹ï¼Œä½†ä¼šåœ¨æ³¨å†Œè¡¨ä¸­å­˜å‚¨å’Œæ£€ç´¢åŸå‹ã€‚å®¢æˆ·åœ¨å…‹éš†ä¸€ä¸ªåŸå‹å‰ä¼šå‘æ³¨å†Œè¡¨è¯·æ±‚è¯¥åŸå‹ã€‚</p><p>2ï¼‰å®ç°å…‹éš†æ“ä½œã€‚Prototypeæ¨¡å¼æœ€å›°éš¾çš„éƒ¨åˆ†åœ¨äºæ­£ç¡®å®ç°Cloneæ“ä½œã€‚å½“å¯¹è±¡ç»“æ„åŒ…å«å¾ªç¯å¼•ç”¨æ—¶ï¼Œè¿™å°¤ä¸ºæ£˜æ‰‹ã€‚</p><p>3ï¼‰åˆå§‹åŒ–å…‹éš†å¯¹è±¡ã€‚</p><h2 id="8-ç¤ºä¾‹ä»£ç "><a class="markdownIt-Anchor" href="#8-ç¤ºä¾‹ä»£ç "></a> 8. ç¤ºä¾‹ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Prototype.h</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/9.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> CREATIONPATTERNDESIGN_PROTOTYPE_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CREATIONPATTERNDESIGN_PROTOTYPE_H</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_prototype</span><span class="hljs-params">()</span></span>;<br><br><span class="hljs-comment">// æŠ½è±¡çš„æ–‡å…·ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Stationery</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">use</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;è¿™æ˜¯ä¸€ä¸ªæ–‡å…·&quot;</span> &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> Stationery* <span class="hljs-title">clone</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pen</span> :</span> <span class="hljs-keyword">public</span> Stationery&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">use</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;è¿™æ˜¯ä¸€åªç¬”&quot;</span> &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-comment">// è¿™é‡Œå°±ç®€å•å®ç°ä¸ºæµ…æ‹·è´</span><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> Stationery* <span class="hljs-title">clone</span><span class="hljs-params">()</span>  </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Pen</span>();<br>    &#125;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Eraser</span> :</span> <span class="hljs-keyword">public</span> Stationery &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">use</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;è¿™æ˜¯ä¸€å—æ©¡çš®æ“¦&quot;</span> &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> Stationery* <span class="hljs-title">clone</span><span class="hljs-params">()</span>  </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Eraser</span>();<br>    &#125;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StationeryFactory</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">StationeryFactory</span>(Stationery* stationery) : <span class="hljs-built_in">prototype</span>(stationery) &#123;<br><br>    &#125;<br>    <span class="hljs-function">Stationery* <span class="hljs-title">create_stationery</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> prototype-&gt;<span class="hljs-built_in">clone</span>();<br>    &#125;<br>    ~<span class="hljs-built_in">StationeryFactory</span>()&#123;<br>        <span class="hljs-keyword">if</span> (prototype != <span class="hljs-literal">nullptr</span>) &#123;<br>            <span class="hljs-keyword">delete</span> prototype;<br>        &#125;<br>    &#125;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-comment">// è¦ç”Ÿäº§æ–‡å…·çš„åŸå‹</span><br>    Stationery* prototype;<br>&#125;;<br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//CREATIONPATTERNDESIGN_PROTOTYPE_H</span></span><br><br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Prototype.cpp</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/9.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;Prototype.h&quot;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_prototype</span><span class="hljs-params">()</span></span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯•åŸå‹æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>    <span class="hljs-function">StationeryFactory <span class="hljs-title">pen_factory</span><span class="hljs-params">(<span class="hljs-keyword">new</span> Pen)</span></span>;<br>    Stationery* pen1 = pen_factory.<span class="hljs-built_in">create_stationery</span>();<br>    Stationery* pen2 = pen_factory.<span class="hljs-built_in">create_stationery</span>();<br>    pen1-&gt;<span class="hljs-built_in">use</span>();<br>    pen2-&gt;<span class="hljs-built_in">use</span>();<br>    <span class="hljs-function">StationeryFactory <span class="hljs-title">eraser_factory</span><span class="hljs-params">(<span class="hljs-keyword">new</span> Eraser)</span></span>;<br>    Stationery* eraser = eraser_factory.<span class="hljs-built_in">create_stationery</span>();<br>    eraser-&gt;<span class="hljs-built_in">use</span>();<br><br>    <span class="hljs-keyword">delete</span> pen1;<br>    <span class="hljs-keyword">delete</span> pen2;<br>    <span class="hljs-keyword">delete</span> eraser;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç»“æŸæµ‹è¯•åŸå‹æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="9-ç›¸å…³æ¨¡å¼"><a class="markdownIt-Anchor" href="#9-ç›¸å…³æ¨¡å¼"></a> 9. ç›¸å…³æ¨¡å¼</h2><p>Prototypeå’Œ Abstract Factoryæ¨¡å¼åœ¨æŸäº›æ–¹é¢æ˜¯ç›¸äº’ç«äº‰çš„ã€‚ä½†æ˜¯ä»–ä»¬ä¹Ÿå¯ä»¥ä¸€èµ·ä½¿ç”¨ã€‚Abstract Factory å¯ä»¥å­˜å‚¨ä¸€ä¸ªè¢«å…‹éš†çš„åŸå‹é›†åˆï¼Œå¹¶ä¸”è¿”å›äº§å“å¯¹è±¡ã€‚</p><p>å¤§é‡ä½¿ç”¨ Composite å’Œ Decoratoræ¨¡å¼çš„è®¾è®¡ä¹Ÿå¯ä»¥ä»Prototypeæ¨¡å¼è·ç›Šã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¼–ç¨‹æŠ€å·§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¥‡æ€ªçš„forkç»“æœ</title>
    <link href="/2022/04/02/2022-04/2022-04-02%20%E5%A5%87%E6%80%AA%E7%9A%84fork%E7%BB%93%E6%9E%9C/"/>
    <url>/2022/04/02/2022-04/2022-04-02%20%E5%A5%87%E6%80%AA%E7%9A%84fork%E7%BB%93%E6%9E%9C/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>æœ€è¿‘åœ¨ä¸Šæ“ä½œç³»ç»Ÿçš„ç›¸å…³è¯¾ç¨‹ï¼Œæ°å¥½å­¦åˆ°äº†forkå‡½æ•°ã€‚è¿™ä¹ˆä¸ºäº†å¼•å…¥é—®é¢˜ï¼Œç®€å•æµ‹è¯•ä¸€ä¸‹ï¼Œè¯·é—®ä¸‹é¢çš„ä»£ç ä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>     fork();<br>     fork();<br>     fork();<br>     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hello World\n&quot;</span>);<br>     <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204031058600.jpg" alt="" /></p><h1 id="å¥‡å¦™çš„è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#å¥‡å¦™çš„è¿‡ç¨‹"></a> å¥‡å¦™çš„è¿‡ç¨‹</h1><p>ç›¸ä¿¡èªæ˜çš„å°ä¼™ä¼´ï¼Œé©¬ä¸Šå°±èƒ½å›ç­”ï¼Œâ€œä¼šè¾“å‡º8è¡Œ Hello Worldâ€ã€‚åŸå› ä¹Ÿå¾ˆç®€å•ï¼Œå› ä¸ºæ¯æ¬¡æ‰§è¡Œå®Œforkå‡½æ•°éƒ½ä¼šç”Ÿæˆä¸€ä¸ªè·Ÿçˆ¶è¿›ç¨‹ä¸€æ ·çš„å­è¿›ç¨‹ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡æ‰§è¡Œå®Œforkï¼Œæ€»å…±æœ‰2ä¸ªè¿›ç¨‹ï¼Œç¬¬äºŒæ¬¡æ‰§è¡Œå®Œforkå°±ä¼šæœ‰4ä¸ªï¼Œç¬¬ä¸‰æ¬¡æ‰§è¡Œå®Œå°±ä¼šæœ‰8ä¸ªï¼Œæ‰€ä»¥æœ€åæ¯ä¸ªè¿›ç¨‹éƒ½ä¼šè¾“å‡ºä¸€è¡ŒHello Worldã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç¨å¾®æ”¹å˜ä»£ç ï¼Œå˜æˆä¸‹é¢è¿™æ ·å­ï¼Œé‚£ä¹ˆè¿™æ¬¡è¾“å‡ºç»“æœä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hello World\n&quot;</span>);<br>     fork();<br>     fork();<br>     fork();<br>     <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ä¹Ÿè¿˜æ˜¯å¾ˆç®€å•å—ï¼Œç»“æœåªæ˜¯è¾“å‡ºä¸€è¡Œâ€œHello Worldâ€ï¼Œå› ä¸ºæ‰“å°æ“ä½œåœ¨forkæ“ä½œå‰ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥çš„å­è¿›ç¨‹éƒ½ä¸ä¼šå†æ‰§è¡Œæ‰“å°è¾“å‡ºçš„æ“ä½œäº†ã€‚ä¸€å¼€å§‹æˆ‘ä¹Ÿæ˜¯è¿™ä¹ˆæƒ³çš„ï¼Œä½†æ˜¯VScodeä¸Šçš„è¾“å‡ºç»“æœå´ä»¤äººå¤§åƒä¸€æƒŠï¼Œè¿™æ€ä¹ˆè¿˜æ˜¯è¾“å‡º8è¡Œå•Šï¼Ÿ</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204022126863.png" alt="VScodeè¾“å‡ºç»“æœ" /></p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204031059494.jpg" alt="" style="zoom: 50%;" /></center></br><p>è¿™çœŸè®©äººæœ‰äº›æ‘¸ä¸ç€å¤´è„‘ï¼Œç„¶åæˆ‘åˆè¯•äº†è¯•åœ¨å‘½ä»¤è¡Œä¸‹ç›´æ¥ç¼–è¯‘æ‰§è¡Œï¼Œå‘ç°è¿™æ¬¡å¾—åˆ°çš„ç»“æœç¬¦åˆé¢„æœŸï¼Œè¿™æ›´åŠ ä»¤äººç–‘æƒ‘äº†ã€‚æ‰€ä»¥æˆ‘åˆå»è¯•äº†è¯•åœ¨Clionä¸‹æ‰§è¡Œè¿™æ®µä»£ç ï¼Œå‘ç°è¾“å‡ºçš„ç»“æœä¹Ÿæ˜¯ç¬¦åˆé¢„æœŸçš„ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204022128750.png" alt="å‘½ä»¤è¡Œä¸‹ç¼–è¯‘æ‰§è¡Œ" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204022130779.png" alt="Clionæ‰§è¡Œç»“æœ" /></p><p>é‚£ä¹ˆåœ¨å¤šæ–¹å¯¹æ¯”ä¹‹ä¸‹ï¼Œåªèƒ½æ˜¯è®¤ä¸ºæ˜¯VScodeå‡ºäº†é—®é¢˜ã€‚å½“æ—¶æˆ‘è¿˜è®¤ä¸ºæ˜¯VScodeé‡ŒCode Runnerè¿™ä¸ªæ’ä»¶çš„é—®é¢˜ï¼Œæ‰€ä»¥åœ¨Stack Overflowä¸Šæé—®äº†<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="stackoverflowä¸Š æé—®forkçš„å¥‡æ€ªè¾“å‡ºç»“æœ">[1]</span></a></sup>ï¼Œéšåå¾—åˆ°äº†å¤§ç‰›çš„è§£ç­”ã€‚</p><p>ç®€å•æ¥è¯´printfæ˜¯æœ‰ä¸€ä¸ªbufferçš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¹¶ä¸æ˜¯æ‰§è¡Œå®Œprintfè¯­å¥ï¼Œå°±ä¼šç«‹å³è¾“å‡ºæ˜¾ç¤ºåˆ°ç»ˆç«¯å±å¹•ï¼ˆæ ‡å‡†è¾“å‡ºstdoutï¼‰ä¸Šï¼Œåªæœ‰bufferæ»¡äº†ï¼Œæˆ–è€…æ˜¾ç¤ºè°ƒç”¨åˆ·æ–°ï¼Œæˆ–æ˜¯è¾“å…¥å›è½¦ç¬¦ â€˜\nâ€™ ï¼Œæ‰ä¼šç«‹å³å°†ç¼“å†²åŒºçš„å†…å®¹è¾“å‡ºåˆ°å±å¹•ä¸Šã€‚</p><p>ä½†æ˜¯å¯¹äºVScodeæ¥è¯´ï¼Œç¨‹åºä»£ç å¹¶ä¸æ˜¯ç›´æ¥è¿è¡Œåœ¨ç»ˆç«¯shellé‡Œçš„ï¼Œæ ‡å‡†è¾“å‡ºstdoutä¼šç»‘å®šåˆ°IDEè‡ªèº«çš„ä¸€ä¸ªGUIï¼ˆå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼‰ã€‚æ­¤æ—¶ï¼Œåªæœ‰å½“ç¼“å†²åŒºæ»¡äº†ï¼Œæˆ–è€…æ˜¯æ‰‹åŠ¨åˆ·æ–°ç¼“å†²åŒºçš„æ—¶å€™ï¼Œæ‰ä¼šç«‹åˆ»è¾“å‡ºåˆ°GUIç•Œé¢ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´ç¼“å†²åŒºæ¥æ”¶åˆ°äº†â€™\nâ€™å›è½¦ç¬¦ä¹Ÿä¸ä¼šç«‹å³è¾“å‡ºã€‚ä¸‹å›¾æ˜¯æˆ‘çš„ç†è§£ï¼Œå¯èƒ½ä¸å¤ªå‡†ç¡®ï¼Œä¸è¿‡å¤§ä½“ä¸Šè¿™ä¹ˆè§£é‡Šèƒ½å¤Ÿè¯´å¾—é€šã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204031034635.jpeg" alt="ä¸ªäººå›¾è§£ï¼ˆå¯èƒ½ä¸å¤ªå‡†ç¡®ï¼‰" /></p><p>å› æ­¤å°±æœ‰äº†è¾“å‡º8è¡Œçš„å¥‡æ€ªå½¢è±¡ï¼Œå› ä¸ºæ¯ä¸ªå­è¿›ç¨‹éƒ½ç»§æ‰¿äº†ç¼“å†²åŒºé‡Œçš„å†…å®¹ï¼Œç›´åˆ°æœ€åç¨‹åºé€€å‡ºæ—¶åˆ·æ–°ç¼“å†²åŒºï¼Œå› æ­¤æœ€åæ¯ä¸ªç¨‹åºéƒ½è¾“å‡ºä¸€è¡Œã€‚</p><p>ç„¶ååœ¨å°è¯•ä¸‹æ·»åŠ <code>fflush</code>æ‰‹åŠ¨åˆ·æ–°ç¼“å†²åŒºï¼Œè¾“å‡ºæœç„¶å˜æˆäº†åªæœ‰ä¸€è¡Œï¼ŒéªŒè¯äº†ä¹‹å‰çš„æƒ³æ³•ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>     <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Hello World\n&quot;</span>);<br>     fflush(<span class="hljs-built_in">stdout</span>);<br>     fork();<br>     fork();<br>     fork();<br>     <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204031041593.png" alt="æ·»åŠ fflushåè¾“å‡ºç»“æœ" /></p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204031102883.jpg" alt="" style="zoom: 50%;" /></center><h1 id="å°ç»“"><a class="markdownIt-Anchor" href="#å°ç»“"></a> å°ç»“</h1><p>è‡³æ­¤ï¼Œæœ‰å…³forkä¹‹åå¥‡æ€ªçš„è¾“å‡ºç»“æœç»ˆäºæ°´è½çŸ³å‡ºï¼Œå…¶ä¸­æ¶‰åŠåˆ°çš„ä¸€ä¸ªå…³é”®ç‚¹å°±æ˜¯printfæˆ–è€…è¯´stdoutæ˜¯æœ‰ç¼“å†²åŒºçš„ï¼Œå¹¶ä¸æ˜¯æ‰§è¡Œå®Œè¯¥å‡½æ•°è¯­å¥å°±ä¼šç«‹åˆ»è¾“å‡ºåˆ°å±å¹•ä¸Šï¼Œè¿™ä¸€ä¸ªçŸ¥è¯†ç‚¹å…¶å®ä»¥å‰ä¹Ÿäº†è§£è¿‡ï¼Œä½†æ˜¯æ²¡æœ‰é‡è§†ï¼Œæˆ–è€…è¯´æ²¡æœ‰è¿›ä¸€æ­¥äº†è§£åº•å±‚å®ç°ï¼ŒåªçŸ¥é“ä¸ªæ¦‚å¿µï¼Œæ‰€ä»¥çœŸæ­£é‡åˆ°é—®é¢˜æ—¶ï¼Œè¿˜æ˜¯ä¸èƒ½æƒ³åˆ°è¿™ä¸€ç‚¹ã€‚</p><p>æ‰€ä»¥è¿˜æ˜¯è¦çœ‹æºç å•Šï¼Œæºç ä¹‹å‰ï¼Œäº†æ— ç§˜å¯†ã€‚ä½†å°´å°¬çš„æ˜¯ï¼Œæˆ‘åœ¨IDEé‡Œæƒ³çœ‹å¯¹åº”åº“å‡½æ•°çš„æºä»£ç å®ç°æ—¶ï¼Œæ€»æ˜¯è·³è½¬ä¸åˆ°å¯¹åº”çš„å®ç°ï¼Œåªæœ‰ä¸€äº›å£°æ˜ï¼Œè¿™å°±å¾ˆå°´å°¬ã€‚ä¸çŸ¥é“æœ‰æ²¡æœ‰äººè·Ÿæˆ‘æœ‰ç±»ä¼¼çš„è‹¦æ¼ï¼Œæ­£å¥½ç­‰ä¸‹æ¬¡è§£å†³äº†ï¼Œåˆå¯ä»¥æ°´ä¸€ç¯‡åšæ–‡äº† ğŸ˜ƒã€‚</p><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://stackoverflow.com/questions/71691584/why-are-the-results-performed-using-code-runner-in-vscode-different-from-the-res">stackoverflowä¸Š æé—®forkçš„å¥‡æ€ªè¾“å‡ºç»“æœ</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://blog.csdn.net/LG1259156776/article/details/52935741">printfç¼“å†²åŒºå°ç»“</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ä»£ç è¿·æƒ‘è¡Œä¸ºå¤§èµ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€è®¾è®¡æ¨¡å¼ã€‘æŠ½è±¡å·¥å‚æ¨¡å¼</title>
    <link href="/2022/04/02/2022-04/2022-04-02%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
    <url>/2022/04/02/2022-04/2022-04-02%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="abstract-factory-æŠ½è±¡å·¥å‚å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼"><a class="markdownIt-Anchor" href="#abstract-factory-æŠ½è±¡å·¥å‚å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼"></a> Abstract Factory æŠ½è±¡å·¥å‚â€”â€”å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼</h1><h2 id="1-æ„å›¾"><a class="markdownIt-Anchor" href="#1-æ„å›¾"></a> 1. æ„å›¾</h2><p>æä¾›ä¸€ä¸ªæ¥å£ä»¥åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–çš„å¯¹è±¡ï¼Œè€Œæ— éœ€æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚</p><h2 id="2-åŠ¨æœº"><a class="markdownIt-Anchor" href="#2-åŠ¨æœº"></a> 2. åŠ¨æœº</h2><p>è€ƒè™‘ä¸€ä¸ªæ”¯æŒå¤šç§è§†æ„Ÿï¼ˆlook-and-feelï¼‰æ ‡å‡†çš„ç”¨æˆ·ç•Œé¢å·¥å…·åŒ…ï¼Œä¸åŒçš„è§†æ„Ÿé£æ ¼ä¸ºè¯¸å¦‚æ»šåŠ¨æ¡ã€çª—å£å’ŒæŒ‰é’®ç­‰ç”¨æˆ·ç•Œé¢â€œçª—å£ç»„ä»¶â€å®šä¹‰ä¸åŒçš„å¤–è§‚å’Œè¡Œä¸ºã€‚ä¸ºä¿è¯è§†æ„Ÿé£æ ¼æ ‡å‡†ä¹‹é—´çš„å¯ç§»æ¤æ€§ï¼Œä¸€ä¸ªåº”ç”¨ä¸åº”è¯¥ä¸ºä¸€ä¸ªç‰¹å®šçš„è§†æ„Ÿå¤–è§‚ç¡¬ç¼–ç å®ƒçš„çª—å£ç»„ä»¶ã€‚åœ¨æ•´ä¸ªåº”ç”¨å®ä¾‹åŒ–ç‰¹å®šè§†æ„Ÿé£æ ¼çš„çª—å£ç»„ä»¶ç±»å°†ä½¿å¾—ä»¥åå¾ˆéš¾æ”¹å˜è§†æ„Ÿé£æ ¼ã€‚</p><p>ä¸ºè§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæŠ½è±¡çš„WidgetFactoryç±»ï¼Œè¿™ä¸ªç±»å£°æ˜äº†ä¸€ä¸ªåˆ›å»ºæ¯ä¸€ç±»åŸºæœ¬çª—å£ç»„ä»¶çš„æ¥å£ã€‚æ¯ä¸€ç±»çª—å£ç»„ä»¶éƒ½æœ‰ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œè€Œå…·ä½“å­ç±»åˆ™å®ç°äº†çª—å£ç»„ä»¶çš„ç‰¹å®šè§†æ„Ÿé£æ ¼ã€‚</p><h2 id="3-é€‚ç”¨æ€§"><a class="markdownIt-Anchor" href="#3-é€‚ç”¨æ€§"></a> 3. é€‚ç”¨æ€§</h2><p>åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ä½¿ç”¨Abstract Factory</p><ul><li>ä¸€ä¸ªç³»ç»Ÿè¦ç‹¬ç«‹äºå®ƒçš„äº§å“çš„åˆ›å»ºã€ç»„åˆå’Œè¡¨ç¤ºã€‚</li><li>ä¸€ä¸ªç³»ç»Ÿè¦ç”±å¤šä¸ªäº§å“ç³»åˆ—ä¸­çš„ä¸€ä¸ªæ¥é…ç½®ã€‚</li><li>è¦å¼ºè°ƒä¸€ç³»åˆ—ç›¸å…³çš„äº§å“å¯¹è±¡çš„è®¾è®¡ä»¥ä¾¿è¿›è¡Œè”åˆä½¿ç”¨ã€‚</li><li>æä¾›ä¸€ä¸ªäº§å“ç±»åº“ï¼Œä½†åªæƒ³æ˜¾ç¤ºå®ƒä»¬çš„æ¥å£è€Œä¸æ˜¯å®ç°ã€‚</li></ul><h2 id="4-ç»“æ„"><a class="markdownIt-Anchor" href="#4-ç»“æ„"></a> 4. ç»“æ„</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204021937446.jpeg" alt="UMLç±»å›¾ç¤ºæ„" /></p><h2 id="5-å‚ä¸è€…"><a class="markdownIt-Anchor" href="#5-å‚ä¸è€…"></a> 5. å‚ä¸è€…</h2><ul><li>AbstractFactory<ul><li>å£°æ˜ä¸€ä¸ªåˆ›å»ºæŠ½è±¡äº§å“å¯¹è±¡çš„æ“ä½œæ¥å£</li></ul></li><li>ConcreteFactory<ul><li>å®ç°åˆ›å»ºå…·ä½“äº§å“å¯¹è±¡çš„æ“ä½œ</li></ul></li><li>AbstractProduct<ul><li>ä¸ºä¸€ç±»äº§å“å¯¹è±¡å£°æ˜ä¸€ä¸ªæ¥å£</li></ul></li><li>ConcreteProduct<ul><li>å®šä¹‰ä¸€ä¸ªå°†è¢«ç›¸åº”çš„å…·ä½“å·¥å‚åˆ›å»ºçš„äº§å“å¯¹è±¡</li><li>å®ç°AbstracProductæ¥å£</li></ul></li><li>Client<ul><li>ä»…ä½¿ç”¨ç”±AbstractFactory å’Œ AbstractProductç±»å£°æ˜çš„æ¥å£</li></ul></li></ul><h2 id="6-åä½œ"><a class="markdownIt-Anchor" href="#6-åä½œ"></a> 6. åä½œ</h2><p>é€šå¸¸åœ¨è¿è¡Œæ—¶åˆ›å»ºä¸€ä¸ªConcreteFactoryç±»çš„å®ä¾‹ã€‚è¿™ä¸€å…·ä½“çš„å·¥å‚åˆ›å»ºå…·æœ‰ç‰¹å®šå®ç°çš„äº§å“å¯¹è±¡ã€‚ä¸ºåˆ›å»ºä¸åŒçš„äº§å“å¯¹è±¡ï¼Œå®¢æˆ·åº”ä½¿ç”¨ä¸åŒçš„å…·ä½“å·¥å‚ã€‚</p><p>AbstractFactoryå°†äº§å“å¯¹è±¡çš„åˆ›å»ºå»¶è¿Ÿåˆ°å®ƒçš„ConcreteFactoryå­ç±»ã€‚</p><h2 id="7-æ•ˆæœ"><a class="markdownIt-Anchor" href="#7-æ•ˆæœ"></a> 7. æ•ˆæœ</h2><p>AbstractFactoryæ¨¡å¼æœ‰ä¸€ä¸‹ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼š</p><ul><li>ä¼˜ç‚¹ï¼šå®ƒåˆ†ç¦»äº†å…·ä½“çš„ç±»ã€‚</li><li>ä¼˜ç‚¹ï¼šå®ƒä½¿å¾—æ˜“äºäº¤æ¢äº§å“ç³»åˆ—ã€‚ä¸€ä¸ªå…·ä½“å·¥å‚ç±»åœ¨ä¸€ä¸ªåº”ç”¨ä¸­ä»…å‡ºç°ä¸€æ¬¡â€”â€”åœ¨å®ƒåˆå§‹åŒ–çš„æ—¶å€™ã€‚è¿™ä½¿å¾—æ”¹å˜ä¸€ä¸ªåº”ç”¨çš„å…·ä½“å·¥å‚å˜å¾—å¾ˆå®¹æ˜“ã€‚</li><li>ä¼˜ç‚¹ï¼šå®ƒæœ‰åˆ©äºäº§å“çš„ä¸€è‡´æ€§ã€‚å½“ä¸€ä¸ªç³»åˆ—ä¸­çš„äº§å“å¯¹è±¡è¢«è®¾è®¡æˆä¸€èµ·å·¥ä½œæ—¶ï¼Œä¸€ä¸ªåº”ç”¨ä¸€æ¬¡åªèƒ½ä½¿ç”¨åŒä¸€ä¸ªç³»åˆ—ä¸­çš„å¯¹è±¡ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚</li><li>ç¼ºç‚¹ï¼šéš¾ä»¥æ”¯æŒæ–°ç§ç±»çš„äº§å“ï¼Œä¹Ÿå°±æ˜¯éš¾ä»¥æ‰©å±•æŠ½è±¡å·¥å‚ä»¥ç”Ÿäº§æ–°ç§ç±»çš„äº§å“ã€‚è¿™æ˜¯å› ä¸ºAbstractFactoryæ¥å£ç¡®å®šäº†å¯ä»¥è¢«åˆ›å»ºçš„äº§å“é›†åˆã€‚æ”¯æŒæ–°ç§ç±»çš„äº§å“å°±éœ€è¦æ‰©å±•è¯¥å·¥å‚æ¥å£ï¼Œè¿™å°†æ¶‰åŠAbstractFactoryç±»åŠå…¶æ‰€æœ‰å­ç±»çš„æ”¹å˜ã€‚</li></ul><h2 id="8-ç¤ºä¾‹ä»£ç "><a class="markdownIt-Anchor" href="#8-ç¤ºä¾‹ä»£ç "></a> 8. ç¤ºä¾‹ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// AbstractFactory.h</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/2.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> CREATIONPATTERNDESIGN_ABSTRACTFACTORY_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> CREATIONPATTERNDESIGN_ABSTRACTFACTORY_H</span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-comment">/** </span><br><span class="hljs-comment"> * @brief å®šä¹‰ä¸€ä¸ªç”Ÿäº§ç»„ä»¶çš„æŠ½è±¡å·¥å‚ WidgetFactoryï¼Œæ´¾ç”Ÿå‡º Mac å’Œ Linux ä¸¤ç§é£æ ¼çš„å…·ä½“æŠ½è±¡å·¥å‚å®ç°ç±»ï¼›</span><br><span class="hljs-comment"> * æŠ½è±¡çš„äº§å“ç±»å¯¹åº”æœ‰ Window çª—å£ç»„ä»¶å’Œ ScrollBar æ»šåŠ¨æ¡ç»„ä»¶</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_abstract_factory</span><span class="hljs-params">()</span></span>;<br><br><span class="hljs-comment">// æŠ½è±¡äº§å“ç±»ï¼Œçª—å£</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Window</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;è¿™æ˜¯ä¸€ä¸ªæ™®é€šçª—å£&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// å…·ä½“äº§å“ç±»ï¼Œå¯¹åº”äº Mac é£æ ¼ç³»åˆ—</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MacWindow</span> :</span> <span class="hljs-keyword">public</span> Window&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;è¿™æ˜¯ä¸€ä¸ª mac é£æ ¼çš„çª—å£&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// å…·ä½“äº§å“ç±»ï¼Œå¯¹åº”äº Linux é£æ ¼ç³»åˆ—</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LinuxWindow</span> :</span> <span class="hljs-keyword">public</span> Window&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;è¿™æ˜¯ä¸€ä¸ª Linux é£æ ¼çš„çª—å£&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// æŠ½è±¡äº§å“ç±»ï¼Œæ»šåŠ¨æ¡</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ScrollBar</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">scroll</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;è¿™æ˜¯ä¸€ä¸ªæ™®é€šæ»šåŠ¨æ¡&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MacScrollBar</span> :</span> <span class="hljs-keyword">public</span> ScrollBar &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">scroll</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;è¿™æ˜¯ Mac é£æ ¼çš„æ»šåŠ¨æ¡&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LinuxScrollBar</span> :</span> <span class="hljs-keyword">public</span> ScrollBar &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">scroll</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;è¿™æ˜¯ Linux é£æ ¼çš„æ»šåŠ¨æ¡&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// æŠ½è±¡å·¥å‚ç±» AbstractFactory</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WidgetFactory</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> std::shared_ptr&lt;ScrollBar&gt; <span class="hljs-title">create_scrollbar</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> std::shared_ptr&lt;Window&gt; <span class="hljs-title">create_window</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;<br>&#125;;<br><br><span class="hljs-comment">// å…·ä½“å·¥å‚ç±»ï¼Œç”¨äºç”Ÿäº§ Mac é£æ ¼ç³»åˆ—çš„ç»„ä»¶</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MacWidgetFactory</span> :</span> <span class="hljs-keyword">public</span> WidgetFactory &#123;<br><span class="hljs-keyword">public</span> :<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> std::shared_ptr&lt;ScrollBar&gt; <span class="hljs-title">create_scrollbar</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> make_shared&lt;MacScrollBar&gt;();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> std::shared_ptr&lt;Window&gt; <span class="hljs-title">create_window</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> make_shared&lt;MacWindow&gt;();<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// å…·ä½“å·¥å‚ç±»ï¼Œç”¨äºç”Ÿäº§ Linux é£æ ¼ç³»åˆ—çš„ç»„ä»¶</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LinuxWidgetFactory</span> :</span> <span class="hljs-keyword">public</span> WidgetFactory &#123;<br><span class="hljs-keyword">public</span> :<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> std::shared_ptr&lt;ScrollBar&gt; <span class="hljs-title">create_scrollbar</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> make_shared&lt;LinuxScrollBar&gt;();<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> std::shared_ptr&lt;Window&gt; <span class="hljs-title">create_window</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> make_shared&lt;LinuxWindow&gt;();<br>    &#125;<br>&#125;;<br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//CREATIONPATTERNDESIGN_ABSTRACTFACTORY_H</span></span><br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// AbstractFactory.cpp</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/4/2.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;AbstractFactory.h&quot;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_abstract_factory</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯•æŠ½è±¡å·¥å‚æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br><br>    shared_ptr&lt;WidgetFactory&gt; wf = make_shared&lt;MacWidgetFactory&gt;();<br>    shared_ptr&lt;ScrollBar&gt; sb = wf-&gt;<span class="hljs-built_in">create_scrollbar</span>();<br>    shared_ptr&lt;Window&gt; window = wf-&gt;<span class="hljs-built_in">create_window</span>();<br>    sb-&gt;<span class="hljs-built_in">scroll</span>();<br>    window-&gt;<span class="hljs-built_in">show</span>();<br><br>    wf = make_shared&lt;LinuxWidgetFactory&gt;();<br>    sb = wf-&gt;<span class="hljs-built_in">create_scrollbar</span>();<br>    window = wf-&gt;<span class="hljs-built_in">create_window</span>();<br>    sb-&gt;<span class="hljs-built_in">scroll</span>();<br>    window-&gt;<span class="hljs-built_in">show</span>();<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç»“æŸæµ‹è¯•æŠ½è±¡å·¥å‚æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="9-ç›¸å…³æ¨¡å¼"><a class="markdownIt-Anchor" href="#9-ç›¸å…³æ¨¡å¼"></a> 9. ç›¸å…³æ¨¡å¼</h2><p>AbstractFactoryç±»é€šå¸¸ç”¨å·¥å‚æ–¹æ³•ï¼ˆFactory Methodï¼‰æ¥å®ç°ï¼Œä½†å®ƒä»¬ä¹Ÿå¯ä»¥ç”¨Prototypeå®ç°ã€‚</p><p>ä¸€ä¸ªå…·ä½“çš„å·¥å‚é€šå¸¸æ˜¯ä¸€ä¸ªå•ä¾‹ï¼ˆSingletonï¼‰ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¼–ç¨‹æŠ€å·§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€è®¾è®¡æ¨¡å¼ã€‘äº«å…ƒæ¨¡å¼ä¸ç­–ç•¥æ¨¡å¼</title>
    <link href="/2022/03/26/2022-03/2022-03-26%20%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E4%BA%AB%E5%85%83%E5%92%8C%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
    <url>/2022/03/26/2022-03/2022-03-26%20%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E4%BA%AB%E5%85%83%E5%92%8C%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="flyweightäº«å…ƒæ¨¡å¼"><a class="markdownIt-Anchor" href="#flyweightäº«å…ƒæ¨¡å¼"></a> Flyweightï¼ˆäº«å…ƒï¼‰æ¨¡å¼</h1><h2 id="1-æ„å›¾"><a class="markdownIt-Anchor" href="#1-æ„å›¾"></a> 1. æ„å›¾</h2><p>è¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡</p><h2 id="2-åŠ¨æœº"><a class="markdownIt-Anchor" href="#2-åŠ¨æœº"></a> 2. åŠ¨æœº</h2><p>Flyweightæ¨¡å¼æè¿°äº†å¦‚ä½•å…±äº«å¯¹è±¡ï¼Œä½¿å¾—å¯ä»¥ç»†ç²’åº¦åœ°ä½¿ç”¨å®ƒä»¬è€Œä¸éœ€è¦é«˜æ˜‚çš„ä»£ä»·ã€‚</p><p>Flyweightæ˜¯ä¸€ä¸ªå…±äº«å¯¹è±¡ï¼Œä»–å¯ä»¥åŒæ—¶åœ¨å¤šä¸ªåœºæ™¯ï¼ˆcontextï¼‰ä¸­ä½¿ç”¨ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªåœºæ™¯ä¸­flyweightéƒ½å¯ä»¥ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡â€”â€”è¿™ä¸€ç‚¹ä¸éå…±äº«å¯¹è±¡çš„å®ä¾‹æ²¡æœ‰åŒºåˆ«ã€‚flyweightä¸èƒ½å¯¹å®ƒæ‰€è¿è¡Œçš„åœºæ™¯åšå‡ºä»»ä½•å‡è®¾ï¼Œè¿™é‡Œå…³é”®çš„æ¦‚å¿µæ˜¯<strong>å†…éƒ¨çŠ¶æ€</strong>ä¸<strong>å¤–éƒ¨çŠ¶æ€</strong>ä¹‹é—´çš„åŒºåˆ«ã€‚å†…éƒ¨çŠ¶æ€å­˜å‚¨äºflyweightä¸­ï¼Œå®ƒåŒ…å«äº†ç‹¬ç«‹äºflyweightåœºæ™¯çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ä½¿å¾—flyweightå¯ä»¥è¢«å…±äº«ã€‚è€Œå¤–éƒ¨çŠ¶æ€å–å†³äºflyweightåœºæ™¯ï¼Œå¹¶æ ¹æ®åœºæ™¯è€Œå˜åŒ–ï¼Œå› æ­¤ä¸å¯å…±äº«ã€‚ç”¨æˆ·å¯¹è±¡è´Ÿè´£åœ¨å¿…è¦çš„æ—¶å€™å°†å¤–éƒ¨çŠ¶æ€ä¼ é€’ç»™flyweightã€‚</p><p>Flyweightæ¨¡å¼å¯¹é‚£äº›é€šå¸¸ç”±äºæ•°é‡å¤ªå¤§è€Œéš¾ä»¥ç”¨å¯¹è±¡æ¥è¡¨ç¤ºçš„æ¦‚å¿µæˆ–å®ä½“è¿›è¡Œå»ºæ¨¡ã€‚</p><h2 id="3-é€‚ç”¨æ€§"><a class="markdownIt-Anchor" href="#3-é€‚ç”¨æ€§"></a> 3. é€‚ç”¨æ€§</h2><p>Flyweightæ¨¡å¼çš„æœ‰æ•ˆæ€§å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå¦‚ä½•ä½¿ç”¨å®ƒä»¥åŠåœ¨ä½•å¤„ä½¿ç”¨å®ƒã€‚å½“ä¸€ä¸‹æƒ…å†µæˆç«‹æ—¶ï¼Œä½¿ç”¨Flyweightæ¨¡å¼ï¼š</p><ul><li>ä¸€ä¸ªåº”ç”¨ä½¿ç”¨äº†å¤§é‡çš„å¯¹è±¡ã€‚</li><li>å®Œå…¨ç”±äºä½¿ç”¨å¤§é‡çš„å¯¹è±¡é€ æˆå¾ˆå¤§çš„å­˜å‚¨å¼€é”€ã€‚</li><li>å¯¹è±¡çš„å¤§å¤šæ•°çŠ¶æ€éƒ½å¯å˜ä¸ºå¤–éƒ¨çŠ¶æ€ã€‚</li><li>å¦‚æœåˆ é™¤å¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ç›¸å¯¹è¾ƒå°‘çš„å…±äº«å¯¹è±¡å–ä»£å¾ˆå¯¹ç»„å¯¹è±¡</li><li>åº”ç”¨ç¨‹åºä¸ä¾èµ–äºå¯¹è±¡æ ‡è¯†ã€‚ç”±äºFlyweightå¯¹è±¡å¯ä»¥è¢«å…±äº«ï¼Œå› æ­¤æ¦‚å¿µä¸Šæ˜æ˜¾æœ‰åˆ«çš„å¯¹è±¡ï¼Œæ ‡è¯†æµ‹è¯•å°†è¿”å›çœŸå€¼ã€‚</li></ul><h2 id="4-ç»“æ„"><a class="markdownIt-Anchor" href="#4-ç»“æ„"></a> 4. ç»“æ„</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203281441718.jpeg" alt="ç»“æ„ç¤ºæ„å›¾" /></p><p>ä¸‹é¢å¯¹è±¡å›¾è¯´æ˜äº†å¦‚ä½•å…±äº«flyweight</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203281441858.jpeg" alt="å¯¹è±¡å›¾" /></p><h2 id="5-å‚ä¸è€…"><a class="markdownIt-Anchor" href="#5-å‚ä¸è€…"></a> 5. å‚ä¸è€…</h2><ul><li>Flyweightï¼ˆGlyphï¼‰<ul><li>æè¿°ä¸€ä¸ªæ¥å£ï¼Œé€šè¿‡è¿™ä¸ªæ¥å£flyweghtå¯ä»¥æ¥å—å¹¶ä½œç”¨äºå¤–éƒ¨çŠ¶æ€</li></ul></li><li>ConcreteFlyweightï¼ˆcharacterï¼‰<ul><li>å®ç°Flyweightæ¥å£ï¼Œå¹¶ä¸ºå†…éƒ¨çŠ¶æ€ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰å¢åŠ å­˜å‚¨ç©ºé—´ã€‚ConcreteFlyweightå¯¹è±¡å¿…é¡»æ˜¯å¯å…±äº«çš„ã€‚å®ƒæ‰€å­˜å‚¨çš„çŠ¶æ€å¿…é¡»æ˜¯å†…éƒ¨çš„ã€‚å³å®ƒå¿…é¡»ç‹¬ç«‹äºConcreteFlyweight å¯¹è±¡çš„åœºæ™¯ã€‚</li></ul></li><li>UnsharedConcreteFlyweightï¼ˆRowã€Columnï¼‰<ul><li>å¹¶éæ‰€æœ‰çš„Flyweightå­ç±»éƒ½éœ€è¦è¢«å…±äº«ã€‚Flyweightæ¥å£ä½¿å…±äº«æˆä¸ºå¯èƒ½ï¼Œä½†å®ƒå¹¶ä¸å¼ºåˆ¶å…±äº«ã€‚åœ¨flyweightå¯¹è±¡ç»“æ„çš„æŸäº›å±‚æ¬¡ï¼ŒUnsharedConcreteFlyweightå¯¹è±¡é€šå¸¸å°†ConcreteFlyweightå¯¹è±¡ä½œä¸ºå­èŠ‚ç‚¹ã€‚</li></ul></li><li>FlyweightFactory<ul><li>åˆ›å»ºå¹¶ç®¡ç†Flyweightå¯¹è±¡</li><li>ç¡®ä¿åˆç†åœ°å…±äº«Flyweightã€‚å½“ç”¨æˆ·è¯·æ±‚ä¸€ä¸ªflyweightæ—¶ï¼ŒFlyweightFactoryå¯¹è±¡æä¾›ä¸€ä¸ªå·²åˆ›å»ºçš„å®ä¾‹æˆ–åˆ›å»ºä¸€ä¸ªï¼ˆå¦‚æœä¸å­˜åœ¨çš„è¯ï¼‰</li></ul></li><li>Client<ul><li>ç»´æŒä¸€ä¸ªå¯¹Flyweightçš„å¼•ç”¨</li><li>è®¡ç®—æˆ–å­˜å‚¨ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰flyweightçš„å¤–éƒ¨çŠ¶æ€</li></ul></li></ul><h2 id="6-åä½œ"><a class="markdownIt-Anchor" href="#6-åä½œ"></a> 6. åä½œ</h2><ul><li>flyweightæ‰§è¡Œæ—¶æ‰€éœ€çš„çŠ¶æ€å¿…å®šæ˜¯å†…éƒ¨çš„æˆ–å¤–éƒ¨çš„ã€‚å†…éƒ¨çŠ¶æ€å­˜å‚¨äºConcreteFlyweightå¯¹è±¡ä¸­ï¼Œè€Œå¤–éƒ¨çŠ¶æ€åˆ™æ˜¯ç”±Clientå¯¹è±¡å­˜å‚¨æˆ–è®¡ç®—ã€‚å½“ç”¨æˆ·è°ƒç”¨flyweightå¯¹è±¡çš„æ“ä½œæ—¶ï¼Œå°†è¯¥çŠ¶æ€ä¼ é€’ç»™å®ƒã€‚</li><li>ç”¨æˆ·ä¸åº”è¯¥ç›´æ¥å¯¹ConcreteFlyweightç±»è¿›è¡Œå®ä¾‹åŒ–ï¼Œè€Œåªèƒ½ä»FlyweightFactoryå¯¹è±¡å¾—åˆ°ConcreteFlyweightå¯¹è±¡ã€‚è¿™å¯ä»¥ä¿è¯å¯¹å®ƒä»¬é€‚å½“åœ°è¿›è¡Œå…±äº«ã€‚</li></ul><h2 id="7-å®ç°"><a class="markdownIt-Anchor" href="#7-å®ç°"></a> 7. å®ç°</h2><p>åœ¨å®ç°Flyweightæ¨¡å¼æ—¶ï¼Œåº”æ³¨æ„ä¸€ä¸‹å‡ ç‚¹ï¼š</p><p>â‘  åˆ é™¤å¤–éƒ¨çŠ¶æ€ã€‚è¯¥æ¨¡å¼çš„å¯ç”¨æ€§åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºæ˜¯å¦å®¹æ˜“è¯†åˆ«å¤–éƒ¨çŠ¶æ€å¹¶å°†å®ƒä»å…±äº«å¯¹è±¡ä¸­åˆ é™¤ã€‚</p><p>â‘¡ ç®¡ç†å…±äº«å¯¹è±¡ã€‚ å› ä¸ºå¯¹è±¡æ˜¯å…±äº«çš„ï¼Œç”¨æˆ·ä¸èƒ½ç›´æ¥å¯¹å®ƒè¿›è¡Œå®ä¾‹åŒ–ï¼Œæ‰€ä»¥FlyweightFactoryæ¥å¸®åŠ©ç”¨æˆ·æŸ¥æ‰¾æŸä¸ªç‰¹å®šçš„flyweightå¯¹è±¡ã€‚å…±äº«è¿˜æ„å‘³ç€æŸç§å½¢å¼çš„å¼•ç”¨è®¡æ•°å’Œåƒåœ¾å›æ”¶ï¼Œè¿™æ ·å½“ä¸€ä¸ªflyweightä¸å†ä½¿ç”¨æ—¶ï¼Œå¯ä»¥å›æ”¶å®ƒçš„å­˜å‚¨ç©ºé—´ã€‚</p><h2 id="8-ç¤ºä¾‹ä»£ç "><a class="markdownIt-Anchor" href="#8-ç¤ºä¾‹ä»£ç "></a> 8. ç¤ºä¾‹ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Flyweight.h</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/3/26.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unordered_map&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> BEHAVIORALPATTERNDESIGN_FLYWEIGHT_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> BEHAVIORALPATTERNDESIGN_FLYWEIGHT_H</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_Flyweight</span><span class="hljs-params">()</span></span>;<br><br><span class="hljs-comment">// æ£‹å­çŠ¶æ€ï¼Œåæ ‡</span><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ChessPoint</span> &#123;</span><br>    <span class="hljs-keyword">int</span> x;<br>    <span class="hljs-keyword">int</span> y;<br>    <span class="hljs-built_in">ChessPoint</span>() = <span class="hljs-keyword">default</span>;<br>    <span class="hljs-built_in">ChessPoint</span>(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y) : <span class="hljs-built_in">x</span>(x),<span class="hljs-built_in">y</span>(y) &#123;&#125;<br>    <span class="hljs-function">string <span class="hljs-title">to_string</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;(&quot;</span> + ::<span class="hljs-built_in">to_string</span>(x)+<span class="hljs-string">&quot;,&quot;</span> + ::<span class="hljs-built_in">to_string</span>(y)+<span class="hljs-string">&quot;)&quot;</span>;<br>    &#125;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ChessPointHash</span> &#123;</span><br>    <span class="hljs-function"><span class="hljs-keyword">size_t</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(<span class="hljs-keyword">const</span> ChessPoint&amp; point)</span> <span class="hljs-keyword">const</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> hash&lt;<span class="hljs-keyword">int</span>&gt;()(point.x + <span class="hljs-number">10</span> * point.y);<br>    &#125;<br>&#125;;<br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ChessPointEqual</span> &#123;</span><br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">operator</span><span class="hljs-params">()</span><span class="hljs-params">(<span class="hljs-keyword">const</span> ChessPoint&amp; p1,<span class="hljs-keyword">const</span> ChessPoint&amp; p2 )</span> <span class="hljs-keyword">const</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (p1.x == p2.x &amp;&amp; p1.y == p2.y);<br>    &#125;<br>&#125;;<br><br><br><span class="hljs-comment">// è±¡æ£‹æ£‹å­</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Chess</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">Type</span> &#123;</span><br>        Red,<br>        Black,<br>        Board<br>    &#125;;<br>    <span class="hljs-built_in">Chess</span>(string name, Type type) :<span class="hljs-built_in">name</span>(name),<span class="hljs-built_in">type</span>(type) &#123;<br><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">move</span><span class="hljs-params">(ChessPoint start, ChessPoint end)</span> </span>&#123;<br>        <span class="hljs-comment">// æ£‹ç›˜è¶Šç•Œ</span><br>        <span class="hljs-keyword">if</span> (start.x &lt; <span class="hljs-number">0</span> || start.y &lt; <span class="hljs-number">0</span> || start.x &gt;= <span class="hljs-number">9</span> || start.y &gt;= <span class="hljs-number">10</span> ||<br>            end.x &lt;<span class="hljs-number">0</span> || end.y &lt; <span class="hljs-number">0</span> || end.x &gt;= <span class="hljs-number">9</span> || end.y &gt;= <span class="hljs-number">10</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-function">string <span class="hljs-title">get_name</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br>    <span class="hljs-function">Type <span class="hljs-title">get_type</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> type;<br>    &#125;<br><br><span class="hljs-keyword">protected</span>:<br>    string name;<br>    Type type;<br>&#125;;<br><br><span class="hljs-comment">// å…µ</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Soldier</span> :</span> <span class="hljs-keyword">public</span> Chess &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Soldier</span>(string name, Type type) : <span class="hljs-built_in">Chess</span>(name, type)  &#123;<br><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">move</span><span class="hljs-params">(ChessPoint start, ChessPoint end)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (!Chess::<span class="hljs-built_in">move</span>(start,end)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> ( (start.x == end.x &amp;&amp; start.y +<span class="hljs-number">1</span> == end.y) ||       <span class="hljs-comment">// å‘ä¸Šèµ°</span><br>             (start.y == end.y &amp;&amp; (start.x+<span class="hljs-number">1</span> == end.x || start.x<span class="hljs-number">-1</span> == end.y)))&#123;      <span class="hljs-comment">// å·¦å³èµ°</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// è½¦</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> :</span> <span class="hljs-keyword">public</span> Chess &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">move</span><span class="hljs-params">(ChessPoint start, ChessPoint end)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (!Chess::<span class="hljs-built_in">move</span>(start,end)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-comment">// è½¦ æ²¡æœ‰å¤šä½™çš„é™åˆ¶</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ChessFactory</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// å¦‚æœä¸æå‰åˆ›å»ºçš„è¯ï¼Œå¦‚ä½•æ ¹æ®ä¼ å…¥çš„nameï¼ŒåŠ¨æ€åˆ›å»ºå¯¹åº”çš„ç±»ï¼ˆä¸ç”¨if else è¿›è¡Œåˆ¤æ–­ï¼‰ï¼Ÿ</span><br>    <span class="hljs-built_in">ChessFactory</span>() &#123;<br>        red_chess[<span class="hljs-string">&quot;å…µ&quot;</span>] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Soldier</span>(<span class="hljs-string">&quot;å…µ&quot;</span>,Chess::Red);<br>        red_chess[<span class="hljs-string">&quot;è½¦&quot;</span>] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Soldier</span>(<span class="hljs-string">&quot;è½¦&quot;</span>,Chess::Red);<br>        black_chess[<span class="hljs-string">&quot;å…µ&quot;</span>] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Soldier</span>(<span class="hljs-string">&quot;å…µ&quot;</span>,Chess::Red);<br>        red_chess[<span class="hljs-string">&quot;è½¦&quot;</span>] = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Soldier</span>(<span class="hljs-string">&quot;è½¦&quot;</span>,Chess::Red);<br>    &#125;<br><br>    <span class="hljs-function">Chess* <span class="hljs-title">create_chess</span><span class="hljs-params">(string name, Chess::Type type)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (type == Chess::Type::Red) &#123;<br>            <span class="hljs-keyword">return</span> red_chess[name];<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> black_chess[name];<br>        &#125;<br>    &#125;<br>    ~<span class="hljs-built_in">ChessFactory</span>() &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> iter : red_chess) &#123;<br>            <span class="hljs-keyword">delete</span> iter.second;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> iter : black_chess) &#123;<br>            <span class="hljs-keyword">delete</span> iter.second;<br>        &#125;<br>    &#125;<br><br><span class="hljs-keyword">private</span>:<br>    unordered_map&lt;string, Chess*&gt; red_chess;<br>    unordered_map&lt;string, Chess*&gt; black_chess;<br>&#125;;<br><br><br><span class="hljs-comment">// è±¡æ£‹æ£‹ç›˜ï¼Œç±»æ¯” UnsharedConcreteFlyweight</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ChessBoard</span> :</span> <span class="hljs-keyword">public</span> Chess &#123;<br><span class="hljs-keyword">public</span> :<br>    <span class="hljs-built_in">ChessBoard</span>(string name, Type type, ChessFactory&amp; factory) : <span class="hljs-built_in">Chess</span>(name, type) &#123;<br>        <span class="hljs-comment">// ç®€å•åœ°åšä¸‹åˆå§‹åŒ–</span><br>        <span class="hljs-function">ChessPoint <span class="hljs-title">p1</span><span class="hljs-params">(<span class="hljs-number">1</span>,<span class="hljs-number">4</span>)</span></span>;<br>        <span class="hljs-function">ChessPoint <span class="hljs-title">p2</span><span class="hljs-params">(<span class="hljs-number">1</span>,<span class="hljs-number">8</span>)</span></span>;<br>        board[p1] = factory.<span class="hljs-built_in">create_chess</span>(<span class="hljs-string">&quot;å…µ&quot;</span>,Red);<br>        board[p2] = factory.<span class="hljs-built_in">create_chess</span>(<span class="hljs-string">&quot;è½¦&quot;</span>,Red);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">move</span><span class="hljs-params">(ChessPoint start, ChessPoint end)</span> </span>&#123;<br>        <span class="hljs-keyword">auto</span> start_iter = board.<span class="hljs-built_in">find</span>(start);<br>        <span class="hljs-keyword">if</span> (start_iter == board.<span class="hljs-built_in">end</span>()) &#123;        <span class="hljs-comment">// èµ·ç‚¹æ²¡æœ‰æ£‹å­</span><br>            cout &lt;&lt; <span class="hljs-string">&quot;èµ·ç‚¹æ²¡æœ‰æ£‹å­ï¼&quot;</span> &lt;&lt;endl;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">auto</span> end_iter = board.<span class="hljs-built_in">find</span>(end);<br>        <span class="hljs-keyword">if</span> (end_iter != board.<span class="hljs-built_in">end</span>() &amp;&amp;          <span class="hljs-comment">// èµ·ç‚¹å’Œç»ˆç‚¹çš„æ£‹å­é¢œè‰²ç›¸åŒ</span><br>            end_iter-&gt;second-&gt;<span class="hljs-built_in">get_type</span>() == start_iter-&gt;second-&gt;<span class="hljs-built_in">get_type</span>()) &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;èµ·ç‚¹å’Œç»ˆç‚¹çš„æ£‹å­é¢œè‰²ç›¸åŒ&quot;</span> &lt;&lt; endl;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">bool</span> flag = start_iter-&gt;second-&gt;<span class="hljs-built_in">move</span>(start,end);<br>        <span class="hljs-keyword">if</span> (flag) &#123;<br>            board[end] = start_iter-&gt;second;<br>            board.<span class="hljs-built_in">erase</span>(start_iter);<br>            cout &lt;&lt; <span class="hljs-string">&quot;æ£‹å­ï¼š&quot;</span> &lt;&lt; start_iter-&gt;second-&gt;<span class="hljs-built_in">get_name</span>() &lt;&lt;<br>                 <span class="hljs-string">&quot; ä»&quot;</span> &lt;&lt; start.<span class="hljs-built_in">to_string</span>() &lt;&lt; <span class="hljs-string">&quot;åˆ°&quot;</span> &lt;&lt; end.<span class="hljs-built_in">to_string</span>() &lt;&lt;<span class="hljs-string">&quot; ç§»åŠ¨æˆåŠŸ&quot;</span> &lt;&lt; endl;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;æ£‹å­ï¼š&quot;</span> &lt;&lt; start_iter-&gt;second-&gt;<span class="hljs-built_in">get_name</span>() &lt;&lt;<br>             <span class="hljs-string">&quot; ä»&quot;</span> &lt;&lt; start.<span class="hljs-built_in">to_string</span>() &lt;&lt; <span class="hljs-string">&quot;åˆ°&quot;</span> &lt;&lt; end.<span class="hljs-built_in">to_string</span>() &lt;&lt;<span class="hljs-string">&quot; ç§»åŠ¨å¤±è´¥&quot;</span> &lt;&lt; endl;<br>        &#125;<br>        <span class="hljs-keyword">return</span> flag;<br>    &#125;<br><br><span class="hljs-keyword">private</span>:<br>    unordered_map&lt;ChessPoint, Chess*, ChessPointHash, ChessPointEqual&gt; board;<br><br>&#125;;<br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//BEHAVIORALPATTERNDESIGN_FLYWEIGHT_H</span></span><br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Flyweight.cpp</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/3/26.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;Flyweight.h&quot;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_Flyweight</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯• Flyweight æ¨¡å¼â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>    ChessFactory factory;<br>    <span class="hljs-function">ChessBoard <span class="hljs-title">board</span><span class="hljs-params">(<span class="hljs-string">&quot;æ£‹ç›˜&quot;</span>,Chess::Board, factory)</span></span>;<br>    <span class="hljs-function">ChessPoint <span class="hljs-title">start1</span><span class="hljs-params">(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)</span>, <span class="hljs-title">start2</span><span class="hljs-params">(<span class="hljs-number">1</span>,<span class="hljs-number">4</span>)</span>,<span class="hljs-title">end1</span><span class="hljs-params">(<span class="hljs-number">1</span>,<span class="hljs-number">8</span>)</span>,<span class="hljs-title">end2</span><span class="hljs-params">(<span class="hljs-number">1</span>,<span class="hljs-number">5</span>)</span>, <span class="hljs-title">end3</span><span class="hljs-params">(<span class="hljs-number">1</span>,<span class="hljs-number">7</span>)</span></span>;<br>    board.<span class="hljs-built_in">move</span>(start1,end1);<br>    board.<span class="hljs-built_in">move</span>(start2,end1);<br>    board.<span class="hljs-built_in">move</span>(start2,end2);<br>    board.<span class="hljs-built_in">move</span>(end2,end3);<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”ç»“æŸæµ‹è¯• Flyweight æ¨¡å¼â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; endl ;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="9-ç›¸å…³æ¨¡å¼"><a class="markdownIt-Anchor" href="#9-ç›¸å…³æ¨¡å¼"></a> 9. ç›¸å…³æ¨¡å¼</h2><p>Flyweightæ¨¡å¼é€šå¸¸å’ŒCompositeï¼ˆç»„åˆï¼‰æ¨¡å¼ç»“åˆèµ·æ¥ï¼Œç”¨å…±äº«å¶èŠ‚ç‚¹çš„æœ‰å‘æ— ç¯å›¾å®ç°ä¸€ä¸ªé€»è¾‘ä¸Šçš„å±‚æ¬¡ç»“æ„ã€‚</p><p>é€šå¸¸ï¼Œæœ€å¥½ç”¨flyweightå®ç°Stateå’ŒStrategyå¯¹è±¡ã€‚</p><h1 id="strategyç­–ç•¥æ¨¡å¼"><a class="markdownIt-Anchor" href="#strategyç­–ç•¥æ¨¡å¼"></a> Strategyï¼ˆç­–ç•¥ï¼‰æ¨¡å¼</h1><h2 id="1-æ„å›¾-2"><a class="markdownIt-Anchor" href="#1-æ„å›¾-2"></a> 1. æ„å›¾</h2><p>å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•ï¼ŒæŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚æœ¬æ¨¡å¼ä½¿å¾—ç®—æ³•å¯ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·è€Œå˜åŒ–</p><h2 id="2-åˆ«å"><a class="markdownIt-Anchor" href="#2-åˆ«å"></a> 2. åˆ«å</h2><p>æ”¿ç­–ï¼ˆpolicyï¼‰</p><h2 id="3-é€‚ç”¨æ€§-2"><a class="markdownIt-Anchor" href="#3-é€‚ç”¨æ€§-2"></a> 3. é€‚ç”¨æ€§</h2><p>åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ä½¿ç”¨Strategyæ¨¡å¼ï¼š</p><ul><li>è®¸å¤šç›¸å…³çš„ç±»ä»…ä»…æ˜¯è¡Œä¸ºæœ‰å¼‚ã€‚â€œç­–ç•¥â€æä¾›äº†ä¸€ç§ç”¨å¤šä¸ªè¡Œä¸ºä¸­çš„ä¸€ä¸ªè¡Œä¸ºæ¥é…ç½®ä¸€ä¸ªç±»çš„æ–¹æ³•ã€‚</li><li>éœ€è¦ä½¿ç”¨ä¸€ä¸ªç®—æ³•çš„ä¸åŒå˜ä½“ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¼šå®šä¹‰ä¸€äº›åæ˜ ä¸åŒçš„ç©ºé—´/æ—¶é—´æƒè¡¡çš„ç®—æ³•ã€‚å½“è¿™äº›å˜ä½“å®ç°ä¸ºä¸€ä¸ªç®—æ³•çš„ç±»å±‚æ¬¡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼ã€‚</li><li>ç®—æ³•ä½¿ç”¨å®¢æˆ·ä¸åº”è¯¥çŸ¥é“çš„æ•°æ®ã€‚å¯ä½¿ç”¨ç­–ç•¥æ¨¡å¼ä»¥é¿å…æš´éœ²å¤æ‚çš„ã€ä¸ç®—æ³•ç›¸å…³çš„æ•°æ®ç»“æ„</li><li>ä¸€ä¸ªç±»å®šä¹‰äº†å¤šç§è¡Œä¸ºï¼Œå¹¶ä¸”è¿™äº›è¡Œä¸ºåœ¨è¿™ä¸ªç±»çš„æ“ä½œä¸­ä»¥å¤šä¸ªæ¡ä»¶è¯­å¥çš„å½¢å¼å‡ºç°ã€‚å°†ç›¸å…³çš„æ¡ä»¶åˆ†æ”¯ç§»å…¥å®ƒä»¬å„è‡ªçš„Strategyç±»ä¸­ä»¥ä»£æ›¿è¿™äº›æ¡ä»¶è¯­å¥ã€‚</li></ul><h2 id="4-ç»“æ„-2"><a class="markdownIt-Anchor" href="#4-ç»“æ„-2"></a> 4. ç»“æ„</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203281444593.jpeg" alt="ç»“æ„ç¤ºæ„å›¾" /></p><h2 id="5-å‚ä¸è€…-2"><a class="markdownIt-Anchor" href="#5-å‚ä¸è€…-2"></a> 5. å‚ä¸è€…</h2><ul><li>Strategyï¼ˆç­–ç•¥ï¼Œå¦‚Compositorï¼‰<ul><li>å®šä¹‰æ‰€æ”¯æŒçš„ç®—æ³•çš„å…¬å…±æ¥å£ã€‚Contextä½¿ç”¨è¿™ä¸ªæ¥å£æ¥è°ƒç”¨æŸConcreteStrategyå®šä¹‰çš„ç®—æ³•</li></ul></li><li>ConcreteStrategyï¼ˆå…·ä½“ç­–ç•¥ï¼Œå¦‚SimpleCompositorã€TeXCompositorã€ArrayCompositorï¼‰<ul><li>ä»¥Strategyæ¥å£å®ç°å…·ä½“ç®—æ³•</li></ul></li><li>Contextï¼ˆä¸Šä¸‹æ–‡ï¼Œå¦‚Compositionï¼‰<ul><li>ç”¨ä¸€ä¸ªConcreteStrategyå¯¹è±¡æ¥é…ç½®</li><li>ç»´æŠ¤ä¸€ä¸ªStrategyå¯¹è±¡çš„å¼•ç”¨</li><li>å¯å®šä¹‰ä¸€ä¸ªæ¥å£æ¥è®©Strategyè®¿é—®å®ƒçš„æ•°æ®</li></ul></li></ul><h2 id="6-åä½œ-2"><a class="markdownIt-Anchor" href="#6-åä½œ-2"></a> 6. åä½œ</h2><ul><li>Strategyå’ŒContextç›¸äº’ä½œç”¨ä»¥å®ç°é€‰å®šçš„ç®—æ³•ã€‚å½“ç®—æ³•è¢«è°ƒç”¨æ—¶ï¼ŒContextå¯ä»¥å°†è¯¥ç®—æ³•æ‰€éœ€è¦çš„æ‰€æœ‰æ•°æ®éƒ½ä¼ é€’ç»™è¯¥Strategyã€‚æˆ–è€…ï¼ŒContextå¯ä»¥å°†è‡ªèº«ä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ é€’ç»™Strategyæ“ä½œã€‚è¿™å°±è®©Strategyåœ¨éœ€è¦æ—¶å¯ä»¥å›è°ƒContext</li><li>Contextå°†å®¢æˆ·çš„è¯·æ±‚è½¬å‘ç»™å®ƒçš„Strategyã€‚å®¢æˆ·é€šå¸¸åˆ›å»ºå¹¶ä¼ é€’ä¸€ä¸ªConcreteStrategyå¯¹è±¡ç»™è¯¥Contextï¼Œè¿™æ ·å®¢æˆ·ä»…ä¸Contextäº¤äº’ã€‚é€šå¸¸æœ‰ä¸€ç³»åˆ—Strategyç±»å¯ä¾›å®¢æˆ·ä»ä¸­é€‰æ‹©ã€‚</li></ul><h2 id="7-å®ç°-2"><a class="markdownIt-Anchor" href="#7-å®ç°-2"></a> 7. å®ç°</h2><p>è€ƒè™‘ä¸‹é¢çš„å®ç°é—®é¢˜ï¼š</p><ol><li>å®šä¹‰Strategyå’ŒContextæ¥å£ã€‚</li></ol><ul><li>Strategyå’ŒContextæ¥å£å¿…é¡»ä½¿å¾—ConcreteStrategyèƒ½å¤Ÿæœ‰æ•ˆåœ°è®¿é—®å®ƒæ‰€éœ€è¦çš„contextä¸­çš„ä»»ä½•æ•°æ®ï¼Œåä¹‹äº¦ç„¶ã€‚ä¸€ç§æ–¹æ³•æ˜¯è®©Contextå°†æ•°æ®æ”¾åœ¨å‚æ•°ä¸­ä¼ é€’ç»™Strategyï¼Œè¿™ä½¿å¾—Strategyå’ŒContextè§£è€¦ï¼Œä½†Contextä¹Ÿå¯èƒ½å‘é€ä¸€äº›Strategyä¸éœ€è¦çš„æ•°æ®ã€‚</li><li>å¦ä¸€ç§æ–¹æ³•æ˜¯è®©Contextå°†è‡ªèº«ä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ é€’ç»™Strategyï¼Œè¯¥Strategyå†æ˜¾å¼åœ°æƒ³Contextè¯·æ±‚æ•°æ®ã€‚æˆ–è€…Strategyå¯ä»¥å­˜å‚¨å¯¹å®ƒçš„Contextçš„å¼•ç”¨ã€‚</li></ul><ol start="2"><li>å°†Strategyä½œä¸ºæ¨¡æ¿å‚æ•°</li></ol><ul><li>åœ¨C++ä¸­ï¼Œå¯åˆ©ç”¨æ¨¡æ¿æœºåˆ¶ç”¨ä¸€ä¸ªStrategyæ¥é…ç½®ä¸€ä¸ªç±»ã€‚ç„¶è€Œè¿™ç§æ–¹æ³•ä»…å½“æ»¡è¶³ä¸‹é¢æ¡ä»¶æ—¶æ‰èƒ½ä½¿ç”¨ï¼šâ‘  å¯ä»¥åœ¨ç¼–è¯‘æ—¶é€‰æ‹©Strategyï¼›â‘¡ ä¸éœ€è¦åœ¨è¿è¡Œæ—¶æ”¹å˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¦è¢«é…ç½®çš„ç±»ï¼ˆå¦‚Contextï¼‰è¢«å®šä¹‰ä¸ºä¸€ä¸ªä»¥Strategyç±»ä½œä¸ºå‚æ•°çš„æ¨¡æ¿ç±»ã€‚</li></ul><ol start="3"><li>ä½¿Strategyå¯¹è±¡æˆä¸ºå¯é€‰çš„</li></ol><ul><li>å³ä½¿åœ¨ä¸ä½¿ç”¨é¢å¤–çš„Strategyå¯¹è±¡çš„æƒ…å†µä¸‹ï¼ŒContextä¹Ÿæœ‰æ„ä¹‰çš„è¯ï¼Œé‚£ä¹ˆå®ƒè¿˜å¯ä»¥è¢«ç®€åŒ–ã€‚Contextåœ¨è®¿é—®æŸStrategyå‰å…ˆæ£€æŸ¥å®ƒæ˜¯å¦å­˜åœ¨ã€‚å¦‚æœæœ‰ï¼Œå°±ä½¿ç”¨å®ƒï¼›å¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆContextæ‰§è¡Œç¼ºçœçš„è¡Œä¸ºã€‚è¿™ç§æ–¹æ³•çš„å¥½å¤„æ˜¯å®¢æˆ·æ ¹æœ¬ä¸éœ€è¦å¤„ç†Strategyå¯¹è±¡ï¼Œé™¤éä¸å–œæ¬¢ç¼ºçœçš„è¡Œä¸ºã€‚</li></ul><h2 id="8-ç¤ºä¾‹ä»£ç -2"><a class="markdownIt-Anchor" href="#8-ç¤ºä¾‹ä»£ç -2"></a> 8. ç¤ºä¾‹ä»£ç </h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Strategy.h</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/3/26.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> BEHAVIORALPATTERNDESIGN_STRATEGY_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> BEHAVIORALPATTERNDESIGN_STRATEGY_H</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @brief ç­–ç•¥æ¨¡å¼ï¼Œæ¨¡æ‹Ÿä¸¤ä¸ªå®ç°</span><br><span class="hljs-comment"> * 1. å®šä¹‰Strategyå’ŒContextæ¥å£ï¼Œæ¨¡æ‹Ÿåœºæ™¯ä¸º è¾“å…¥æ¡†å­—ç¬¦ä¸²çš„éªŒè¯ç­–ç•¥</span><br><span class="hljs-comment"> * 2. å°†Strategyä½œä¸ºæ¨¡æ¿å‚æ•°ï¼Œå¯ä»¥å‚è€ƒSTLä¸­åˆ†é…å™¨ï¼Œå…¶ä¸­å°±è¿ç”¨äº†ç­–ç•¥æ¨¡å¼</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_strategy</span><span class="hljs-params">()</span></span>;<br><br><span class="hljs-comment">// æ ¡éªŒå™¨ï¼Œå¯¹åº”äº Strategy ç±»ï¼Œå¯¹å­—ç¬¦ä¸²è¿›è¡Œæ ¡éªŒ</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Validator</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">validate</span><span class="hljs-params">(string text)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (text.<span class="hljs-built_in">empty</span>()) &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;æ–‡æœ¬ä¸ºç©ºï¼&quot;</span> &lt;&lt; endl;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    ~<span class="hljs-built_in">Validator</span>() = <span class="hljs-keyword">default</span>;<br>&#125;;<br><br><span class="hljs-comment">// è¾“å…¥æ¡† å¯¹åº”Contextç±»ï¼Œéœ€è¦å¯¹è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œæ ¡éªŒï¼Œåœ¨ä¸åŒåœºæ™¯ä¸‹éœ€è¦ä¸åŒçš„éªŒè¯ç­–ç•¥</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InputText</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">InputText</span>() &#123;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_validator</span><span class="hljs-params">(shared_ptr&lt;Validator&gt; validator)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>-&gt;validator = validator;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">input_text</span><span class="hljs-params">(string input)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (validator-&gt;<span class="hljs-built_in">validate</span>(input)) &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;è¾“å…¥ï¼š&quot;</span>&lt;&lt; input &lt;&lt;<span class="hljs-string">&quot;\tæ ¡éªŒæˆåŠŸï¼&quot;</span> &lt;&lt; endl;<br>            text = input;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            cout &lt;&lt; <span class="hljs-string">&quot;è¾“å…¥ï¼š&quot;</span>&lt;&lt; input &lt;&lt;<span class="hljs-string">&quot;\tæ ¡éªŒå¤±è´¥ï¼Œè¯·é‡æ–°è¾“å…¥ï¼&quot;</span> &lt;&lt; endl;<br>        &#125;<br>    &#125;<br>    <span class="hljs-function">string <span class="hljs-title">get_text</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> text;<br>    &#125;<br><span class="hljs-keyword">private</span>:<br>    string text;<br>    std::shared_ptr&lt;Validator&gt; validator;<br>&#125;;<br><br><span class="hljs-comment">// æ•°å­—æ ¡éªŒå™¨ï¼Œæ ¡éªŒç­–ç•¥ä¸ºè¾“å…¥çš„å¿…é¡»æ˜¯æ•°å­—</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DigitValidator</span> :</span> <span class="hljs-keyword">public</span> Validator&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">validate</span><span class="hljs-params">(string text)</span> </span>&#123;<br>        <span class="hljs-keyword">bool</span> flag = Validator::<span class="hljs-built_in">validate</span>(text);<br>        <span class="hljs-keyword">if</span> (!flag) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : text) &#123;<br>            <span class="hljs-keyword">if</span> (c &lt; <span class="hljs-string">&#x27;0&#x27;</span> || c &gt; <span class="hljs-string">&#x27;9&#x27;</span>)&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// å­—æ¯æ ¡éªŒå™¨ï¼Œæ ¡éªŒç­–ç•¥ä¸ºè¾“å…¥çš„å¿…é¡»æ˜¯å­—æ¯</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CharacterValidator</span> :</span> <span class="hljs-keyword">public</span> Validator &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">validate</span><span class="hljs-params">(string text)</span> </span>&#123;<br>        <span class="hljs-keyword">bool</span> flag = Validator::<span class="hljs-built_in">validate</span>(text);<br>        <span class="hljs-keyword">if</span> (!flag) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">char</span> c : text) &#123;<br>            <span class="hljs-keyword">if</span> (!( (c &gt;=<span class="hljs-string">&#x27;a&#x27;</span> &amp;&amp; c&lt;=<span class="hljs-string">&#x27;z&#x27;</span>) || (c&gt;=<span class="hljs-string">&#x27;A&#x27;</span> &amp;&amp; c&lt;=<span class="hljs-string">&#x27;Z&#x27;</span>)))&#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;;<br><br><br><span class="hljs-comment">// ç„¶åæ¨¡æ‹Ÿå°†Strategyä½œä¸ºæ¨¡æ¿å‚æ•°ï¼Œç±»æ¯”STLå®¹å™¨å’Œåˆ†é…å™¨çš„å…³ç³»ï¼Œåšä¸€ä¸ªç®€å•åœ°ç¤ºæ„</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Allocator</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">allocate</span><span class="hljs-params">()</span> </span>&#123;<br><br>    &#125;<br>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Allocator</span>() = <span class="hljs-keyword">default</span>;<br>&#125;;<br><br><span class="hljs-comment">// ç±»æ¯”ç­–ç•¥ç±»ï¼Œå®ç°ç®€å•å†…å­˜åˆ†æ‰¹é¢ç­–ç•¥</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleAllocator</span> :</span> <span class="hljs-keyword">public</span> Allocator&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">allocate</span><span class="hljs-params">()</span>  </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;å®ç°ç®€å•å†…å­˜åˆ†é…ç­–ç•¥&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// ç±»æ¯”ç­–ç•¥ç±»ï¼Œå®ç°å†…å­˜æ± åˆ†é…ç­–ç•¥</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PoolAllocator</span> :</span> <span class="hljs-keyword">public</span> Allocator &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">allocate</span><span class="hljs-params">()</span>  </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;å®ç°å†…å­˜æ± åˆ†é…ç­–ç•¥&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-keyword">template</span> &lt;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">T</span>, <span class="hljs-keyword">class</span> <span class="hljs-title">Allocator</span>&gt;</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Container</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">push</span><span class="hljs-params">(T val)</span> </span>&#123;<br>        allocator.<span class="hljs-built_in">allocate</span>();<br>        cout &lt;&lt; <span class="hljs-string">&quot;åŠ å…¥å…ƒç´ ï¼š &quot;</span> &lt;&lt; val &lt;&lt; endl;<br>    &#125;<br><span class="hljs-keyword">private</span>:<br>    Allocator allocator;<br>&#125;;<br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//BEHAVIORALPATTERNDESIGN_STRATEGY_H</span></span><br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Strategy.cpp</span><br><span class="hljs-comment">// Created by å¼ å®‡è½© on 2022/3/26.</span><br><span class="hljs-comment">// Copyright (c) 2022 zhangyuxuan. All rights reserved.</span><br><span class="hljs-comment">// </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;Strategy.h&quot;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_strategy</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯• Strategy æ¨¡å¼â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>    <span class="hljs-comment">// å®šä¹‰æ¥å£</span><br>    InputText it;<br>    it.<span class="hljs-built_in">set_validator</span>(make_shared&lt;DigitValidator&gt;());<br>    it.<span class="hljs-built_in">input_text</span>(<span class="hljs-string">&quot;1aaaa&quot;</span>);<br>    it.<span class="hljs-built_in">set_validator</span>(make_shared&lt;CharacterValidator&gt;());<br>    it.<span class="hljs-built_in">input_text</span>(<span class="hljs-string">&quot;aaaa&quot;</span>);<br><br>    <span class="hljs-comment">// ä½¿ç”¨æ¨¡æ¿å‚æ•°</span><br>    Container&lt;<span class="hljs-keyword">int</span>,SimpleAllocator&gt; container;<br>    container.<span class="hljs-built_in">push</span>(<span class="hljs-number">1</span>);<br>    Container&lt;<span class="hljs-keyword">int</span>,PoolAllocator&gt; container2;<br>    container2.<span class="hljs-built_in">push</span>(<span class="hljs-number">2</span>);<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”ç»“æŸæµ‹è¯• Strategy æ¨¡å¼â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt;endl;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="9-ç›¸å…³æ¨¡å¼-2"><a class="markdownIt-Anchor" href="#9-ç›¸å…³æ¨¡å¼-2"></a> 9. ç›¸å…³æ¨¡å¼</h2><p>Flyweightï¼šStrategyå¯¹è±¡é€šå¸¸æ˜¯å¾ˆå¥½çš„è½»é‡çº§å¯¹è±¡</p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¼–ç¨‹æŠ€å·§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€è®¾è®¡æ¨¡å¼ã€‘ç»„åˆæ¨¡å¼ä¸è£…é¥°æ¨¡å¼</title>
    <link href="/2022/03/20/2022-03/2022-03-20%20%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%E4%B8%8E%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F/"/>
    <url>/2022/03/20/2022-03/2022-03-20%20%E3%80%90%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%91%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F%E4%B8%8E%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="compositeç»„åˆ-å¯¹è±¡ç»“æ„å‹æ¨¡å¼"><a class="markdownIt-Anchor" href="#compositeç»„åˆ-å¯¹è±¡ç»“æ„å‹æ¨¡å¼"></a> Compositeç»„åˆ â€”â€” å¯¹è±¡ç»“æ„å‹æ¨¡å¼</h1><ol><li>æ„å›¾</li></ol><p>å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†â€”â€”æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ã€‚Compositeä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚</p><ol start="2"><li>ä½¿ç”¨æ€§</li></ol><ul><li>ä½ æƒ³è¡¨ç¤ºå¯¹è±¡çš„éƒ¨åˆ† - æ•´ä½“å±‚æ¬¡ç»“æ„</li><li>ä½ å¸Œæœ›ç”¨æˆ·å¿½ç•¥ç»„åˆå¯¹è±¡ä¸å•ä¸ªå¯¹è±¡çš„ä¸åŒï¼Œç”¨æˆ·å°†ç»Ÿä¸€åœ°ä½¿ç”¨ç»„åˆç»“æ„ä¸­çš„æ‰€æœ‰ç‹¬äº«</li></ul><ol start="3"><li>ç»“æ„<br /><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203202023130.jpeg" alt="ç±»å›¾è®¾è®¡" /></li></ol><p>å…¸å‹ç»“æ„å¦‚ä¸‹ï¼š<br /><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203202024231.jpeg" alt="å…¸å‹ç»“æ„" /></p><ol start="4"><li>å‚ä¸è€…</li></ol><ul><li>Componentï¼ˆGraphic)<ul><li>ä¸ºç»„åˆä¸­çš„å¯¹è±¡å£°æ˜æ¥å£</li><li>åœ¨é€‚å½“æƒ…å†µä¸‹ï¼Œå®ç°æ‰€æœ‰ç±»å…±æœ‰æ¥å£çš„ç¼ºçœè¡Œä¸º</li><li>å£°æ˜ä¸€ä¸ªæ¥å£ç”¨äºè®¿é—®å’Œç®¡ç†Componentçš„å­ç»„ä»¶</li><li>ï¼ˆå¯é€‰ï¼‰åœ¨é€’å½’ç»“æ„ä¸­å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œç”¨äºè®¿é—®ä¸€ä¸ªçˆ¶ç»„ä»¶ï¼Œå¹¶åœ¨åˆé€‚æƒ…å†µä¸‹å®ç°å®ƒ</li></ul></li><li>Leafï¼ˆRectangleï¼ŒLineï¼ŒTextç­‰ï¼‰<ul><li>åœ¨ç»„åˆä¸­è¡¨ç¤ºå¶èŠ‚ç‚¹å¯¹è±¡ï¼Œå¶èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹</li><li>åœ¨ç»„åˆä¸­å®šä¹‰å›¾å…ƒå¯¹è±¡çš„è¡Œä¸º</li></ul></li><li>Compositeï¼ˆPictureï¼‰<ul><li>å®šä¹‰æœ‰å­éƒ¨ä»¶çš„é‚£äº›éƒ¨ä»¶çš„è¡Œä¸º</li><li>å­˜å‚¨å­éƒ¨ä»¶</li><li>åœ¨Componentæ¥å£ä¸­å®ç°ä¸å­éƒ¨ä»¶æœ‰å…³çš„æ“ä½œ</li></ul></li><li>Cilent<ul><li>é€šè¿‡Componentæ¥å£æ“ä½œç»„åˆéƒ¨ä»¶çš„å¯¹è±¡</li></ul></li></ul><ol start="5"><li>ç›¸å…³æ¨¡å¼</li></ol><p>é€šå¸¸ï¼Œéƒ¨ä»¶ - çˆ¶éƒ¨ä»¶è¿æ¥ç”¨äº Responsibility of Chainæ¨¡å¼</p><ul><li>Decoratoræ¨¡å¼ç»å¸¸ä¸Compositeæ¨¡å¼ä¸€èµ·ä½¿ç”¨ã€‚å½“è£…é¥°å’Œç»„åˆä¸€èµ·ä½¿ç”¨æ—¶ï¼Œå®ƒä»¬é€šå¸¸æœ‰ä¸€ä¸ªå…¬å…±çš„çˆ¶ç±»ã€‚å› æ­¤è£…é¥°å¿…é¡»æ”¯æŒå…·æœ‰Addã€Removeã€GetChildæ“ä½œçš„Componentæ¥å£</li><li>Flyweight è®©ä½ å…±äº«ç»„ä»¶ï¼Œä½†ä¸å†èƒ½å¼•ç”¨å…¶çˆ¶ç»„ä»¶</li><li>Iterator å¯ç”¨æ¥éå†Composite</li><li>Visitor å°†æœ¬æ¥åº”è¯¥åˆ†å¸ƒåœ¨Compositeå’ŒLeafç±»ä¸­çš„æ“ä½œå’Œè¡Œä¸ºå±€éƒ¨åŒ–</li></ul><ol start="6"><li>ç¤ºä¾‹ä»£ç </li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Decorator.h</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;vector&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> PATTERNDESIGN_DECORATOR_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> PATTERNDESIGN_DECORATOR_H</span><br><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_composite</span><span class="hljs-params">()</span> </span>;<br><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @brief ç»„åˆæ¨¡å¼</span><br><span class="hljs-comment"> * ç²—ç•¥åœ°å°†è®¡ç®—æœºä½œä¸ºä¾‹å­ï¼Œä¸€äº›åŸºæœ¬çš„å¤–è®¾ä½œä¸ºLeafï¼Œä¸»æ¿ä½œä¸ºä¸€ä¸ªå°æ•´ä½“ Compositeï¼ˆé‡Œé¢åˆåŒ…å«äº†cpuã€å†…å­˜ã€æ˜¾å¡ç­‰ï¼‰</span><br><span class="hljs-comment"> * ä»¥æŸ¥è¯¢ä»·æ ¼ä½œä¸ºå…¬å…±æ¥å£</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-comment">// Componentç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Equipment</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Equipment</span>(std::string name, <span class="hljs-keyword">int</span> price) : <span class="hljs-built_in">name</span>(name),<span class="hljs-built_in">price</span>(price) &#123;&#125;<br>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Equipment</span>() = <span class="hljs-keyword">default</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> std::string <span class="hljs-title">get_name</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">int</span> <span class="hljs-title">get_price</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> price;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(Equipment* equipment)</span> </span>&#123;&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">remove</span><span class="hljs-params">(Equipment* equipment)</span> </span>&#123;&#125;<br><br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span>å¯ä»¥æ›´è¿‘ä¸€æ­¥ï¼Œä½¿ç”¨ Iterator æ¨¡å¼</span><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> Equipment* <span class="hljs-title">get_child</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>    &#125;<br><br><span class="hljs-keyword">protected</span>:<br>    std::string name;<br>    <span class="hljs-keyword">int</span> price;<br>&#125;;<br><br><span class="hljs-comment">// é¼ æ ‡ï¼ŒLeafç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mouse</span> :</span> <span class="hljs-keyword">public</span> Equipment&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Mouse</span>(std::string name, <span class="hljs-keyword">int</span> price) : <span class="hljs-built_in">Equipment</span>(name,price) &#123;<br><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">int</span> <span class="hljs-title">get_price</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> price * <span class="hljs-number">0.9</span> ;        <span class="hljs-comment">// æ¯”å¦‚è¿™æ®µæ—¶é—´é¼ æ ‡å¹³å‡ä»·ä¸‹é™</span><br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// CPUï¼ŒLeafç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CPU</span> :</span> <span class="hljs-keyword">public</span> Equipment &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">CPU</span>(std::string name, <span class="hljs-keyword">int</span> price, std::string type) : <span class="hljs-built_in">Equipment</span>(name, price), <span class="hljs-built_in">type</span>(type) &#123;<br><br>    &#125;<br><span class="hljs-keyword">private</span>:<br>    std::string type;<br>&#125;;<br><br><span class="hljs-comment">// æ˜¾å¡ï¼ŒLeafç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GraphicCards</span> :</span><span class="hljs-keyword">public</span> Equipment &#123;<br><span class="hljs-keyword">public</span> :<br>    <span class="hljs-built_in">GraphicCards</span>(std::string name, <span class="hljs-keyword">int</span> price) : <span class="hljs-built_in">Equipment</span>(name, price) &#123;<br><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">int</span> <span class="hljs-title">get_price</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> price * <span class="hljs-number">2</span>;           <span class="hljs-comment">// è¿™æ®µæ—¶é—´æ˜¾å¡æº¢ä»·</span><br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// Compositeç±»ï¼Œä¸»æ¿</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainBoard</span> :</span> <span class="hljs-keyword">public</span> Equipment &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">MainBoard</span>(std::string name, <span class="hljs-keyword">int</span> price) : <span class="hljs-built_in">Equipment</span>(name, price) &#123;<br><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">(Equipment* equipment)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (equipment == <span class="hljs-literal">nullptr</span>)<br>            <span class="hljs-keyword">return</span>;<br>        children.<span class="hljs-built_in">push_back</span>(equipment);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">remove</span><span class="hljs-params">(Equipment* equipment)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (equipment == <span class="hljs-literal">nullptr</span>)<br>            <span class="hljs-keyword">return</span> ;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> iter = children.<span class="hljs-built_in">begin</span>(); iter != children.<span class="hljs-built_in">end</span>(); iter++) &#123;<br>            <span class="hljs-keyword">if</span> (*iter == equipment) &#123;<br>                children.<span class="hljs-built_in">erase</span>(iter);<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> Equipment* <span class="hljs-title">get_child</span><span class="hljs-params">(<span class="hljs-keyword">int</span> index)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (index &lt; <span class="hljs-number">0</span> || index &gt;= children.<span class="hljs-built_in">size</span>()) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> children[index];<br>    &#125;<br><br>    <span class="hljs-comment">// ç´¯åŠ è¯¥è®¾å¤‡ä¸Šé™„å¸¦çš„æ‰€æœ‰è®¾å¤‡çš„ä»·å€¼</span><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">int</span> <span class="hljs-title">get_price</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-keyword">int</span> sum = price;<br>       <span class="hljs-keyword">for</span> (Equipment* p : children) &#123;<br>           sum += p-&gt;<span class="hljs-built_in">get_price</span>();<br>       &#125;<br>       <span class="hljs-keyword">return</span> sum;<br>    &#125;<br><br><span class="hljs-keyword">private</span>:<br>    std::vector&lt;Equipment*&gt; children;<br>&#125;;<br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//PATTERNDESIGN_DECORATOR_H</span></span><br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Decorator.cpp</span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;Composite.h&quot;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_composite</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯•è£…é¥°æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>    Equipment* cpu = <span class="hljs-keyword">new</span> <span class="hljs-built_in">CPU</span>(<span class="hljs-string">&quot;CPU&quot;</span>, <span class="hljs-number">1000</span>, <span class="hljs-string">&quot;Intel&quot;</span>);<br>    Equipment* graphic_card = <span class="hljs-keyword">new</span> <span class="hljs-built_in">GraphicCards</span>(<span class="hljs-string">&quot;æ˜¾å¡&quot;</span>,<span class="hljs-number">4000</span>);<br>    Equipment* main_board = <span class="hljs-keyword">new</span> <span class="hljs-built_in">MainBoard</span>(<span class="hljs-string">&quot;ä¸»æ¿&quot;</span>,<span class="hljs-number">800</span>);<br>    main_board-&gt;<span class="hljs-built_in">add</span>(cpu);<br>    main_board-&gt;<span class="hljs-built_in">add</span>(graphic_card);<br>    cout &lt;&lt; main_board-&gt;<span class="hljs-built_in">get_name</span>() &lt;&lt; <span class="hljs-string">&quot; with &quot;</span> ;<br>    cout &lt;&lt; main_board-&gt;<span class="hljs-built_in">get_child</span>(<span class="hljs-number">0</span>)-&gt;<span class="hljs-built_in">get_name</span>() &lt;&lt; <span class="hljs-string">&quot; &quot;</span> &lt;&lt; main_board-&gt;<span class="hljs-built_in">get_child</span>(<span class="hljs-number">1</span>) -&gt;<span class="hljs-built_in">get_name</span>() &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;all price:&quot;</span> &lt;&lt; main_board-&gt;<span class="hljs-built_in">get_price</span>() &lt;&lt; endl;<br>    main_board-&gt;<span class="hljs-built_in">remove</span>(cpu);<br>    cout &lt;&lt; <span class="hljs-string">&quot;ä¸»æ¿ï¼ˆå¸¦æœ‰æ˜¾å¡ï¼‰å½“å‰ä»·æ ¼:&quot;</span> &lt;&lt; main_board-&gt;<span class="hljs-built_in">get_price</span>() &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç»“æŸæµ‹è¯•è£…é¥°æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="decoratorè£…é¥°å¯¹è±¡ç»“æ„å‹æ¨¡å¼"><a class="markdownIt-Anchor" href="#decoratorè£…é¥°å¯¹è±¡ç»“æ„å‹æ¨¡å¼"></a> Decoratorï¼ˆè£…é¥°ï¼‰â€”â€”å¯¹è±¡ç»“æ„å‹æ¨¡å¼</h1><ol><li>æ„å›¾</li></ol><p>åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±æ·»åŠ åŠŸèƒ½æ¥è¯´ï¼ŒDecoratoræ¨¡å¼ç›¸æ¯”ç”Ÿæˆå­ç±»æ›´åŠ çµæ´»</p><ol start="2"><li>åˆ«å</li></ol><p>åŒ…è£…å™¨ï¼ˆwrapperï¼‰</p><ol start="3"><li>åŠ¨æœº</li></ol><p>æœ‰æ—¶æˆ‘ä»¬å¸Œæœ›ç»™æŸä¸ªå¯¹è±¡è€Œä¸æ˜¯æ•´ä¸ªç±»æ·»åŠ ä¸€äº›åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸€ä¸ªå›¾å½¢ç”¨æˆ·ç•Œé¢å·¥å…·ç®±å…è®¸ä½ å¯¹ä»»æ„ä¸€ä¸ªç”¨æˆ·ç•Œé¢ç»„ä»¶æ·»åŠ ä¸€äº›ç‰¹æ€§ï¼ˆä¾‹å¦‚è¾¹æ¡†ï¼‰ï¼Œæˆ–æ˜¯ä¸€äº›è¡Œä¸ºï¼ˆä¾‹å¦‚çª—å£æ»‘åŠ¨ï¼‰ã€‚</p><p>ä½¿ç”¨ç»§æ‰¿æœºåˆ¶æ˜¯æ·»åŠ åŠŸèƒ½çš„ä¸€ç§æœ‰æ•ˆé€”ç»ï¼Œä»å…¶ä»–ç±»ç»§æ‰¿è¿‡æ¥çš„è¾¹æ¡†ç‰¹æ€§å¯ä»¥è¢«å¤šä¸ªå­ç±»çš„å®ä¾‹æ‰€ä½¿ç”¨ï¼Œä½†è¿™ç§æ–¹æ³•ä¸å¤Ÿçµæ´»ï¼Œå› ä¸ºè¾¹æ¡†çš„é€‰æ‹©æ—¶é™æ€çš„ï¼Œç”¨æˆ·ä¸èƒ½æ§åˆ¶å¯¹ç»„ä»¶åŠ è¾¹æ¡†çš„æ–¹å¼å’Œæ—¶æœºã€‚</p><p>ä¸€ç§è¾ƒä¸ºçµæ´»çš„æ–¹å¼å°±æ˜¯å°†ç»„ä»¶åµŒå…¥å¦ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œç”±è¿™ä¸ªå¯¹è±¡æ·»åŠ è¾¹æ¡†ã€‚æˆ‘ä»¬ç§°è¿™ä¸ªåµŒå…¥çš„å¯¹è±¡ä¸ºè£…é¥°ã€‚è¿™ä¸ªè£…é¥°ä¸å®ƒæ‰€è£…é¥°çš„ç»„ä»¶æ¥å£ä¸€è‡´ï¼Œå› æ­¤å®ƒå¯¹ä½¿ç”¨è¯¥ç»„ä»¶çš„å®¢æˆ·é€æ˜ã€‚å®ƒå°†å®¢æˆ·è¯·æ±‚è½¬å‘ç»™è¯¥ç»„ä»¶ï¼Œå¹¶ä¸”å¯èƒ½åœ¨è½¬å‘å‰åæ‰§è¡Œä¸€äº›é¢å¤–çš„åŠ¨ä½œï¼ˆä¾‹å¦‚ç”»ä¸€ä¸ªè¾¹æ¡†ï¼‰ã€‚é€æ˜æ€§ä½¿å¾—ä½ å¯ä»¥é€’å½’åœ°åµŒå¥—å¤šä¸ªè£…é¥°ï¼Œä»è€Œå¯ä»¥æ·»åŠ ä»»æ„å¤šçš„åŠŸèƒ½ã€‚</p><ol start="4"><li>é€‚ç”¨æ€§</li></ol><p>ä»¥ä¸‹æƒ…å†µä¸‹ä½¿ç”¨Decoratoræ¨¡å¼ï¼š</p><ul><li>åœ¨ä¸å½±å“å…¶ä»–å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œä»¥åŠ¨æ€ã€é€æ˜çš„æ–¹å¼ç»™å•ä¸ªå¯¹è±¡æ·»åŠ èŒè´£</li><li>å¤„ç†é‚£äº›å¯ä»¥æ’¤é”€çš„èŒè´£</li><li>å½“ä¸èƒ½é‡‡ç”¨ç”Ÿæˆå­ç±»çš„æ–¹æ³•è¿›è¡Œæ‰©å……æ—¶ã€‚ä¸€ç§æƒ…å†µæ˜¯ï¼Œå¯èƒ½æœ‰å¤§é‡ç‹¬ç«‹çš„æ‰©å±•ï¼Œä¸ºæ”¯æŒæ¯ä¸€ç§ç»„åˆå°†äº§ç”Ÿå¤§é‡çš„å­ç±»ï¼Œä½¿å¾—å­ç±»æ•°ç›®å‘ˆçˆ†ç‚¸æ€§å¢é•¿ã€‚å¦ä¸€ç§æƒ…å†µå¯èƒ½æ˜¯ï¼Œç±»å®šä¹‰è¢«éšè—ï¼Œæˆ–ç±»å®šä¹‰ä¸èƒ½ç”¨äºç”Ÿæˆå­ç±»ï¼ˆè¿™ä¸ªæ„æ€å°±æ˜¯è£…é¥°çš„æ„æ€ï¼Ÿï¼‰ã€‚</li></ul><ol start="5"><li>ç»“æ„</li></ol><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203202024851.jpeg" alt="ç±»å›¾è®¾è®¡" /></p><ol start="6"><li>å‚ä¸è€…</li></ol><ul><li>Componentï¼ˆVisualComponentï¼‰<ul><li>å®šä¹‰ä¸€ä¸ªå¯¹è±¡æ¥å£ï¼Œå¯ä»¥ç»™è¿™äº›å¯¹è±¡åŠ¨æ€åœ°æ·»åŠ èŒè´£</li></ul></li><li>ConcreteComponent(TextView)<ul><li>å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ç»™è¿™ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›èŒè´£</li></ul></li><li>Decorator<ul><li>ç»´æŒä¸€ä¸ªæŒ‡å‘Componentå¯¹è±¡çš„æŒ‡é’ˆï¼Œå¹¶å®šä¹‰ä¸€ä¸ªä¸Componentæ¥å£ä¸€è‡´çš„æ¥å£</li></ul></li><li>ConcreteDecoratorï¼ˆBorderDecoratorã€ScrollDecorator)<ul><li>å‘ç»„ä»¶æ·»åŠ èŒè´£</li></ul></li></ul><ol start="7"><li>åä½œ</li></ol><p>Decoratorå°†è¯·æ±‚è½¬å‘ç»™å®ƒçš„Componentå¯¹è±¡ï¼Œå¹¶æœ‰å¯èƒ½åœ¨è½¬å‘è¯·æ±‚å‰åæ‰§è¡Œä¸€äº›é™„åŠ çš„åŠ¨ä½œ</p><ol start="8"><li>ç›¸å…³æ¨¡å¼</li></ol><ul><li>Adapterï¼šDecoratoræ¨¡å¼ä¸åŒäºAdapteræ¨¡å¼ï¼Œå› ä¸ºè£…é¥°ä»…æ”¹å˜å¯¹è±¡çš„èŒè´£è€Œä¸æ”¹å˜å®ƒçš„æ¥å£ï¼›è€Œé€‚é…å™¨å°†ç»™å¯¹è±¡ä¸€ä¸ªå…¨æ–°çš„æ¥å£</li><li>Compositeï¼šå¯ä»¥å°†è£…é¥°è§†ä¸ºä¸€ä¸ªé€€åŒ–çš„ã€ä»…æœ‰ä¸€ä¸ªç»„ä»¶çš„ç»„åˆã€‚ç„¶è€Œï¼Œ è£…é¥°ä»…ç»™å¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£â€”â€”å®ƒçš„ç›®çš„ä¸åœ¨äºå¯¹è±¡èšé›†ã€‚</li><li>Strategyï¼šç”¨ä¸€ä¸ªè£…é¥°å¯ä»¥æ”¹å˜å¯¹è±¡çš„å¤–è¡¨ï¼›è€ŒStrategyæ¨¡å¼ä½¿ä½ å¯ä»¥æ”¹å˜å¯¹è±¡çš„å†…æ ¸ã€‚è¿™æ˜¯æ”¹å˜å¯¹è±¡çš„ä¸¤ç§é€”ç»ã€‚</li></ul><ol start="9"><li>ç¤ºä¾‹ä»£ç </li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Decorator.h </span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> STRUCTURALPATTERNDESIGN_DECORATOR_H</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> STRUCTURALPATTERNDESIGN_DECORATOR_H</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @brief è£…é¥°æ¨¡å¼</span><br><span class="hljs-comment"> * ä»¥GUIç»„ä»¶ä¸ºä¾‹ï¼Œå®šä¹‰å¯è§†åŒ–ç»„ä»¶ä¸ºåŸºæœ¬çš„componentç±»ï¼Œæ–‡æœ¬æ¡†ä¸ºå…·ä½“çš„ä¸€ä¸ªç»„ä»¶ç±»ï¼Œ</span><br><span class="hljs-comment"> * è¾¹æ¡†å’Œæ»šè½®åˆ™æ˜¯è£…é¥°å™¨ç±»</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_decorator</span><span class="hljs-params">()</span></span>;<br><br><span class="hljs-comment">// Componentç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VisualComponent</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">draw</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;<br>    ~<span class="hljs-built_in">VisualComponent</span>() = <span class="hljs-keyword">default</span>;<br>&#125;;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TextLine</span> :</span> <span class="hljs-keyword">public</span> VisualComponent &#123;<br><span class="hljs-keyword">public</span> :<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">draw</span><span class="hljs-params">()</span>  </span>&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;ç”»å‡ºä¸€ä¸ªæ–‡æœ¬æ¡†&quot;</span> &lt;&lt; std::endl;<br><br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// ç®€å•ä¿®é¥°å™¨ç±»</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Decorator</span> :</span> <span class="hljs-keyword">public</span> VisualComponent&#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">Decorator</span>(VisualComponent* component) : <span class="hljs-built_in">component</span>(component) &#123;<br><br>    &#125;<br>    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Decorator</span>() = <span class="hljs-keyword">default</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">draw</span><span class="hljs-params">()</span> </span>&#123;<br>        component-&gt;<span class="hljs-built_in">draw</span>();<br>    &#125;<br><br><span class="hljs-keyword">private</span>:<br>    VisualComponent* component;<br><br>&#125;;<br><br><span class="hljs-comment">// è¾¹æ¡†ä¿®é¥°å™¨</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BorderDecorator</span> :</span> <span class="hljs-keyword">public</span> Decorator &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">BorderDecorator</span>(VisualComponent* component, <span class="hljs-keyword">int</span> width) : <span class="hljs-built_in">Decorator</span>(component), <span class="hljs-built_in">width</span>(width) &#123;<br><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">draw</span><span class="hljs-params">()</span> </span>&#123;<br>       Decorator::<span class="hljs-built_in">draw</span>();<br>       <span class="hljs-built_in">add_border</span>();<br>    &#125;<br><br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-keyword">int</span> width;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add_border</span><span class="hljs-params">()</span> </span>&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;æ·»åŠ è¾¹æ¡†,&quot;</span> &lt;&lt; <span class="hljs-string">&quot;åšåº¦ä¸º&quot;</span> &lt;&lt; width &lt;&lt; std::endl;<br>    &#125;<br><br><br>&#125;;<br><br><span class="hljs-comment">// æ»šåŠ¨æ¡ä¿®é¥°å™¨</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ScrollDecorator</span> :</span> <span class="hljs-keyword">public</span> Decorator &#123;<br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">ScrollDecorator</span>(VisualComponent* component) : <span class="hljs-built_in">Decorator</span>(component) &#123;<br><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">draw</span><span class="hljs-params">()</span> </span>&#123;<br>        Decorator::<span class="hljs-built_in">draw</span>();<br>        <span class="hljs-built_in">add_scroll</span>();<br>    &#125;<br><span class="hljs-keyword">private</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add_scroll</span><span class="hljs-params">()</span> </span>&#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;æ·»åŠ æ»šåŠ¨æ¡&quot;</span> &lt;&lt; std::endl;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// çª—å£windowï¼Œå¯ä»¥å°†ä¸€ä¸ªå¯è§†åŒ–ç»„ä»¶æ”¾å…¥çª—å£ä¸­æ˜¾ç¤º</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Window</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">set_content</span><span class="hljs-params">(VisualComponent* component)</span> </span>&#123;<br>        component-&gt;<span class="hljs-built_in">draw</span>();<br>    &#125;<br>&#125;;<br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">//STRUCTURALPATTERNDESIGN_DECORATOR_H</span></span><br></code></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// Decorator.cpp</span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;Decorator.h&quot;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">test_decorator</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å¼€å§‹æµ‹è¯•è£…é¥°æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>    Window window;<br><br>    window.<span class="hljs-built_in">set_content</span>(<br>            <span class="hljs-keyword">new</span> <span class="hljs-built_in">ScrollDecorator</span>(<br>                    <span class="hljs-keyword">new</span> <span class="hljs-built_in">BorderDecorator</span>(<br>                            <span class="hljs-keyword">new</span> TextLine, <span class="hljs-number">3</span>)));<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç»“æŸæµ‹è¯•è£…é¥°æ¨¡å¼â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¼–ç¨‹æŠ€å·§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€99%ç¯å¢ƒæ­å»ºç³»åˆ—ã€‘xv6-riscvå†…æ ¸è°ƒè¯•æ•™ç¨‹</title>
    <link href="/2022/03/19/2022-03/2022-03-19%20%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E7%B3%BB%E5%88%97-xv6%E5%86%85%E6%A0%B8%E8%B0%83%E8%AF%95%E6%95%99%E7%A8%8B/"/>
    <url>/2022/03/19/2022-03/2022-03-19%20%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E7%B3%BB%E5%88%97-xv6%E5%86%85%E6%A0%B8%E8%B0%83%E8%AF%95%E6%95%99%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>æœ€è¿‘åœ¨ä¸Šã€Šæ“ä½œç³»ç»Ÿé«˜çº§è¯¾ç¨‹ã€‹ï¼Œåšçš„å®éªŒæ˜¯MIT6.828çš„è¯¾ç¨‹å®éªŒï¼Œåœ¨ä¸€ä¸ªç®€æ˜“æ“ä½œç³»ç»Ÿå†…æ ¸XV6ä¸Šè¿›è¡Œè°ƒè¯•å¼€å‘ã€‚åç»­æˆ‘ä¹Ÿä¼šå†™ä¸€äº›ä»‹ç»æ“ä½œç³»ç»Ÿçš„æ–‡ç« ã€‚</p><p>å…³äºXV6ï¼Œè¿™æ˜¯MITå¼€å‘çš„ä¸€ä¸ªæ•™å­¦ç›®çš„çš„æ“ä½œç³»ç»Ÿã€‚<em>XV6</em>æ˜¯åœ¨x86å¤„ç†å™¨ä¸Š(xå³æŒ‡x86)ç”¨ANSIæ ‡å‡†Cé‡æ–°å®ç°çš„Unixç¬¬å…­ç‰ˆ(Uni<em>x V6</em>ï¼Œé€šå¸¸ç›´æ¥è¢«ç§°ä¸ºV6)ã€‚å¹¶ä¸”MIT6.828è¿™é—¨å…³äºæ“ä½œç³»ç»Ÿçš„è¯¾ç¨‹ä¹Ÿæ˜¯å¹¿å—å¥½è¯„çš„ï¼Œä¹Ÿæ¨èå¤§å®¶å»å­¦ä¹ ã€‚</p><p>è¿™é‡Œå†è´´å‡ºä¸€ä»½ç›¸å…³çš„èµ„æºæ¸…å•ï¼ˆä¸è¦å†è¯´æ‰¾ä¸åˆ°å­¦ä¹ èµ„æºäº†è€Œä¸å­¦äº†~ï¼‰ï¼š</p><ul><li>è¯¾ç¨‹ç½‘ç«™ï¼š<a href="https://pdos.csail.mit.edu/6.828/2020">https://pdos.csail.mit.edu/6.828/2020</a></li><li>xv6 å®˜ç½‘å®‰è£…æ•™ç¨‹ï¼š<a href="https://pdos.csail.mit.edu/6.828/2020/tools.html">https://pdos.csail.mit.edu/6.828/2020/tools.html</a></li><li>åŒ—å¤§è¯¾ç¨‹æç¤ºï¼š<a href="https://github.com/FrankZn/xv6-pku-hints">https://github.com/FrankZn/xv6-pku-hints</a></li><li>xv6-bookä¸­æ–‡ç‰ˆï¼š<a href="https://github.com/FrankZn/xv6-riscv-book-Chinese">https://github.com/FrankZn/xv6-riscv-book-Chinese</a></li><li>ä¸­æ–‡å­—å¹•è§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV19k4y1C7kA">6.S081 / Fall 2020 éº»çœç†å·¥æ“ä½œç³»ç»Ÿ - 2020 å¹´ç§‹å­£</a></li><li>å®éªŒä»£ç å‚è€ƒï¼š<a href="https://home.cnblogs.com/u/weijunji/">https://home.cnblogs.com/u/weijunji/</a></li></ul><hr /><p>å›å½’ä¸»é¢˜ï¼Œè¿™æ¬¡æ–‡ç« çš„æ¥ç”±å°±æ˜¯å®ç°è™šæ‹Ÿæœºä¸Šå®ç°gdbè°ƒè¯•xv6ã€‚ä¸€å¼€å§‹å› ä¸ºåªä¸‹è½½äº†å†…æ ¸çš„ä»£ç ï¼Œæ‰€ä»¥åªèƒ½è¿›è¡Œç¼–è¯‘è¿è¡Œï¼Œä½¿ç”¨è‡ªå¸¦çš„gdbå‡ºç°å„ç§é—®é¢˜ï¼Œåæ¥å‘ç°æ˜¯æ²¡æœ‰å®‰è£…ç›¸åº”çš„ç¼–è¯‘å·¥å…·ã€‚ä½†æ˜¯å®é™…å®‰è£…èµ·æ¥å´èŠ±è´¹äº†æˆ‘å¥½å¤§ä¸€ç•ªåŠŸå¤«ï¼Œæ‰€ä»¥ç‰¹æ­¤è®°å½•ï¼Œå¸®åŠ©åæ¥äººå‡å°‘å¼¯è·¯ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203200908096.(null)" alt="æŠ¥é”™ä¿¡æ¯1" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203200908937.(null)" alt="æŠ¥é”™ä¿¡æ¯2" /></p><p>å†æä¸€ä¸‹æˆ‘çš„æœºå™¨ç¯å¢ƒï¼š</p><ul><li>å®¿ä¸»æœºæ“ä½œç³»ç»Ÿï¼šWin10</li><li>è™šæ‹Ÿæœºï¼šUbuntu20.04</li></ul><h1 id="è¿½è®°"><a class="markdownIt-Anchor" href="#è¿½è®°"></a> è¿½è®°</h1><p>åæ¥ç»è¿‡æŒ‡ç‚¹ï¼Œå‘ç°æ ¹æœ¬ä¸éœ€è¦ä¸‹é¢riscv-gnu-toolchain å®‰è£…è¿™ä¸€æ­¥éª¤ï¼Œå¯ä»¥è·³è¿‡é‚£éƒ¨åˆ†ï¼ˆå…¶å®é‚£éƒ¨åˆ†æ“ä½œç›¸å½“äºæ˜¯è‡ªå·±æ‰‹åŠ¨è¿›è¡Œç¼–è¯‘äº†ï¼Œä½†å®é™…ä¸Šåªéœ€è¦ç”¨åˆ°ç¼–è¯‘å¥½çš„å·¥å…·ç¨‹åºå³å¯ï¼‰ã€‚</p><p>è¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šæ•™ç¨‹ã€‚</p><ol><li>é¦–å…ˆå¯ä»¥æ ¹æ®å®˜ç½‘æ•™ç¨‹å®‰è£…ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œä¸‹é¢è¿™æ¡å‘½ä»¤ï¼Œå®‰è£…ç›¸å…³å·¥å…·ï¼š</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt-get install git build-essential gdb-multiarch qemu-system-misc gcc-riscv64-linux-gnu binutils-riscv64-linux-gnu <br></code></pre></td></tr></table></figure><ol start="2"><li>ç„¶åå†å…‹éš†å®éªŒä»£ç </li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">git clone git://g.csail.mit.edu/xv6-labs-2020<br></code></pre></td></tr></table></figure><ol start="3"><li>åˆ‡æ¢åˆ†æ”¯ï¼Œå¹¶è¿›è¡Œç¼–è¯‘</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">git checkout util<br>make qemu<br></code></pre></td></tr></table></figure><p>å¦‚æœå‡ºç°ç±»ä¼¼ä¸‹é¢çš„ç•Œé¢ï¼Œåˆ™è¡¨æ˜å®‰è£…æˆåŠŸ</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204082125043.png" alt="xv6å†…æ ¸è¿è¡Œæˆªå›¾" /></p><ol start="4"><li>æŒ‰ctrl + a + x é€€å‡ºå†…æ ¸è¿è¡Œï¼Œåœ¨å¯åŠ¨make qemu-gdb</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">make qemu-gdb<br></code></pre></td></tr></table></figure><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204082133201.png" alt="make qemu-gdbè¿è¡Œç»“æœ" /></p><ol start="5"><li>ç„¶åæ‰“å¼€å¦ä¸€ä¸ªä¸­æ–­çª—å£ï¼Œç›´æ¥æ‰§è¡Œgdbçš„è¯ï¼Œä¼šå‡ºç°ä¸‹é¢çš„æç¤º</li></ol><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204082134470.png" alt="æç¤º" /></p><ol start="6"><li>æŒ‰ç…§æç¤ºï¼Œåœ¨<code>~/.gdbinit</code>æ–‡ä»¶ä¸­åŠ å…¥ <code>set auto-load safe-path /</code></li><li>ç„¶åæ‰§è¡Œ<code>gdb-multiarch</code>ï¼Œçœ‹åˆ°å‡ºç°ç±»ä¼¼ä¸‹é¢çš„ç•Œé¢ï¼Œå°±è¡¨ç¤ºæˆåŠŸäº†ï¼Œæ¥ä¸‹é‡Œå°±æ˜¯æ„‰å¿«çš„è°ƒè¯•æ—¶é—´äº†ï¼Œå¯ä»¥å‚è€ƒä¸‹æ–‡çš„GDBè°ƒè¯•å†…å®¹ã€‚</li></ol><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202204082134187.png" alt="æ‰§è¡ŒæˆåŠŸ" /></p><h1 id="riscv-gnu-toolchain-å®‰è£…"><a class="markdownIt-Anchor" href="#riscv-gnu-toolchain-å®‰è£…"></a> riscv-gnu-toolchain å®‰è£…</h1><p>æ ¹æ®å®˜ç½‘ä¸Šçš„æ•™ç¨‹å®‰è£…ï¼Œå‘ç°è™šæ‹Ÿæœºè¿ä¸ä¸Šå¤–ç½‘ï¼ˆè¿™é‡Œè¿˜å°è¯•ä¸€ç•ªåŠŸå¤«ï¼Œæ²¡èƒ½æˆåŠŸï¼‰ï¼Œæ‰€ä»¥çœ‹åˆ°è¿™ç¯‡æ–‡ç« ï¼Œ<a href="https://blog.csdn.net/qq_35990574/article/details/110006307">riscv-gnu-toolchainå·¥å…·é“¾ä¸‹è½½å®‰è£…_roockietçš„åšå®¢</a><sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="riscv-gnu-toolchainå·¥å…·é“¾ä¸‹è½½å®‰è£…_roockietçš„åšå®¢">[1]</span></a></sup></p><p>ä½¿ç”¨giteeä¸Šçš„é•œåƒè¿›è¡Œä¸‹è½½ï¼Œéœ€è¦æ‰§è¡Œçš„å‘½ä»¤å¤§ä½“å¦‚ä¸‹ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs PowerShell"><span class="hljs-comment"># å®‰è£…ç¼–è¯‘éœ€è¦çš„ä¸€äº›ä¾èµ–</span><br>sudo apt<span class="hljs-literal">-get</span> install autoconf automake autotools<span class="hljs-literal">-dev</span> <span class="hljs-built_in">curl</span> libmpc<span class="hljs-literal">-dev</span> libmpfr<span class="hljs-literal">-dev</span> libgmp<span class="hljs-literal">-dev</span> gawk <span class="hljs-built_in">build-essential</span> bison flex texinfo gperf libtool patchutils bc zlib1g<span class="hljs-literal">-dev</span> libexpat<span class="hljs-literal">-dev</span><br><br><span class="hljs-comment"># å…‹éš†å·¥å…·ä»“åº“</span><br>git clone https://gitee.com/mirrors/riscv<span class="hljs-literal">-gnu</span><span class="hljs-literal">-toolchain</span>.git<br><br><span class="hljs-comment"># è¿›å…¥ç›®å½•</span><br><span class="hljs-built_in">cd</span> riscv<span class="hljs-literal">-gnu</span><span class="hljs-literal">-toolchain</span> <br><br><span class="hljs-comment"># æ‰‹åŠ¨å…‹éš†å…¶ä»–ä»“åº“ï¼Œä¸‹è½½æ¯”è¾ƒè€—æ—¶ï¼Œè€å¿ƒç­‰å¾…å§</span><br>git clone https://gitee.com/mirrors/riscv<span class="hljs-literal">-binutils</span><span class="hljs-literal">-gdb</span>.git riscv<span class="hljs-literal">-binutils</span><br>git clone https://gitee.com/mirrors/riscv<span class="hljs-literal">-dejagnu</span>.git riscv<span class="hljs-literal">-dejagnu</span><br>git clone https://gitee.com/mirrors/riscv<span class="hljs-literal">-gcc</span>.git riscv<span class="hljs-literal">-gcc</span><br>git clone https://gitee.com/mirrors/riscv<span class="hljs-literal">-binutils</span><span class="hljs-literal">-gdb</span>.git riscv<span class="hljs-literal">-gdb</span><br>git clone https://gitee.com/mirrors/riscv<span class="hljs-literal">-glibc</span>.git riscv<span class="hljs-literal">-glibc</span><br>git clone https://gitee.com/mirrors/riscv<span class="hljs-literal">-newlib</span>.git riscv<span class="hljs-literal">-newlib</span><br><br><span class="hljs-comment"># è¿™ä¸ªqemuç›®å½•ï¼Œåé¢å¥½åƒæ²¡æœ‰ç”¨åˆ°ï¼Œå¯ä»¥æŠŠè¿™ä¸ªç›®å½•ç»™å»äº†ï¼Œå¦‚æœæ‹…å¿ƒï¼Œé‚£å°±ä¹Ÿä¸€å¹¶ä¸‹è½½å§</span><br>git clone https://gitee.com/mirrors/qemu.git qemu<br><br><span class="hljs-comment"># æ‰€æœ‰ä»“åº“ä¸‹è½½å®Œæˆï¼Œå¼€å§‹ç¼–è¯‘</span><br>./configure -<span class="hljs-literal">-prefix</span>=/usr/local  <span class="hljs-comment">#ï¼ˆé€‰æ‹©å®‰è£…ç›®å½•ï¼Œè¯·ç¡®ä¿å¯¹åº”çš„ç›®å½•æœ‰è¶³å¤Ÿå¤§çš„å®¹é‡ï¼Œç®—ä¸Šä¸‹è½½çš„ä»“åº“å¤§çº¦20Gï¼‰</span><br>sudo make<br><span class="hljs-comment"># è¿™æ ·ç¼–è¯‘å¤§çº¦éœ€è¦ 1 ~ 2 å°æ—¶</span><br></code></pre></td></tr></table></figure><hr /><p>æ³¨æ„è¿™ä¸ªriscv-gnu-toolchainæ‰€æœ‰çš„ä»“åº“éƒ½å…‹éš†ä¸‹æ¥åï¼Œå¹¶ä¸”ç›´æ¥æ‰§è¡Œmakeå®‰è£…çš„è¯ï¼Œè€—æ—¶è¾ƒä¹…ï¼Œä¼°è®¡æœ‰1~2å°æ—¶ï¼Œæœ€åå¤§çº¦æœ‰18Gï¼ˆæˆ‘æ˜¯å®‰è£…åœ¨äº†/opt/binç›®å½•ä¸‹ï¼‰ï¼Œæ‰€ä»¥ä¸€å®šè¦ç¡®ä¿å¯¹åº”åˆ†åŒºçš„å®¹é‡è¶³å¤Ÿï¼Œä¸ç„¶å°±ä¼šå› ä¸ºå®¹é‡ä¸å¤Ÿè€Œå†™å¤±è´¥ï¼ˆéƒ½æ˜¯è¡€æ·‹æ·‹çš„æ•™è®­å•Šï¼Œçœ‹åˆ°ä¸‹å›¾æ ¹ç›®å½•çš„æŒ‚è½½ç‚¹äº†å—ï¼Œä¹‹å‰å°±æ˜¯å› ä¸ºå®‰è£…åœ¨æ ¹ç›®å½•å¯¹åº”çš„åˆ†åŒºä¸‹ï¼Œå¯¼è‡´å®¹é‡ç©ºé—´ç›´æ¥æ»¡äº†ã€‚ã€‚ï¼‰ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203192203252.(null)" alt="æŸ¥çœ‹ç£ç›˜åˆ†åŒºä½¿ç”¨æƒ…å†µ" /></p><p>å¦‚æœä¸ºäº†èŠ‚çœç©ºé—´å’Œæ—¶é—´ï¼Œå¯ä»¥åªå°è¯•ä¸‹é¢çš„é…ç½®æ–¹å¼ï¼Œåªå®‰è£…riscv64-unknown-elf-gccï¼Œå‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œ<a href="https://blog.csdn.net/weiqi7777/article/details/88045720">riscvå„ç§ç‰ˆæœ¬gccå·¥å…·é“¾ç¼–è¯‘ä¸å®‰è£…_weiqi7777çš„åšå®¢-CSDNåšå®¢_riscvç¼–è¯‘å™¨</a><sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="riscvå„ç§ç‰ˆæœ¬gccå·¥å…·é“¾ç¼–è¯‘ä¸å®‰è£…_weiqi7777çš„åšå®¢-CSDNåšå®¢_riscvç¼–è¯‘å™¨">[2]</span></a></sup></p><p>å› ä¸ºåé¢è°ƒè¯•æ—¶åªç”¨åˆ°äº†riscv64-unknown-elf-gdbï¼Œæ‰€ä»¥æˆ‘çŒœæµ‹åªéœ€è¦å®‰è£…å¯¹åº”gccå·¥å…·å³å¯ï¼Œä¸è¿‡æˆ‘è‡ªå·²æ²¡æœ‰å°è¯•è¿‡å¯ä¸å¯è¡Œï¼Œæ‰€ä»¥è¿˜æ˜¯äº¤ç”±å„ä½çœ‹å®˜è‡ªè¡Œå†³å®šã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Shell">../configure --prefix=/opt/riscv64 --with-arch=rv64imc --with-abi=lp64<br>make<br></code></pre></td></tr></table></figure><h1 id="gdbè°ƒè¯•"><a class="markdownIt-Anchor" href="#gdbè°ƒè¯•"></a> GDBè°ƒè¯•</h1><ol><li>é¦–å…ˆåœ¨ä¸€ä¸ªçª—å£ä¸Šæ‰§è¡Œï¼š</li></ol><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">make qemu-gdb</span><br></code></pre></td></tr></table></figure><ol start="2"><li>ç„¶åæ‰“å¼€å¦ä¸€ä¸ªçª—å£ï¼Œæ‰§è¡Œï¼š</li></ol><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">riscv64-<span class="hljs-literal">unknown</span>-elf-gdb kernel/kernel<br></code></pre></td></tr></table></figure><ol start="3"><li>ç„¶åå¯ä»¥çœ‹åˆ°è¿›å…¥äº†gdbç•Œé¢ï¼Œæ¥ç€è¿œç¨‹è¿æ¥ä¸Šä¸€ä¸ªçª—å£çš„gdbï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</li></ol><p><code>target remote localhost:26000</code> ï¼ˆè¿™é‡Œçš„26000å¡«ä¸Šä¸€ä¸ªçª—å£çš„ç«¯å£å·ï¼‰</p><ol start="4"><li>è¿æ¥æˆåŠŸä¹‹åï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š</li></ol><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203200909360.(null)" alt="è¿œç¨‹è¿æ¥ç¨‹åº" /></p><ol start="5"><li>ç„¶åæŠŠè‡ªå·±ç¼–è¯‘å¥½çš„ç”¨æˆ·ç¨‹åºåŠ è½½è¿›æ¥ï¼Œä¹Ÿå°±æ˜¯userç›®å½•ä¸‹çš„æ–‡ä»¶<code>file user/_find</code></li></ol><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203200909713.(null)" alt="åŠ è½½è¦è°ƒè¯•çš„ç¼–è¯‘æ–‡ä»¶" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203200909785.(null)" alt="è®¾ç½®æ–­ç‚¹å¹¶æ‰§è¡Œ" /></p><ol start="6"><li>ç„¶åè®¾ç½®å¥½æ–­ç‚¹ï¼Œå°±å¯ä»¥æŒ‰ä¸‹ c è®©ç¨‹åºè¿è¡Œåˆ°æ–­ç‚¹å¤„ï¼Œå†è¿”å›ä¸Šä¸ªçª—å£ï¼Œæ‰§è¡Œå¯¹åº”å‘½ä»¤ï¼Œå°±å¯ä»¥çœ‹åˆ°ç¨‹åºæš‚åœä½äº†ï¼Œè¿”å›gdbè°ƒè¯•ç¨‹åºçª—å£ï¼Œä¹Ÿèƒ½çœ‹åˆ°å½“å‰æš‚åœçš„åœ°æ–¹å°±æ˜¯åˆšåˆšè®¾ç½®çš„æ–­ç‚¹å¤„ã€‚</li></ol><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203200909251.(null)" alt="è¿œç¨‹å†…æ ¸å¼€å§‹è¿è¡Œ" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203200910116.(null)" alt="gdbæŸ¥çœ‹å½“å‰æ–­ç‚¹" /></p><ol start="7"><li>ä¹‹åå°±æ˜¯ç—›è‹¦åœ°æ„‰å¿«åœ°è°ƒè¯•bugå•¦~æœ‰å…³gdbè°ƒè¯•æŠ€å·§ï¼Œè¿˜å¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰å†™çš„è¿™ç¯‡æ–‡ç« ï¼Œ<a href="http://gg.gg/y7c2n">GDBè°ƒè¯•å­¦ä¹ </a>ã€‚</li></ol><h1 id="è¸©å‘è®°å½•"><a class="markdownIt-Anchor" href="#è¸©å‘è®°å½•"></a> è¸©å‘è®°å½•</h1><p>è¿™æ¬¡å®‰è£…è¿‡ç¨‹ä¸­é‡åˆ°ä¸¤ä¸ªå‘ï¼Œä¸€ä¸ªæ˜¯åœ¨å…‹éš†ä»“åº“çš„æ—¶å€™ï¼Œè™šæ‹Ÿæœºæ— æ³•è®¿é—®å¤–ç½‘ï¼Œä¸€ä¸ªæ˜¯å®‰è£…riscvç¼–è¯‘å·¥å…·æ—¶ï¼Œåˆ†åŒºçš„å®¹é‡ä¸å¤Ÿäº†ï¼Œè¿™é‡Œå°±ç®€å•åœ°åšä¸ªè®°å½•ã€‚</p><h2 id="è™šæ‹Ÿæœºç½‘ç»œé…ç½®"><a class="markdownIt-Anchor" href="#è™šæ‹Ÿæœºç½‘ç»œé…ç½®"></a> è™šæ‹Ÿæœºç½‘ç»œé…ç½®</h2><p>ä¸€å¼€å§‹çš„éœ€æ±‚æ˜¯å®ç°è™šæ‹Ÿæœºå…±äº«ä¸»æœºçš„VPNï¼Œä¹Ÿèƒ½å¤Ÿè®¿é—®å¤–ç½‘ï¼Œå‚è€ƒäº†è¿™ç¯‡æ–‡ç« ï¼Œ<a href="https://www.jianshu.com/p/6c7abd4adc9b">Ubuntuè™šæ‹Ÿæœºå…±äº«ä¸»æœºVPNï¼ˆé€‚ç”¨äºNATæˆ–æ¡¥æ¥ï¼‰</a><sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="Ubuntuè™šæ‹Ÿæœºå…±äº«ä¸»æœºVPNï¼ˆé€‚ç”¨äºNATæˆ–æ¡¥æ¥ï¼‰">[3]</span></a></sup></p><p>å°è¯•ä¹‹åï¼ŒæŠ¥é”™ä»£ç†æœåŠ¡å™¨é”™è¯¯ï¼Œæ­£å¸¸çš„å›½å†…ç½‘é¡µæ— æ³•è®¿é—®äº†ã€‚å› ä¸ºè¿™ä¸ªæ—¶å€™æˆ‘ç”¨çš„æ˜¯NATæ¨¡å¼ï¼Œæ‰€ä»¥å°±æƒ³è¦å°è¯•ç”¨æ¡¥æ¥æ¨¡å¼å†è¯•ä¸€ä¸‹ã€‚</p><p>å‚è€ƒè¿™é‡Œçš„è§†é¢‘æ•™ç¨‹ <a href="https://www.bilibili.com/video/BV1ji4y1772Z?from=search&amp;seid=5722489325382065130&amp;spm_id_from=333.337.0.0">VMwareç½‘ç»œé€‰æ‹©å’Œubuntu 20_04 ç½‘ç»œé…ç½®æ•™ç¨‹</a><sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="VMwareç½‘ç»œé€‰æ‹©å’Œubuntu 20_04 ç½‘ç»œé…ç½®æ•™ç¨‹">[4]</span></a></sup>ï¼Œ</p><p>é…ç½®é™æ€IPçš„æ–¹å¼ï¼Œæˆ‘ä¹‹å‰ä¹Ÿæåˆ°è¿‡<a href="http://gg.gg/y7c4c">ã€99%ç¯å¢ƒæ­å»ºç³»åˆ—ã€‘äº‘è®¡ç®—ç®¡ç†å¹³å°Devstackå®‰è£…</a>ï¼Œåæ¥è™½ç„¶å›½å†…ç½‘ç»œèƒ½å¤Ÿæ­£å¸¸è®¿é—®äº†ï¼Œä½†æ˜¯å¤–ç½‘è¿˜æ˜¯ä¸è¡Œã€‚</p><p>åæ¥å°è¯•å¾ˆä¹…è¿˜æ˜¯æ²¡èƒ½æˆåŠŸï¼Œæœ€åä¹Ÿå°±ä½œç½¢äº†ã€‚æ—¢ç„¶å¤–ç½‘è®¿é—®ä¸äº†ï¼Œé‚£å°±æ‰¾å›½å†…é•œåƒå§ï¼Œå¹¸è¿çš„æ˜¯è¿™æ¡è·¯èµ°é€šäº†ã€‚</p><hr /><p>æœ€åæ²¡æœ‰å®ç°éœ€æ±‚ï¼Œæˆ‘æƒ³å¯èƒ½è¿˜æ˜¯è‡ªå·±å¯¹ç½‘ç»œçš„äº†è§£è¿˜æ˜¯å¤ªç²—æµ…äº†ï¼Œæ—¥åä¸€å®šè¦å†æ¶è¡¥ä¸€ä¸‹ã€‚ä¸è¿‡å€Ÿæ­¤æœºä¼šï¼Œä¹Ÿäº†è§£å­¦ä¹ äº†ä¸‹VPNã€æ¡¥æ¥æ¨¡å¼ã€NATæ¨¡å¼çš„æ¦‚å¿µï¼Œè¿™é‡Œåšä¸ªç®€å•æ€»ç»“å§ã€‚</p><p>VPNï¼šVitrual Private Networkï¼Œç®€å•æ¥è¯´å°±æ˜¯é€šä¿¡åŒæ–¹ä¹‹é—´çš„æ•°æ®è¿›è¡Œäº†åŠ å¯†ã€‚æ›´å¤šå†…å®¹å‚è€ƒ <a href="https://www.bilibili.com/video/BV1KY411t75D?from=search&amp;seid=9126546184192701202&amp;spm_id_from=333.337.0.0">VPNæ¦‚å¿µï¼ŒæŠ€æœ¯åŸç†å’Œè¯¯åŒº_å“”å“©å“”å“©_bilibili</a><sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="VPNæ¦‚å¿µï¼ŒæŠ€æœ¯åŸç†å’Œè¯¯åŒº_å“”å“©å“”å“©_bilibili">[5]</span></a></sup></p><p>æ¡¥æ¥æ¨¡å¼ï¼šè™šæ‹Ÿæœºä½¿ç”¨å®¿ä¸»æœºçš„çœŸå®ç½‘å¡ï¼Œå®¿ä¸»æœºå’Œè™šæ‹Ÿæœºåœ¨ç›¸åŒçš„å…¬ç½‘IPæ®µä¸‹ã€‚</p><p>NATæ¨¡å¼ï¼šè™šæ‹Ÿæœºå’Œå®¿ä¸»æœºä½¿ç”¨åŒä¸€ä¸ªè™šæ‹Ÿç½‘å¡ï¼Œä»è€Œå®ç°åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ç½‘æ®µä¸‹ï¼Œæ¯”å¦‚192.168.17.0 / 24ã€‚</p><h2 id="ubuntuæ·»åŠ ç£ç›˜åˆ†åŒº"><a class="markdownIt-Anchor" href="#ubuntuæ·»åŠ ç£ç›˜åˆ†åŒº"></a> ubuntuæ·»åŠ ç£ç›˜åˆ†åŒº</h2><p>è¿˜æœ‰ä¸€ä¸ªå‘å°±æ˜¯åœ¨ç¼–è¯‘å®‰è£…çš„æ—¶å€™ï¼Œç£ç›˜åˆ†åŒºå®¹é‡ä¸å¤Ÿäº†ã€‚æ‰€ä»¥è¿™é‡Œåœ¨æ¼”ç¤ºä¸€ä¸‹å¦‚ä½•ç»™linuxè™šæ‹Ÿæœºæ·»åŠ ç£ç›˜åˆ†åŒºã€‚</p><ol><li>é¦–å…ˆåœ¨VMware -&gt; è™šæ‹Ÿæœºé€‰é¡¹ -&gt; ç®¡ç†ï¼Œé€‰æ‹©æ‰©å±•ï¼Œæ·»åŠ æƒ³è¦å¢åŠ çš„åˆ†åŒºå®¹é‡ã€‚ï¼ˆæ³¨æ„éœ€è¦å…³é—­è™šæ‹Ÿæœºè¿›è¡Œè®¾ç½®)</li><li>æ­¤æ—¶æ˜¯è¿˜æ— æ³•ä½¿ç”¨æ–°å¢å®¹é‡çš„ï¼Œéœ€è¦åœ¨è™šæ‹Ÿæœºä¸Šæ·»åŠ åˆ†åŒºï¼Œå¹¶æŒ‚è½½æŸä¸€ç›®å½•ã€‚é‚£ä¹ˆé¦–å…ˆç™»é™†è™šæ‹Ÿæœºï¼Œæ·»åŠ åˆ†åŒºã€‚</li></ol><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs PowerShell"><span class="hljs-comment"># åˆ—å‡ºæ‰€æœ‰è®¾å¤‡ï¼Œæ‰¾åˆ° type ç±»å‹ä¸º disk çš„è®¾å¤‡åç§°</span><br>lsblk<br><br><span class="hljs-comment"># fdisk é€‚åˆMBRåˆ†åŒº </span><br>fdisk /dev/sda <span class="hljs-comment"># è¿™é‡Œçš„è®¾å¤‡åç§°å°±æ˜¯ä¸Šé¢æ‰¾åˆ°çš„è®¾å¤‡åç§°</span><br><br><span class="hljs-comment"># ç„¶åæŒ‰ n ï¼Œ æ–°å¢åˆ†åŒºï¼Œé€‰æ‹©ä¸€ä¸ªåŒºå·ï¼Œä¸€è·¯å›è½¦ï¼Œæœ€å w å†™å…¥ </span><br><span class="hljs-comment"># æ›´è¯¦ç»†çš„æ•™ç¨‹å¯ä»¥å‚è€ƒ https://www.cnblogs.com/rootshaw/p/12895022.html</span><br></code></pre></td></tr></table></figure><ol start="3"><li><p>æ·»åŠ å¥½åˆ†åŒºä¹‹åï¼Œå°±æ˜¯æ ¼å¼åŒ– <code>sudo mkfs.ext4 /dev/sda3</code> (è®¾å¤‡åæ¢æˆåˆšåˆšæ–°å¢çš„åˆ†åŒº)</p></li><li><p>ç„¶åå°±æ˜¯æŒ‚è½½ç›®å½•<code>sudo mount /dev/sda3 /opt/bin</code>ï¼ˆé€‰æ‹©è‡ªå·±éœ€è¦æŒ‚è½½çš„ç›®å½•ï¼‰</p></li><li><p>ä½¿ç”¨<code>df -h</code> å¯ä»¥çœ‹æ˜¯å¦æŒ‚è½½æˆåŠŸã€‚æŒ‚è½½æˆåŠŸä¹‹åå°±å¯ä»¥ä½¿ç”¨è¯¥åˆ†åŒºäº†ã€‚</p></li><li><p>ä¸Šé¢çš„æŒ‚è½½ï¼Œæ¯æ¬¡é‡å¯åéƒ½éœ€è¦æ‰‹åŠ¨é‡æ–°è®¾ç½®ï¼Œæ‰€ä»¥è¿™é‡Œå†å®ç°å¼€æœºè‡ªåŠ¨æŒ‚è½½ï¼Œå…¶å®å°±æ˜¯å¾€é…ç½®æ–‡ä»¶<code>/etc/fstab</code> é‡Œå†™é…ç½®ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">åˆ†åŒº/è®¾å¤‡å     è¦æŒ‚è½½çš„ç›®å½•     æ–‡ä»¶ç³»ç»Ÿç±»å‹     defaults        0       0<br>/dev/sda3   /opt/bin   ext4   defaults 0   0<br></code></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h1><p>è‡³æ­¤ï¼ŒæŠ˜è…¾äº†æˆ‘å¿«ä¸€æ˜ŸæœŸï¼Œæ€»è®¡è€—æ—¶çº¦10å°æ—¶çš„è°ƒè¯•ç¯å¢ƒå®‰è£…ä¹‹æ—…ç»ˆäºè½ä¸‹äº†å¸·å¹•ã€‚æ­¤æ—¶æ­¤åˆ»æˆ‘çš„å¿ƒæƒ…æ˜¯å¤æ‚çš„ï¼Œä¸€æ–¹é¢æ˜¯ä¸ºè‡ªå·±çš„æ— èƒ½è€Œæµæ³ªï¼ˆä¸€ä¸ªç®€å•çš„è°ƒè¯•ç¯å¢ƒæ­å»ºå¼„äº†è¿™ä¹ˆä¹…ï¼‰ï¼Œå…œå…œè½¬è½¬è¿™ä¹ˆä¹…ï¼Œä¹Ÿè¿˜åªæ˜¯å®Œæˆäº†è°ƒè¯•å‰çš„å‡†å¤‡å·¥ä½œï¼ŒæŸ¥bugè¿˜åœ¨åå¤´å‘¢ã€‚å¦ä¸€æ–¹é¢ä¹Ÿæ˜¯ä¸€ç§é‡Šç„¶ï¼Œè‡³å°‘æˆ‘æ²¡æœ‰åŠé€”è€ŒåºŸï¼Œè™½ç„¶è¿‡ç¨‹åå·ï¼Œä½†æˆ‘ç»ˆç©¶è¿˜æ˜¯æ¥åˆ°äº†ç»ˆç‚¹ã€‚æˆ–è®¸ä¸€å¼€å§‹æˆ‘å¯ä»¥å°è¯•ç”¨printè¾“å‡ºæ¥è°ƒè¯•ï¼Œä½†æ˜¯æˆ‘çŸ¥é“è¿™ç§è°ƒè¯•æ–¹å¼ç»ˆç©¶èµ°ä¸è¿œï¼Œå› ä¸ºçœŸæ­£å‡ºé—®é¢˜çš„æ—¶å€™ï¼Œæ˜¯æ²¡æœ‰åŠæ³•é€šè¿‡å®æ—¶è¾“å‡ºæ¥è¿›è¡Œè°ƒè¯•çš„ã€‚æ‰€ä»¥è¿™æ¬¡ä½¿ç”¨gdbæ¥è°ƒè¯•å†…æ ¸ï¼Œæ˜¯ä¸€ä¸ªåƒè½½éš¾é€¢çš„æœºä¼šï¼Œæˆ‘ä¸è¯¥é”™è¿‡ã€‚</p><hr /><p><em>ç¼“æ…¢çš„ã€æŒä¹…çš„ã€æœ‰çºªå¾‹çš„åŠªåŠ›ï¼Œæœ€ç»ˆä¼šå¯¼è‡´ä»¤äººéš¾ä»¥ç½®ä¿¡çš„ç»“æœã€‚</em></p><p><em>æ¯å½“æˆ‘æ— æ³•å¿å—æ—¥å¸¸ç”Ÿæ´»æ—¶ï¼Œæˆ‘å°±æé†’è‡ªå·±ï¼Œæ²¡æœ‰ä»€ä¹ˆæ¯”æ¯å¤©åšæŒåšä¸‹å»æ›´é‡è¦äº†ã€‚è™½ç„¶æˆ‘å¾ˆéš¾çœ‹åˆ°æœªæ¥ä¼šæ€æ ·ï¼Œä½†æˆ‘çŸ¥é“æŒä¹…æ€§å…·æœ‰å¼ºå¤§çš„å¨åŠ›ï¼Œå°±åƒä¸€å¥å¤è€æ ¼è¨€è¯´çš„â€œç»§ç»­å»åšâ€ï¼ˆkeep doingï¼‰ã€‚</em></p><p>â€”â€”<a href="https://www.collaborativefund.com/blog/lessons-from-the-sea/">ã€Šå¤§æµ·æ•™ç»™æˆ‘çš„ã€‹</a></p><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://blog.csdn.net/qq_35990574/article/details/110006307">riscv-gnu-toolchainå·¥å…·é“¾ä¸‹è½½å®‰è£…_roockietçš„åšå®¢</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://blog.csdn.net/weiqi7777/article/details/88045720">riscvå„ç§ç‰ˆæœ¬gccå·¥å…·é“¾ç¼–è¯‘ä¸å®‰è£…_weiqi7777çš„åšå®¢-CSDNåšå®¢_riscvç¼–è¯‘å™¨</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.jianshu.com/p/6c7abd4adc9b">Ubuntuè™šæ‹Ÿæœºå…±äº«ä¸»æœºVPNï¼ˆé€‚ç”¨äºNATæˆ–æ¡¥æ¥ï¼‰</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://www.bilibili.com/video/BV1ji4y1772Z?from=search&amp;seid=5722489325382065130&amp;spm_id_from=333.337.0.0">VMwareç½‘ç»œé€‰æ‹©å’Œubuntu 20_04 ç½‘ç»œé…ç½®æ•™ç¨‹</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://www.bilibili.com/video/BV1KY411t75D?from=search&amp;seid=9126546184192701202&amp;spm_id_from=333.337.0.0">VPNæ¦‚å¿µï¼ŒæŠ€æœ¯åŸç†å’Œè¯¯åŒº_å“”å“©å“”å“©_bilibili</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¯å¢ƒæ­å»ºç³»åˆ—</category>
      
      <category>æ“ä½œç³»ç»Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>xv6-riscv</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GitæŒ‡å—</title>
    <link href="/2022/03/12/2022-03/2022-03-12%20Git%E6%8C%87%E5%8D%97/"/>
    <url>/2022/03/12/2022-03/2022-03-12%20Git%E6%8C%87%E5%8D%97/</url>
    
    <content type="html"><![CDATA[<h1 id="åŸºæœ¬æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#åŸºæœ¬æ¦‚å¿µ"></a> åŸºæœ¬æ¦‚å¿µ</h1><h2 id="ç®€å•ä»‹ç»"><a class="markdownIt-Anchor" href="#ç®€å•ä»‹ç»"></a> ç®€å•ä»‹ç»</h2><p>Gitæ˜¯ç›®å‰ä¸–ç•Œä¸Šæœ€å…ˆè¿›çš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆæ²¡æœ‰ä¹‹ä¸€ï¼‰ã€‚Gitæ˜¯ç”±Linuxå†…æ ¸ç¤¾åŒºä»¥Linusä¸ºä¸»åŸºäºBitKeeperå¼€å‘çš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå…·æœ‰å¿«é€Ÿã€ç®€å•ã€åˆ†å¸ƒå¼ã€èƒ½å¤Ÿé«˜æ•ˆç®¡ç†å¤§è§„æ¨¡é¡¹ç›®çš„ç‰¹ç‚¹ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203121131335.cn&amp;app=2002&amp;size=f9999,10000&amp;q=a80&amp;n=0&amp;g=0n&amp;fmt=auto" alt="" /></p><h2 id="æœ¬åœ°ä»“åº“ç»“æ„"><a class="markdownIt-Anchor" href="#æœ¬åœ°ä»“åº“ç»“æ„"></a> æœ¬åœ°ä»“åº“ç»“æ„</h2><p>Gitæœ¬åœ°ä»“åº“é€»è¾‘ç»“æ„å¯ä»¥åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š</p><ul><li>å·¥ä½œåŒº Working Directoryï¼šå°±æ˜¯å­˜æ”¾é¡¹ç›®æ–‡ä»¶ã€ä»£ç çš„åœ°æ–¹ï¼Œå¯¹äºæ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤æ–‡ä»¶çš„æ“ä½œï¼Œéƒ½å‘ç”Ÿåœ¨å·¥ä½œåŒºä¸­ï¼›</li><li>æš‚å­˜åŒº Staging Areaã€Indexï¼šç”¨äºä¸´æ—¶å­˜æ”¾ä½ çš„æ”¹åŠ¨ï¼Œå°†å·¥ä½œåŒºä¸­çš„æ“ä½œè¿›è¡Œä¿å­˜ï¼›</li><li>ç‰ˆæœ¬åº“ Repositoryï¼šæŠŠæ‰€æœ‰çš„commitç»„ç»‡èµ·æ¥ï¼Œä¹Ÿå°±æ˜¯ä¿å­˜æ‰€æœ‰æäº¤çš„æ•°æ®ï¼Œè®°å½•å†å²ç‰ˆæœ¬ã€‚</li></ul><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203121132711.png" alt="" style="zoom:50%;" /></center>ä¸Šå›¾ä¹Ÿæç»˜äº†åŸºæœ¬çš„å·¥ä½œæµç¨‹ï¼Œå½“ä½ åœ¨å·¥ä½œåŒºå®Œæˆé˜¶æ®µæ€§æ“ä½œåï¼Œå°±å¯ä»¥æ‰§è¡Œ`add`å‘½ä»¤ï¼Œå°†ä¿®æ”¹ä¿å­˜åˆ°æš‚å­˜åŒºã€‚å½“ä½ è§‰å¾—å®Œæˆè¿™æ¬¡å¼€å‘åï¼Œå°±å¯ä»¥æ‰§è¡Œ`commit`å‘½ä»¤ï¼Œæäº¤åˆ°ç‰ˆæœ¬åº“ã€‚æ­¤å¤–`.git`è¿™ä¸ªç›®å½•æ˜¯åœ¨gitè‡ªå¸¦çš„ä¸€ä¸ªéšè—é¡¹ç›®ï¼Œåœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œé‡Œé¢çš„å„ä¸ªç›®å½•å°±è®°å½•ç€å®ç°ç‰ˆæœ¬æ§åˆ¶æ‰€éœ€çš„æ•°æ®ï¼Œä¾‹å¦‚å¯¹è±¡åº“ï¼Œå¯¹è±¡æ¦‚å¿µå°†åœ¨ç¨åä»‹ç»ã€‚<p>ç½‘ä¸Šä¹Ÿæœ‰ä¸å°‘å…³äºgitçš„æ–‡ç« ï¼Œä¸‹å›¾æ¥è‡ªäºè¿™ç¯‡æ–‡ç« <a href="https://www.cnblogs.com/qdhxhz/p/9757390.html">Gitï¼šå·¥ä½œåŒºã€æš‚å­˜åŒºã€ç‰ˆæœ¬åº“ã€è¿œç¨‹ä»“åº“</a><sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="ã€Gitã€‘(1)â€”å·¥ä½œåŒºã€æš‚å­˜åŒºã€ç‰ˆæœ¬åº“ã€è¿œç¨‹ä»“åº“ ">[1]</span></a></sup>ï¼Œæ›´ä¸ºè¯¦ç»†åœ°å±•ç¤ºäº†gitæ•´ä¸ªæµç¨‹ã€‚å…¶ä¸­ Remote è¡¨ç¤ºæ˜¯è¿œç¨‹ä»“åº“ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä»£ç æ‰˜ç®¡çš„æœåŠ¡å™¨/è¿œç¨‹å¤‡ä»½ï¼Œåƒæˆ‘ä»¬æœ€ä¸ºç†ŸçŸ¥çš„å°±æ˜¯Githubã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203121139228.png" alt="gitåŸºæœ¬æµç¨‹" /></p><h2 id="gitä¸­çš„å¯¹è±¡"><a class="markdownIt-Anchor" href="#gitä¸­çš„å¯¹è±¡"></a> Gitä¸­çš„å¯¹è±¡</h2><p>Gitä¸­æœ‰ä¸‰ç§åŸºæœ¬å¯¹è±¡ï¼š</p><ol><li>blobï¼šæ–‡ä»¶ï¼Œä¿å­˜æ–‡ä»¶çš„æ•°æ®å†…å®¹</li><li>treeï¼šç›®å½•æ ‘ï¼Œä¿å­˜ç›®å½•ç»“æ„å’Œæ–‡ä»¶åç­‰ä¿¡æ¯</li><li>commitï¼šæäº¤ï¼Œä¿å­˜æäº¤å†…å®¹ã€ä½œè€…ã€æäº¤è€…ã€æäº¤æ—¶é—´ç­‰ä¿¡æ¯</li></ol><blockquote><p>æ³¨æ„ï¼šè¿™é‡Œè¯´çš„æ˜¯åŸºæœ¬å¯¹è±¡ï¼Œè¿˜æœ‰è¯´æ³•æ˜¯tagä¹Ÿæ˜¯ä¸€ç§å¯¹è±¡ï¼Œç”¨æ¥æ ‡è®°æŸä¸€æ¬¡æäº¤(commit) ï¼Œç±»ä¼¼äºé‡Œç¨‹ç¢‘çš„ä¸€ç§è®°å½•</p></blockquote><p>è€Œå¯¹è±¡æœ‰å¯¹è±¡åï¼Œæ˜¯40ä¸ªå­—ç¬¦ï¼ˆ20å­—èŠ‚çš„16è¿›åˆ¶è¡¨ç¤ºï¼‰çš„å­—ç¬¦ä¸²ï¼Œç”±SHA-1è®¡ç®—æ–‡ä»¶å†…å®¹çš„å“ˆå¸Œå€¼ï¼Œå½“æ²¡æœ‰å†²çªæ­§ä¹‰çš„æ—¶å€™ï¼Œå¯ä»¥å°±ç”¨å‰å‡ ä½å­—ç¬¦è¡¨ç¤ºï¼ˆä½†ä¸å¯ä»¥å°‘äº4ä½ï¼‰ã€‚</p><p>åœ¨gitä¸­ï¼Œå¯¹è±¡ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒcommitåŒ…å«ä¸€ä¸ªtreeå¯¹è±¡ï¼ˆä¸»ç›®å½•ï¼‰ï¼Œè€Œä¸€ä¸ªtreeå¯¹è±¡å¯ä»¥åŒ…å«å¤šä¸ªblobï¼ˆæ–‡ä»¶ï¼‰å’Œå¤šä¸ªtreeï¼ˆå­ç›®å½•ï¼‰ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203121202585.png" alt="blob,tree,commitä¹‹é—´çš„å…³ç³»" /></p><p>å¯ä»¥ç”¨<code>get cat-file -t [å¯¹è±¡å]</code>æŸ¥çœ‹æŸä¸ªå¯¹è±¡çš„ç±»å‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¯¥å¯¹è±¡æ˜¯ä¸€ä¸ªtreeï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203121719515.png" alt="æŸ¥çœ‹å¯¹è±¡ç±»å‹" /></p><p>å¯ä»¥ç”¨<code>get cat-file -p [å¯¹è±¡å]</code>æŸ¥çœ‹æŸä¸ªå¯¹è±¡çš„å†…å®¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°è¯¥treeå¯¹è±¡ä¸‹æœ‰ä¸€ä¸ªblobæ–‡ä»¶ï¼Œå’Œä¸¤ä¸ªtreeå¯¹è±¡ï¼ˆä¸¤ä¸ªå­ç›®å½•ï¼‰ï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203121719712.png" alt="æŸ¥çœ‹å¯¹è±¡å†…å®¹" /></p><h1 id="å•åˆ†æ”¯ç®¡ç†"><a class="markdownIt-Anchor" href="#å•åˆ†æ”¯ç®¡ç†"></a> å•åˆ†æ”¯ç®¡ç†</h1><h2 id="åˆå§‹åŒ–å’Œæäº¤"><a class="markdownIt-Anchor" href="#åˆå§‹åŒ–å’Œæäº¤"></a> åˆå§‹åŒ–å’Œæäº¤</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å°†è‡ªåŠ¨åœ°åœ¨å½“å‰ç›®å½•å®Œæˆç‰ˆæœ¬åº“çš„åˆå§‹åŒ–ï¼Œå³åœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª.gitçš„éšè—ç›®å½•</span><br>git init<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> å°†è‡ªåŠ¨åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæŒ‡å®šé¡¹ç›®åçš„ç›®å½•ï¼Œå¹¶åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º.gitçš„éšè—ç›®å½•</span><br>git init &lt;é¡¹ç›®å&gt;<br></code></pre></td></tr></table></figure><p>ä¸€ä¸ªæ–°çš„<code>.git</code>ç›®å½•ä¸‹é€šå¸¸ä¼šåŒ…æ‹¬7ä¸ªæ–‡ä»¶/ç›®å½•ï¼š</p><ul><li>hooksï¼šåŒ…å«å®¢æˆ·ç«¯æˆ–æœåŠ¡ç«¯çš„é’©å­è„šæœ¬ï¼ˆhooks scripts)</li><li>infoï¼šé»˜è®¤åŒ…å«ä¸€ä¸ªå…¨å±€æ€§å¿½ç•¥æ–‡ä»¶</li><li>objectsï¼šå­˜å‚¨æ‰€æœ‰çš„å¯¹è±¡</li><li>refsï¼šå­˜å‚¨æ‰€æœ‰åˆ†æ”¯å’Œtagï¼ˆæŒ‡å‘commitå¯¹è±¡çš„æŒ‡é’ˆï¼‰</li><li>configï¼šç‰ˆæœ¬åº“çº§åˆ«çš„é…ç½®æ–‡ä»¶</li><li>descriptionï¼šä»…ä¾›GitWebç¨‹åºä½¿ç”¨</li><li>HEADï¼šå½“å‰æŒ‡é’ˆï¼Œç”¨äºå½“å‰æ“ä½œ</li></ul><p>è€Œå½“è¿›è¡Œaddæ“ä½œä¹‹åå°±ä¼šå‡ºç°ä¸€ä¸ªindexæ–‡ä»¶</p><ul><li>indexï¼šä¿å­˜æš‚å­˜åŒºçš„ä¿¡æ¯</li></ul><hr /><p>æœ€ä¸ºå¸¸ç”¨çš„å°±æ˜¯<code>add</code>å’Œ<code>commit</code>çš„å‘½ä»¤äº†ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å°†pathæ‰€æŒ‡å®šçš„ç›®å½•æˆ–æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº</span><br>git add &lt;path&gt;<br><span class="hljs-meta">#</span><span class="bash"> å°†æš‚å­˜åŒºä¸­&lt;path&gt;æ‰€æŒ‡å®šçš„ç›®å½•æˆ–æ–‡ä»¶æ·»åŠ åˆ°ç‰ˆæœ¬åº“ï¼ŒåŒæ—¶äº§ç”Ÿä¸€ä¸ªæ–°çš„commitï¼Œpathé»˜è®¤ä¸ºå½“å‰ç›®å½•</span><br>git commit [&lt;path&gt;] -m &quot;&lt;æäº¤è¯´æ˜&gt;&quot;<br></code></pre></td></tr></table></figure><p>ä½†å…¶å®è¿™ä¸¤ä¸ªå‘½ä»¤ï¼Œæ˜¯ç”±è®¸å¤šä¸ªæ›´åº•å±‚çš„å‘½ä»¤ç»„æˆçš„ï¼š</p><ul><li><code>git update-index --add --cacheinfo</code> å‘½ä»¤å°†å¯¹è±¡åº“ä¸­çš„blobæ·»åŠ åˆ°æš‚å­˜åŒº</li><li><code>git update-index --add</code> å°†å·¥ä½œåŒºä¸­çš„æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºï¼ˆåŒæ—¶åœ¨å¯¹è±¡åº“ä¸­ç”Ÿæˆblobå¯¹è±¡ï¼‰</li><li><code>git write-tree</code> å‘½ä»¤æ ¹æ®å½“å‰æš‚å­˜åŒºå†…å®¹åœ¨å¯¹è±¡åº“ä¸­æ–°å»ºä¸€ä¸ªtreeå¯¹è±¡</li><li><code>git read-tree</code> å‘½ä»¤å°†treeå¯¹è±¡è¯»åˆ°æš‚å­˜åŒº</li><li><code>git commit-tree</code> å‘½ä»¤å¯ä»¥å°†æŒ‡å®šçš„treeå¯¹è±¡â€å°è£…â€œæˆcommitå¯¹è±¡ä¿å­˜åœ¨ç‰ˆæœ¬åº“ä¸­</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203121911543.png" alt="addå’Œcommitçš„å‘½ä»¤åˆ†è§£" /></p><h2 id="æäº¤å†å²å’Œç®¡ç†"><a class="markdownIt-Anchor" href="#æäº¤å†å²å’Œç®¡ç†"></a> æäº¤å†å²å’Œç®¡ç†</h2><p>è¿™é‡Œå°±åˆ—ä¸¾ä¸€äº›æ¯”è¾ƒå…³é”®å¸¸ç”¨çš„å‘½ä»¤å§ï¼š</p><ul><li><code>git diff</code> ï¼šå¯ä»¥æ˜¾ç¤ºå·¥ä½œåŒºã€æš‚å­˜åŒºã€ç‰ˆæœ¬åº“ä¸­æ–‡ä»¶å…·ä½“çš„å·®åˆ«</li><li><code>git log [-n]</code> ï¼šæ˜¾ç¤ºæœ€è¿‘æäº¤çš„commitè®°å½•ï¼›<code>-n</code> å‚æ•°è¡¨ç¤ºæ˜¾ç¤ºæœ€è¿‘næ¡è®°å½•ï¼›è¿˜å¯ä»¥é€šè¿‡æ·»åŠ  <code>--pretty=raw</code> å‚æ•°æ¥æ˜¾ç¤ºcommitå¯¹è±¡çš„å†…å®¹</li><li><code>git status</code>ï¼šæ˜¾ç¤ºå·¥ä½œåŒºã€æš‚å­˜åŒºã€ç‰ˆæœ¬åº“ä¸­æ–‡ä»¶å¢åˆ æ”¹çš„æƒ…å†µ</li><li><code>git stash [list | [pop|apply] [--index] [stashå] ]</code>ï¼šå°†å½“å‰çš„ä¿®æ”¹è¿›åº¦æš‚æ—¶ä¿å­˜èµ·æ¥<ul><li>æ²¡æœ‰å‚æ•°å°±æ˜¯ç°åœºä¿å­˜</li><li>å‚æ•°ä¸ºlistè¡¨ç¤ºæŸ¥çœ‹ä¿å­˜ç°åœºçš„æ ˆçš„å†…å®¹</li><li>å‚æ•°ä¸ºpopæˆ–applyè¡¨ç¤ºå°†æ ˆä¸­çš„å†…å®¹æ¢å¤ï¼ŒåŒºåˆ«åœ¨äºpopåæ ˆçš„è®°å½•ä¼šè¢«åˆ é™¤è€Œapplyä¸ä¼š</li></ul></li><li><code>git blame &lt;æ–‡ä»¶å&gt;</code> ï¼šå¯ä»¥æŒ‰è¡ŒæŸ¥çœ‹æŒ‡å®šæ–‡ä»¶çš„æœ€åä¸€æ¬¡ä¿®æ”¹çš„commitï¼Œä¿®æ”¹äººï¼Œæ—¶é—´</li></ul><h1 id="å¤šåˆ†æ”¯ç®¡ç†"><a class="markdownIt-Anchor" href="#å¤šåˆ†æ”¯ç®¡ç†"></a> å¤šåˆ†æ”¯ç®¡ç†</h1><p><strong>æ¸¸æ ‡ï¼ˆheadï¼‰</strong>ï¼šå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘æŸä¸ªç‰¹å®šçš„commitå¯¹è±¡æˆ–è€…åˆ†æ”¯ï¼Œå³å½“å‰æ“ä½œçš„é»˜è®¤å¯¹è±¡ï¼Œå¦‚git logï¼Œgit statusç­‰å‘½ä»¤ä¸­ï¼Œç‰ˆæœ¬åº“çš„å½“å‰æ“ä½œcommitå°±æ˜¯headæ‰€æŒ‡å‘çš„commitå¯¹è±¡ã€‚</p><p><strong>åˆ†æ”¯ï¼ˆbranchï¼‰</strong>ï¼šå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘äº†ä¸€ä¸ªæäº¤ï¼ˆcommitï¼‰ï¼Œåœ¨è¯¥åˆ†æ”¯ä¸Šçš„æ‰€æœ‰æäº¤éƒ½ä¼šå¯¹è¯¥åˆ†æ”¯è¿›è¡Œæ›´æ–°ï¼Œä¿è¯è¯¥åˆ†æ”¯ä¸€ç›´æŒ‡å‘æœ€æ–°çš„commit</p><blockquote><p>æ³¨æ„ï¼šheadå¯ä»¥æŒ‡å‘åˆ†æ”¯æˆ–è€…commitï¼Œä½†æ˜¯åˆ†æ”¯æ€»æ˜¯æŒ‡å‘commit</p></blockquote><p><strong>ç»å…¸åœºæ™¯</strong>ï¼šåŠŸèƒ½ç‰¹æ€§çš„å¼€å‘â€”â€”åœ¨æ·»åŠ ä¸€ä¸ªæ–°åŠŸèƒ½æ—¶å¯ä»¥é€šè¿‡å†æ–°çš„åˆ†æ”¯ä¸Šè¿›è¡Œå¼€å‘ï¼Œä»è€Œä½¿å¾—åŠŸèƒ½ç‰¹æ€§çš„å¼€å‘ä¸ä¼šå½±å“åˆ°æ­£å¸¸çš„ç‰ˆæœ¬è¿­ä»£ï¼Œåœ¨å¼€å‘å®Œæˆåå†é€šè¿‡åˆ†æ”¯çš„åˆå¹¶å°†è¯¥åŠŸèƒ½æ·»åŠ åˆ°æœ€æ–°çš„ç‰ˆæœ¬ä¸Šã€‚</p><ul><li><code>git branch &lt;åˆ†æ”¯å&gt;</code>ï¼šè¯¥å‘½ä»¤å¯ä»¥åœ¨å½“å‰headæŒ‡å‘çš„commitä½ç½®åˆ›å»ºä¸€ä¸ªæŒ‡å®šåˆ†æ”¯åçš„branchåˆ†æ”¯ã€‚masterå°±æ˜¯ä¸€ä¸ªbranch</li><li><code>git checkout [-b] &lt; commit &gt;</code>ï¼šè¯¥å‘½ä»¤çš„ä¸»è¦åŠŸèƒ½ä¸ºæ”¹å˜headæ¸¸æ ‡ï¼Œå°†å…¶æŒ‡å‘commit<ul><li>å› ä¸ºbranchå’Œtagæœ¬è´¨ä¸Šéƒ½æ˜¯ä¸€ä¸ªcommitå¯¹è±¡ï¼Œæ‰€ä»¥è¿™é‡Œç”¨äº†&lt; commit &gt;å‚æ•°ï¼Œå…¶å®ä¹Ÿå¯ä»¥å†™æˆåˆ†æ”¯å</li><li><code>-b</code> å‚æ•°æ˜¯åˆ›å»ºå¹¶åˆ‡æ¢</li></ul></li></ul><p>æœ‰æ—¶å€™åœ¨æ“ä½œåˆ‡æ¢åˆ†æ”¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°ä¸€ä¸ªå¾ˆç»å…¸çš„é—®é¢˜ï¼š<strong>åˆ†ç¦»å¤´æŒ‡é’ˆçŠ¶æ€(detached HEAD)</strong>ã€‚è¯¥çŠ¶æ€è¡¨æ˜å½“å‰headæ²¡æœ‰æŒ‡å‘ä»»ä½•è®¤çŸ¥ï¼Œè€Œæ˜¯æŒ‡å‘äº†ä¸€ä¸ªç‹¬ç«‹çš„commitï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203121937329.png" alt="åˆ†ç¦»å¤´æŒ‡é’ˆçŠ¶æ€" /></p><p>æƒ³è¦æ¢å¤ä¹Ÿå¾ˆç®€å•ï¼Œä½¿ç”¨checkoutå‘½ä»¤åˆ‡æ¢åˆ°ä¸€ä¸ªåˆ†æ”¯ä¸Šå³å¯ã€‚</p><hr /><p>åˆ†æ”¯ä¼šéšç€commitçš„æäº¤è€Œæ›´æ–°ï¼Œä½†æ˜¯æœ‰æ—¶å€™éœ€è¦è®°å½•ä¸€ä¸ªç¨³å®šçš„ç‰ˆæœ¬ï¼Œå¦‚v1.1ï¼Œv1.2ï¼Œæ­¤æ—¶å°±éœ€è¦å¼•å…¥tagã€‚</p><p>tagå¯ä»¥è®°å½•æŸä¸ªç‰¹å®šçš„commitï¼Œå¹¶ä½¿å…¶ä¸éšç€commitçš„æäº¤è€Œæ”¹å˜å…¶æŒ‡å‘çš„commitä½ç½®ã€‚tagå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªæŒ‡å‘commitçš„å¸¸é‡æŒ‡é’ˆï¼Œæ‰€æœ‰å¯¹commitçš„æ“ä½œéƒ½å¯ä»¥å¯¹tagä½¿ç”¨ã€‚</p><ul><li><code>git tag &lt; tagå &gt;</code>ï¼šå¯ä»¥åœ¨å½“å‰headæŒ‡å‘çš„commitä½ç½®å»ºç«‹ä¸€ä¸ªæŒ‡å®štagåçš„tag</li></ul><hr /><p>å½“å‰éœ€è¦å¯¹åˆ†æ”¯è¿›è¡Œä¿®æ”¹/é‡ç½®çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼Œå°†å½“å‰åˆ†æ”¯æŒ‡å‘æŸcommit</p><ul><li><code>git reset [--soft | --mixed | --head] &lt; commit &gt;</code><ul><li>ä¸­é—´å‚æ•°é»˜è®¤ä¸º --mixed</li><li><code>--soft</code>ï¼šä¼šå°†å½“å‰æŒ‡å‘çš„branchæŒ‡å‘æŒ‡å®šçš„commit</li><li><code>--mixed</code>ï¼ˆæˆ–æ— å‚æ•°ï¼‰ï¼šé™¤äº†æ”¹å˜branchçš„ä½ç½®å¤–ï¼Œè¿˜ä¼šä½¿ç”¨è¯¥commitçš„å†…å®¹æ›´æ–°<strong>æš‚å­˜åŒº</strong>çš„å†…å®¹</li><li><code>--hard</code> ï¼šé™¤äº†æ”¹å˜branchçš„ä½ä¹‹å¤–ï¼Œè¿˜ä¼šç”¨è¯¥commitçš„å†…å®¹æ›´æ–°<strong>æš‚å­˜åŒºå’Œå·¥ä½œåŒº</strong>çš„å†…å®¹ï¼ˆ<strong>å±é™©æ“ä½œï¼è´¸ç„¶ä½¿ç”¨å®¹æ˜“ä¸¢å¤±å½“å‰å·¥ä½œåŒºçš„ä¿®æ”¹</strong>ï¼‰</li></ul></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203121946975.png" alt="åˆ†æ”¯ä¿®æ”¹" /></p><hr /><p>è¿˜æœ‰å‡ ä¸ªåˆ†æ”¯ç›¸å…³çš„é‡è¦å‘½ä»¤ï¼š</p><ul><li><p><code>git merge &lt; commit &gt;</code>ï¼šå°†å½“å‰headæ‰€æŒ‡å‘çš„åˆ†æ”¯å’ŒæŒ‡å®šcommitåˆ†æ”¯è¿›è¡Œåˆå¹¶ï¼Œæœ€åä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„commitï¼Œè¯¥commitçš„parentæŒ‡é’ˆåŒæ—¶æŒ‡å‘ä¸¤ä¸ªcommit</p></li><li><p><code>git rebase &lt; commit &gt;</code>ï¼š å˜åŸºæ“ä½œï¼Œè¯¥å‘½ä»¤å°†æäº¤åˆ°æŸä¸€åˆ†æ”¯ä¸Šçš„æ‰€æœ‰ä¿®æ”¹éƒ½ç§»è‡³å¦ä¸€åˆ†æ”¯ä¸Š</p></li><li><p><code>git rebase -i HEAD~3</code> ï¼š -i é€‰é¡¹è¿›å…¥äº¤äº’å¼ç•Œé¢ï¼Œå¯ä»¥å¯¹å‰ä¸‰ä¸ªcommitè¿›è¡Œå‹ç¼©</p></li></ul><p>å…³äºmergeå’Œrebaseçš„ç›¸å…³æ¦‚å¿µå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« <a href="https://www.imooc.com/article/316077">git rebase å’Œ merge çš„åŒºåˆ«</a><sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="git rebase å’Œ merge çš„åŒºåˆ«">[2]</span></a></sup>ï¼Œè¿™é‡Œå°±ä¸å†é‡å¤é€ è½®å­äº†ï¼Œä¸‹å›¾å°±æ˜¯ç®€å•ç¤ºæ„ï¼Œä¸Šé¢æ˜¯mergeåçš„åˆ†æ”¯å˜åŒ–ï¼Œä¸‹é¢æ˜¯rebaseåçš„åˆ†æ”¯å˜åŒ–ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203122020985.png" alt="mergeï¼ˆä¸Šï¼‰rebaseï¼ˆä¸‹ï¼‰" /></p><h1 id="å¤šäººåä½œ"><a class="markdownIt-Anchor" href="#å¤šäººåä½œ"></a> å¤šäººåä½œ</h1><p>å¤šäººåä½œæ—¶å°±ä¼šæ¶‰åŠè¿œç¨‹ä»“åº“çš„æ¦‚å¿µï¼Œç®€å•ç†è§£å°±æ˜¯è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„gitç‰ˆæœ¬åº“ã€‚ç›®å‰å¸¸è§çš„åŸºäºgitçš„ä»£ç æ‰˜ç®¡å¹³å°æœ‰Githubã€Giteeã€Gitlabç­‰ï¼Œå¯ä»¥ç®€å•çš„æŠŠä»£ç æ‰˜ç®¡å¹³å°çœ‹æˆæ›´æ˜¯ä¸€ä¸ªè¿œç¨‹çš„gitä»“åº“ï¼Œé€šè¿‡pushã€fetchç­‰å‘½ä»¤æ¥è¿›è¡Œæ“ä½œã€‚</p><p>è¿™é‡Œå°±ç®€å•ç½—åˆ—ç›¸å…³å‘½ä»¤ï¼š</p><ul><li><code>git clone</code> ï¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºæŒ‡å®šçš„gitä»“åº“çš„å…‹éš†</li><li><code>git push</code>ï¼šå°†å½“å‰æŒ‡å‘çš„åˆ†æ”¯æ¨é€è‡³è¿œç¨‹ç‰ˆæœ¬åº“</li><li><code>git fetch</code>ï¼šå°†è¿œç¨‹ç‰ˆæœ¬åº“ä¸­æœ¬åœ°æ²¡æœ‰çš„è®°å½•æ‹‰å–åˆ°æœ¬åœ°</li><li><code>git pull</code>ï¼šè¯¥å‘½ä»¤ç­‰äº<code>git fetch</code> åŠ  <code>git merge [fetchå‘½ä»¤è·å¾—çš„head]</code></li><li><code>git remote -v</code> ï¼šå¯ä»¥æŸ¥çœ‹å½“å‰ä½¿ç”¨pushã€fetchã€pullå‘½ä»¤åŒæ­¥çš„è¿œç¨‹ç‰ˆæœ¬åº“</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203122027018.png" alt="å¤šäººåä½œå¼€å‘" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203122030217.png" alt="å¤§å‹é¡¹ç›®åä½œå¼€å‘" /></p><p>Githubä¸Šé¡¹ç›®çš„å¼€å‘æµç¨‹å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¦‚æœæˆ‘ä»¬å¯¹åˆ«äººçš„é¡¹ç›®æ„Ÿå…´è¶£ï¼Œå¯ä»¥é€šè¿‡forkæ“ä½œï¼Œå°†ä»–äººçš„é¡¹ç›®ä»“åº“å¤åˆ¶ä¸€ä¸ªè‡ªå·±çš„é¡¹ç›®ä»“åº“ï¼Œç„¶åé€šè¿‡fetchã€pushå¯¹ä¸ªäººä»“åº“è¿›è¡Œæ“ä½œã€‚è€Œé€šè¿‡Pull requestsæ“ä½œï¼Œå¯ä»¥ç”³è¯·å°†è‡ªå·±ä¸ªäººä»“åº“ä¸Šçš„ç‰¹å®šåˆ†æ”¯ä¸ä»–äººä»“åº“ä¸Šçš„ç‰¹å®šåˆ†æ”¯è¿›è¡Œåˆå¹¶ã€‚</p><hr /><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬æŠŠå¸¦æœ‰bugçš„åˆ†æ”¯æäº¤åˆ°è¿œç«¯ï¼Œå¹¶åˆå…¥äº† master ï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ° <code>git revert</code>å‘½ä»¤æ¥æ’¤é”€ commit ä¿®æ”¹ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ <a href="https://blog.csdn.net/liuxiao723846/article/details/122691779">git revert å‘½ä»¤</a> ã€‚è¿›ä¸€æ­¥çš„ï¼Œæ€è€ƒè¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œå¦‚æœä¸€ä¸ª repo çš„è¿è¥äººå‘˜ä¸å°å¿ƒåœ¨æäº¤çš„ commit ä¸Šæš´éœ²äº†éšç§ä¿¡æ¯ï¼ˆä¾‹å¦‚æ•°æ®åº“è´¦å·å¯†ç ï¼‰ï¼Œé‚£ä¹ˆæ­¤æ—¶åº”è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ è¿™é‡Œæˆ‘æä¾›çš„æ€è·¯æ˜¯ï¼Œæœ¬åœ°ä½¿ç”¨ <code>git reset --hard</code>æ¥é‡ç½®commit å†å²ï¼Œå¹¶è¦†ç›–è¿œç¨‹åˆ†æ”¯ã€‚</p><h1 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h1><p>å¤§ä½“ä¸ŠæŠŠgité‡è¦çš„çŸ¥è¯†ç‚¹éƒ½ä»‹ç»äº†ä¸€ä¸‹ï¼Œä½†å®é™…ä¸Šä¸»è¦å¸¸ç”¨çš„å‘½ä»¤å¯èƒ½å°±é‚£ä¹ˆå‡ ä¸ªï¼Œaddã€commitã€pushã€pullã€mergeã€rebaseã€checkoutï¼ŒæŠŠè¿™å‡ ä¸ªå‘½ä»¤ç”¨ç†Ÿäº†åŸºæœ¬å¤Ÿç”¨äº†ï¼Œé‡åˆ°ä¸ä¼šçš„ç°æŸ¥å°±æ˜¯äº†ï¼ˆè¯ä¸èƒ½è¿™ä¹ˆè¯´å•Šï¼‰ã€‚ æ€»å½’æ˜¯äº†è§£å¾—è¶Šå¤šè¶Šå¥½ï¼Œåªä¸è¿‡ä¸Šé¢è¿™å‡ ä¸ªå‘½ä»¤ç®—æ˜¯åŸºæœ¬è¦æ±‚äº†ï¼Œä¸èƒ½ä¸ä¼šå•Š~</p><p>æœ€åå†æ¨èå‡ ä¸ªgitç›¸å…³çš„å­¦ä¹ å‚è€ƒç½‘ç«™ï¼š</p><ul><li><p><a href="https://git-scm.com/docs">Gitå®˜æ–¹æ–‡æ¡£</a></p></li><li><p><a href="https://www.progit.cn/">Pro Gitç¬¬äºŒç‰ˆï¼ˆä¸­æ–‡ç‰ˆï¼‰</a></p></li><li><p><a href="https://learngitbranching.js.org/?locale=zh_CN">åœ¨çº¿å­¦ä¹ gitï¼ˆæ²™ç›’ç¯å¢ƒï¼‰</a></p></li></ul><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.cnblogs.com/qdhxhz/p/9757390.html">ã€Gitã€‘(1)â€”å·¥ä½œåŒºã€æš‚å­˜åŒºã€ç‰ˆæœ¬åº“ã€è¿œç¨‹ä»“åº“ </a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.imooc.com/article/316077">git rebase å’Œ merge çš„åŒºåˆ«</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¼–ç¨‹æŠ€å·§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C++è¸©å‘è®°å½•ä¹‹å­—é¢å€¼å¸¸é‡</title>
    <link href="/2022/03/04/2022-03/2022-03-04%20C++%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95%E4%B9%8B%E5%AD%97%E9%9D%A2%E5%80%BC%E5%B8%B8%E9%87%8F/"/>
    <url>/2022/03/04/2022-03/2022-03-04%20C++%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95%E4%B9%8B%E5%AD%97%E9%9D%A2%E5%80%BC%E5%B8%B8%E9%87%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="å¼•è¨€"><a class="markdownIt-Anchor" href="#å¼•è¨€"></a> å¼•è¨€</h1><p class='note note-info'>   æœ€è¿‘åœ¨åˆ·é¢˜çš„æ—¶å€™æ— æ„é—´åˆè¸©äº†ä¸ªå‘ï¼Œå‘ç°è‡ªå·±çš„ä¿®è¡Œè¿˜è¿œè¿œä¸å¤Ÿï¼Œæ‰€ä»¥ä¹Ÿç‰¹æ­¤è®°å½•ä¸€ä¸‹ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203051921295.jpg" alt="" /></p><p>ç›®æ ‡æ˜¯æƒ³è¦æ‹¼æ¥ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡å’Œä¸€ä¸ª<code>char</code>å‹å­—ç¬¦ï¼Œç±»ä¼¼ä¸‹é¢è¿™æ ·çš„ä»£ç  ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs C++">string input=<span class="hljs-string">&quot;abc&quot;</span>;<br>cout &lt;&lt; <span class="hljs-string">&quot;&quot;</span> + input[<span class="hljs-number">0</span>] &lt;&lt; endl;<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸Šé¢ä¼šè¾“å‡ºä»€ä¹ˆå‘¢ï¼Ÿ</p><h1 id="æ’æŸ¥è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#æ’æŸ¥è¿‡ç¨‹"></a> æ’æŸ¥è¿‡ç¨‹</h1><p>ä¹‹å‰æˆ‘æƒ³è±¡ä¸­æ˜¯æ‹¼æ¥åè¿”å›æ˜¯ä¸€ä¸ªstringå¯¹è±¡ï¼Œæœ€åè¾“å‡º<code>input</code>çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯è¾“å‡ºç»“æœå´è®©äººæ„å¤–ï¼Œä¸Šé¢è¾“å‡ºçš„ç»“æœä¸æ˜¯æœŸæœ›å€¼ <code>&quot;a&quot;</code>ï¼Œè€Œæ˜¯ä¸€ä¸²è«åå¥‡å¦™çš„å­—ç¬¦ï¼Œå¦‚ä¸‹å›¾ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203050828438.png" alt="ä»¤äººä¸è§£çš„è¾“å‡º" /></p><p>è¿™è®©æˆ‘æœ‰äº›æ‘¸ä¸ç€å¤´è„‘ï¼Œè¿™ä¸€ä¸²æ˜¯æ€ä¹ˆæ¥çš„ï¼Œå½“å‰æ‰§è¡Œçš„ç¨‹åºæ ¹æœ¬æ²¡æœ‰å†™è¿‡è¿™æ ·çš„å­—ç¬¦ä¸²å‘€ï¼Ÿç­‰ç­‰ï¼Œè¿™äº›å­—ç¬¦çœ‹ç€æœ‰ç‚¹çœ¼ç†Ÿï¼Œç„¶åæˆ‘å°è¯•æœç´¢äº†ä¸€ä¸‹ï¼Œå‘ç°è¿™ä¸ªå­—ç¬¦ä¸²åœ¨æˆ‘ä¹‹å‰æ‰§è¡Œçš„å¦ä¸€ä¸ªæºæ–‡ä»¶é‡Œã€‚</p><p>è¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿä¸ºä»€ä¹ˆå½“å‰è¿è¡Œçš„ç¨‹åºï¼Œå´æ¶‰åŠäº†å¦ä¸€ä¸ªæ ¹æœ¬å°±æ²¡æœ‰å¯åŠ¨ã€ä¸ç›¸å…³çš„æºæ–‡ä»¶å‘¢ï¼Ÿ</p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203051921292.jpg" alt="å®‰è¯¦" style="zoom: 50%;" /></center><p>ç„¶åçµå…‰ä¸€ç°ï¼Œæˆ‘ä»¿ä½›æƒ³èµ·ä»€ä¹ˆï¼Œè¯¥ä¸ä¼šæ˜¯è¿™ä¸ªå¸¸é‡å­—ç¬¦ä¸²æ ¹æœ¬æ²¡æœ‰è°ƒç”¨ string é‡è½½çš„åŠ æ³•è¿ç®—ç¬¦å§ï¼Ÿ</p><p>ç„¶åå†IDEé‡Œæµ‹è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°æœç„¶ä¸Šé¢çš„è¿™ä¸ªåŠ æ³•æ˜¯æ— æ³•è·³è½¬åˆ°stringå¯¹åº”çš„é‡è½½è¿ç®—ç¬¦ä¸Šçš„ï¼Œä½†å¦‚æœç”¨stringæ„é€ å‡½æ•°å°è£…ä¸€ä¸‹ï¼Œå‘ç°å°±å¯ä»¥è¿›è¡Œè·³è½¬äº†ã€‚å…¶å®ç¼–è¯‘å™¨ä¹Ÿæç¤ºæˆ‘ï¼Œè¿™ç§åŠ æ³•æ“ä½œå¹¶æ²¡æœ‰çœŸæ­£çš„æŠŠ<code>input[0]</code>è¿™ä¸ªå­—ç¬¦æ’å…¥åˆ°å‰é¢çš„è¿™ä¸ªå­—ç¬¦ä¸²å­—é¢é‡é‡Œã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203051707911.png" alt="ç¼–è¯‘å™¨æç¤º" /></p><p>ç„¶åè”æƒ³ä¸€ä¸‹ç”¨<code>char*</code>è¡¨ç¤ºå­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œä»¥åŠå­—é¢å€¼å¸¸é‡åœ¨å†…å­˜ä¸­çš„å­˜æ”¾ä½ç½®ï¼Œç­”æ¡ˆå°±æµ®å‡ºæ°´é¢äº†ã€‚</p><p>æˆ‘ä»¬çŸ¥é“å­—é¢å€¼å¸¸é‡å­˜å‚¨åœ¨å†…å­˜çš„å¸¸é‡åŒºï¼Œè€Œå¹³å¸¸æˆ‘ä»¬ä½¿ç”¨<code>char* s = &quot;abc&quot;;</code>è¿™æ ·çš„è¡¨è¾¾æ–¹å¼ï¼Œä¹Ÿè¯´æ˜å­—ç¬¦ä¸²å­—é¢é‡å…¶å®æŒ‡å‘çš„å°±æ˜¯å®ƒåœ¨å†…å­˜å¸¸é‡åŒºçš„åœ°å€ï¼Œæ˜¯ä¸€ä¸ªåœ°å€å€¼ï¼ˆæˆ–è€…å†æç«¯ä¸€ç‚¹ï¼ŒæŠŠå­—ç¬¦ä¸²å­—é¢é‡å½“æˆä¸€ä¸ª<code>char*</code>æŒ‡é’ˆæ¥çœ‹ï¼‰ã€‚å› æ­¤<code>&quot;&quot;+input[0]</code>åœ¨æ‰§è¡ŒåŠ æ³•è¿ç®—æ—¶ï¼Œè¿™é‡ŒæŠŠ<code>input[0]</code>éšå¼è½¬æ¢æˆäº†intï¼Œç„¶åè¿›è¡ŒæŒ‡é’ˆçš„åŠ æ³•è¿ç®—ï¼Œæœ€åè®¡ç®—çš„ç»“æœæŒ‡å‘äº†å¸¸é‡åŒºçš„æŸå¤„åœ°å€ï¼Œè€Œè¿™ä¸ªåœ°å€æ°å¥½æŒ‡å‘æˆ‘ä¸Šä¸ªç¨‹åºæ‰§è¡Œåè¿˜ä¿å­˜ç€çš„å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆ<em>ä¸ºä»€ä¹ˆå¸¸é‡åŒºè¿˜å­˜å‚¨ç€ä¹‹å‰ç¨‹åºçš„å†…å®¹ï¼Œæˆ‘çŒœæµ‹å¯èƒ½æ˜¯<strong>ç¼“å­˜</strong>ä¹‹ç±»çš„åŸå› </em>ï¼‰ï¼Œä¹Ÿå°±æ˜¯<code>from left to right are:</code>è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æœ€ç»ˆè¾“å‡ºäº†ä¸Šè¿°ç»“æœã€‚</p><p>æœ€åé€šè¿‡https://cppinsights.io/ è¿™ä¸ªç½‘ç«™éªŒè¯ä¸‹çŒœæƒ³çš„ç»“æœï¼Œå‘ç°çš„ç¡®å¦‚æ­¤ã€‚å¯ä»¥çœ‹åˆ°ç¼–è¯‘è¿‡åï¼Œå¦‚æœå’Œå­—ç¬¦ä¸²å­—é¢è¿›è¡Œç›¸åŠ ï¼Œå®é™…ä¸Šä¼šå¯¹<code>input[0]</code>è¿›è¡Œ<code>static_cast&lt;int&gt;</code>çš„è½¬æ¢ï¼Œè€Œå¦‚æœå’Œstringç±»è¿›è¡Œç›¸åŠ ï¼Œåˆ™ä¼šè°ƒç”¨é‡è½½è¿ç®—ç¬¦æ–¹æ³•ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203051725718.png" alt="cppinsights" /></p><h1 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h1><p>è‡³æ­¤ï¼Œé—®é¢˜è§£å†³ï¼ˆ<s>åˆæ°´äº†ä¸€ç¯‡åšå®¢</s>ï¼‰ã€‚æ€»ç»“ä¸€ä¸‹ï¼Œè¿™æ¬¡è¸©çš„å‘å¾ˆç²—æµ…ï¼Œå¤§æ¦‚æ¶‰åŠä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼Œä¸€ä¸ªæ˜¯å­—ç¬¦ä¸²å­—é¢å€¼æŒ‡å‘çš„æ˜¯å¸¸é‡åŒºçš„ä¸€ä¸ªåœ°å€ï¼ŒäºŒæ˜¯C++æœ‰æ•°æ®éšå¼è½¬æ¢ï¼Œåœ¨è¿›è¡Œç®—æœ¯è¿ç®—æ—¶ä¼šè‡ªåŠ¨æå‡ç±»å‹ï¼Œæ¯”å¦‚<code>char</code>è½¬ä¸º<code>int</code>ã€‚ç©¶å…¶å› ä¸ºåº”è¯¥æ˜¯è‡ªå·±çš„åŸºç¡€ä¸å¤Ÿç‰¢å›ºï¼Œå¯¹å­—é¢å€¼å¸¸é‡æ¬ ç¼ºè®¤è¯†ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯å—ä»¥å‰Javaçš„å½±å“ï¼Œè‡ªä»¥ä¸ºä¼šå°è£…æˆç±»ï¼Œå¤ªè¿‡äºæƒ³å½“ç„¶äº†ï¼Œéœ€è¦å¼•ä»¥ä¸ºæˆ’ã€‚</p><p>æœ€åå†è®°å½•ä¸‹è¿‘æœŸè‡ªå·±çš„ä¸€äº›æ„Ÿå—å§ï¼Œå› ä¸ºåœ¨å‡†å¤‡æ‰¾å®ä¹ ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯åœ¨çœ‹å…«è‚¡ï¼Œåˆ·ç®—æ³•é¢˜ï¼Œç„¶åä»Šå¤©ç»ƒä¹ çš„æ—¶å€™ï¼Œåˆè¢«éš¾ä½äº†ï¼Œå°±è§‰å¾—è‡ªå·±çœŸå¼±å‘€ï¼Œè‡ªå·±è¿™æ ·çš„æ°´å¹³å’Œå®åŠ›èƒ½å»é¢è¯•å—ï¼Ÿå›å¤´ä¸€çœ‹ï¼Œå‘ç°è‡ªå·±ç›¸æ¯”è¿‡å»å¥½åƒå¹¶æ²¡æœ‰å¤ªå¤§çš„è¿›æ­¥ï¼Œæˆ–è€…è¯´æ²¡æœ‰å¯ä»¥æ‹¿å¾—å‡ºæ‰‹ï¼Œå€¼å¾—è‡ªè±ªçš„æœ¬äº‹ã€‚æˆ–è®¸æœ‰è‡ªè°¦çš„æˆåˆ†ï¼Œä½†æˆ‘è‡ªå·±çŸ¥é“ï¼Œè·Ÿé¡¶å°–çš„äººç›¸æ¯”ï¼Œä¸ï¼Œå°±è·Ÿæˆ‘ç†æƒ³ä¸­çš„è‡ªå·±ç›¸æ¯”ï¼Œè¿˜å·®å¾—å¤ªè¿œäº†ï¼Œå¾…åŠäº‹é¡¹é‡Œã€å¾…å­¦ä¹ çš„ä¸œè¥¿è¿˜æœ‰ä¸€ç®©ç­ã€‚</p><p>ä½†æ˜¯ï¼Œå¹³å‡¡æ— å¥‡çš„æˆ‘å•Šï¼Œç°åœ¨æœ‰æ—¶é—´è®©ä½ æ¶ˆæ²‰å—ï¼Ÿï¼æˆ‘èƒ½åšçš„ï¼Œæˆ‘è¦åšçš„ï¼Œå°±æ˜¯å’¬ç‰™åšæŒï¼Œç»§ç»­å­¦ä¹ ï¼</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203051946077.jpg" alt="" /></p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>C++</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äºŒç»´æ•°ç»„ä¸äºŒçº§æŒ‡é’ˆ</title>
    <link href="/2022/02/28/2022-02/2022-02-28%20%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84%E4%B8%8E%E4%BA%8C%E7%BA%A7%E6%8C%87%E9%92%88/"/>
    <url>/2022/02/28/2022-02/2022-02-28%20%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84%E4%B8%8E%E4%BA%8C%E7%BA%A7%E6%8C%87%E9%92%88/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>æœ€è¿‘å†åˆ·ã€Šå‰‘æŒ‡Offerã€‹çš„é¢è¯•é¢˜ï¼Œå…¶ä¸­é‡åˆ°æœ‰ä¸€é¢˜è·ŸäºŒç»´æ•°ç»„ç›¸å…³ï¼Œæ‰€ä»¥éœ€è¦è¿™æ ·å½¢å¼çš„å‡½æ•°ï¼Œ<code>void func(int** matrix, int rows, int columns)</code>ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå†è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œ<strong>åº”è¯¥ä¼ å…¥æ€æ ·çš„å®å‚å‘¢</strong>ï¼Ÿ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// éœ€è¦è¢«è°ƒç”¨çš„å‡½æ•°</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">func</span><span class="hljs-params">(<span class="hljs-keyword">int</span>** matrix, <span class="hljs-keyword">int</span> rows, <span class="hljs-keyword">int</span> columns)</span> </span>&#123;<br>  cout &lt;&lt; matrix[rows<span class="hljs-number">-1</span>][columns<span class="hljs-number">-1</span>] &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-comment">// ç¬¬ä¸€ç§ä¼ å…¥å®å‚æ–¹å¼</span><br><span class="hljs-keyword">int</span> matrix[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>&#125;;<br><span class="hljs-built_in">func</span>(matrix, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>);<br><br><span class="hljs-comment">// ç¬¬äºŒç§ä¼ å…¥å®å‚</span><br><span class="hljs-keyword">int</span>** matrix = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>*[<span class="hljs-number">2</span>];<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i++) &#123;<br>matrix[i] = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">2</span>];<br> <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>; j &lt; <span class="hljs-number">2</span>; j++) &#123;<br>    matrix[i][j] = i*<span class="hljs-number">2</span> + j + <span class="hljs-number">1</span>;<br>  &#125;<br>&#125;<br><span class="hljs-built_in">func</span>(matrix, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>);<br></code></pre></td></tr></table></figure><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203012135420.jpg" alt="" style="zoom:50%;" /></center><h1 id="è¸©å‘è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#è¸©å‘è¿‡ç¨‹"></a> è¸©å‘è¿‡ç¨‹</h1><p>å…¶å®ä¸Šé¢çš„ç­”æ¡ˆå¾ˆç®€å•ï¼Œç›´æ¥æ•²ä»£ç æµ‹è¯•ä¸€ä¸‹ï¼Œå°±çŸ¥é“ç¬¬ä¸€ç§ä¼ å‚æ–¹å¼ç¼–è¯‘å™¨ç›´æ¥æŠ¥é”™ï¼Œæç¤ºä½ ç±»å‹ä¸åŒ¹é…ã€‚ä½†æ˜¯æˆ‘å¤´é“å•Šï¼Œæ„£æ˜¯ç”¨å¼ºåˆ¶è½¬æ¢ <code>func((int**)matrix, 2, 2)</code>çš„æ–¹å¼ï¼Œç„¶åå°±æ˜¯ç¨‹åºå´©æºƒæŠ¥é”™äº†ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203012139296.jpg" alt="" /></p><p>è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿç°åœ¨æ¥ç†æ€§åˆ†æä¸€æ³¢ï¼Œä»¥ä¸‹é¢çš„æµ‹è¯•ä»£ç æ¥è¿›è¡Œè¯´æ˜ã€‚</p><p>é¦–å…ˆ<code>matrix</code> æ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå®ƒï¼ˆæ•°ç»„åï¼‰å¯¹åº”çš„æŒ‡é’ˆç±»å‹å®é™…ä¸Šæ˜¯ <code>int(*)[2]</code> ï¼Œå³æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆï¼ˆæœ‰äººç§°ä½œæ˜¯è¡Œæ•°ç»„æŒ‡é’ˆï¼‰<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="C/C++â€”â€”äºŒç»´æ•°ç»„ä¸æŒ‡é’ˆã€æŒ‡é’ˆæ•°ç»„ã€æ•°ç»„æŒ‡é’ˆï¼ˆè¡ŒæŒ‡é’ˆï¼‰ã€äºŒçº§æŒ‡é’ˆçš„ç”¨æ³• ">[1]</span></a></sup>ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæŠŠ<code>matrix</code>çœ‹æˆæ˜¯ä¸€ä¸ªæŒ‡é’ˆçš„è¯ï¼ŒæŒ‡å‘çš„ç±»å‹æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º2çš„intæ•°ç»„ï¼Œå› æ­¤åœ¨å¯¹<code>matrix</code>æ‰§è¡ŒæŒ‡é’ˆåŠ æ³•<code>ï¼ˆmatrix+1ï¼‰</code>çš„æ—¶å€™ï¼Œä¸€æ¬¡ç§»åŠ¨çš„å­—èŠ‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„çš„é•¿åº¦å³ 2*4 = 8 å­—èŠ‚ã€‚é‚£ä¹ˆæ‰§è¡Œè§£å¼•ç”¨æ—¶ï¼Œ <code>matrix[1]</code> å¾—åˆ°æ˜¯ç¬¬2è¡Œä¸€ç»´æ•°ç»„çš„é¦–åœ°å€ï¼Œå…¶ç±»å‹å°±æ˜¯ä¸€ç»´æ•°ç»„ã€‚åŒæ—¶ä¸€ç»´æ•°ç»„åå¯¹åº”æŒ‡é’ˆç±»å‹ä¸º<code>int *</code>ï¼Œå› æ­¤å†å¯¹ <code>matrix[1]</code> æ‰§è¡ŒæŒ‡é’ˆåŠ æ³•æ“ä½œ<code>ï¼ˆmatrix[1] + 1ï¼‰</code>æ—¶ï¼Œä¸€æ¬¡ç§»åŠ¨çš„å­—èŠ‚æ•°ä¸ºä¸€ä¸ªintç±»å‹çš„å­—èŠ‚é•¿åº¦ã€‚</p><p>å…¶æ¬¡å¯¹äºäºŒçº§æŒ‡é’ˆï¼ˆæŒ‡é’ˆçš„æŒ‡é’ˆï¼‰<code>p</code> æ¥è¯´ï¼Œå› ä¸º<code>p</code> æŒ‡å‘çš„æ˜¯ä¸€ä¸ª<code>int *</code>æŒ‡é’ˆï¼Œæ‰€ä»¥ <code>p</code> æ‰§è¡ŒæŒ‡é’ˆåŠ æ³•çš„æ—¶å€™ï¼Œä¸€æ¬¡ç§»åŠ¨çš„é•¿åº¦ä¸º <code>int *</code> æŒ‡é’ˆç±»å‹çš„å­—èŠ‚æ•°ï¼ˆå³8å­—èŠ‚ï¼‰ï¼Œé‚£ä¹ˆè§£å¼•ç”¨å¾—åˆ°æ•°æ®ç±»å‹ä¹Ÿå°±æ˜¯ <code>int *</code> ï¼Œæ‰€ä»¥<code>p[0]</code> å¾—åˆ°çš„å…ƒç´ å°±æ˜¯ä¸€ä¸ª<code>int *</code> æŒ‡é’ˆï¼Œæ‰“å° <code>p[0]</code> çš„å€¼å°±æ˜¯æ‰“å°è¯¥æŒ‡é’ˆçš„å€¼ï¼Œè€ŒæŒ‡é’ˆçš„å€¼å°±æ˜¯ä¸€ä¸ªåœ°å€ã€‚ä¸ºä»€ä¹ˆè¿™é‡Œæ‰“å°å‡ºæ¥çš„å€¼è¿™ä¹ˆæ€ªå¼‚å‘¢ï¼Ÿå› ä¸ºå®ƒæŠŠ<code>matrix</code>äºŒç»´çŸ©é˜µå­˜å‚¨çš„intå€¼å½“åšæŒ‡é’ˆçš„å€¼æ¥è¿›è¡Œè§£æäº†ï¼Œä¾‹å¦‚3 å’Œ 5 ä¸¤ä¸ªintå€¼åˆèµ·æ¥ä¸º8å­—èŠ‚ï¼Œè¿™ä¸ª8ä¸ªå­—èŠ‚è¢«å½“åšåœ°å€çš„å€¼è€Œä¸æ˜¯å…ƒç´ intçš„å€¼ï¼Œå†åŠ ä¸Šæˆ‘çš„ç”µè„‘æ˜¯å°ç«¯ï¼ˆå³ä½å­—èŠ‚åœ¨ä½åœ°å€ï¼‰ï¼Œæœ€åæ‰“å°å‡ºæ¥çš„ <code>p[0]</code> å°±æ˜¯<code>0x500000003</code> äº†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">int</span> matrix[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>&#125;;<br>cout &lt;&lt; <span class="hljs-string">&quot;matrix    address: &quot;</span> &lt;&lt; matrix &lt;&lt; endl;     <span class="hljs-comment">// 0x16d92b610</span><br>cout &lt;&lt; <span class="hljs-string">&quot;matrix[0] address: &quot;</span> &lt;&lt; matrix[<span class="hljs-number">0</span>] &lt;&lt; endl;  <span class="hljs-comment">// 0x16d92b610</span><br>cout &lt;&lt; <span class="hljs-string">&quot;matrix+1  address: &quot;</span> &lt;&lt; matrix+<span class="hljs-number">1</span> &lt;&lt; endl;   <span class="hljs-comment">// 0x16d92b618</span><br>cout &lt;&lt; <span class="hljs-string">&quot;matrix[1] address: &quot;</span> &lt;&lt; matrix[<span class="hljs-number">1</span>] &lt;&lt; endl;  <span class="hljs-comment">// 0x16d92b618</span><br><br><span class="hljs-keyword">int</span>** p = (<span class="hljs-keyword">int</span>**) matrix;<br>cout &lt;&lt; <span class="hljs-string">&quot;p    address: &quot;</span> &lt;&lt; p &lt;&lt; endl;          <span class="hljs-comment">// 0x16d92b610</span><br>cout &lt;&lt; <span class="hljs-string">&quot;p[0] address: &quot;</span> &lt;&lt; p[<span class="hljs-number">0</span>] &lt;&lt; endl;       <span class="hljs-comment">// 0x500000003</span><br>cout &lt;&lt; <span class="hljs-string">&quot;p+1  address: &quot;</span> &lt;&lt; p+<span class="hljs-number">1</span> &lt;&lt; endl;        <span class="hljs-comment">// 0x16d92b618</span><br>cout &lt;&lt; <span class="hljs-string">&quot;p[1] address: &quot;</span> &lt;&lt; p[<span class="hljs-number">1</span>] &lt;&lt; endl;       <span class="hljs-comment">// 0x800000007</span><br><br><span class="hljs-keyword">int</span> ** p_matrix = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>*[<span class="hljs-number">2</span>];<br>p_matrix[<span class="hljs-number">0</span>] = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">2</span>];<br>p_matrix[<span class="hljs-number">1</span>] = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">2</span>];<br>p_matrix[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">3</span>; p_matrix[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>] = <span class="hljs-number">5</span>;<br>p_matrix[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">7</span>; p_matrix[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = <span class="hljs-number">8</span>;<br>cout &lt;&lt; <span class="hljs-string">&quot;p_matrix    address: &quot;</span> &lt;&lt; p_matrix &lt;&lt; endl;    <span class="hljs-comment">// 0x60000081c020</span><br>cout &lt;&lt; <span class="hljs-string">&quot;p_matrix[0] address: &quot;</span> &lt;&lt; p_matrix[<span class="hljs-number">0</span>] &lt;&lt; endl; <span class="hljs-comment">// 0x60000081c030</span><br>cout &lt;&lt; <span class="hljs-string">&quot;p_matrix+1  address: &quot;</span> &lt;&lt; p_matrix+<span class="hljs-number">1</span> &lt;&lt; endl;  <span class="hljs-comment">// 0x60000081c028</span><br>cout &lt;&lt; <span class="hljs-string">&quot;p_matrix[1] address: &quot;</span> &lt;&lt; p_matrix[<span class="hljs-number">1</span>] &lt;&lt; endl; <span class="hljs-comment">// 0x60000081c040</span><br></code></pre></td></tr></table></figure><p>å•°é‡Œå•°å—¦è¯´äº†è¿™ä¹ˆå¤šï¼Œå¯èƒ½è¿˜æ˜¯æ²¡è§£é‡Šæ¸…æ¥šï¼Œåè€ŒæŠŠè‡ªå·±ç»•æ™•äº†ï¼Œæ‰€ä»¥å†ç”¨ä¸‹é¢è¿™å¼ å›¾è§£é‡Šä¸€ä¸‹ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203011443395.jpeg" alt="å†…å­˜å›¾è§£" /></p><p>å¼„æ¸…æ¥šå†…å­˜ä¸­æ•°æ®åˆ†å¸ƒåï¼Œç°åœ¨åº”è¯¥çŸ¥é“ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥æŠŠäºŒç»´æ•°ç»„matrixç›´æ¥ä¼ ç»™äºŒçº§æŒ‡é’ˆäº†å§ã€‚ä¸è¿‡è¿˜æœ‰ä¸€ä¸ªç‚¹ï¼Œå¯èƒ½è¿˜æ˜¯æ¯”è¾ƒä»¤äººæ„Ÿåˆ°ç–‘æƒ‘çš„ï¼Œå°±æ˜¯ä¸ºä»€ä¹ˆ<code>matrix+1</code> å’Œ <code>matrix[1]</code> æ‰“å°å‡ºæ¥çš„å€¼æ˜¯ç›¸åŒçš„ï¼Ÿ</p><p>æˆ‘æ˜¯è¿™ä¹ˆç†è§£çš„ï¼ˆ<strong>å¦‚æœä¸å¯¹ï¼Œè¿˜è¯·åœ¨è¯„è®ºåŒºä¸­æŒ‡å‡º</strong>ï¼‰ï¼šå› ä¸ºmatrix ç±»å‹æ—¶ <code>int(*)[2]</code>ï¼Œæ˜¯ä¸€ä¸ªæŒ‡å‘ä¸€ç»´æ•°ç»„çš„æŒ‡é’ˆï¼Œå› æ­¤è§£å¼•ç”¨å¾—åˆ°çš„åº”è¯¥å°±æ˜¯ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥å¯ä»¥è®¤ä¸º <code>matrix[1]</code> å°±æ˜¯ä¸ªä¸€ç»´æ•°ç»„ï¼Œè€Œä¸€ç»´æ•°ç»„åä¸å°±æ˜¯æ•°ç»„é¦–å…ƒç´ çš„åœ°å€å˜›ï¼Œå› æ­¤æˆ‘è§‰å¾—ç¼–è¯‘å™¨åœ¨å¯¹ <code>matrix+1</code>è¿™ä¸ªåœ°å€è§£å¼•ç”¨å–å€¼çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰åƒ äºŒçº§æŒ‡é’ˆ <code>int** p</code> é‚£æ ·å»å–å†…å­˜é‡Œçš„å€¼ä½œä¸ºåœ°å€å€¼ï¼Œè€Œæ˜¯ç›´æ¥å°†å½“å‰çš„åœ°å€å€¼ä½œä¸ºæ•°ç»„åçš„åœ°å€å€¼åæ‚”äº†ã€‚æ‰€ä»¥æœ€ç»ˆ <code>matrix+1</code> å’Œ <code>matrix[1]</code> æ‰“å°å¾—åˆ°çš„ç»“æœç›¸åŒã€‚</p><hr /><p>å…¶å®è¿˜é‡åˆ°äº†å¦ä¸€ç§æ¯”è¾ƒå¥‡æ€ªçš„å½¢å¼ï¼Œè§ä¸‹é¢çš„å‡½æ•°ã€‚æˆ‘è¯•äº†å¥½å‡ ç§ä¼ å‚æ–¹å¼ï¼Œä½†æ€»æ˜¯ç¼–è¯‘é€šè¿‡ï¼Œç¼–è¯‘å™¨ä¸€ç›´æç¤ºæˆ‘ç±»å‹ä¸åŒ¹é…ï¼Œå‘Šè¯‰æˆ‘å½¢å‚<code>matrix</code>çš„çœŸå®ç±»å‹ä¸º<code>int(*)[columns]</code>ï¼Œè¿™å°±å’Œå°´å°¬ï¼Œå› ä¸º<code>columns</code>æ˜¯ä¸ªå˜é‡ï¼Œæˆ‘æ€ä¹ˆä¼ ä¸€ä¸ªæ•°ç»„é•¿åº¦ä¸ºå˜é‡çš„æ•°ç»„æŒ‡é’ˆï¼Ÿ</p><p>æˆ‘ä»¬éƒ½çŸ¥é“C++é‡Œï¼Œæ•°ç»„çš„é•¿åº¦æ˜¯ä¸€ä¸ªå›ºå®šå€¼ï¼Œé‚£ä¹ˆè¿™é‡Œçš„<code>func2</code>ä¸ºä»€ä¹ˆå¯ä»¥é€šè¿‡ç¼–è¯‘ï¼Ÿæ›´ç—›è‹¦çš„æ˜¯æˆ‘è¿˜æ— æ³•ä¼ å‚ã€‚ã€‚ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// è¿™é‡Œ martix ç±»å‹ç­‰ä»·ä¸º int(*)[columns]</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">func2</span><span class="hljs-params">(<span class="hljs-keyword">int</span> rows, <span class="hljs-keyword">int</span> columns, <span class="hljs-keyword">int</span> matrix[rows][columns])</span> </span>&#123;<br>    cout &lt;&lt; matrix[rows<span class="hljs-number">-1</span>][columns<span class="hljs-number">-1</span>];<br>&#125;<br></code></pre></td></tr></table></figure><p>åæ¥æˆ‘åœ¨stackoverflowä¸Šæäº†è¿™ä¸ªé—®é¢˜ï¼ˆç»“æœæ ‡è®°ä¸º <em>æ¨¡æ¿å‚æ•°è‡ªåŠ¨æ¨å¯¼</em> çš„é—®é¢˜ï¼Œä½†æˆ‘æ„Ÿè§‰è¿˜æ˜¯ä¸å¤ªä¸€æ ·ï¼‰ï¼Œæœ‰äººå›å¤æˆ‘è¯´ï¼Œè¿™ç§å‡½æ•°å®šä¹‰æ–¹å¼åœ¨Cé‡Œé¢æ˜¯æœ‰æ•ˆçš„ï¼Œä½†åœ¨C++é‡Œæ˜¯ä¸åˆæ³•ï¼Œæ‰€ä»¥è¿™ä¸æ˜¯å¦‚ä½•ä¼ å‚çš„é—®é¢˜ï¼Œè€Œæ˜¯è¿™æ ·çš„å†™æ³•åœ¨C++æ ‡å‡†é‡Œæ˜¯ä¸å…è®¸çš„ã€‚<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="stackoverflowä¸Šçš„æé—®">[2]</span></a></sup>è™½ç„¶æ„Ÿè§‰è¿˜æ˜¯æ²¡è¯´æ˜ç™½ä¸ºä»€ä¹ˆç¼–è¯‘å¯è¡Œï¼Œä½†æ˜¯å§‘ä¸”è®¤ä¸ºæ˜¯C++æ ‡å‡†ä¸å…è®¸è¿™æ ·çš„å†™æ³•ï¼Œæ‰€ä»¥å¯¼è‡´æ²¡æ³•ä¼ å‚ã€‚</p><h1 id="ç»“è®º"><a class="markdownIt-Anchor" href="#ç»“è®º"></a> ç»“è®º</h1><p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼ŒäºŒç»´æ•°ç»„æ˜¯ä¸èƒ½ç›´æ¥èµ‹å€¼ç»™äºŒçº§æŒ‡é’ˆçš„ï¼ŒäºŒç»´æ•°ç»„å¯¹åº”çš„æŒ‡é’ˆç±»å‹æ˜¯ä¸€ä¸ªæ•°ç»„æŒ‡é’ˆï¼Œä¸‹é¢è¡¨æ ¼ç»™å‡ºæ•°ç»„å’ŒæŒ‡é’ˆçš„å‚æ•°åŒ¹é…ã€‚<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="C/C++äºŒç»´æ•°ç»„åå’ŒäºŒçº§æŒ‡é’ˆ">[3]</span></a></sup></p><table><thead><tr><th style="text-align:left">å®å‚</th><th>ä¾‹å­</th><th>æ‰€åŒ¹é…çš„å½¢å‚</th></tr></thead><tbody><tr><td style="text-align:left">äºŒç»´æ•°ç»„</td><td>char c[4][3]</td><td>char (*c)[3]</td></tr><tr><td style="text-align:left">æŒ‡é’ˆæ•°ç»„</td><td>char * c[4]</td><td>char ** c</td></tr><tr><td style="text-align:left">æ•°ç»„æŒ‡é’ˆ</td><td>char (*c)[3]</td><td>char (*c)[3]</td></tr><tr><td style="text-align:left">äºŒçº§æŒ‡é’ˆ</td><td>char ** c</td><td>char ** c</td></tr></tbody></table><p>ç„¶åå†ç»™å‡ºå‡ ç§æ­£ç¡®çš„ä¼ é€’äºŒç»´æ•°ç»„çš„å§¿åŠ¿ã€‚</p><h2 id="1å½¢å‚ä½¿ç”¨äºŒçº§æŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#1å½¢å‚ä½¿ç”¨äºŒçº§æŒ‡é’ˆ"></a> 1.å½¢å‚ä½¿ç”¨äºŒçº§æŒ‡é’ˆ</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">func</span><span class="hljs-params">(<span class="hljs-keyword">int</span> **matrix, <span class="hljs-keyword">int</span> rows, <span class="hljs-keyword">int</span> columns)</span> </span>&#123;<br>    cout &lt;&lt; matrix[rows - <span class="hljs-number">1</span>][columns - <span class="hljs-number">1</span>];<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>  <span class="hljs-keyword">int</span> rows = <span class="hljs-number">2</span>, columns = <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">int</span> **matrix = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span> *[rows];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;<br>        matrix[i] = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[columns];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; columns; j++) &#123;<br>            matrix[i][j] = i * columns + j + <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">func</span>(matrix,rows, columns);<br>  <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i&lt;rows;i++) &#123;<br>        <span class="hljs-keyword">delete</span>[] matrix[i];<br>    &#125;<br>    <span class="hljs-keyword">delete</span>[] matrix;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="2å½¢å‚ä½¿ç”¨ä¸€çº§æŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#2å½¢å‚ä½¿ç”¨ä¸€çº§æŒ‡é’ˆ"></a> 2.å½¢å‚ä½¿ç”¨ä¸€çº§æŒ‡é’ˆ</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">func</span><span class="hljs-params">(<span class="hljs-keyword">int</span> *matrix, <span class="hljs-keyword">int</span> rows, <span class="hljs-keyword">int</span> columns)</span> </span>&#123;<br>    cout &lt;&lt; matrix[(rows - <span class="hljs-number">1</span>) * columns + (columns - <span class="hljs-number">1</span>)];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> rows = <span class="hljs-number">2</span>, columns = <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">int</span> *matrix = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[rows * columns];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; columns; j++) &#123;<br>            matrix[i * columns + j] = i * columns + j + <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">func</span>(matrix, rows, columns);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3å½¢å‚ä½¿ç”¨æ•°ç»„æŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#3å½¢å‚ä½¿ç”¨æ•°ç»„æŒ‡é’ˆ"></a> 3.å½¢å‚ä½¿ç”¨æ•°ç»„æŒ‡é’ˆ</h2><p>é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œéœ€è¦å½¢å‚æŒ‡å®šäºŒç»´æ•°ç»„çš„åˆ—æ•°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// columns = 2</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">func</span><span class="hljs-params">(<span class="hljs-keyword">int</span> (*matrix)[<span class="hljs-number">2</span>], <span class="hljs-keyword">int</span> rows, <span class="hljs-keyword">int</span> columns)</span> </span>&#123;<br>    cout &lt;&lt; matrix[rows<span class="hljs-number">-1</span>][columns<span class="hljs-number">-1</span>];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> rows = <span class="hljs-number">2</span>, columns = <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">int</span> matrix[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>] = &#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>&#125;;<br>    <span class="hljs-built_in">func</span>(matrix, rows, columns);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="4å½¢å‚ä½¿ç”¨æŒ‡é’ˆæ•°ç»„"><a class="markdownIt-Anchor" href="#4å½¢å‚ä½¿ç”¨æŒ‡é’ˆæ•°ç»„"></a> 4.å½¢å‚ä½¿ç”¨æŒ‡é’ˆæ•°ç»„</h2><p>é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œéœ€è¦å½¢å‚æŒ‡å®šäºŒç»´æ•°ç»„çš„è¡Œæ•°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// rows = 3</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">func</span><span class="hljs-params">(<span class="hljs-keyword">int</span>* matrix[<span class="hljs-number">3</span>], <span class="hljs-keyword">int</span> rows, <span class="hljs-keyword">int</span> columns)</span> </span>&#123;<br>    cout &lt;&lt; matrix[rows - <span class="hljs-number">1</span>][columns - <span class="hljs-number">1</span>];<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> rows = <span class="hljs-number">3</span>, columns = <span class="hljs-number">2</span>;<br>    <span class="hljs-keyword">int</span> *matrix[rows];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;<br>        matrix[i] = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[columns];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; columns; j++) &#123;<br>            matrix[i][j] = i * columns + j;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">func</span>(matrix, rows, columns);<br>  <br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) &#123;<br>        <span class="hljs-keyword">delete</span>[] matrix[i];<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="5å½¢å‚ä½¿ç”¨-vector-å®¹å™¨"><a class="markdownIt-Anchor" href="#5å½¢å‚ä½¿ç”¨-vector-å®¹å™¨"></a> 5.å½¢å‚ä½¿ç”¨ vector å®¹å™¨</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">func</span><span class="hljs-params">(vector&lt;vector&lt;<span class="hljs-keyword">int</span>&gt;&gt;&amp; matrix, <span class="hljs-keyword">int</span> rows, <span class="hljs-keyword">int</span> columns)</span> </span>&#123;<br>    cout &lt;&lt; matrix[rows - <span class="hljs-number">1</span>][columns - <span class="hljs-number">1</span>];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> rows = <span class="hljs-number">3</span>, columns = <span class="hljs-number">2</span>;<br>    vector&lt;vector&lt;<span class="hljs-keyword">int</span>&gt;&gt; <span class="hljs-built_in">matrix</span>(rows);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;rows;i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;columns;j++) &#123;<br>            matrix[i].<span class="hljs-built_in">push_back</span>(i * columns + j + <span class="hljs-number">1</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">func</span>(matrix, rows, columns);<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202203012140651.jpeg" alt="" /></p><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.cnblogs.com/oddcat/p/9701518.html">C/C++â€”â€”äºŒç»´æ•°ç»„ä¸æŒ‡é’ˆã€æŒ‡é’ˆæ•°ç»„ã€æ•°ç»„æŒ‡é’ˆï¼ˆè¡ŒæŒ‡é’ˆï¼‰ã€äºŒçº§æŒ‡é’ˆçš„ç”¨æ³• </a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://stackoverflow.com/questions/71303527/how-to-pass-parameters-to-this-function-void-funcint-rows-int-columns-int-m">stackoverflowä¸Šçš„æé—®</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.cnblogs.com/fuao2000/p/11005671.html">C/C++äºŒç»´æ•°ç»„åå’ŒäºŒçº§æŒ‡é’ˆ</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>C++</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>æŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¤šå³æ˜¯å°‘ï¼Œå°‘å³æ˜¯å¤š</title>
    <link href="/2022/02/21/2022-02/2022-02-21%20%E5%A4%9A%E5%8D%B3%E6%98%AF%E5%B0%91%EF%BC%8C%E5%B0%91%E5%8D%B3%E6%98%AF%E5%A4%9A/"/>
    <url>/2022/02/21/2022-02/2022-02-21%20%E5%A4%9A%E5%8D%B3%E6%98%AF%E5%B0%91%EF%BC%8C%E5%B0%91%E5%8D%B3%E6%98%AF%E5%A4%9A/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>è¿™å‡ å¤©ä¸€ç›´åœ¨æŠ˜è…¾obsidianè¿™æ¬¾ç¬”è®°è½¯ä»¶ï¼Œçœ‹ç›¸å…³è§†é¢‘ï¼Œå­¦ä¹ æœ‰å…³ç”¨æ³•ï¼Œå¹¿é˜”çš„ä¸»é¢˜å’Œä¸è®¡å…¶æ•°çš„æ’ä»¶ä»¤æˆ‘çƒŸèŠ±ç¼­ä¹±ï¼Œå®Œå…¨è¢«ç»šä¸½çš„ç•Œé¢é…ç½®æ‰€å¸å¼•ã€‚</p><p>ä½†æ˜¯ç­‰æˆ‘å†·é™ä¸‹æ¥ä¹‹åï¼Œæ‰ªå¿ƒè‡ªé—®ï¼Œè‡ªå·±çœŸçš„éœ€è¦è¿™ä¹ˆæ·±å…¥å­¦ä¹ ä½¿ç”¨obsidianå—ï¼Ÿæˆ‘å†³å®šæ¥è§¦ä½¿ç”¨obsidiançš„åˆå¿ƒæ˜¯ä»€ä¹ˆï¼Ÿæˆ‘çš„çœŸå®éœ€æ±‚åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿè¿™æ ·ç†æ¸…è‡ªå·±çš„æ€è·¯åï¼Œæˆ–è®¸å°±ä¼šè±ç„¶å¼€æœ—äº†ã€‚</p><h1 id="è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#è¿‡ç¨‹"></a> è¿‡ç¨‹</h1><p>å…¶å®æˆ‘çš„éœ€æ±‚å¾ˆç®€å•ï¼Œå°±æ˜¯æƒ³è¦æ‰¾ä¸€ä¸ªåœ°æ–¹å¯ä»¥è®°å½•æˆ‘çš„è´¢åŠ¡çŠ¶å†µã€‚æ­¤å‰æˆ‘çš„ä¸»è¦ç¬”è®°è½¯ä»¶ç”¨çš„æ˜¯é£ä¹¦ï¼Œä½†å› ä¸ºé£ä¹¦éœ€è¦è”ç½‘ï¼Œä¸”æ•°æ®å­˜å‚¨åœ¨åˆ«äººçš„æœåŠ¡å™¨ä¸Šï¼Œæ‰€ä»¥ä¸€äº›ä¸ªäººç§å¯†æ•°æ®å°±ä¸å¥½å†™åœ¨ä¸Šé¢ï¼Œæ‰€ä»¥å°±éœ€è¦ä¸€æ¬¾æœ¬åœ°çš„æ–‡æœ¬ç¼–è¾‘è½¯ä»¶ã€‚</p><p>ç„¶åå°±é€šè¿‡å…¬ä¼—å·ç­‰æ¸ é“ï¼Œå°±äº†è§£åˆ°äº†obsidianè¿™æ¬¾ç¬”è®°è½¯ä»¶ï¼Œç›¸æ¯” typora æ¥è¯´å…·æœ‰æ›´å¤šçš„æ’ä»¶å’Œæ›´é«˜çš„è‡ªç”±åº¦ã€‚è€Œæ­¤å‰æˆ‘å†™åšå®¢ç”¨çš„å°±æ˜¯ typora æ¥ç¼–è¾‘æ’°å†™ï¼Œæ‰€ä»¥å°±æƒ³ç€èƒ½ä¸èƒ½æ”¹æˆç”¨ obsidianï¼Œè¿™æ ·å¯ä»¥å°è¯•å»å­¦ä¹ ä½¿ç”¨ç‚«é…·çš„æ’ä»¶äº†ï¼ˆè¿˜æ˜¯è¿½æ±‚èŠ±é‡Œèƒ¡å“¨çš„å¿ƒç†å•Šï¼‰ï¼Œç”šè‡³ä¹‹åå¯ä»¥å–ä»£é£ä¹¦ã€‚</p><p>ä½†æ˜¯ç°åœ¨æˆ‘å‘ç°ï¼Œå…¶å®å½“ä¸‹å°è¯•å»æ·±åº¦å­¦ä¹ ä½¿ç”¨obsidianå¹¶æ²¡æœ‰å¤ªå¤§å¿…è¦ï¼šä¸€æ¥æˆ‘æœ€åˆçš„éœ€æ±‚å¾ˆç®€å•ï¼Œåªæ˜¯æƒ³åœ¨æœ¬åœ°è®°å½•ç‚¹è´¢åŠ¡ä¿¡æ¯ï¼›äºŒæ¥å¦‚æœä½¿ç”¨obsidianå–ä»£typoraæ¥å†™åšå®¢ï¼Œå…¶å®æˆ‘è¿˜æ˜¯æ²¡æ³•ç”¨ä¸Šobsidiané‡Œæœ€å…³é”®çš„åŒé“¾åŠŸèƒ½ï¼Œå› ä¸ºåšå®¢æ¸²æŸ“çš„æ—¶å€™æ— æ³•æ”¯æŒï¼›ä¸‰æ¥å¦‚æœç”¨obsidianå–ä»£é£ä¹¦åšç¬”è®°ï¼Œæˆæœ¬æ¯”è¾ƒé«˜ï¼Œæƒ³è¦æŠŠobsidianæ‰“é€ æˆç°åœ¨é£ä¹¦è¿™æ ·å­éœ€è¦èŠ±è´¹çš„ç²¾åŠ›å’Œæ—¶é—´å¯å¤ªå¤§äº†ã€‚</p><h1 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h1><p>ç»¼ä¸Šæ‰€è¿°ï¼Œå…¶å®æˆ‘å¤§å¯ä¸å¿…å»æ·±å…¥å­¦ä¹ obsidianï¼Œå»å­¦å„ç§æ’ä»¶ï¼Œæ‰“é€ ä¸€ä¸ªå®Œç¾çš„å†™ä½œç³»ç»Ÿï¼Œæ¯•ç«Ÿå·²ç»æœ‰ä¸€ä¸ªæ¯”è¾ƒå®Œå¤‡çš„è½¯ä»¶åœ¨ä½¿ç”¨äº†ï¼Œä¹Ÿæ²¡æœ‰ç‰¹åˆ«çš„éœ€æ±‚ï¼Œæœ‰è¿™ä¸ªæ—¶é—´ç²¾åŠ›è¿˜ä¸å¦‚å»åšå½“ä¸‹ä¼˜å…ˆçº§æ›´é«˜çš„äº‹æƒ…ï¼Œå­¦ä¹ æ›´å¤šå®é™…æ€§çš„çŸ¥è¯†å†…å®¹ã€‚</p><p>è¿™ä»¶äº‹è®©æˆ‘è”æƒ³åˆ°ä»Šå¤©è€å¸ˆè¯¾ä¸Šè®²çš„è¯ï¼Œâ€œ<strong>å¤šå³æ˜¯å°‘ï¼Œå°‘å³æ˜¯å¤š</strong>â€ã€‚åœ¨å½“ä¸‹ä¿¡æ¯çˆ†ç‚¸çš„æ—¶ä»£ï¼Œæˆ‘ä»¬ä¼šæ¥è§¦åˆ°å¾ˆå¤šçº·ç¹å¤æ‚çš„äº‹ç‰©ï¼Œæˆ‘ä»¬æˆ–è®¸ä¼šè¢«è¡¨è±¡æ‰€è¿·æƒ‘ï¼Œè€Œå¿˜è®°è‡ªå·±çœŸå®çš„éœ€æ±‚ã€‚å½“å¤ªå¤šçš„é€‰æ‹©æ‘†åœ¨é¢å‰ï¼Œåè€Œæ— æ³•å†³å®šï¼Œè®¤ä¸ºè¿˜æ˜¯å¤ªå°‘ï¼Œè¿˜æƒ³è¿½æ±‚æ›´å¤šæ›´å¥½ã€‚ä½†å…¶å®åªè¦æŒæ¡å…³é”®çš„å‡ ä¸ªæŠ€æœ¯ã€è½¯ä»¶ï¼Œå°±è¶³ä»¥è§£å†³å¤§å¤šæ•°é—®é¢˜å’Œéœ€æ±‚ã€‚</p><p>æœ€å…³é”®çš„è¿˜æ˜¯è¦æ˜ç¡®è‡ªå·±çš„éœ€æ±‚å’Œæƒ³æ³•ï¼Œç„¶åä»¥æ­¤ä¸ºå‡ºå‘ç‚¹å¯»æ‰¾åˆé€‚çš„è§£å†³æ–¹æ³•ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç”Ÿæ´»</category>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚è°ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€æ¼‚æµå°‘å¹´ã€‘é’æ˜¥çš„æ„ä¹‰åœ¨äºæˆé•¿</title>
    <link href="/2022/02/19/2022-02/2022-02-19%20%E3%80%90%E6%BC%82%E6%B5%81%E5%B0%91%E5%B9%B4%E3%80%91%E9%9D%92%E6%98%A5%E7%9A%84%E6%84%8F%E4%B9%89%E5%9C%A8%E4%BA%8E%E6%88%90%E9%95%BF/"/>
    <url>/2022/02/19/2022-02/2022-02-19%20%E3%80%90%E6%BC%82%E6%B5%81%E5%B0%91%E5%B9%B4%E3%80%91%E9%9D%92%E6%98%A5%E7%9A%84%E6%84%8F%E4%B9%89%E5%9C%A8%E4%BA%8E%E6%88%90%E9%95%BF/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>ä¹‹å‰å°±å¬é—»ã€Šæ¼‚æµå°‘å¹´ã€‹è¿™éƒ¨ç•ªè¯„ä»·å¾ˆé«˜ï¼Œå°±ä¸€ç›´æƒ³æ‰¾æœºä¼šè¡¥äº†ï¼Œæ°å¥½è¿™æ®µå¯’å‡æ—¶é—´é‡Œæœ‰ç©ºï¼Œå°±ä¸€æ¬¡æ€§åˆ·å®Œäº†ã€‚å½“æ—¶çœ‹å®Œçš„ç¡®æ˜¯å¿ƒç”°é‡Œæ¶Œå‡ºäº†äº›ä»€ä¹ˆï¼Œä½†å¯æƒœçš„æ˜¯æ²¡æœ‰åŠæ—¶è®°å½•ä¸‹æ¥ï¼Œç°åœ¨å›è¿‡å¤´æ¥ï¼Œæƒ³è¦è¯´äº›ä»€ä¹ˆï¼Œå´åˆæ— ä»è¯´èµ·äº†ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202201047171.png" alt="" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202201048916.png" alt="" /></p><h1 id="æ„Ÿæ‚Ÿ"><a class="markdownIt-Anchor" href="#æ„Ÿæ‚Ÿ"></a> æ„Ÿæ‚Ÿ</h1><p>ã€Šæ¼‚æµå°‘å¹´ã€‹è®²è¿°äº†ä¸€ä¸ªç­çº§çš„ä¸­å­¦ç”Ÿçªç„¶æ¥åˆ°äº†å¥‡å¦™çš„å¼‚æ¬¡å…ƒä¸–ç•Œï¼Œæ¯ä¸ªäººè·å¾—äº†ä¸åŒçš„è¶…èƒ½åŠ›ï¼Œä¸ºäº†å›åˆ°ç°å®ä¸–ç•Œï¼Œå­¦ç”Ÿä»¬åšäº†å„ç§å°è¯•å’ŒåŠªåŠ›ï¼ŒæœŸé—´ä¹Ÿå‘ç”Ÿäº†å¾ˆå¤šäº‹ä»¶ï¼Œæœ€ç»ˆåªæœ‰ä¸»è§’é•¿è‰¯å’Œç‘ç©—å›åˆ°äº†ç°å®ä¸–ç•Œã€‚</p><p>ã€Šæ¼‚æµå°‘å¹´ã€‹æ˜¯ä¸€éƒ¨ç¾¤åƒç•ªï¼Œå°†ç­çº§é‡Œæ¯ä¸ªå­¦ç”Ÿçš„ä¸ªæ€§åˆ»ç”»å¾—å¾ˆé²œæ˜ï¼Œå¾ˆæœ‰ç‰¹ç‚¹ï¼Œå½“å·å…¥å¥‡æ€ªçš„äº‹ä»¶ä¸­ï¼Œæ¼‚æµåˆ°å¼‚ä¸–ç•Œï¼Œæ¯ä¸ªäººéƒ½æœ‰ç€å„è‡ªçš„æ€åº¦å’Œè¡¨ç°ã€‚è€Œå†ç»ä¼—å¤šäº‹ä»¶åï¼Œæ¯ä¸ªäººä¹Ÿéƒ½èµ°ä¸Šäº†ä¸åŒçš„é“è·¯ã€‚</p><p>å…¶ä¸­ä»¤æˆ‘å°è±¡æœ€æ·±çš„å°±æ˜¯ä¸»è§’çš„æˆé•¿å˜åŒ–äº†ï¼ˆå½“ç„¶è¿˜æœ‰å…ƒæ°”å°‘å¥³å¸Œå’Œå‚²å¨‡çš„ç‘ç©—ï¼Œç¬‘ï¼‰ï¼Œä¸»è§’é•¿è‰¯ä»ä¸€å¼€å§‹çš„æ¶ˆæé¿ä¸–ï¼Œè®¤ä¸ºè‡ªå·±ä¸é‡è¦ï¼Œä»€ä¹ˆéƒ½ä¸æƒ³åšï¼Œåˆ°æœ€åå˜å¾—åšå®šä¸ç§»ï¼Œç«­å°½å…¨åŠ›å›åˆ°ç°å®ï¼Œè¿™ä¸€æˆé•¿è¿‡ç¨‹ä»¤äººä¾§ç›®ã€‚æˆ–è®¸æ˜¯ä»é•¿è‰¯èº«ä¸Šçœ‹åˆ°äº†è‡ªå·±ï¼Œé‚£ä¸ªå¦„è‡ªè²è–„ï¼Œèƒ†å°æ‡¦å¼±çš„è‡ªå·±ï¼Œæ‰€ä»¥ä¸ºé•¿è‰¯çš„æˆé•¿å˜åŒ–è€Œå–œæ‚¦åŠ¨å®¹ï¼Œå› ä¸ºåœ¨æˆ‘å¿ƒåº•çš„æŸå¤„ï¼Œä¹Ÿä¸€ç›´å¸Œæœ›è‡ªå·±èƒ½å¤Ÿåšå‡ºæ”¹å˜ï¼Œæ”¹æ­£æ¶ä¹ ï¼Œä¸€æ‰«é¢“åºŸæ€ æƒ°ä¹‹é£ï¼Œå˜å¾—åšå®šè‡ªä¿¡ï¼Œå‹‡å¾€ç›´å‰ã€‚</p><p>ç•ªå‰§é‡Œè¿˜è®²è¿°äº†å¾ˆå¤šæ•…äº‹ï¼Œæˆ‘è®¤ä¸ºå¾ˆåƒæ˜¯é’æ˜¥æˆé•¿è·¯ä¸Šé‡åˆ°çš„ç§ç§ï¼Œæœ‰æŒ«æŠ˜æœ‰ç£¨éš¾ï¼Œæœ‰é»‘æš—æœ‰æ­»äº¡ï¼Œä½†ä¹Ÿæœ‰æ‹æƒ…å‹æƒ…ï¼Œæœ‰å‹‡æ°”æœ‰åšéŸ§ï¼Œæœ‰è‡ªä¿¡å…ƒæ°”ã€å‚²å¨‡å–„è‰¯çš„å°‘å¥³ï¼Œæœ‰ä¸æ–­æˆé•¿ã€è‡ªæˆ‘æ•‘èµçš„å°‘å¹´ï¼Œè¿™ä¸€åˆ‡å…±åŒäº¤ç»‡çš„äº‹ç‰©ï¼Œç»„æˆäº†æˆ‘ä»¬çš„é’æ˜¥ã€‚</p><p>æœ€åæ•…äº‹çš„ç»“å°¾ï¼Œé•¿è‰¯å’Œç‘ç©—å›åˆ°äº†å¸Œè¿˜æ´»ç€çš„ç°å®ä¸–ç•Œï¼ˆä½†å·²ç»ä¸æ˜¯åŸæ¥çš„ä¸–ç•Œäº†ï¼‰ï¼Œä¸€åˆ‡éƒ½å½’äºå¹³æ·¡ï¼Œä»¿ä½›ä¹‹å‰çš„é‚£åœºæ¼‚æµä¹‹æ—…æœªæ›¾å‘ç”Ÿè¿‡ï¼Œé•¿è‰¯ä¹Ÿå›åˆ°äº†å¹³é™çš„ç”Ÿæ´»ä¹‹ä¸­ã€‚æ²¡æœ‰æƒ³è±¡ä¸­çš„ç»ˆæˆçœ·å±ï¼Œæ²¡æœ‰æƒ³è±¡ä¸­çš„è½°è½°çƒˆçƒˆï¼Œä½†çš„ç¡®æœ‰ä»€ä¹ˆå‘ç”Ÿäº†å˜åŒ–ï¼Œé•¿è‰¯æˆé•¿äº†ï¼Œä¸å†æ˜¯æ¶ˆæç”Ÿæ´»ï¼Œè€Œæ˜¯èƒ½å¤ŸæŠ¬èµ·èƒ¸è†›è‡ªä¿¡åœ°èµ°ä¸‹å»ã€‚ä½œä¸ºè§‚ä¼—çš„æˆ‘æ¥è¯´ï¼Œæ•…äº‹çš„ç»“å±€å¹¶æ²¡æœ‰äº‹äº‹å¦‚æ„¿ï¼Œä½†è¿™å°±æ˜¯ç”Ÿæ´»ä¸æ˜¯å—ï¼Ÿ</p><p>è¿™æ˜¯ä¸€åœºåä¸ºâ€æˆé•¿â€œçš„é’æ˜¥æ¼‚æµä¹‹æ—…ã€‚</p><h1 id="åè®°"><a class="markdownIt-Anchor" href="#åè®°"></a> åè®°</h1><p>äºæˆ‘è€Œè¨€ï¼Œ æˆ‘ä¸çŸ¥é“è‡ªå·±çš„é’æ˜¥ä½•æ—¶å¼€å§‹ï¼Œæ›´æ— ä»è°ˆèµ·ä½•æ—¶ç»“æŸï¼Œæˆ‘æƒ³è‡ªèº«æˆ–è®¸è¿˜æ²¡ç»å†è¿‡æˆé•¿çš„é˜µç—›ï¼Œæˆ‘è¿˜æ˜¯å¸¦æœ‰å­©å­èˆ¬çš„å¤©çœŸå’Œç¨šæ°”ï¼Œä¸å…·æœ‰æˆ‘è¿™ä¸ªå¹´é¾„åº”æœ‰çš„æˆç†Ÿå’Œåšæ¯…ã€‚æˆ‘æƒ³ï¼Œæˆ‘æ˜¯æ¸´æœ›æˆé•¿çš„ï¼Œä¹Ÿå¸Œæœ›è‡ªå·±å˜å¾—è´Ÿè´£ä»»æœ‰æ‹…å½“ï¼Œä½†æ€»æ˜¯ç¼ºä¹å®é™…è¡ŒåŠ¨ã€‚æˆ–è®¸æ”¹å˜æ˜¯æœ‰çš„ï¼Œä½†è¿˜æ˜¯å¤ªå°ï¼Œè¿˜æ˜¯å¤ªæ…¢ï¼Œè¿˜æ˜¯ä¸æ»¡è¶³ã€‚å˜›ï¼Œæˆ–è®¸ä¹Ÿä¸èƒ½æ“ä¹‹è¿‡æ€¥ã€‚</p><p>ä½ å¯ä»¥å¾ˆèœï¼Œä½†ä½ ä¸èƒ½ä¸€ç›´èœã€‚</p><p>ä½ å¯ä»¥å¤©çœŸï¼Œä½†ä½ ä¸èƒ½ä¸€ç›´å¤©çœŸã€‚</p><p>ä½ å¯ä»¥é€ƒé¿ï¼Œä½†ä½ ä¸èƒ½ä¸€ç›´é€ƒé¿ã€‚</p><p class='note note-primary'>  <font size='4'>äººç”Ÿå°±æ˜¯æ°¸æ— æ­¢å¢ƒçš„å¾’åŠ³ï¼Œä½†æ­£æ˜¯å› ä¸ºä¸€åˆ‡çš†æ— æ„ä¹‰ï¼Œæ‰€ä»¥ã€Œæ´»ç€ã€çš„è¿™ä¸ªç¬é—´ï¼Œè¿™ä¸ªå…‰èŠ’æ‰ä¼šæ— æ¯”çè´µï¼Œå› ä¸ºé‚£ä¸ªç¬é—´æ˜¯åªå±äºé‚£ä¸ªäººè‡ªå·±çš„ã€‚</font></p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202201025436.png" alt="" style="zoom: 50%;" /></center>]]></content>
    
    
    <categories>
      
      <category>å¨±ä¹</category>
      
      <category>åŠ¨æ¼«</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¼‚æµå°‘å¹´</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GDBè°ƒè¯•å­¦ä¹ </title>
    <link href="/2022/02/16/2022-02/2022-02-16%20GDB%E8%B0%83%E8%AF%95%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/02/16/2022-02/2022-02-16%20GDB%E8%B0%83%E8%AF%95%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h1><p>GDBæ˜¯ä¸€ä¸ªç”±GNUå¼€æºç»„ç»‡å‘å¸ƒçš„ã€UNIX / LINUXæ“ä½œç³»ç»Ÿä¸‹çš„ã€åŸºäºå‘½ä»¤è¡Œçš„ã€åŠŸèƒ½å¼ºå¤§çš„ç¨‹åºè°ƒè¯•å·¥å…·ã€‚ å¯¹äºä¸€åLinuxä¸‹å·¥ä½œçš„c/c++ç¨‹åºå‘˜ï¼Œgdbæ˜¯å¿…ä¸å¯å°‘çš„å·¥å…·ã€‚æ ‡å‡†çš„ GDB æ˜¯çº¯å‘½ä»¤è¡Œå¼çš„ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›åŸºäºå®ƒçš„å›¾å½¢åŒ–å·¥å…·ï¼ˆæ¯”å¦‚ DDDã€Data Display Debuggerï¼‰ï¼Œä½†ç”¨å¥½ GDB å‘½ä»¤è¡Œè°ƒè¯•ï¼Œè¿˜æ˜¯æˆ‘ä»¬çš„ä¸€é¡¹åŸºæœ¬ç´ è´¨ã€‚</p><p>**GDB ä¸ä»…æ˜¯ä¸€ä¸ªè°ƒè¯•å·¥å…·ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ªå­¦ä¹ æºç çš„å¥½å·¥å…·ã€‚**å•çº¯çš„æºç æ˜¯é™æ€çš„ï¼Œè™½ç„¶ä½ å¯ä»¥åˆ†æå®ƒçš„æ•´ä½“æ¶æ„ï¼Œåœ¨å¤´è„‘é‡Œæ¨¡æ‹Ÿå‡ºå®ƒçš„å·¥ä½œæµç¨‹ï¼Œä½†è®¡ç®—æœºå®åœ¨æ˜¯å¤ªå¤æ‚äº†ï¼Œå†…å¤–éƒ¨ç¯å¢ƒå› ç´ å¾ˆå¤šï¼Œä»…é â€œäººè‚‰åˆ†æâ€å¾ˆéš¾å®Œå…¨ç†è§£å®ƒçš„é€»è¾‘ã€‚è¿™ä¸ªæ—¶å€™ï¼ŒGDB å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œä»¥è°ƒè¯•æ¨¡å¼å¯åŠ¨ï¼Œä»»æ„è®¾å®šå¤–éƒ¨æ¡ä»¶ï¼Œä»æŒ‡å®šçš„å…¥å£è¿è¡Œï¼ŒæŠŠç¨‹åºæ”¾æ…¢å‡ ä¸‡å€ï¼Œç»†è‡´åœ°è§‚å¯Ÿæ¯ä¸ªå˜é‡çš„å€¼ï¼Œè·Ÿè¸ªä»£ç çš„åˆ†æ”¯å’Œæ•°æ®çš„æµå‘ï¼Œè¿™æ ·èµ°ä¸Šå‡ ä¸ªæ¥å›ä¹‹åï¼Œå†ç»“åˆæºç ï¼Œå°±èƒ½å¤Ÿå¯¹ç¨‹åºçš„æ•´ä½“æƒ…å†µâ€œäº†ç„¶äºèƒ¸â€ã€‚</p><p>æœ¬ç¯‡æ–‡ç« å°†ç®€å•åœ°ä»‹ç» GDB å¸¸è§ç”¨æ³•ï¼Œæ›´å¤šå†…å®¹å¯ä»¥å‚è€ƒä¸‹é¢çš„æ–‡ç« ï¼š</p><ul><li><a href="https://blog.csdn.net/niyaozuozuihao/article/details/91802994">linuxä¸‹gdbè°ƒè¯•æ–¹æ³•ä¸æŠ€å·§æ•´ç†</a><sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="linuxä¸‹gdbè°ƒè¯•æ–¹æ³•ä¸æŠ€å·§æ•´ç†">[1]</span></a></sup></li><li><a href="https://github.com/hellogcc/100-gdb-tips">ã€Š100ä¸ªgdbå°æŠ€å·§ã€‹</a><sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="ã€Š100ä¸ªgdbå°æŠ€å·§ã€‹">[2]</span></a></sup> (å¼ºçƒˆæ¨è)</li></ul><h1 id="gdbä½¿ç”¨æµç¨‹"><a class="markdownIt-Anchor" href="#gdbä½¿ç”¨æµç¨‹"></a> GDBä½¿ç”¨æµç¨‹</h1><h2 id="1å¯åŠ¨gdbè°ƒè¯•"><a class="markdownIt-Anchor" href="#1å¯åŠ¨gdbè°ƒè¯•"></a> 1.å¯åŠ¨GDBè°ƒè¯•</h2><p>æµ‹è¯•ç¨‹åºæºä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">square</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> x * x;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_num</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> x_2 = <span class="hljs-built_in">square</span>(x);<br>    <span class="hljs-keyword">return</span>  x_2;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">int</span> a = <span class="hljs-number">10</span>;<br>    <span class="hljs-keyword">int</span> b = <span class="hljs-built_in">get_num</span>(a);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯åŠ¨å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">gcc test.cpp -o test # ç¼–è¯‘æºæ–‡ä»¶<br>gdb test<br>gdb -q test # -q è¡¨ç¤ºä¸æ‰“å°gdbç‰ˆæœ¬ä¿¡æ¯ï¼Œç•Œé¢è¾ƒä¸ºå¹²å‡€ï¼›<br></code></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202160948610.png" alt="å¯åŠ¨gdb" /></p><h2 id="2æŸ¥çœ‹æºç "><a class="markdownIt-Anchor" href="#2æŸ¥çœ‹æºç "></a> 2.æŸ¥çœ‹æºç </h2><p><strong>list(ç®€å†™ l)</strong>ï¼š æŸ¥çœ‹æºç¨‹åºä»£ç ï¼Œé»˜è®¤æ˜¾ç¤º10è¡Œï¼ŒæŒ‰å›è½¦é”®æˆ–ç»§ç»­è¾“å…¥<code>l</code>æŸ¥çœ‹ä¸‹10è¡Œã€‚</p><p>æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202160951660.png" alt="list æŸ¥çœ‹æºç¨‹åºä»£ç " /></p><h2 id="3è¿è¡Œç¨‹åº"><a class="markdownIt-Anchor" href="#3è¿è¡Œç¨‹åº"></a> 3.è¿è¡Œç¨‹åº</h2><p><strong>run(ç®€å†™ r)</strong> ï¼šè¿è¡Œç¨‹åºç›´åˆ°é‡åˆ° ç»“æŸæˆ–è€…é‡åˆ°æ–­ç‚¹ç­‰å¾…ä¸‹ä¸€ä¸ªå‘½ä»¤ï¼›<br />æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼ˆè¿™é‡Œæˆ‘æ²¡æœ‰è®¾ç½®æ–­ç‚¹ï¼Œæ‰€ä»¥ç¨‹åºç›´æ¥è¿è¡Œåˆ°ç»“æŸï¼‰ï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202160953401.png" alt="run è¿è¡Œç¨‹åº" /></p><h2 id="4è®¾ç½®æ–­ç‚¹"><a class="markdownIt-Anchor" href="#4è®¾ç½®æ–­ç‚¹"></a> 4.è®¾ç½®æ–­ç‚¹</h2><p><strong>break(ç®€å†™ b)</strong> ï¼šå‘½ä»¤æ ¼å¼ <code>b è¡Œå·</code>ï¼Œåœ¨æŸè¡Œè®¾ç½®æ–­ç‚¹ï¼›<br /><strong>info breakpoints</strong> (ç®€å†™ <code>i b</code>) ï¼šæ˜¾ç¤ºæ–­ç‚¹ä¿¡æ¯</p><ul><li>Numï¼š æ–­ç‚¹ç¼–å·</li><li>Typeï¼šç±»å‹ï¼Œbreakpoint æˆ–è€… watchpoint</li><li>Dispï¼šæ–­ç‚¹æ‰§è¡Œä¸€æ¬¡ä¹‹åæ˜¯å¦æœ‰æ•ˆ kepï¼šæœ‰æ•ˆ disï¼šæ— æ•ˆ</li><li>Enbï¼š å½“å‰æ–­ç‚¹æ˜¯å¦æœ‰æ•ˆ yï¼šæœ‰æ•ˆ nï¼šæ— æ•ˆ</li><li>Addressï¼šå†…å­˜åœ°å€</li><li>Whatï¼šä½ç½®</li></ul><p>æ¼”ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202160957555.png" alt="b è®¾ç½®æ–­ç‚¹" /></p><h2 id="5å•æ­¥æ‰§è¡Œ"><a class="markdownIt-Anchor" href="#5å•æ­¥æ‰§è¡Œ"></a> 5.å•æ­¥æ‰§è¡Œ</h2><p>é¦–å…ˆéœ€è¦è¾“å…¥<code>run</code>å¯åŠ¨ç¨‹åºï¼Œè¿è¡Œåˆ°ç¬¬ä¸€ä¸ªæ–­ç‚¹å¤„ï¼Œç„¶åå¯ä»¥é€‰æ‹©<code>step</code>å•æ­¥è°ƒè¯•ï¼ˆå¦‚æœæœ‰å‡½æ•°è°ƒç”¨åˆ™è¿›å…¥å‡½æ•°ï¼‰ï¼Œ<code>next</code>å•æ­¥è·Ÿè¸ªç¨‹åºï¼ˆé‡åˆ°å‡½æ•°è°ƒç”¨ï¼Œç›´æ¥è°ƒç”¨å‡½æ•°ï¼Œä¸ä¼šè¿›å…¥å‡½æ•°ä½“å†…ï¼‰ï¼Œ<code>continue</code>ç»§ç»­è¿è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹å¤„ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202161026973.png" alt="æ‰§è¡Œç¨‹åº" /></p><hr /><p>ç¨‹åºè¿è¡Œçš„ç›¸å…³å‘½ä»¤å¦‚ä¸‹ï¼š</p><ul><li><strong>run</strong>ï¼šç®€è®°ä¸º r ï¼Œå…¶ä½œç”¨æ˜¯è¿è¡Œç¨‹åºï¼Œå½“é‡åˆ°æ–­ç‚¹åï¼Œç¨‹åºä¼šåœ¨æ–­ç‚¹å¤„åœæ­¢è¿è¡Œï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥ä¸‹ä¸€æ­¥çš„å‘½ä»¤ã€‚</li><li><strong>continue</strong> ï¼ˆç®€å†™c ï¼‰ï¼šç»§ç»­æ‰§è¡Œï¼Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹å¤„ï¼ˆæˆ–è¿è¡Œç»“æŸï¼‰</li><li><strong>next</strong>ï¼šï¼ˆç®€å†™ nï¼‰ï¼Œå•æ­¥è·Ÿè¸ªç¨‹åºï¼Œå½“é‡åˆ°å‡½æ•°è°ƒç”¨æ—¶ï¼Œä¹Ÿä¸è¿›å…¥æ­¤å‡½æ•°ä½“ï¼›æ­¤å‘½ä»¤åŒstep çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼Œstep é‡åˆ°ç”¨æˆ·è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œå°†æ­¥è¿›åˆ°å‡½æ•°ä¸­å»è¿è¡Œï¼Œè€Œ next åˆ™ç›´æ¥è°ƒç”¨å‡½æ•°ï¼Œä¸ä¼šè¿›å…¥åˆ°å‡½æ•°ä½“å†…ã€‚</li><li><strong>step</strong> ï¼ˆç®€å†™sï¼‰ï¼šå•æ­¥è°ƒè¯•å¦‚æœæœ‰å‡½æ•°è°ƒç”¨ï¼Œåˆ™è¿›å…¥å‡½æ•°ï¼›ä¸å‘½ä»¤nä¸åŒï¼Œnæ˜¯ä¸è¿›å…¥è°ƒç”¨çš„å‡½æ•°çš„</li><li><strong>until</strong>ï¼šå½“ä½ åŒå€¦äº†åœ¨ä¸€ä¸ªå¾ªç¯ä½“å†…å•æ­¥è·Ÿè¸ªæ—¶ï¼Œè¿™ä¸ªå‘½ä»¤å¯ä»¥è¿è¡Œç¨‹åºç›´åˆ°é€€å‡ºå¾ªç¯ä½“ã€‚</li><li><strong>until+è¡Œå·</strong>ï¼š è¿è¡Œè‡³æŸè¡Œï¼Œä¸ä»…ä»…ç”¨æ¥è·³å‡ºå¾ªç¯</li><li><strong>finish</strong>ï¼š è¿è¡Œç¨‹åºï¼Œç›´åˆ°å½“å‰å‡½æ•°å®Œæˆè¿”å›ï¼Œå¹¶æ‰“å°å‡½æ•°è¿”å›æ—¶çš„å †æ ˆåœ°å€å’Œè¿”å›å€¼åŠå‚æ•°å€¼ç­‰ä¿¡æ¯ã€‚</li><li><strong>call å‡½æ•°(å‚æ•°)</strong>ï¼šè°ƒç”¨ç¨‹åºä¸­å¯è§çš„å‡½æ•°ï¼Œå¹¶ä¼ é€’â€œå‚æ•°â€ï¼Œå¦‚ï¼šcall gdb_test(55)</li></ul><h2 id="6æŸ¥çœ‹å˜é‡"><a class="markdownIt-Anchor" href="#6æŸ¥çœ‹å˜é‡"></a> 6.æŸ¥çœ‹å˜é‡</h2><ul><li>print ï¼šæ‰“å°å˜é‡æˆ–è¡¨è¾¾å¼çš„å€¼</li><li>whatis ï¼šæŸ¥è¯¢å˜é‡æˆ–å‡½æ•°</li><li>pt ï¼šè·Ÿwhatisä½œç”¨ç±»ä¼¼</li><li>displayï¼šåœ¨å•æ­¥è°ƒè¯•çš„æ—¶å€™å¾ˆæœ‰ç”¨ï¼Œä½¿ç”¨displayå‘½ä»¤è®¾ç½®ä¸€ä¸ªè¡¨è¾¾å¼åï¼Œå®ƒå°†åœ¨æ¯æ¬¡å•æ­¥è¿›è¡ŒæŒ‡ä»¤åï¼Œç´§æ¥ç€è¾“å‡ºè¢«è®¾ç½®çš„è¡¨è¾¾å¼åŠå€¼ã€‚<ul><li>å¯ä»¥é€šè¿‡info dispalyï¼ŒæŸ¥çœ‹å½“å‰è¢«è®¾ç½®çš„å˜é‡ï¼Œç„¶åå¯ä»¥ç”¨undisplay numï¼ˆå˜é‡å¯¹åº”çš„ç¼–å·ï¼‰å–æ¶ˆè®¾ç½®</li></ul></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202161039792.png" alt="æŸ¥çœ‹å˜é‡" /></p><h2 id="7é€€å‡ºgdb"><a class="markdownIt-Anchor" href="#7é€€å‡ºgdb"></a> 7.é€€å‡ºGDB</h2><p>ä½¿ç”¨<code>quit</code>å‘½ä»¤é€€å‡ºå³å¯ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202161041935.png" alt="é€€å‡ºgdb" /></p><h1 id="gdbå¸¸ç”¨å‘½ä»¤"><a class="markdownIt-Anchor" href="#gdbå¸¸ç”¨å‘½ä»¤"></a> GDBå¸¸ç”¨å‘½ä»¤</h1><p>ä¸‹é¢åˆ—å‡ºæœ€å¸¸ç”¨çš„GDBå‘½ä»¤ï¼š</p><ul><li>ptï¼šæŸ¥çœ‹å˜é‡çš„çœŸå®ç±»å‹ï¼Œä¸å— typedef çš„å½±å“ã€‚</li><li>btï¼šæ˜¾ç¤ºå½“å‰è°ƒç”¨å †æ ˆã€‚</li><li>up/downï¼šåœ¨å‡½æ•°è°ƒç”¨æ ˆé‡Œä¸Šä¸‹ç§»åŠ¨ã€‚æˆ–è€…ä½¿ç”¨<code>frame å‡½æ•°å¸§å·</code>è·³è½¬ã€‚</li><li>finï¼šç›´æ¥è¿è¡Œåˆ°å‡½æ•°ç»“æŸã€‚</li><li>i bï¼šæŸ¥çœ‹æ‰€æœ‰çš„æ–­ç‚¹ä¿¡æ¯ã€‚</li><li>i localsï¼šæŸ¥çœ‹å½“å‰å †æ ˆé¡µçš„æ‰€æœ‰å˜é‡ã€‚</li><li>whï¼šå¯åŠ¨â€œå¯è§†åŒ–è°ƒè¯•â€ã€‚è¿™ä¸ªæ˜¯æˆ‘æœ€å–œæ¬¢çš„å‘½ä»¤ï¼Œå¯ä»¥æŠŠå±å¹•åˆ†æˆä¸Šä¸‹ä¸¤ä¸ªçª—å£ï¼Œä¸Šé¢æ˜¾ç¤ºæºç ï¼Œä¸‹é¢æ˜¯ GDB å‘½ä»¤è¾“å‡ºï¼Œä¸å¿…å†ç”¨â€œlâ€é¢‘ç¹åœ°åˆ—å‡ºæºç äº†ï¼Œèƒ½å¤Ÿå¤§å¤§æé«˜è°ƒè¯•çš„æ•ˆç‡ã€‚<ul><li>ctrl x + a ï¼šé€€å‡ºæˆ–è¿›å…¥å¯è§†åŒ–æ¨¡å¼</li></ul></li><li>layout regsï¼šæ˜¾ç¤ºæºä»£ç /æ±‡ç¼–å’Œå¯„å­˜å™¨çª—å£</li><li>layout splitï¼šæ˜¾ç¤ºæºä»£ç å’Œæ±‡ç¼–çª—å£</li></ul><h1 id="åˆ†æcoredump"><a class="markdownIt-Anchor" href="#åˆ†æcoredump"></a> åˆ†æCoreDump</h1><p>åœ¨çœŸå®ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç¨‹åºå¯èƒ½ä¼šå´©æºƒè€Œäº§ç”ŸCoreDumpæ–‡ä»¶ï¼Œæ­¤æ—¶æˆ‘ä»¬é€šå¸¸å°±éœ€è¦ç”¨gdbæ¥è°ƒè¯•CoreDumpæ–‡ä»¶ï¼Œåˆ†æç¨‹åºå´©æºƒçš„åŸå› ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæ¥æ¨¡æ‹Ÿè¿™ä¸€è¿‡ç¨‹ã€‚é¦–å…ˆéœ€è¦ä¿®æ”¹ä¸‹æºä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">square</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> x * x;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_num</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> x_2 = <span class="hljs-built_in">square</span>(x);<br>    <span class="hljs-keyword">return</span>  x_2;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">int</span> a = <span class="hljs-number">10</span>;<br>    <span class="hljs-keyword">int</span> b = <span class="hljs-built_in">get_num</span>(a);<br>    <span class="hljs-keyword">int</span>* p = <span class="hljs-literal">NULL</span>;<br>    *p = <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶åç¼–è¯‘ç”Ÿæˆæ–°çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">gcc -g test.cpp -o test6<br></code></pre></td></tr></table></figure><p>ç„¶åéœ€è¦ä¿®æ”¹ä¸‹é…ç½®<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="è®©ç¨‹åºå´©æºƒåç”ŸæˆCore Dump">[3]</span></a></sup>ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ä½œç”¨æ˜¯è®©ç¨‹åºå´©æºƒæ˜¯äº§ç”Ÿçš„core dumpæ–‡ä»¶å¤§å°æ²¡æœ‰é™åˆ¶ï¼Œé»˜è®¤æ˜¯0è¡¨ç¤ºä¸ç”Ÿæˆcore dumpæ–‡ä»¶</span><br>ulimit -c unlimited<br></code></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œä¿®æ”¹åçš„ç¨‹åºï¼Œå‘ç”Ÿæ®µé”™è¯¯ï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202161515053.png" alt="ç¨‹åºå´©æºƒå‘ç”Ÿæ®µé”™è¯¯" /></p><p>ä½†å¥‡æ€ªçš„æ˜¯ï¼Œå¹¶æ²¡æœ‰ç”Ÿæˆcoreæ–‡ä»¶ï¼Œæ˜æ˜æˆ‘å·²ç»ä¿®æ”¹äº†ulimitã€‚åæ¥å‡ ç»æ³¢æŠ˜ï¼Œå‘ç°äº†åŸå› ï¼Œå‚è€ƒ<a href="https://baijiahao.baidu.com/s?id=1599347824327158577&amp;wfr=spider&amp;for=pc">åœ¨Linuxä¸Šåˆ©ç”¨core dumpå’ŒGDBè°ƒè¯•segfault</a><sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="åœ¨Linuxä¸Šåˆ©ç”¨core dumpå’ŒGDBè°ƒè¯•segfault">[4]</span></a></sup>ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯Ubuntué»˜è®¤å¿½ç•¥éUbuntuè½¯ä»¶åŒ…çš„äºŒè¿›åˆ¶æ–‡ä»¶çš„å´©æºƒæ—¥å¿—ï¼Œä¹Ÿå°±ä¸ä¼šäº§ç”Ÿcore dumpæ–‡ä»¶ã€‚è°ƒæ•´çš„åšæ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯é‡æ–°è®¾ç½®kernel.core_patternçš„å€¼ï¼ˆè¯¥å€¼è¡¨ç¤ºcore dumpæ–‡ä»¶çš„è¾“å‡ºç›®å½•ï¼‰ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo sysctl -w kernel.core_pattern=/tmp/core/core-%e.%p.%h.%t<br></code></pre></td></tr></table></figure><p>ç°åœ¨å†æ‰§è¡Œä¹‹å‰çš„ç¨‹åºï¼Œå°±å¯ä»¥åœ¨å¯¹åº”ç›®å½•ä¸‹ç”Ÿæˆcore dumpæ–‡ä»¶ï¼Œå¹¶å¯ä»¥ç”¨gdbæ¥è¿›è¡Œè°ƒè¯•åˆ†æï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°å‡ºé”™åŸå› åœ¨æºä»£ç çš„ç¬¬15è¡Œï¼Œå¯¹ä¸€ä¸ªç©ºæŒ‡é’ˆèµ‹å€¼ï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202161511784.png" alt="è°ƒè¯•coreæ–‡ä»¶" /></p><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://blog.csdn.net/niyaozuozuihao/article/details/91802994">linuxä¸‹gdbè°ƒè¯•æ–¹æ³•ä¸æŠ€å·§æ•´ç†</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://github.com/hellogcc/100-gdb-tips">ã€Š100ä¸ªgdbå°æŠ€å·§ã€‹</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://www.cnblogs.com/chingliu/archive/2011/07/25/2223815.html">è®©ç¨‹åºå´©æºƒåç”ŸæˆCore Dump</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://baijiahao.baidu.com/s?id=1599347824327158577&amp;wfr=spider&amp;for=pc">åœ¨Linuxä¸Šåˆ©ç”¨core dumpå’ŒGDBè°ƒè¯•segfault</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GDB</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€éªšæ“ä½œã€‘MacOSä¸Šè‡ªåŠ¨å‹ç¼©æˆªå›¾</title>
    <link href="/2022/02/15/2022-02/2022-02-15%20%E3%80%90%E9%AA%9A%E6%93%8D%E4%BD%9C%E3%80%91MacOS%E4%B8%8A%E8%87%AA%E5%8A%A8%E5%8E%8B%E7%BC%A9%E6%88%AA%E5%9B%BE/"/>
    <url>/2022/02/15/2022-02/2022-02-15%20%E3%80%90%E9%AA%9A%E6%93%8D%E4%BD%9C%E3%80%91MacOS%E4%B8%8A%E8%87%AA%E5%8A%A8%E5%8E%8B%E7%BC%A9%E6%88%AA%E5%9B%BE/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>ä¹‹å‰å†™åšå®¢ä¸€ç›´æ˜¯ç”¨ picgo + github ä½œä¸º typoraçš„å›¾åºŠï¼Œä½†æ˜¯æœ‰æ—¶å€™ç½‘ä¸å¤ªè¡Œï¼Œå›¾ç‰‡æ˜¾ç¤ºå¾—å¾ˆæ…¢ã€‚æ‰€ä»¥åæ¥æ¢äº† gitee ä½œä¸ºå›¾åºŠï¼Œä½†æ˜¯å‘ç°ä»ç„¶æœ‰æ—¶å€™å›¾ç‰‡æ— æ³•æ˜¾ç¤ºï¼Œä½†æ˜¯é€šè¿‡æµè§ˆå™¨çš„URLè®¿é—®æ²¡æœ‰é—®é¢˜ï¼Œè¿™å°±è®©æˆ‘å¾ˆç–‘æƒ‘ï¼Œåæ¥æŸ¥é˜…èµ„æ–™å‘ç°ï¼Œgitee å±…ç„¶ä¸æ”¯æŒ 1M ä»¥ä¸Šå›¾ç‰‡çš„æŸ¥çœ‹<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="è®°ä¸€æ¬¡cssæ–‡ä»¶å¼•èµ·çš„è·¨åŸŸé—®é¢˜ï¼ˆgiteeå›¾ç‰‡è¶…è¿‡1Méœ€è¦ç™»å½•æŸ¥çœ‹) â†©">[1]</span></a></sup>ï¼Œè¿™å¯å¤ªå‘äº†ã€‚</p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202152050052.jpeg" alt="æƒŠäº†" style="zoom: 25%;" /></center><p>ç„¶åæˆ‘å°±æƒ³ç€èƒ½ä¸èƒ½åšåˆ°è‡ªåŠ¨å‹ç¼©æˆªå›¾å¤§å°ï¼Œæ¥å®ç°æ›²çº¿æ•‘å›½ï¼Œé€šè¿‡æŸ¥é˜…ç½‘ä¸Šèµ„æ–™ï¼Œè¿˜çœŸè®©æˆ‘æ‰¾åˆ°äº†æ–¹æ³•ã€‚</p><h1 id="è‡ªåŠ¨å‹ç¼©æˆªå›¾"><a class="markdownIt-Anchor" href="#è‡ªåŠ¨å‹ç¼©æˆªå›¾"></a> è‡ªåŠ¨å‹ç¼©æˆªå›¾</h1><p>å®ç°æ–¹æ³•å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href="https://depp.wang/2020/08/07/how-to-automatically-compress-screenshot-size-in-macos/">åœ¨ macOS ä¸­ï¼Œå¦‚ä½•è‡ªåŠ¨å‹ç¼©æˆªå±å›¾ç‰‡å¤§å°</a><sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="åœ¨ macOS ä¸­ï¼Œå¦‚ä½•è‡ªåŠ¨å‹ç¼©æˆªå±å›¾ç‰‡å¤§å°">[2]</span></a></sup>ï¼Œé‡Œé¢å†™å¾—å¾ˆè¯¦ç»†äº†ï¼Œæˆ‘è¿™é‡Œå°±ç®€å•åœ°æè¿°ä¸‹å®ç°åŸç†ï¼Œå¹¶æ¼”ç¤ºå®é™…æ•ˆæœã€‚</p><h2 id="å®ç°åŸç†"><a class="markdownIt-Anchor" href="#å®ç°åŸç†"></a> å®ç°åŸç†</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“æœ‰ä¸€äº›åŠæ³•èƒ½å¤Ÿè°ƒæ•´å›¾ç‰‡å¤§å°ï¼Œæ¯”å¦‚åˆ©ç”¨MacOSä¸Šçš„é¢„è§ˆï¼Œå¯¹å›¾ç‰‡è¿›è¡Œå¯¼å‡ºï¼Œå°±å¯ä»¥å®ç°å‹ç¼©å›¾ç‰‡å¤§å°ã€‚è¿˜å¯ä»¥é€šè¿‡å…¶ä»–è½¯ä»¶ï¼Œæˆ–è€…å‘½ä»¤è¡Œå·¥å…·ï¼ˆä¾‹å¦‚pngquantï¼ŒImageMagickï¼‰æ¥å‹ç¼©å›¾ç‰‡ã€‚ä½†æ˜¯ä¸Šé¢å¦‚æœæ‰‹åŠ¨æ“ä½œå°±æœ‰ç‚¹ç¹çäº†ï¼Œ æ‰€ä»¥å…³é”®åœ¨äºå¦‚ä½•å®ç°â€œ<strong>è‡ªåŠ¨</strong>â€çš„æ•ˆæœã€‚</p><p>æåˆ°â€œè‡ªåŠ¨â€ï¼Œé‚£ä¹ˆè‡ªç„¶å°±éœ€è¦è‡ªåŠ¨çš„å·¥ä½œæµè½¯ä»¶äº†ï¼Œä¹Ÿå°±æ˜¯ Hazel æˆ–è€…  Automatorï¼Œåˆ©ç”¨å·¥ä½œæµè½¯ä»¶ï¼Œæ¥è‡ªåŠ¨åœ°å¯¹æˆªå›¾è¿›è¡Œå‹ç¼©ã€‚å®Œæ•´æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>å°†æˆªå›¾ä¿å­˜åˆ°ä¸€ä¸ªç›®å½•ä¸­ï¼›</li><li>åˆ©ç”¨ Hazel æˆ–è€… Automator å·¥ä½œæµè½¯ä»¶ï¼Œè‡ªåŠ¨è§¦å‘è„šæœ¬ï¼›</li><li>åœ¨è„šæœ¬ä¸­ï¼Œä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·å¯¹æˆªå›¾è¿›è¡Œå‹ç¼©å¹¶ä¿å­˜ï¼›</li><li>å°†å‹ç¼©åçš„å›¾ç‰‡å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼ˆä¹Ÿæ˜¯åˆ©ç”¨è„šæœ¬å®Œæˆï¼‰ï¼›</li><li>å±å¹•é€šçŸ¥å›¾ç‰‡å‹ç¼©å®Œæˆï¼›</li><li>ï¼ˆå¯é€‰ï¼‰å°†å‹ç¼©åçš„å›¾ç‰‡åˆ é™¤ã€‚</li></ol><h2 id="å®é™…æ¼”ç¤º"><a class="markdownIt-Anchor" href="#å®é™…æ¼”ç¤º"></a> å®é™…æ¼”ç¤º</h2><p>æ¥ä¸‹æ¥æˆ‘å°†æ¼”ç¤ºå¦‚ä½•é…ç½® Hazel ï¼ŒAutomator å¯ä»¥å‚è€ƒä¸Šé¢åšæ–‡çš„å†…å®¹ã€‚</p><ol><li>é¦–å…ˆé€‰æ‹©ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä½œä¸ºå­˜æ”¾æˆªå›¾çš„ç›®å½•ã€‚</li></ol><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202152110926.png" alt="é€‰æ‹©æˆªå›¾ç›®å½•" style="zoom: 50%;" /></center>2. ç„¶åæ·»åŠ è§„åˆ™<center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202152112016.png" alt="æ·»åŠ è§„åˆ™" style="zoom:50%;" /></center>3. é…ç½®è§„åˆ™ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º<p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202152113647.png" alt="é…ç½®è§„åˆ™" /></p><ol start="4"><li>å…·ä½“è„šæœ¬å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202152115294.png" alt="å‹ç¼©å›¾ç‰‡å¹¶å¤åˆ¶åˆ°å‰ªè´´æ¿" /></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">pngquant 128 --skip-if-larger --strip --ext=.png --force &quot;$1&quot;<br>osascript -e &quot;set the clipboard to (read (POSIX file \&quot;$(perl -e &quot;print glob(&#x27;$1&#x27;)&quot;)\&quot;) as &#123;Â«class PNGfÂ»&#125;)&quot;<br></code></pre></td></tr></table></figure><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202152116588.png" alt="å±å¹•æç¤º" /></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">The compressed image `file` has been copied to the clipboard.<br></code></pre></td></tr></table></figure><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202152116561.png" alt="åˆ é™¤æˆªå›¾" /></p><p>æœ€ååˆ é™¤æˆªå›¾æ˜¯å¯é€‰çš„ï¼Œå› ä¸ºåœ¨typoraé‡Œå›¾ç‰‡å¤åˆ¶åè‡ªåŠ¨ä¸Šä¼ ï¼Œæ‰€ä»¥æˆ‘å°±è®¾ç½®äº†åˆ é™¤æˆªå›¾ã€‚</p><hr /><p>è‡³æ­¤å°±å®ç°äº†è‡ªåŠ¨å‹ç¼©æˆªå›¾çš„æ•ˆæœï¼Œåªè¦æ¯æ¬¡æˆªå›¾çš„æ—¶å€™ä¿å­˜åˆ°è®¾ç½®çš„ç›®å½•ï¼Œå°±ä¼šè‡ªåŠ¨å‹ç¼©å›¾ç‰‡ï¼Œå¹¶å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œç­‰å±å¹•æç¤ºâ€œå‹ç¼©å·²å®Œæˆâ€åï¼Œæˆ‘ç›´æ¥åœ¨ typora é‡Œç²˜è´´å›¾ç‰‡å³å¯ï¼Œåˆå¯ä»¥æ„‰å¿«åœ°å†™åšå®¢å–½~</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202152126405.jpeg" alt="" /></p><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.cnblogs.com/xsyz/p/14043564.html">è®°ä¸€æ¬¡cssæ–‡ä»¶å¼•èµ·çš„è·¨åŸŸé—®é¢˜ï¼ˆgiteeå›¾ç‰‡è¶…è¿‡1Méœ€è¦ç™»å½•æŸ¥çœ‹)</a> â†©<a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://depp.wang/2020/08/07/how-to-automatically-compress-screenshot-size-in-macos/">åœ¨ macOS ä¸­ï¼Œå¦‚ä½•è‡ªåŠ¨å‹ç¼©æˆªå±å›¾ç‰‡å¤§å°</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>éªšæ“ä½œç³»åˆ—</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MacOSæŠ€å·§</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€99%ç¯å¢ƒæ­å»ºç³»åˆ—ã€‘é˜¿é‡Œäº‘æœåŠ¡å™¨é…ç½®Hexoåšå®¢</title>
    <link href="/2022/02/13/2022-02/2022-02-13%20%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AEHexo%E5%8D%9A%E5%AE%A2/"/>
    <url>/2022/02/13/2022-02/2022-02-13%20%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AEHexo%E5%8D%9A%E5%AE%A2/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>è¿™ä¸ªç¯å¢ƒæ­å»ºç³»åˆ—å¥½ä¹…æ²¡æ›´äº†ï¼Œæ‰€ä»¥è¶æ­¤æœºä¼šéš¾å¾—å¡«å‘ä¸€ä¸‹ã€‚</p><p>ä¹‹å‰ä¸€ç›´ç™½å«–æ˜¯Github pagesæ¥éƒ¨ç½²è‡ªå·±çš„åšå®¢ï¼Œç„¶åè§‰å¾—è¿˜æ˜¯æœ‰ä¸€ä¸ªè‡ªå·±çš„æœåŠ¡å™¨æ›´å¥½ä¸€ç‚¹ï¼Œè¿˜èƒ½å­¦ä¹ ç›¸å…³çŸ¥è¯†ã€‚æ‰€ä»¥è¶è¿˜æ²¡å›å­¦æ ¡ï¼ŒæŠŠè‡ªå·±çš„åšå®¢éƒ¨ç½²åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œæ¯•ç«Ÿä¹‹å‰è´­ä¹°çš„åŸŸåä¸€ç›´æ²¡ç”¨ä¸Šï¼Œç”šæ˜¯å¿ƒç—›å•Šã€‚</p><p>è¿™æ¬¡æˆ‘æ˜¯åœ¨é˜¿é‡Œäº‘ä¸Šä¹°çš„æœåŠ¡å™¨ï¼Œä¸»è¦æ˜¯å› ä¸ºä¹‹å‰åœ¨é˜¿é‡Œäº‘ä¸Šä¹°çš„åŸŸåï¼Œæ‰€ä»¥è¿™æ¬¡æ­å»ºçš„è¿‡ç¨‹å°±ç”¨é˜¿é‡Œäº‘è¿›è¡Œè¯´æ˜ã€‚</p><h1 id="æ–°å»ºç”¨æˆ·"><a class="markdownIt-Anchor" href="#æ–°å»ºç”¨æˆ·"></a> æ–°å»ºç”¨æˆ·</h1><p>è¿™é‡Œä»¥é˜¿é‡Œäº‘çš„æœåŠ¡å™¨æ¥ä¸¾ä¾‹ã€‚</p><p>é€šå¸¸åˆ›å»ºå¥½æœåŠ¡å™¨å®ä¾‹åï¼Œåœ¨é‡ç½®ä¸€ä¸‹å®ä¾‹çš„å¯†ç ï¼Œå°±å¯ä»¥ç”¨rootç”¨æˆ·è¿›è¡Œsshè¿æ¥äº†ã€‚ä½¿ç”¨rootç”¨æˆ·ç™»å½•åï¼Œæˆ‘è¿™é‡Œæ˜¯æ–°å»ºäº†ä¸€ä¸ªç”¨æˆ·ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æ–°å»ºç”¨æˆ·</span><br>adduser zyx<br><span class="hljs-meta">#</span><span class="bash"> è®¾ç½®å¯†ç </span><br>passwd zyx<br></code></pre></td></tr></table></figure><p>ç„¶åèµ‹äºˆ<code>zyx</code>ç”¨æˆ·rootæƒé™ï¼Œå…·ä½“åšæ³•æ˜¯ç¼–è¾‘<code>/etc/sudoers</code>ï¼Œåœ¨rootç”¨æˆ·ä¸‹æ–¹æ·»åŠ æ–°å¢çš„ç”¨æˆ·åï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202131602517.png" alt="image-20220213160236426" style="zoom: 67%;" /></center><h1 id="sshå…å¯†ç™»å½•"><a class="markdownIt-Anchor" href="#sshå…å¯†ç™»å½•"></a> sshå…å¯†ç™»å½•</h1><p>åœ¨æœ¬åœ°åˆ›å»ºå¯†é’¥ï¼Œä½¿ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ssh-keygen -t rsa<br></code></pre></td></tr></table></figure><p>ç„¶åä¸€ç›´å›è½¦ï¼Œåˆ›å»ºä¸€ä¸ªå¯†é’¥ã€‚å› ä¸ºæˆ‘æ˜¯macç³»ç»Ÿï¼Œç”Ÿæˆçš„å¯†é’¥æ–‡ä»¶ä½ç½®åœ¨<code>~/.ssh/id_rsa.pub</code></p><p>ç„¶åå›åˆ°æœåŠ¡å™¨ç«¯ï¼Œåˆ›å»º<code>.ssh</code>ç›®å½•ï¼ˆåœ¨å½“å‰ç”¨æˆ·çš„~ ç›®å½•ä¸‹å³å¯ï¼‰ï¼Œå¹¶ç¼–è¾‘æ–‡ä»¶<code>.ssh/authorized_keys</code>ï¼Œå¤åˆ¶ç²˜è´´åˆšåˆšåœ¨æœ¬åœ°åˆ›å»ºå¥½çš„å¯†é’¥ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim .ssh/authorized_keys<br></code></pre></td></tr></table></figure><h1 id="é…ç½®ç¯å¢ƒ"><a class="markdownIt-Anchor" href="#é…ç½®ç¯å¢ƒ"></a> é…ç½®ç¯å¢ƒ</h1><p>é¦–å…ˆéœ€è¦å®‰è£…é…ç½®ä¸€ä¸‹å¼€å‘ç›¸å…³çš„è½¯ä»¶ç¯å¢ƒäº†ï¼Œä½¿ç”¨çš„å‘½ä»¤å¦‚ä¸‹<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="hexoæœ¬åœ°åšå®¢éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨">[1]</span></a></sup>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æ›´æ–°ä¸‹è½½æº</span><br>sudo apt-get update<br><span class="hljs-meta">#</span><span class="bash"> å®‰è£… git</span><br>sudo apt install git<br><span class="hljs-meta">#</span><span class="bash"> å®‰è£… vim</span><br>sudo apt install vim<br><span class="hljs-meta">#</span><span class="bash"> å®‰è£… node.js</span><br>sudo apt install nodejs<br><span class="hljs-meta">#</span><span class="bash"> å®‰è£… nginx</span><br>sudo apt install nginx<br></code></pre></td></tr></table></figure><p>ç„¶åå†åˆ›å»ºç½‘ç«™ç›®å½•å’Œè¿œç¨‹ä»“åº“ç›®å½•ï¼Œä½¿ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> åˆ›å»ºç½‘ç«™ç›®å½•ï¼Œä»¥è¿™ä¸ªç›®å½•ä½œä¸ºåšå®¢é™æ€æ–‡ä»¶çš„å­˜æ”¾ç›®å½•ï¼Œä¹‹åå†nginxé…ç½®æ–‡ä»¶é‡Œä¼šç”¨åˆ°</span><br>mkdir /home/zyx/hexo<br><span class="hljs-meta">#</span><span class="bash"> åˆ›å»ºæœåŠ¡å™¨ä¸Šçš„è¿œç¨‹ä»“åº“ç›®å½•</span><br>git init --bare blog.git<br><span class="hljs-meta">#</span><span class="bash"> æ–°å»ºé’©å­æ–‡ä»¶</span><br>vim /home/zyx/blog.git/hooks/post-receive<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> ---------</span><br><span class="hljs-meta">#</span><span class="bash"> æŠŠå¦‚ä¸‹å†…å®¹ç²˜è´´è¿›å»</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash">!/bin/bash</span><br>git --work-tree=/home/zyx/hexo --git-dir=/home/zyx/blog.git checkout -f<br></code></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ä¸Šé¢åˆ›å»ºè¿œç¨‹ä»“åº“çš„å‘½ä»¤ï¼Œè¿™é‡ŒåŠ äº†<code>--bare</code>å‚æ•°ï¼Œè¡¨ç¤ºåˆ›å»ºçš„æ˜¯ä¸€ä¸ªè£¸ä»“åº“ï¼Œå«ä¹‰æ˜¯è¿™ä¸ªä»“åº“åªä¿å­˜gitå†å²æäº¤çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œè€Œä¸å…è®¸ç”¨æˆ·åœ¨ä¸Šé¢è¿›è¡Œå„ç§gitæ“ä½œã€‚</p></blockquote><h1 id="å¼€æ”¾ç«¯å£"><a class="markdownIt-Anchor" href="#å¼€æ”¾ç«¯å£"></a> å¼€æ”¾ç«¯å£</h1><p>åœ¨å®‰è£…å®Œnginxå¹¶å¯åŠ¨æœåŠ¡åï¼Œåœ¨æµè§ˆå™¨ä¸­ç›´æ¥è®¿é—®æœåŠ¡å™¨çš„å…¬ç½‘ipæ˜¯å¯ä»¥çœ‹åˆ°nginxçš„æ¬¢è¿é¡µçš„ã€‚ä½†æ˜¯åœ¨å®é™…æ“ä½œä¸­å´å‘ç°ï¼Œæ— æ³•è®¿é—®ã€‚åæ¥å‘ç°æ˜¯æ²¡æœ‰å¼€æ”¾ç«¯å£ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ECSäº‘æœåŠ¡å™¨çš„æ§åˆ¶å°ä¸­ï¼Œåœ¨â€<strong>ç½‘ç»œä¸å®‰å…¨</strong>â€œä¸­çš„â€<strong>å®‰å…¨ç»„</strong>â€œä¸­ï¼Œé€‰æ‹©å¯¹åº”çš„å®‰å…¨ç»„ï¼Œé€‰æ‹©â€<strong>é…ç½®è§„åˆ™</strong>â€œï¼Œå¼€æ”¾80ï¼ˆhttpï¼‰å’Œ443ï¼ˆhttpsï¼‰ç«¯å£ã€‚æœ€ç»ˆæ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼Œæ­¤æ—¶å†è®¿é—®å…¬ç½‘ipï¼Œå°±å¯ä»¥çœ‹åˆ°nginxçš„æ¬¢è¿é¡µçš„ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202131917400.png" alt="åŸŸåè§£ææ·»åŠ è®°å½•" /></p><h1 id="sslè¯ä¹¦"><a class="markdownIt-Anchor" href="#sslè¯ä¹¦"></a> SSLè¯ä¹¦</h1><p>åœ¨é˜¿é‡Œäº‘ä¸­ï¼Œæœç´¢â€SSLè¯ä¹¦â€œäº§å“ï¼Œé€‰è´­å…è´¹çš„â€œDVå•åŸŸåè¯ä¹¦â€ï¼Œç„¶ååœ¨æ§åˆ¶å°é‡Œåˆ›å»ºè¯ä¹¦ï¼Œå¡«ä¸Šè‡ªå·±è´­ä¹°çš„åŸŸåå’Œç›¸å…³ä¿¡æ¯å³å¯ã€‚ç­¾å‘æˆåŠŸåï¼Œå°±å¯ä»¥ä¸‹è½½è¯ä¹¦ã€‚</p><p>å› ä¸ºä¹‹åä½¿ç”¨nginxè¿›è¡Œé…ç½®ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œä¸‹è½½çš„ä¹Ÿå°±æ˜¯nginxå¯¹åº”çš„è¯ä¹¦ã€‚ä¸‹è½½åä¼šå¾—åˆ°ä¸€ä¸ªzipå‹ç¼©åŒ…ï¼Œè§£å‹åå¾—åˆ° <em>.key</em> å’Œ <em>.pem</em> ç»“å°¾çš„ä¸¤ä¸ªæ–‡ä»¶ã€‚</p><p>åœ¨nginxçš„å®‰è£…ç›®å½•ï¼ˆå°±æ˜¯nginx.confæ‰€åœ¨çš„ç›®å½•ï¼Œä¸çŸ¥é“çš„è¯å¯ä»¥é€šè¿‡<code>nginx -t</code>æ¥æŸ¥çœ‹é…ç½®æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼‰ä¸‹ï¼Œæ–°å»ºä¸€ä¸ª <em>cert</em> ç›®å½•ï¼Œå°†ä¸‹è½½çš„ä¸¤ä¸ªè¯ä¹¦æ–‡ä»¶æ”¾åˆ° <em>cert</em> ç›®å½•ä¸‹ã€‚</p><p>ç„¶åä¿®æ”¹ <strong>nginx.conf</strong> é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="åœ¨Nginxï¼ˆæˆ–Tengineï¼‰æœåŠ¡å™¨ä¸Šå®‰è£…è¯ä¹¦">[2]</span></a></sup>ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">server</span> &#123;<br>    <span class="hljs-string">listen</span> <span class="hljs-number">80</span><span class="hljs-string">;</span><br>    <span class="hljs-string">server_name</span> <span class="hljs-string">yourdomain.com;</span> <span class="hljs-comment">#éœ€è¦å°†yourdomain.comæ›¿æ¢æˆè¯ä¹¦ç»‘å®šçš„åŸŸåï¼Œæˆ–è€…æ˜¯åŸŸåçš„ç”¨ä¸ºIP</span><br>    <span class="hljs-string">rewrite</span> <span class="hljs-string">^(.*)$</span> <span class="hljs-string">https://$host$1;</span> <span class="hljs-comment">#å°†æ‰€æœ‰HTTPè¯·æ±‚é€šè¿‡rewriteæŒ‡ä»¤é‡å®šå‘åˆ°HTTPSã€‚</span><br>    <span class="hljs-string">location</span> <span class="hljs-string">/</span> &#123;<br>        <span class="hljs-string">index</span> <span class="hljs-string">index.html</span> <span class="hljs-string">index.htm;</span><br>    &#125;<br>&#125;<br><span class="hljs-string">server</span> &#123;<br>    <span class="hljs-comment">#å¦‚æœæ‚¨ä½¿ç”¨Nginx 1.15.0åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œè¯·ä½¿ç”¨listen 443 sslä»£æ›¿listen 443å’Œssl onã€‚</span><br>    <span class="hljs-string">listen</span> <span class="hljs-number">443</span> <span class="hljs-string">ssl;</span><br>    <span class="hljs-string">server_name</span> <span class="hljs-string">yourdomain.com;</span> <span class="hljs-comment">#éœ€è¦å°†yourdomain.comæ›¿æ¢æˆè¯ä¹¦ç»‘å®šçš„åŸŸåã€‚</span><br>    <span class="hljs-string">root</span> <span class="hljs-string">html;</span><br>    <span class="hljs-string">index</span> <span class="hljs-string">index.html</span> <span class="hljs-string">index.htm;</span><br>    <span class="hljs-string">ssl_certificate</span> <span class="hljs-string">cert/cert-file-name.pem;</span>   <span class="hljs-comment">#éœ€è¦å°†cert-file-name.pemæ›¿æ¢æˆå·²ä¸Šä¼ çš„è¯ä¹¦æ–‡ä»¶çš„åç§°ã€‚</span><br>    <span class="hljs-string">ssl_certificate_key</span> <span class="hljs-string">cert/cert-file-name.key;</span>   <span class="hljs-comment">#éœ€è¦å°†cert-file-name.keyæ›¿æ¢å·²ä¸Šä¼ çš„è¯ä¹¦ç§é’¥æ–‡ä»¶çš„åç§°ã€‚</span><br>    <span class="hljs-string">ssl_session_timeout</span> <span class="hljs-string">5m;</span><br>    <span class="hljs-string">ssl_ciphers</span> <span class="hljs-string">ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br>    <span class="hljs-string">ssl_protocols</span> <span class="hljs-string">TLSv1.1</span> <span class="hljs-string">TLSv1.2</span> <span class="hljs-string">TLSv1.3;</span><br>    <span class="hljs-string">ssl_prefer_server_ciphers</span> <span class="hljs-string">on;</span><br>    <span class="hljs-string">location</span> <span class="hljs-string">/</span> &#123;<br>        <span class="hljs-string">index</span> <span class="hljs-string">index.html</span> <span class="hljs-string">index.htm;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ç½‘ç«™å¤‡æ¡ˆ"><a class="markdownIt-Anchor" href="#ç½‘ç«™å¤‡æ¡ˆ"></a> ç½‘ç«™å¤‡æ¡ˆ</h1><h2 id="icpå¤‡æ¡ˆ"><a class="markdownIt-Anchor" href="#icpå¤‡æ¡ˆ"></a> ICPå¤‡æ¡ˆ</h2><p>åœ¨å³ä¸Šè§’æ§åˆ¶å°æ—è¾¹ï¼Œæœ‰ä¸ªâ€œICPå¤‡æ¡ˆâ€æŒ‰é’®ï¼Œç‚¹å‡»è¿™é‡Œè¿›è¡Œç½‘ç«™çš„ICPå¤‡æ¡ˆï¼ŒæŒ‰ç…§ç›¸å…³æµç¨‹æ“ä½œå³å¯<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="é˜¿é‡Œäº‘-ICPå¤‡æ¡ˆæŒ‡å¯¼">[3]</span></a></sup>ã€‚å¤‡æ¡ˆæ—¶é—´æœ€å¥½åœ¨å·¥ä½œæ—¥ï¼Œå¤§æ¦‚éœ€è¦ä¸€å¤©æ—¶é—´ã€‚è¿˜æœ‰ä¸€ä¸ªæ³¨æ„ç‚¹æ˜¯ï¼Œå¤‡æ¡ˆç”¨çš„æœåŠ¡å™¨æ‹¥æœ‰æ—¶é•¿å¿…é¡»<strong>æ»¡3ä¸ªæœˆ</strong>ä»¥ä¸Šï¼Œå¦åˆ™æ˜¯æ— æ³•ç”¨äºç½‘ç«™å¤‡æ¡ˆçš„ï¼Œä¹Ÿå°±æ˜¯è¯´å…è´¹ç”³è¯·çš„æœåŠ¡å™¨æ˜¯ä¸èƒ½æ‹¿æ¥åšå¤‡æ¡ˆçš„ã€‚ï¼ˆç™½å«–å…šè½æ³ªQAQï¼‰</p><p>åªæœ‰åŸŸåICPå¤‡æ¡ˆä¹‹åï¼Œæ‰èƒ½é€šè¿‡åŸŸåè®¿é—®ç½‘ç«™ï¼Œå¦åˆ™åªèƒ½é€šè¿‡å…¬ç½‘ipè¿›è¡Œè®¿é—®ã€‚<strong>è¿˜è¦è®°å¾—åœ¨åŸŸåè§£æçš„æ§åˆ¶å°é‡Œï¼Œç»™è‡ªå·±è´­ä¹°çš„åŸŸåæ·»åŠ è®°å½•ã€‚</strong></p><p class='note note-info'>æ³¨æ„è¿™é‡Œä¸ç”¨é€šè¿‡æœç´¢â€œç½‘ç«™å¤‡æ¡ˆâ€æ¥æ‰¾ï¼Œä¼šæŠŠä½ å¯¼å‘çœ¼èŠ±ç¼­ä¹±çš„äº‘å¸‚åœºï¼Œå±å®æ²¡æœ‰å¿…è¦ã€‚å¹¶ä¸”å¤‡æ¡ˆæˆåŠŸä¹‹åï¼Œæ³¨æ„è¦åœ¨è‡ªå·±çš„ç½‘ç«™é¡µé¢ä¸Šå¢åŠ å¤‡æ¡ˆçš„è„šæ³¨ã€‚</p><h2 id="å…¬å®‰è”ç½‘å¤‡æ¡ˆ"><a class="markdownIt-Anchor" href="#å…¬å®‰è”ç½‘å¤‡æ¡ˆ"></a> å…¬å®‰è”ç½‘å¤‡æ¡ˆ</h2><p>é™¤äº†å·¥ä¿¡éƒ¨çš„ICPå¤‡æ¡ˆï¼Œè¿˜éœ€è¦è¿›è¡Œ<a href="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202211449323.png">å…¬å®‰è”ç½‘å¤‡æ¡ˆ</a>ï¼ŒåŒæ ·æŒ‰ç…§é˜¿é‡Œäº‘çš„æŒ‡å¯¼æ–‡æ¡£è¿›è¡Œæ“ä½œå³å¯<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="é˜¿é‡Œäº‘-å…¬å®‰è”ç½‘å¤‡æ¡ˆ">[4]</span></a></sup>ã€‚æ³¨æ„åœ¨é€‰æ‹©æœåŠ¡ç±»å‹æ—¶ï¼Œä¸è¦é€‰æ‹©â€åšå®¢ç½‘ç«™â€œï¼Œé€‰æ‹©â€wwwæœåŠ¡â€œå³å¯ï¼Œä¸ç„¶å¯èƒ½åˆéœ€è¦ç­‰å¾…ä¸‹æ¬¡å®¡æ ¸å®¡æ ¸ã€‚</p><p>å†è¡¥å……ä¸€ä¸‹ï¼Œè¿˜éœ€è¦ä¸Šä¼ å®‰å…¨è¯„ä¼°æŠ¥å‘Šï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾çš„å·¦ä¾§ç™»å½•å…¥å£ã€‚å…¶ä¸­å¡«æŠ¥å®‰å…¨è¯„ä¼°æŠ¥å‘Šçš„å†…å®¹å¯ä»¥å‚è€ƒ<a href="https://wenku.baidu.com/view/17e55c62951ea76e58fafab069dc5022aaea46e6.html">å®‰å…¨ç½‘ç»œæŠ¥å‘Šä¸­çš„é—®é¢˜åŠå‚è€ƒè§£ç­”</a>ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202211451504.png" alt="å…¨å›½äº’è”ç½‘å®‰å…¨ç®¡ç†æœå¹³å°" /></p><p class='note note-info'>  æ³¨æ„ä¸€ä¸‹ï¼Œå…¬å®‰è”ç½‘å¤‡æ¡ˆæ˜¯éœ€è¦æœ¬äººç°åœºåˆ°æœ¬åœ°çš„ç½‘è­¦éƒ¨é—¨å®¡æ ¸ç­¾å­—çš„ï¼Œæ‰€ä»¥æœ€å¥½åœ¨å½“åœ°ç•™å‡ºå……è£•çš„æ—¶é—´ã€‚æˆ‘çš„ä¸€ä¸ªæƒ¨ç—›æ•™è®­å°±æ˜¯ä¸´è¿‘å¼€å­¦çš„æ—¶å€™ç”³è¯·ï¼Œç»“æœäººå»å­¦æ ¡äº†ï¼Œæ‰€ä»¥å°±ä¸èƒ½åœ¨æœ¬åœ°è¿™è¾¹åŠç†äº†ã€‚<br>  å¹¸è¿çš„æ˜¯åŒ—äº¬è¿™è¾¹ä¼¼ä¹ç½‘ä¸ŠåŠç†å°±å¯ä»¥äº†ã€‚ä¹Ÿå°±æ˜¯ICPå¤‡æ¡ˆå’Œå…¬å®‰è”ç½‘å¤‡æ¡ˆå¯ä»¥æ˜¯ä¸åŒçœä»½ï¼Œä½†å„ä¸ªåœ°æ–¹ä¼šæœ‰è‡ªå·±çš„è¦æ±‚ã€‚</p><h1 id="hexoç«™ç‚¹é…ç½®ä¿®æ”¹"><a class="markdownIt-Anchor" href="#hexoç«™ç‚¹é…ç½®ä¿®æ”¹"></a> Hexoç«™ç‚¹é…ç½®ä¿®æ”¹</h1><p>æœ€åä¿®æ”¹æœ¬åœ°hexoåšå®¢æ‰€åœ¨ç›®å½•ä¸‹çš„ç«™ç‚¹é…ç½®æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯**_config.yml**ï¼Œå¡«å…¥ä¹‹å‰åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºçš„gitä»“åº“åœ°å€ã€‚æœ€ç»ˆæ‰§è¡Œ<code>hexo clean &amp; hexo g &amp; hexo d</code>å‘½ä»¤ï¼Œå°±å¯ä»¥å°†é™æ€æ–‡ä»¶ä»£ç éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šäº†ï¼Œå°±å¯ä»¥é€šè¿‡åŸŸåæˆ–è€…ipè¿›è¡Œè®¿é—®ï¼Œçœ‹åˆ°éƒ¨ç½²å¥½çš„åšå®¢é¡µé¢ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">deploy:</span><br>  <span class="hljs-attr">type:</span> <span class="hljs-string">git</span><br>  <span class="hljs-attr">repository:</span> [<span class="hljs-string">username</span>]<span class="hljs-string">@100.0.0.100:/home/git/blog.git</span>   <span class="hljs-comment">#ç”¨æˆ·å@æœåŠ¡å™¨Ip:gitä»“åº“ä½ç½®</span><br>  <span class="hljs-attr">branch:</span> <span class="hljs-string">master</span><br><br></code></pre></td></tr></table></figure><h1 id="é™„å½•nginxå¸¸ç”¨å‘½ä»¤"><a class="markdownIt-Anchor" href="#é™„å½•nginxå¸¸ç”¨å‘½ä»¤"></a> é™„å½•ï¼šNginxå¸¸ç”¨å‘½ä»¤</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> åœæ­¢å¼€æœºè‡ªå¯åŠ¨</span><br>systemctl disable nginx.service<br><span class="hljs-meta">#</span><span class="bash">è®¾ç½®nginxæœåŠ¡å¼€æœºè‡ªå¯åŠ¨</span><br>systemctl enable nginx.service<br><span class="hljs-meta">#</span><span class="bash">å¯åŠ¨nginxæœåŠ¡</span><br>systemctl start nginx.service<br><span class="hljs-meta">#</span><span class="bash">åœæ­¢nginxæœåŠ¡</span><br>systemctl stop nginx.service<br><span class="hljs-meta">#</span><span class="bash">é‡å¯nginxæœåŠ¡</span><br>systemctl restart nginx.service<br><span class="hljs-meta">#</span><span class="bash">é‡æ–°è¯»å–nginxé…ç½®(è¿™ä¸ªæœ€å¸¸ç”¨, ä¸ç”¨åœæ­¢nginxæœåŠ¡å°±èƒ½ä½¿ä¿®æ”¹çš„é…ç½®ç”Ÿæ•ˆ)</span><br>systemctl reload nginx.service<br><span class="hljs-meta">#</span><span class="bash"> æŸ¥çœ‹æœåŠ¡å½“å‰çŠ¶æ€</span><br>systemctl status nginx.service<br><span class="hljs-meta">#</span><span class="bash"> æŸ¥çœ‹æ‰€æœ‰å·²å¯åŠ¨çš„æœåŠ¡</span><br>systemctl list-units --type=service<br></code></pre></td></tr></table></figure><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.yyyzyyyz.cn/posts/45dafe31d273/">hexoæœ¬åœ°åšå®¢éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://help.aliyun.com/document_detail/98728.html?spm=5176.b657008.help.dexternal.7891799dpSS9Ed">åœ¨Nginxï¼ˆæˆ–Tengineï¼‰æœåŠ¡å™¨ä¸Šå®‰è£…è¯ä¹¦</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://help.aliyun.com/document_detail/36921.html0">é˜¿é‡Œäº‘-ICPå¤‡æ¡ˆæŒ‡å¯¼</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://help.aliyun.com/document_detail/116029.html">é˜¿é‡Œäº‘-å…¬å®‰è”ç½‘å¤‡æ¡ˆ</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¯å¢ƒæ­å»ºç³»åˆ—</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åšå®¢æ­å»º</tag>
      
      <tag>é˜¿é‡Œäº‘ECS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æˆ‘è¿˜æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰æ”¹å˜</title>
    <link href="/2022/02/12/2022-02/2022-02-12%20%E6%88%91%E8%BF%98%E6%98%AF%E4%BB%80%E4%B9%88%E9%83%BD%E6%B2%A1%E6%9C%89%E6%94%B9%E5%8F%98/"/>
    <url>/2022/02/12/2022-02/2022-02-12%20%E6%88%91%E8%BF%98%E6%98%AF%E4%BB%80%E4%B9%88%E9%83%BD%E6%B2%A1%E6%9C%89%E6%94%B9%E5%8F%98/</url>
    
    <content type="html"><![CDATA[<p>åˆå‡ ä¹é¢“åºŸäº†ä¸€å‘¨ï¼Œæ¯å¤©éƒ½åœ¨æ¸¸æˆä¸­èŠ±è´¹äº†å¤§é‡æ—¶å…‰ï¼ŒæŠ›å¼ƒäº†ç›®æ ‡ï¼ŒæŠ›å¼ƒäº†ç†æƒ³ï¼ŒæŠ›å¼ƒäº†æ‰€æœ‰ï¼Œå°±åƒæ˜¯æººæ°´çš„äººæ‹¼å‘½åœ°æƒ³è¦æŠ“ä½ä»€ä¹ˆï¼Œæˆ‘ä¹ŸæŠŠæ¸¸æˆå½“ä½œå”¯ä¸€çš„å®£æ³„å£ã€‚æ˜æ˜çŸ¥é“è‡ªå·±è¿™æ ·ä¸‹å»ä¸è¡Œï¼Œæ˜æ˜ç½ªæ¶æ„Ÿå’Œå†…ç–šæ„Ÿä¸æ–­æœæˆ‘è¢­æ¥ï¼Œæˆ‘å´æ— æ³•æ§åˆ¶è‡ªå·±ï¼Œæ¯æ¬¡å‘Šè¯‰è‡ªå·±æ”¶æ‰‹å§ï¼Œå´åˆå¾„è‡ªå å…¥æ·±æ¸Šã€‚</p><p class='note note-danger'>  â€œä½ å°å­ï¼ŒçœŸçš„æ˜¯ï¼ŒçœŸçš„æ˜¯ä¸€ç‚¹éƒ½æ²¡æœ‰æ”¹å˜å•Šï¼è¿˜æ˜¯ï¼Œä»€ä¹ˆéƒ½åšä¸åˆ°å•Šï¼ä»€ä¹ˆéƒ½...åšä¸åˆ°â€</p><p>æ˜¯å•Šï¼Œä»åˆä¸­å¼€å§‹çš„æ¯ä¸ªå‡æœŸï¼Œå°±ä»æ¥æ²¡æœ‰æŒ‰è‡ªå·±æœ€åˆè®¡åˆ’çš„é‚£æ ·åº¦è¿‡ï¼Œæ¯æ¬¡éƒ½æ˜¯æ²‰è¿·åœ¨æ¸¸æˆä¸–ç•Œäº†ï¼Œå¿˜è®°æ—¶é—´ï¼Œå¿˜è®°è‡ªæˆ‘ï¼Œå¿˜è®°èº«è¾¹çš„ä¸€åˆ‡ï¼Œè‡ªç”˜å •è½ï¼Œä¼¤å®³è‡ªå·±ï¼Œä¼¤å®³èº«è¾¹çš„äº²äººï¼Œç„¶ååˆæ¯æ¬¡åœ¨å‡æœŸç»“æŸçš„æ—¶å€™ï¼Œæ„Ÿåˆ°æ— å°½çš„æ‡Šæ¼ä¸æ‚”æ¨ï¼Œå´åˆæ€»æ˜¯å®‰æ…°è‡ªå·±ï¼Œâ€œæ²¡äº‹çš„ï¼Œå¤§ä¸äº†é‡æ–°å¼€å§‹å°±å¥½â€ï¼Œä»¥æ­¤ä½œä¸ºå€Ÿå£ï¼Œç»™è‡ªå·±ä¸€ä¸ªå°é˜¶ä¸‹ã€‚å¯äº‹å®ç©¶ç«Ÿå¦‚ä½•å‘¢ï¼Ÿæ—¶å…‰ä»æ¥ä¸èƒ½å€’æµï¼Œå”¯æœ‰æ—¶é—´ï¼Œå¤±å»äº†å°±çœŸæ­£çš„å¤±å»äº†ï¼Œè¿™æ®µå¤±å»çš„æ—¶å…‰æ°¸è¿œä¸ä¼šé‡æ¥ï¼Œè€Œè¿™æ®µæ—¶å…‰çš„ä»·å€¼æˆ‘åˆå¾—åˆ°äº†å¤šå°‘å‘¢ï¼Œæˆ‘åˆèƒ½å¼¥è¡¥å¤šå°‘å‘¢ï¼Ÿ</p><p class='note note-danger'>  â€œæˆ‘é€æ¸å˜æˆè‡ªå·±æœ€åŒæ¶çš„æ ·å­ã€‚â€</p><p>æˆ–è®¸ä¸€äº›ä¸œè¥¿ï¼Œæ›´ç›´ç™½åœ°è¯´ï¼Œäººçš„ä¹ æ€§ï¼Œæ ¹æ·±è’‚å›ºçš„æ¶ä¹ ï¼ŒçœŸçš„å¾ˆéš¾æ”¹æ­£ã€‚ä½†æ˜¯å°±è¿™æ ·æ”¾å¼ƒäº†å—ï¼Œå› ä¸ºå¤±è´¥å¤ªå¤šæ¬¡å°±æ”¾å¼ƒæ”¹å˜äº†å—ï¼Ÿæˆ‘ï¼ŒçœŸçš„æ˜¯è¿™æ ·è½¯å¼±æ— èƒ½çš„äººå—ï¼Ÿ</p><p>ç­”æ¡ˆå…¶å®å·²ç»å¾ˆæ˜æ˜¾äº†å§ï¼Œæˆ‘é‚£ç‡ƒçƒ§çš„çµé­‚å‘Šè¯‰æˆ‘ï¼Œä¸è¦ç•æƒ§å¤±è´¥ï¼Œä¸è¦åœä¸‹è„šæ­¥ï¼Œå°±ç®—éä½“é³ä¼¤ï¼Œå°±ç®—ä¸€æ— æ‰€æœ‰ï¼Œä¹Ÿè¦å‰è¿›ï¼Œä¹Ÿè¦æˆ˜æ–—ï¼Œä¹Ÿè¦è¯æ˜ç»™è‡ªå·±çœ‹ï¼Œæˆ‘åˆ°åº•æ˜¯æ€æ ·çš„ä¸€ä¸ªäººï¼ï¼Ÿ</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202122109437.jpg" alt="æœ‰è¯ç›´è¯´ï¼Œè¯´åˆ°åšåˆ°" /></p>]]></content>
    
    
    <categories>
      
      <category>ç”Ÿæ´»</category>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚è°ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxå‘½ä»¤è¡Œä¸‹æ€§èƒ½åˆ†æ</title>
    <link href="/2022/02/02/2022-02/2022-02-02%20Linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8B%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/"/>
    <url>/2022/02/02/2022-02/2022-02-02%20Linux%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8B%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h1 id="æ€§èƒ½åˆ†æ"><a class="markdownIt-Anchor" href="#æ€§èƒ½åˆ†æ"></a> æ€§èƒ½åˆ†æ</h1><p>æˆ‘æ ¹æ®æˆ‘è¿™äº›å¹´çš„ç»éªŒï¼ŒæŒ‘é€‰äº†å››ä¸ªâ€œé«˜æ€§ä»·æ¯”â€çš„å·¥å…·ï¼štopã€pstackã€strace å’Œ perfã€‚å®ƒä»¬ç”¨èµ·æ¥å¾ˆç®€å•ï¼Œè€Œä¸”å®ç”¨æ€§å¾ˆå¼ºï¼Œå¯ä»¥è§‚æµ‹åˆ°ç¨‹åºçš„å¾ˆå¤šå¤–éƒ¨å‚æ•°å’Œå†…éƒ¨å‡½æ•°è°ƒç”¨ï¼Œç”±å†…è€Œå¤–ã€ç”±è¡¨åŠé‡Œåœ°åˆ†æç¨‹åºæ€§èƒ½ã€‚</p><h1 id="top"><a class="markdownIt-Anchor" href="#top"></a> top</h1><h2 id="å‚æ•°è§£é‡Š"><a class="markdownIt-Anchor" href="#å‚æ•°è§£é‡Š"></a> å‚æ•°è§£é‡Š</h2><p>é€šè¿‡topå‘½ä»¤ï¼Œå°±èƒ½å¤Ÿç®€å•ç›´è§‚åœ°çœ‹åˆ° åº”ç”¨ç¨‹åºçš„CPUã€å†…å­˜ç­‰å‡ ä¸ªæœ€å…³é”®çš„æ€§èƒ½æŒ‡æ ‡ã€‚ä¸‹é¢è¿™å¼ å›¾æˆªè‡ªubuntu20.04 è™šæ‹Ÿæœºçš„topå‘½ä»¤ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202041956057.png" alt="ubuntuä¸­topå‘½ä»¤æˆªå›¾" /></p><p>å…¶ä¸­ä¸ªæŒ‡æ ‡çš„å«ä¹‰å¯ä»¥å‚è€ƒè‡ªè¿™ç¯‡åšå®¢<a href="https://blog.csdn.net/zhuoya_/article/details/81049967">topå‘½ä»¤çš„ç”¨æ³•</a> <sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="topå‘½ä»¤çš„ç”¨æ³•">[1]</span></a></sup>ï¼š</p><ul><li><p>Tasksä¸€è¡Œï¼š</p><ul><li><p>total : è¿›ç¨‹æ€»æ•°</p></li><li><p>Running: æ­£åœ¨è¿è¡Œè¿›ç¨‹æ•°</p></li><li><p>Sleeping: ç¡çœ çš„è¿›ç¨‹æ•°</p></li><li><p>Stopped: åœæ­¢çš„è¿›ç¨‹æ•°</p></li><li><p>zombie: åƒµå°¸è¿›ç¨‹æ•°</p></li></ul></li><li><p>Cpuä¸€è¡Œï¼š</p><ul><li>usï¼šç”¨æˆ·ç©ºé—´å ç”¨CPUçš„ç™¾åˆ†æ¯”</li><li>syï¼šå†…æ ¸ç©ºé—´å ç”¨CPUçš„ç™¾åˆ†æ¯”</li><li>niï¼šç”¨æˆ·è¿›ç¨‹ç©ºé—´å†…æ”¹å˜è¿‡ä¼˜å…ˆçº§çš„è¿›ç¨‹å ç”¨CPUç™¾åˆ†æ¯”</li><li>idï¼šç©ºé—²CPUç™¾åˆ†æ¯”</li><li>waï¼šç­‰å¾…è¾“å…¥è¾“å‡ºçš„CPUç™¾åˆ†æ¯”</li><li>hiï¼šç¡¬ä¸­æ–­å ç”¨CPUç™¾åˆ†æ¯”</li><li>siï¼šè½¯ä¸­æ–­å ç”¨CPUç™¾åˆ†æ¯”</li><li>stï¼šå½“hypervisoræœåŠ¡å¦ä¸€ä¸ªè™šæ‹Ÿå¤„ç†å™¨çš„æ—¶å€™ï¼Œè™šæ‹ŸCPUç­‰å¾…å®é™…CPUçš„ç™¾åˆ†æ¯”</li></ul></li></ul><p class='note note-info'>è½¯ä¸­æ–­æ˜¯æ‰§è¡Œä¸­æ–­æŒ‡ä»¤äº§ç”Ÿçš„ï¼Œè€Œç¡¬ä¸­æ–­æ˜¯ç”±å¤–è®¾å¼•å‘çš„ã€‚</br>ä¸ºäº†æ»¡è¶³å®æ—¶ç³»ç»Ÿçš„è¦æ±‚ï¼Œä¸­æ–­å¤„ç†åº”è¯¥æ˜¯è¶Šå¿«è¶Šå¥½ã€‚linuxä¸ºäº†å®ç°è¿™ä¸ªç‰¹ç‚¹ï¼Œå½“ä¸­æ–­å‘ç”Ÿçš„æ—¶å€™ï¼Œç¡¬ä¸­æ–­å¤„ç†é‚£äº›çŸ­æ—¶é—´å°±å¯ä»¥å®Œæˆçš„å·¥ä½œï¼Œè€Œå°†é‚£äº›å¤„ç†äº‹ä»¶æ¯”è¾ƒé•¿çš„å·¥ä½œï¼Œæ”¾åˆ°ä¸­æ–­ä¹‹åæ¥å®Œæˆï¼Œä¹Ÿå°±æ˜¯è½¯ä¸­æ–­æ¥å®Œæˆã€‚</p><ul><li>Memä¸ºç‰©ç†å†…å­˜ä½¿ç”¨ï¼ŒSwapä¸ºäº¤æ¢åŒºä½¿ç”¨ã€‚</li><li>ç™½è‰²æ ‡æ³¨è¡Œï¼š<ul><li><p>PIDï¼šè¿›ç¨‹ID</p></li><li><p>USERï¼šè¿›ç¨‹æ‰€æœ‰è€…çš„ç”¨æˆ·ID</p></li><li><p>PRï¼špriorityï¼ŒåŠ¨æ€ä¼˜å…ˆçº§ï¼Œå–å€¼èŒƒå›´[0,99]ï¼Œå–å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚priorityçš„å€¼åœ¨ä¹‹å‰å†…æ ¸çš„O1è°ƒåº¦å™¨ä¸Šè¡¨ç°æ˜¯ä¼šå˜åŒ–çš„ï¼Œæ‰€ä»¥å«åš<strong>åŠ¨æ€ä¼˜å…ˆçº§</strong>ã€‚</p></li><li><p>NIï¼šniceå€¼ï¼Œé™æ€ä¼˜å…ˆçº§ã€‚å–å€¼èŒƒå›´[-20,19]ï¼Œå–å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚niceå€¼è®¾å®šå¥½åï¼Œä¸€èˆ¬æ˜¯ä¸ä¼šæ”¹å˜çš„ï¼Œé™¤éä½¿ç”¨ç³»ç»Ÿè°ƒç”¨è¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥ç§°ä¸º<strong>é™æ€ä¼˜å…ˆçº§</strong>ã€‚</p></li><li><p>VIRTï¼šè¿›ç¨‹ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜çš„æ€»é‡ï¼ŒVIRT = SWAP + RES</p></li><li><p>RESï¼šè¿›ç¨‹ä½¿ç”¨çš„ã€æœªè¢«æ¢å‡ºçš„ç‰©ç†å†…å­˜å¤§å°ï¼Œå•ä½kbï¼ŒRES = CODE + DATA</p></li><li><p>SHRï¼šå…±äº«å†…å­˜ï¼Œä¹Ÿä¼šè¢«ç»Ÿè®¡åœ¨RESä¸­ã€‚</p><ul><li><p>é™¤äº†è‡ªèº«è¿›ç¨‹çš„å…±äº«å†…å­˜ï¼Œä¹ŸåŒ…æ‹¬å…¶ä»–è¿›ç¨‹çš„å…±äº«å†…å­˜ï¼›</p></li><li><p>è™½ç„¶è¿›ç¨‹åªä½¿ç”¨äº†å‡ ä¸ªå…±äº«åº“çš„å‡½æ•°ï¼Œä½†å®ƒåŒ…å«äº†æ•´ä¸ªå…±äº«åº“çš„å¤§å°ï¼›</p></li><li><p>è®¡ç®—æŸä¸ªè¿›ç¨‹æ‰€å çš„ç‰©ç†å†…å­˜å¤§å°å…¬å¼ï¼šRES â€“ SHRï¼›</p></li></ul></li><li><p>Sï¼šè¿›ç¨‹çŠ¶æ€</p><ul><li>Rï¼šå½“å‰æ­£åœ¨è¿è¡Œ(RUNNING)</li><li>Sï¼šç¡çœ (SLEEP)</li><li>Dï¼šä¸å¯ä¸­æ–­</li><li>Tï¼šåœæ­¢(STOP)</li><li>Zï¼šåƒµå°¸è¿›ç¨‹(ZOMBIE)</li></ul></li><li><p>%CPUï¼šä¸Šæ¬¡æ›´æ–°åˆ°ç°åœ¨çš„CPUæ—¶é—´å ç”¨ç™¾åˆ†æ¯”</p></li><li><p>%MEMï¼šè¿›ç¨‹å ç”¨ç‰©ç†å†…å­˜å æ¯”</p></li><li><p>TIME+ï¼šè¿›ç¨‹ä½¿ç”¨CPUæ—¶é—´æ€»ç»“</p></li><li><p>COMMANDï¼šè¿›ç¨‹åç§°ï¼ˆå‘½åå/å‘½ä»¤è¡Œï¼‰</p></li></ul></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202042034815.jpeg" alt="ç¨‹åºä¼˜å…ˆçº§æè¿°" /></p><h2 id="äº¤äº’å‘½ä»¤"><a class="markdownIt-Anchor" href="#äº¤äº’å‘½ä»¤"></a> äº¤äº’å‘½ä»¤</h2><ul><li>æŒ‰ <code>f</code> é”®è¿›å…¥äº¤äº’ç•Œé¢ï¼Œæ­¤æ—¶æŒ‰<code>d</code>å¯ä»¥æ˜¾ç¤ºæˆ–éšè—åˆ—ï¼ŒæŒ‰<code>s</code>å¯ä»¥è®¾ç½®å½“å‰é€‰ä¸­çš„åˆ—è¿›è¡Œæ’åºï¼Œé»˜è®¤ä¸ºé™åºï¼Œå¯ä»¥æŒ‰<code>R</code>è¿›è¡Œå‡åºï¼ˆæ³¨æ„å¤§å†™ï¼‰ã€‚</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202042053474.png" alt="æŒ‰ f é”®è¿›å…¥äº¤äº’ç•Œé¢" /></p><ul><li>å…ˆæŒ‰<code>-&gt;</code>å³é”®è¡¨ç¤ºé€‰ä¸­è¯¥åˆ—ï¼Œåœ¨æŒ‰ä¸Šä¸‹ç§»åŠ¨é”®ï¼Œå°±å¯ä»¥è°ƒæ•´åˆ—çš„æ˜¾ç¤ºé¡ºåº</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202042056414.png" alt="è°ƒæ•´åˆ—çš„é¡ºåº" /></p><ul><li><strong>h</strong>æˆ–è€… <strong>?</strong>ï¼šæ˜¾ç¤ºå¸®åŠ©ç”»é¢</li><li><strong>k</strong> :ç»ˆæ­¢ä¸€ä¸ªè¿›ç¨‹ï¼›é»˜è®¤ä½¿ç”¨15ä¿¡å·ï¼Œå¯ä»¥ä½¿ç”¨ä¿¡å·9æ¥å¼ºåˆ¶ç»“æŸè¯¥è¿›ç¨‹ã€‚ä½†æ˜¯åœ¨å®‰å…¨æ¨¡å¼ä¸‹æ­¤å‘½ä»¤è¢«å±è”½ã€‚</li><li><strong>t</strong>  ï¼šåˆ‡æ¢æ˜¾ç¤ºè¿›ç¨‹å’ŒCPUçŠ¶æ€ä¿¡æ¯ã€‚</li><li><strong>m</strong>  :åˆ‡æ¢æ˜¾ç¤ºå†…å­˜ä¿¡æ¯ã€‚</li><li><strong>H</strong>ï¼šåˆ‡æ¢ä¸ºçº¿ç¨‹æŸ¥çœ‹æ¨¡å¼</li><li><strong>i</strong> :å¿½ç•¥é—²ç½®å’Œåƒµæ­»è¿›ç¨‹ï¼Œå¼€å…³å¼å‘½ä»¤ã€‚</li><li><strong>M</strong>  ï¼šæ ¹æ®é©»ç•™å†…å­˜å¤§å°è¿›è¡Œæ’åºã€‚</li><li><strong>P</strong>  ï¼šæ ¹æ®CPUä½¿ç”¨ç™¾åˆ†æ¯”å¤§å°è¿›è¡Œæ’åºã€‚</li><li><strong>T</strong>   ï¼šæ ¹æ®æ—¶é—´æˆ–è€…ç´¯è®¡æ—¶é—´è¿›è¡Œæ’åºã€‚</li><li><strong>top -d ç§’æ•°</strong>ï¼šè¡¨ç¤ºè¿›ç¨‹ç•Œé¢æ›´æ–°æ—¶é—´ï¼ˆé»˜è®¤5ç§’ï¼‰</li><li><strong>top -p 1</strong> : æŸ¥çœ‹è¿›ç¨‹å·ä¸º1çš„è¿›ç¨‹</li></ul><h1 id="pstack"><a class="markdownIt-Anchor" href="#pstack"></a> pstack</h1><p>ä» top çš„è¾“å‡ºç»“æœé‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿›ç¨‹è¿è¡Œçš„æ¦‚å†µï¼ŒçŸ¥é“ CPUã€å†…å­˜çš„ä½¿ç”¨ç‡ã€‚å¦‚æœå‘ç°æŸä¸ªæŒ‡æ ‡è¶…å‡ºäº†é¢„æœŸï¼Œå°±è¯´æ˜ç¨‹åºå¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±åº”è¯¥é‡‡å–æ›´å…·ä½“çš„æªæ–½å»è¿›ä¸€æ­¥åˆ†æï¼Œæ¯”å¦‚é‡‡ç”¨pstackã€‚pstack å¯ä»¥æ‰“å°å‡ºè¿›ç¨‹çš„è°ƒç”¨æ ˆä¿¡æ¯ï¼Œæœ‰ç‚¹åƒæ˜¯ç»™æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹æ‹äº†ä¸ªå¿«ç…§ï¼Œèƒ½çœ‹åˆ°æŸä¸ªæ—¶åˆ»çš„è¿›ç¨‹é‡Œè°ƒç”¨çš„å‡½æ•°å’Œå…³ç³»ï¼Œå¯¹è¿›ç¨‹çš„è¿è¡Œæœ‰ä¸ªåˆæ­¥çš„å°è±¡ã€‚</p><p>pstackå…¶å®æ˜¯ä¸ªShellè„šæœ¬ï¼Œæ ¸å¿ƒåŸç†æ˜¯GDBçš„<strong>thread apply all bt</strong>å‘½ä»¤ï¼ŒåŸºæœ¬é€»è¾‘æ˜¯é€šè¿‡è¿›ç¨‹å·process-idæ¥åˆ†ææ˜¯å¦ä½¿ç”¨äº†å¤šçº¿ç¨‹ï¼ŒåŒæ—¶ä½¿ç”¨GDB Attachåˆ°åœ¨è·‘è¿›ç¨‹ä¸Šï¼Œæœ€åè°ƒç”¨btå­å‘½ä»¤åç®€å•æ ¼å¼åŒ–è¾“å‡º<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="Linux pstack æºç é‡Œçš„åŸºç¡€çŸ¥è¯†">[2]</span></a></sup>ã€‚</p><hr /><p>ç¼–å†™ä¸€ä¸ªæµ‹è¯•ç¨‹åºå¦‚ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªæ­»å¾ªç¯çº¿ç¨‹ï¼Œä¸åœåœ°ç¡çœ 1ç§’åè¾“å‡ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;thread&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">sleeptime</span><span class="hljs-params">()</span></span>&#123;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>        this_thread::<span class="hljs-built_in">sleep_for</span>(chrono::<span class="hljs-built_in">seconds</span>(<span class="hljs-number">1</span>));<br>        cout &lt;&lt; <span class="hljs-string">&quot;sleep 1 s&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-function">thread <span class="hljs-title">t</span><span class="hljs-params">(sleeptime)</span></span>;<br>    t.<span class="hljs-built_in">join</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç¼–è¯‘å‘½ä»¤ï¼š<code>g++ -g -pthread test2.cpp -o test2</code>ã€‚</p><p>pstackå‘½ä»¤ï¼š<code>sudo pstack $&#123;pid&#125;</code>è¿™é‡Œçš„pidå¯é€šè¿‡topæˆ–è€…psæ¥æ‰¾åˆ°ã€‚æ³¨æ„è¿™é‡Œä¸åŠ sudoå¯èƒ½ä¸ä¼šæ‰“å°è¾“å‡ºã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202042256078.png" alt="pstackæ‰“å°å‡½æ•°è°ƒç”¨æ ˆ" /></p><h1 id="strace"><a class="markdownIt-Anchor" href="#strace"></a> strace</h1><p><code>strace</code>æ˜¯ä¸ªåŠŸèƒ½å¼ºå¤§çš„Linuxè°ƒè¯•åˆ†æè¯Šæ–­å·¥å…·ï¼Œå¯ç”¨äºè·Ÿè¸ªç¨‹åºæ‰§è¡Œæ—¶è¿›ç¨‹ç³»ç»Ÿè°ƒç”¨(system call)å’Œæ‰€æ¥æ”¶çš„ä¿¡å·ï¼Œå°¤å…¶æ˜¯é’ˆå¯¹æºç ä¸å¯è¯»æˆ–æºç æ— æ³•å†ç¼–è¯‘çš„ç¨‹åºã€‚åœ¨Linuxç³»ç»Ÿä¸­ï¼Œç”¨æˆ·è¿›ç¨‹ä¸èƒ½ç›´æ¥è®¿é—®è®¡ç®—æœºç¡¬ä»¶è®¾å¤‡ã€‚å½“è¿›ç¨‹éœ€è¦è®¿é—®ç¡¬ä»¶è®¾å¤‡(å¦‚è¯»å–ç£ç›˜æ–‡ä»¶æˆ–æ¥æ”¶ç½‘ç»œæ•°æ®ç­‰)æ—¶ï¼Œå¿…é¡»ç”±ç”¨æˆ·æ€æ¨¡å¼åˆ‡æ¢è‡³å†…æ ¸æ€æ¨¡å¼ï¼Œé€šè¿‡ç³»ç»Ÿè°ƒç”¨è®¿é—®ç¡¬ä»¶è®¾å¤‡ã€‚<code>strace</code>å¯è·Ÿè¸ªè¿›ç¨‹äº§ç”Ÿçš„ç³»ç»Ÿè°ƒç”¨ï¼ŒåŒ…æ‹¬å‚æ•°ã€è¿”å›å€¼å’Œæ‰§è¡Œæ‰€æ¶ˆè€—çš„æ—¶é—´ã€‚<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="Linuxè¿›ç¨‹ç…§å¦–é•œstraceå‘½ä»¤">[3]</span></a></sup></p><p>å‚è€ƒçŸ¥ä¹è¿™ç¯‡æ–‡ç« <a href="https://zhuanlan.zhihu.com/p/69527356">Linuxè¿›ç¨‹ç…§å¦–é•œstraceå‘½ä»¤</a>ï¼Œæ¼”ç¤ºä¸‹ strace å‘½ä»¤ä½œç”¨ã€‚</p><p>é¦–å…ˆç¼–å†™ä¸€ä¸ªæµ‹è¯•ç¨‹åºï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;unistd.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>** argv)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">char</span> buffer[<span class="hljs-number">256</span>];<br>  <br>  <span class="hljs-comment">// è·å–å½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„</span><br>    <span class="hljs-built_in">getcwd</span>(buffer, <span class="hljs-number">255</span>);<br><br>    <span class="hljs-built_in">printf</span>(buffer);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œä¸‹åˆ—å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ç¼–è¯‘</span><br>gcc test3.cpp -o test3<br><span class="hljs-meta">#</span><span class="bash"> ä½¿ç”¨strace è¿½è¸ª test3ç¨‹åº</span><br>strace ./test3<br></code></pre></td></tr></table></figure><p>å°±å¯ä»¥çœ‹åˆ°ç¨‹åºäº§ç”Ÿçš„ç³»ç»Ÿè°ƒç”¨ï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202151120052.png" alt="ç¨‹åºä¸­çš„ç³»ç»Ÿè°ƒç”¨" /></p><p>æ ¹æ®ä¸Šè¿°é‚£ç‰‡çŸ¥ä¹æ–‡ç« å‚è€ƒï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œç¨‹åºè°ƒç”¨äº†<code>getcwd</code>å‡½æ•°ï¼Œè·å–å½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„ï¼›<code>fstat</code>æ˜¯ç”¨äºæ£€æŸ¥æ–‡ä»¶çŠ¶æ€ï¼Œ<code>brk</code>ç³»ç»Ÿè°ƒç”¨æŸ¥é˜…äº†ä¸€ä¸‹ï¼Œå¤§è‡´ä½œç”¨æ˜¯è¯·æ±‚å†…æ ¸å…è®¸è¯»å†™ä¸€ä¸ªç§°ä¸ºå †çš„è¿ç»­å†…å­˜å—<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="BRK()ç³»ç»Ÿè°ƒç”¨åšä»€ä¹ˆï¼Ÿ">[4]</span></a></sup>ï¼Œæˆ–è€…æ˜¯è¯´ç”¨äºè¿›ç¨‹çš„å†…å­˜åˆ†é…<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="Linuxè¿›ç¨‹åˆ†é…å†…å­˜çš„ä¸¤ç§æ–¹å¼â€“brk() å’Œmmap()">[5]</span></a></sup>ï¼›<code>write</code>åˆ™æ˜¯å¾€æ–‡ä»¶å†™å…¥å†…å®¹ã€‚</p><hr /><p>straceçš„å¸¸ç”¨å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æ‰§è¡Œåç§°ä¸º<span class="hljs-built_in">command</span>çš„å‘½ä»¤æˆ–ç¨‹åºå¹¶è·Ÿè¸ªç³»ç»Ÿè°ƒç”¨</span><br>strace command<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> è·Ÿè¸ªIDä¸ºçš„procidçš„è¿›ç¨‹ç³»ç»Ÿè°ƒç”¨æƒ…å†µ</span><br>strace -p procid<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> ç»Ÿè®¡IDä¸ºçš„procidçš„è¿›ç¨‹ç³»ç»Ÿè°ƒç”¨æ¬¡æ•°ä¸ç”¨æ—¶ï¼ŒæŒ‰CTRL+Cç»“æŸç»Ÿè®¡</span><br>strace -c -p procid<br></code></pre></td></tr></table></figure><p class='note note-info'>  æŠŠ pstack å’Œ strace ç»“åˆèµ·æ¥ï¼Œæˆ‘ä»¬å¤§æ¦‚å°±å¯ä»¥çŸ¥é“ï¼Œè¿›ç¨‹åœ¨ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´éƒ½å¹²äº†äº›ä»€ä¹ˆã€‚å½“è¿›ç¨‹çš„ CPU åˆ©ç”¨ç‡è¿‡é«˜æˆ–è€…è¿‡ä½çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ‰å¾ˆå¤§æ¦‚ç‡èƒ½ç›´æ¥å‘ç°ç“¶é¢ˆæ‰€åœ¨ã€‚</p><h1 id="perf"><a class="markdownIt-Anchor" href="#perf"></a> perf</h1><p><code>perf</code> å¯ä»¥è¯´æ˜¯ <code>pstack</code> å’Œ <code>strace</code> çš„â€œé«˜çº§ç‰ˆâ€ï¼Œå®ƒæŒ‰ç…§å›ºå®šçš„é¢‘ç‡å»â€œé‡‡æ ·â€ï¼Œç›¸å½“äºè¿ç»­æ‰§è¡Œå¤šæ¬¡çš„ pstackï¼Œç„¶åå†ç»Ÿè®¡å‡½æ•°çš„è°ƒç”¨æ¬¡æ•°ï¼Œç®—å‡ºç™¾åˆ†æ¯”ã€‚åªè¦é‡‡æ ·çš„é¢‘ç‡è¶³å¤Ÿå¤§ï¼ŒæŠŠè¿™äº›â€œç¬æ—¶æˆªé¢â€ç»„åˆåœ¨ä¸€èµ·ï¼Œå°±å¯ä»¥å¾—åˆ°è¿›ç¨‹è¿è¡Œæ—¶çš„å¯ä¿¡æ•°æ®ï¼Œæ¯”è¾ƒå…¨é¢åœ°æè¿°å‡ºç¨‹åºçš„è¿è¡Œæƒ…å†µã€‚</p><p>é¦–å…ˆæ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼Œå®‰è£…perfï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt install linux-tools-common <br></code></pre></td></tr></table></figure><p>ä½†æ˜¯æç¤ºæˆ‘éœ€è¦å†å®‰è£…æ–°çš„åŒ…ï¼Œè¿™é‡Œæˆ‘å†å®‰è£…<code>linux-tools-5.4.0-97-generic</code>å°±å¯ä»¥äº†ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202151953426.png" alt="å®‰è£…perfå‘½ä»¤" /></p><p>æˆ–è€…ç›´æ¥å®‰è£…æ‰€æœ‰ç›¸å…³çš„ä¾èµ–åŒ…ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt-get install linux-tools-common<br>sudo apt-get install linux-tools-&quot;$(uname -r)&quot;<br>sudo apt-get install linux-cloud-tools-&quot;$(uname -r)&quot;<br>sudo apt-get install linux-tools-generic<br>sudo apt-get install linux-cloud-tools-generic<br></code></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œ <code>sudo perf top</code>å‘½ä»¤ï¼Œå°±å¯ä»¥çœ‹åˆ° <code>perf</code>ç•Œé¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202152014700.png" alt="perf top ç•Œé¢" /></p><p>å‚è€ƒè¿™ç¯‡æ–‡ç« <a href="https://www.cnblogs.com/arnoldlu/p/6241297.html">ç³»ç»Ÿçº§æ€§èƒ½åˆ†æå·¥å…·perfçš„ä»‹ç»ä¸ä½¿ç”¨</a>ï¼Œäº†è§£å„åˆ—çš„å«ä¹‰ï¼š</p><ul><li><p>ç¬¬ä¸€åˆ—ï¼šç¬¦å·å¼•å‘çš„æ€§èƒ½äº‹ä»¶çš„æ¯”ä¾‹ï¼ŒæŒ‡å ç”¨çš„cpuå‘¨æœŸæ¯”ä¾‹ã€‚</p></li><li><p>ç¬¬äºŒåˆ—ï¼šç¬¦å·æ‰€åœ¨çš„DSO(Dynamic Shared Object)ï¼Œå¯ä»¥æ˜¯åº”ç”¨ç¨‹åºã€å†…æ ¸ã€åŠ¨æ€é“¾æ¥åº“ã€æ¨¡å—ã€‚</p></li><li><p>ç¬¬ä¸‰åˆ—ï¼šDSOçš„ç±»å‹ã€‚[.]è¡¨ç¤ºæ­¤ç¬¦å·å±äºç”¨æˆ·æ€çš„ELFæ–‡ä»¶ï¼ŒåŒ…æ‹¬å¯æ‰§è¡Œæ–‡ä»¶ä¸åŠ¨æ€é“¾æ¥åº“ï¼›[k]è¡¨è¿°æ­¤ç¬¦å·å±äºå†…æ ¸æˆ–æ¨¡å—ã€‚</p></li><li><p>ç¬¬å››åˆ—ï¼šç¬¦å·åã€‚æœ‰äº›ç¬¦å·ä¸èƒ½è§£æä¸ºå‡½æ•°åï¼Œåªèƒ½ç”¨åœ°å€è¡¨ç¤ºã€‚</p></li></ul><hr /><p>perf topå¸¸ç”¨é€‰é¡¹æœ‰ï¼š</p><blockquote><p>-e &lt; event &gt;ï¼šæŒ‡æ˜è¦åˆ†æçš„æ€§èƒ½äº‹ä»¶ã€‚</p><p>-p &lt; pid &gt;ï¼šProfile events on existing Process ID (comma sperated list). ä»…åˆ†æç›®æ ‡è¿›ç¨‹åŠå…¶åˆ›å»ºçš„çº¿ç¨‹ã€‚</p><p>-k &lt; path &gt;ï¼šPath to vmlinux. Required for annotation functionality. å¸¦ç¬¦å·è¡¨çš„å†…æ ¸æ˜ åƒæ‰€åœ¨çš„è·¯å¾„ã€‚</p><p>-Kï¼šä¸æ˜¾ç¤ºå±äºå†…æ ¸æˆ–æ¨¡å—çš„ç¬¦å·ã€‚</p><p>-Uï¼šä¸æ˜¾ç¤ºå±äºç”¨æˆ·æ€ç¨‹åºçš„ç¬¦å·ã€‚</p><p>-d &lt; n &gt;ï¼šç•Œé¢çš„åˆ·æ–°å‘¨æœŸï¼Œé»˜è®¤ä¸º2sï¼Œå› ä¸ºperf topé»˜è®¤æ¯2sä»mmapçš„å†…å­˜åŒºåŸŸè¯»å–ä¸€æ¬¡æ€§èƒ½æ•°æ®ã€‚</p><p>-gï¼šå¾—åˆ°å‡½æ•°çš„è°ƒç”¨å…³ç³»å›¾ã€‚</p></blockquote><p>å¸¸ç”¨çš„ perf å‘½ä»¤æ˜¯<code>perf top -K -p xxx</code>ï¼ŒæŒ‰ CPU ä½¿ç”¨ç‡æ’åºï¼Œåªçœ‹ç”¨æˆ·ç©ºé—´çš„è°ƒç”¨ï¼Œè¿™æ ·å¾ˆå®¹æ˜“å°±èƒ½æ‰¾å‡ºæœ€è€—è´¹ CPU çš„ç¨‹åºã€‚</p><hr /><p>æ­¤å¤–ï¼Œperf å’Œæ€§èƒ½åˆ†æä¸­çš„ç«ç„°å›¾ä¹Ÿæ˜¯å¯†åˆ‡ç›¸å…³ï¼Œé€šè¿‡<code>perf record</code>é‡‡é›†æ•°æ®ï¼Œå†é€šè¿‡ <a href="https://github.com/brendangregg/FlameGraph">FlameGraph</a> ç›¸å…³å‘½ä»¤å°±å¯ä»¥ç”Ÿæˆç«ç„°å›¾.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> -F æŒ‡å®šé‡‡æ ·é¢‘ç‡ï¼› -a æŒ‡å®šé‡‡æ ·æ‰€æœ‰CPUï¼› -g è®°å½•å‡½æ•°è°ƒç”¨æ ˆï¼› sleep æŒ‡å®šè¿è¡Œæ—¶é—´</span><br>perf record -F 99 -a -g -- sleep 60<br><span class="hljs-meta">#</span><span class="bash"> å°†perfæ•°æ® æ–‡æœ¬è¾“å‡º</span><br>perf script -i perf.data &gt; out.perf <br><span class="hljs-meta">#</span><span class="bash"> Fold Stacks</span><br>stackcollapse-perf.pl out.perf &gt; out.folded<br><span class="hljs-meta">#</span><span class="bash"> å½¢æˆç«ç„°å›¾</span><br>flamegraph.pl out.folded &gt; kernel.svg<br><span class="hljs-meta">#</span><span class="bash"> æŒ‡å®šæŸä¸ªå‡½æ•°</span><br>grep $&#123;func&#125; out.folded | flamegraph.pl &gt; func.svg<br></code></pre></td></tr></table></figure><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://blog.csdn.net/zhuoya_/article/details/81049967">topå‘½ä»¤çš„ç”¨æ³•</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://cloud.tencent.com/developer/article/1005992">Linux pstack æºç é‡Œçš„åŸºç¡€çŸ¥è¯†</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/69527356">Linuxè¿›ç¨‹ç…§å¦–é•œstraceå‘½ä»¤</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://cloud.tencent.com/developer/ask/72042">BRK()ç³»ç»Ÿè°ƒç”¨åšä»€ä¹ˆï¼Ÿ</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://www.cnblogs.com/vinozly/p/5489138.html">Linuxè¿›ç¨‹åˆ†é…å†…å­˜çš„ä¸¤ç§æ–¹å¼â€“brk() å’Œmmap()</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>æ€§èƒ½åˆ†æ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxå‘½ä»¤å­¦ä¹ </title>
    <link href="/2022/02/01/2022-02/2022-02-01%20Linux%E5%91%BD%E4%BB%A4/"/>
    <url>/2022/02/01/2022-02/2022-02-01%20Linux%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h1 id="ä»»åŠ¡æŒ‚èµ·å’Œæ¢å¤"><a class="markdownIt-Anchor" href="#ä»»åŠ¡æŒ‚èµ·å’Œæ¢å¤"></a> ä»»åŠ¡æŒ‚èµ·å’Œæ¢å¤</h1><p>æˆ‘æƒ³å¤§å®¶åº”è¯¥éƒ½çŸ¥é“<code>ctrl+c</code>æ˜¯ç»ˆæ­¢ä»»åŠ¡/è¿›ç¨‹ï¼Œ <code>ctrl+z</code>æ˜¯ä»»åŠ¡æŒ‚èµ·ï¼ˆå°†ä¸€ä¸ªæ­£åœ¨å‰å°æ‰§è¡Œçš„å‘½ä»¤æ”¾åˆ°åå°ï¼Œå¹¶ä¸”å¤„äºæš‚åœçŠ¶æ€ï¼‰ï¼Œé‚£ä¹ˆä»»åŠ¡æŒ‚èµ·åè¯¥å¦‚ä½•æ¢å¤å‘¢ï¼Ÿç»è¿‡æŸ¥é˜…<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="ctrl+z ä»¥åæ€ä¹ˆæ¢å¤æŒ‚èµ·çš„è¿›ç¨‹">[1]</span></a></sup>ï¼Œå¯ä»¥å‚è€ƒä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p><ol><li>jobs æ˜¾ç¤ºå½“å‰æš‚åœçš„è¿›ç¨‹</li><li>bg %N ä½¿ç¬¬Nä¸ªä»»åŠ¡åœ¨åå°è¿è¡Œ(%å‰æœ‰ç©ºæ ¼)</li><li>fg %N ä½¿ç¬¬Nä¸ªä»»åŠ¡åœ¨å‰å°è¿è¡Œ</li></ol><p class="note note-info">  æ³¨æ„ï¼šé»˜è®¤ bg å’Œ fg ä¸å¸¦%Næ—¶è¡¨ç¤ºå¯¹æœ€åä¸€ä¸ªè¿›ç¨‹æ“ä½œ</p><hr /><p>æ­¤å¤–ä¸ä»»åŠ¡/è¿›ç¨‹æ§åˆ¶ç›¸å…³çš„å‘½ä»¤è¿˜æœ‰ &amp; å’Œ nohup<sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="linux è¿œç¨‹ä¸»æœºåå°è¿è¡Œä»»åŠ¡ æŒ‚èµ·è„šæœ¬">[2]</span></a></sup>ã€‚</p><p><code>Commod + &amp;</code> åœ¨ä¸€ä¸ªå‘½ä»¤æœ€ååŠ ä¸Šä¸€ä¸ª &amp;ï¼Œå¯ä»¥å°†è¿™ä¸ªå‘½ä»¤æ”¾åˆ°åå°æ‰§è¡Œï¼›</p><p>å¦‚æœè®©ç¨‹åºå§‹ç»ˆåœ¨åå°æ‰§è¡Œï¼Œå³ä½¿å…³é—­å½“å‰çš„ç»ˆç«¯ä¹Ÿæ‰§è¡Œï¼ˆä¹‹å‰çš„&amp;åšä¸åˆ°ï¼‰ï¼Œè¿™æ—¶å€™éœ€è¦<code>nohup</code>ã€‚è¯¥å‘½ä»¤å¯ä»¥åœ¨ä½ é€€å‡ºå¸æˆ·/å…³é—­ç»ˆç«¯ä¹‹åç»§ç»­è¿è¡Œç›¸åº”çš„è¿›ç¨‹ã€‚<br />å…³é—­ç»ˆç«¯åï¼Œåœ¨å¦ä¸€ä¸ªç»ˆç«¯jobså·²ç»æ— æ³•çœ‹åˆ°åå°è·‘å¾—ç¨‹åºäº†ï¼Œæ­¤æ—¶åˆ©ç”¨psï¼ˆè¿›ç¨‹æŸ¥çœ‹å‘½ä»¤ï¼‰</p><h1 id="éªŒè¯jsonæ ¼å¼æ­£ç¡®æ€§"><a class="markdownIt-Anchor" href="#éªŒè¯jsonæ ¼å¼æ­£ç¡®æ€§"></a> éªŒè¯JSONæ ¼å¼æ­£ç¡®æ€§</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat a.json | python -m json.tool | wc -l <br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸Šè¿°å‘½ä»¤ï¼Œå¯ä»¥æ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶æ˜¯å¦ç¬¦åˆjsonæ ¼å¼ï¼Œå…¶å®ç°åŸç†å¦‚ä¸‹ï¼š</p><ul><li>è¦éªŒè¯çš„æ–‡ä»¶ a.jsonï¼›</li><li>å¦‚æœè¿”å›ç»“æœä¸€è¡Œæ•°å­—ï¼Œåˆ™è¡¨ç¤º a.json æ–‡ä»¶æ ¼å¼æ­£ç¡®ï¼›</li><li>å¦åˆ™è¿”å› a.json æ–‡ä»¶ä¸­é”™è¯¯çš„è¡Œå·åŠé”™è¯¯ä¿¡æ¯ã€‚</li></ul><p>ä¸€æ—¦ JSON æ–‡ä»¶æ ¼å¼ä¸å¯¹ï¼Œæˆ–è€…æ–‡ä»¶å†…å®¹ç¼ºå¤±æˆ–è€…å…¶ä»–é—®é¢˜ï¼Œå°±ä¼šå¯¼è‡´ python -m å‘½ä»¤æ— æ³•æ ¼å¼åŒ–ï¼Œæ­£æ˜¯åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥åšä¸€ä¸ª JSON çš„éªŒè¯ã€‚<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="Linuxå¼€å‘å°æŠ€å·§">[3]</span></a></sup></p><hr /><p>ä¸ºäº†ç®€åŒ–å‘½ä»¤ï¼Œå¯ä»¥åˆ©ç”¨aliasè®¾ç½®å‘½ä»¤åˆ«åï¼Œä½†æ˜¯å› ä¸ºéœ€è¦å‘½ä»¤è¡Œå‚æ•°ä¼ å…¥æ–‡ä»¶åï¼Œè€Œaliasä¸æ”¯æŒå‘½ä»¤è¡Œå‚æ•°ã€‚åœ¨æŸ¥é˜…èµ„æ–™å<sup id="fnref:4" class="footnote-ref"><a href="#fn:4" rel="footnote"><span class="hint--top hint--rounded" aria-label="linuxä¸­ç»™ alias æ·»åŠ è‡ªå®šä¹‰çš„å‚æ•°">[4]</span></a></sup>ï¼Œæ‰¾åˆ°ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯é€šè¿‡å®šä¹‰å‡½æ•°çš„æ–¹å¼æ¥å®ç°ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">alias isjson=&#x27;isjson()&#123;cat &quot;$1&quot; | python -m json.tool | wc -l&#125;; isjson&#x27;<br></code></pre></td></tr></table></figure><h1 id="grep-sed-awkå‘½ä»¤"><a class="markdownIt-Anchor" href="#grep-sed-awkå‘½ä»¤"></a> GREPã€SEDã€AWKå‘½ä»¤</h1><h2 id="grep"><a class="markdownIt-Anchor" href="#grep"></a> GREP</h2><p>grep æŒ‡ä»¤ç”¨äºæŸ¥æ‰¾å†…å®¹åŒ…å«æŒ‡å®šçš„èŒƒæœ¬æ ·å¼çš„æ–‡ä»¶ï¼Œå¦‚æœå‘ç°æŸæ–‡ä»¶çš„å†…å®¹ç¬¦åˆæ‰€æŒ‡å®šçš„èŒƒæœ¬æ ·å¼ï¼Œé¢„è®¾ grep æŒ‡ä»¤ä¼šæŠŠå«æœ‰èŒƒæœ¬æ ·å¼çš„é‚£ä¸€åˆ—æ˜¾ç¤ºå‡ºæ¥ã€‚<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="Linuxå¼€å‘å°æŠ€å·§">[3]</span></a></sup></p><ul><li>grepé»˜è®¤æ˜¯å¿½ç•¥äºŒè¿›åˆ¶æ•°æ®çš„ï¼Œå¯ä»¥åŠ ä¸Š <code>-a</code> æˆ– <code>--text</code> æ¥è¡¨ç¤ºä¸å¿½ç•¥äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">grep -a file_name<br>æˆ–<br>grep --text file_name <br></code></pre></td></tr></table></figure><ul><li><strong>-E</strong>  : ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒ¹é…äº†æ‰è¾“å‡º</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">grep -E &quot;word1|word2|word3&quot; file.txt<br><span class="hljs-meta">#</span><span class="bash">æ»¡è¶³ä»»æ„æ¡ä»¶ï¼ˆword1ã€word2å’Œword3ä¹‹ä¸€ï¼‰å°†åŒ¹é…ã€‚</span><br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">grep word1 file.txt | grep word2 |grep word3<br><span class="hljs-meta">#</span><span class="bash">å¿…é¡»åŒæ—¶æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ï¼ˆword1ã€word2å’Œword3ï¼‰æ‰åŒ¹é…ã€‚</span><br></code></pre></td></tr></table></figure><ul><li><strong>-r</strong>  ï¼šé€’å½’æœç´¢ç›®å½•</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">grep -r word directory<br></code></pre></td></tr></table></figure><ul><li><strong>-v</strong> : æ˜¾ç¤ºä¸åŒ…å«åŒ¹é…æ–‡æœ¬çš„æ‰€æœ‰è¡Œã€‚</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">grep -v &#x27;abc\|efg&#x27; log.txt<br><span class="hljs-meta">#</span><span class="bash">æ’é™¤ log.txt ä¸­çš„ abc efg å…³é”®å­—</span><br></code></pre></td></tr></table></figure><h2 id="sed"><a class="markdownIt-Anchor" href="#sed"></a> SED</h2><p>sed å¯ä¾ç…§è„šæœ¬çš„æŒ‡ä»¤æ¥å¤„ç†ã€ç¼–è¾‘æ–‡æœ¬æ–‡ä»¶ã€‚sed ä¸»è¦ç”¨æ¥è‡ªåŠ¨ç¼–è¾‘ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ã€ç®€åŒ–å¯¹æ–‡ä»¶çš„åå¤æ“ä½œã€ç¼–å†™è½¬æ¢ç¨‹åºç­‰ã€‚</p><p>å¯¹æ–‡ä»¶è¿›è¡Œæ–‡æœ¬æ›¿æ¢æ“ä½œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">sed -i &#x27;s/åŸå­—ç¬¦ä¸²/æ–°å­—ç¬¦ä¸²/&#x27; filename<br>sed -i &#x27;s/åŸå­—ç¬¦ä¸²/æ–°å­—ç¬¦ä¸²/g&#x27; filename<br></code></pre></td></tr></table></figure><p><strong>-i</strong> è¡¨ç¤ºç›´æ¥ä¿®æ”¹è¯»å–çš„æ–‡ä»¶å†…å®¹ï¼Œè€Œä¸æ˜¯è¾“å‡ºåˆ°ç»ˆç«¯ã€‚</p><p>æœ€åå¸¦ g è¿›è¡Œäº†ä¸€ä¸ªå…¨å±€çš„æœç´¢ï¼›ä¸å¸¦gçš„è¯ï¼Œåªæ˜¯åŒ¹é…æ¯è¡Œçš„ç¬¬ä¸€ä¸ªå­—æ®µï¼Œåé¢çš„åŒ¹é…åˆ™ä¼šå¿½ç•¥ã€‚</p><hr /><p>ç¤ºä¾‹ï¼š</p><ul><li>sed æ–‡ä»¶é¦–å°¾æ·»åŠ å¼•å·</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sed -i &#x27;s/^/&quot;/;s/$/&quot;/&#x27;  log.txt<br></code></pre></td></tr></table></figure><ul><li>sed æ–‡ä»¶å°¾æ·»åŠ é€—å·</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sed -i &#x27;s/$/,/&#x27;  txt<br></code></pre></td></tr></table></figure><p class="note note-info">  æ³¨æ„ä¸Šè¿°å‘½ä»¤åœ¨Macç³»ç»Ÿçš„ç»ˆç«¯é‡Œä¼šæŠ¥é”™ï¼Œéœ€è¦åœ¨"-i" ååŠ ä¸Š "" </p><h2 id="awk"><a class="markdownIt-Anchor" href="#awk"></a> AWK</h2><p>AWK æ˜¯ä¸€ç§å¤„ç†æ–‡æœ¬æ–‡ä»¶çš„è¯­è¨€ï¼Œæ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ–‡æœ¬åˆ†æå·¥å…·ã€‚</p><ul><li>-F ï¼šæŒ‡å®šè¾“å…¥æ–‡ä»¶æŠ˜åˆ†éš”ç¬¦</li><li>-v : èµ‹å€¼ä¸€ä¸ªç”¨æˆ·å®šä¹‰å˜é‡ã€‚</li></ul><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æ¯è¡ŒæŒ‰ç©ºæ ¼æˆ–TABåˆ†å‰²ï¼Œè¾“å‡ºæ–‡æœ¬ä¸­çš„1ã€4é¡¹</span><br>awk &#x27;&#123;print $1,$4&#125;&#x27; log.txt<br><span class="hljs-meta">#</span><span class="bash"> æ ¼å¼åŒ–è¾“å‡º</span><br>awk &#x27;&#123;printf &quot;%-8s %-10s\n&quot;,$1,$4&#125;&#x27; log.txt<br><span class="hljs-meta">#</span><span class="bash"> ä½¿ç”¨<span class="hljs-string">&quot;,&quot;</span>åˆ†å‰²</span><br>awk -F , &#x27;&#123;print $1,$2&#125;&#x27;   log.txt<br><span class="hljs-meta">#</span><span class="bash"> ä½¿ç”¨è‡ªå®šä¹‰å˜é‡</span><br>awk -v a=1 &#x27;&#123;print $1,$1+a&#125;&#x27; log.txt# æ•°å€¼åŠ <br>awk -v a=1 &#x27;&#123;print $1,$1a&#125;&#x27; log.txt# å­—ç¬¦åŠ <br></code></pre></td></tr></table></figure><h1 id="å‹ç¼©å’Œè§£å‹"><a class="markdownIt-Anchor" href="#å‹ç¼©å’Œè§£å‹"></a> å‹ç¼©å’Œè§£å‹</h1><h2 id="zip"><a class="markdownIt-Anchor" href="#zip"></a> zip</h2><ul><li>å‹ç¼©æ–‡ä»¶ï¼š <code>zip å‹ç¼©æ–‡ä»¶å æºæ–‡ä»¶</code></li><li>å‹ç¼©ç›®å½•ï¼š <code>zip -r å‹ç¼©æ–‡ä»¶å æºç›®å½•</code></li><li>è§£å‹ï¼š <code>unzip å‹ç¼©æ–‡ä»¶å</code></li></ul><p>ç¤ºä¾‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir book<br>touch book/1.txt<br>touch book/2.txt<br>zip -r book.zip book<br>unzip book.zip<br></code></pre></td></tr></table></figure><h2 id="gzip"><a class="markdownIt-Anchor" href="#gzip"></a> gzip</h2><table><thead><tr><th style="text-align:left">å‘½ä»¤</th><th style="text-align:left">ç¤ºä¾‹</th><th style="text-align:left">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left">gzip æºæ–‡ä»¶</td><td style="text-align:left">gzip a.txt</td><td style="text-align:left">å‹ç¼©ä¸º.gzæ ¼å¼çš„å‹ç¼©æ–‡ä»¶ï¼Œæºæ–‡ä»¶ä¼šæ¶ˆå¤±</td></tr><tr><td style="text-align:left">gzip -c æºæ–‡ä»¶ &gt; å‹ç¼©æ–‡ä»¶</td><td style="text-align:left">gzip -c yum.txt &gt; yum.txt.gz</td><td style="text-align:left">å‹ç¼©ä¸º.gzæ ¼å¼çš„å‹ç¼©æ–‡ä»¶ï¼Œæºæ–‡ä»¶ä¸ä¼šæ¶ˆå¤±</td></tr><tr><td style="text-align:left">gzip -r ç›®å½•</td><td style="text-align:left">gzip -r xx</td><td style="text-align:left">å‹ç¼©ç›®å½•ä¸‹çš„æ‰€æœ‰å­æ–‡ä»¶ï¼Œä½†æ˜¯ä¸å‹ç¼©ç›®å½•</td></tr><tr><td style="text-align:left">gzip -d å‹ç¼©æ–‡ä»¶å</td><td style="text-align:left">gzip -d yum.txt.gz</td><td style="text-align:left">è§£å‹ç¼©æ–‡ä»¶,ä¸ä¿ç•™å‹ç¼©åŒ…</td></tr><tr><td style="text-align:left">gunzip å‹ç¼©æ–‡ä»¶</td><td style="text-align:left">gunzip yum.txt.gz</td><td style="text-align:left">è§£å‹ç¼©æ–‡ä»¶,ä¸ä¿ç•™å‹ç¼©åŒ…</td></tr></tbody></table><h2 id="tar"><a class="markdownIt-Anchor" href="#tar"></a> tar</h2><ul><li>tar -cvf æ‰“åŒ…æ–‡ä»¶å æºæ–‡ä»¶<sup id="fnref:5" class="footnote-ref"><a href="#fn:5" rel="footnote"><span class="hint--top hint--rounded" aria-label="linuxæ€»ç»“">[5]</span></a></sup><ul><li>-c æ‰“åŒ…</li><li>-v æ˜¾ç¤ºè¿‡ç¨‹</li><li>-f æŒ‡å®šæ‰“åŒ…åçš„æ–‡ä»¶å</li><li>-x è§£æ‰“åŒ…</li></ul></li></ul><p>ç¤ºä¾‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar -cvf book.tar book<br>tar -xvf book.tar<br></code></pre></td></tr></table></figure><p><strong>æ›´å¤šå‹ç¼©å‘½ä»¤ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar â€“cvf jpg.tar *.jpg #å°†ç›®å½•é‡Œæ‰€æœ‰jpgæ–‡ä»¶æ‰“åŒ…æˆtar.jpg <br><br>tar â€“czf jpg.tar.gz *.jpg #å°†ç›®å½•é‡Œæ‰€æœ‰jpgæ–‡ä»¶æ‰“åŒ…æˆjpg.taråï¼Œå¹¶ä¸”å°†å…¶ç”¨gzipå‹ç¼©ï¼Œç”Ÿæˆä¸€ä¸ªgzipå‹ç¼©è¿‡çš„åŒ…ï¼Œå‘½åä¸ºjpg.tar.gz <br><br>tar â€“cjf jpg.tar.bz2 *.jpg #å°†ç›®å½•é‡Œæ‰€æœ‰jpgæ–‡ä»¶æ‰“åŒ…æˆjpg.taråï¼Œå¹¶ä¸”å°†å…¶ç”¨bzip2å‹ç¼©ï¼Œç”Ÿæˆä¸€ä¸ªbzip2å‹ç¼©è¿‡çš„åŒ…ï¼Œå‘½åä¸ºjpg.tar.bz2 <br><br>tar â€“cZf jpg.tar.Z *.jpg #å°†ç›®å½•é‡Œæ‰€æœ‰jpgæ–‡ä»¶æ‰“åŒ…æˆjpg.taråï¼Œå¹¶ä¸”å°†å…¶ç”¨compresså‹ç¼©ï¼Œç”Ÿæˆä¸€ä¸ªumcompresså‹ç¼©è¿‡çš„åŒ…ï¼Œå‘½åä¸ºjpg.tar.Z <br><br>rar a jpg.rar *.jpg #raræ ¼å¼çš„å‹ç¼©ï¼Œéœ€è¦å…ˆä¸‹è½½rar for linux <br><br>zip jpg.zip *.jpg #zipæ ¼å¼çš„å‹ç¼©ï¼Œéœ€è¦å…ˆä¸‹è½½zip for linux<br></code></pre></td></tr></table></figure><p><strong>æ›´å¤šè§£å‹å‘½ä»¤ï¼š</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar â€“xvf file.tar #è§£å‹ taråŒ… <br><br>tar -xzvf file.tar.gz #è§£å‹tar.gz<br><br>tar -xjvf file.tar.bz2 #è§£å‹ tar.bz2 <br><br>tar â€“xZvf file.tar.Z #è§£å‹tar.Z <br><br>unrar e file.rar #è§£å‹rar <br><br>unzip file.zip #è§£å‹zip<br></code></pre></td></tr></table></figure><h1 id="ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥"><a class="markdownIt-Anchor" href="#ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥"></a> ç¡¬é“¾æ¥å’Œè½¯é“¾æ¥</h1><blockquote><p>å‚è€ƒï¼š<a href="https://www.linuxprobe.com/soft-and-hard-links.html">è½¯é“¾æ¥å’Œç¡¬é“¾æ¥çš„åŒºåˆ«</a><sup id="fnref:6" class="footnote-ref"><a href="#fn:6" rel="footnote"><span class="hint--top hint--rounded" aria-label="è½¯é“¾æ¥å’Œç¡¬é“¾æ¥çš„åŒºåˆ«">[6]</span></a></sup></p></blockquote><p>æˆ‘ä»¬çŸ¥é“æ–‡ä»¶éƒ½æœ‰æ–‡ä»¶åä¸æ•°æ®ï¼Œè¿™åœ¨ <a href="https://www.linuxprobe.com/">Linux</a> ä¸Šè¢«åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼šç”¨æˆ·æ•°æ® (user data) ä¸å…ƒæ•°æ® (metadata)ã€‚ç”¨æˆ·æ•°æ®ï¼Œå³æ–‡ä»¶æ•°æ®å— (data block)ï¼Œæ•°æ®å—æ˜¯è®°å½•æ–‡ä»¶çœŸå®å†…å®¹çš„åœ°æ–¹ï¼›è€Œå…ƒæ•°æ®åˆ™æ˜¯æ–‡ä»¶çš„é™„åŠ å±æ€§ï¼Œå¦‚æ–‡ä»¶å¤§å°ã€åˆ›å»ºæ—¶é—´ã€æ‰€æœ‰è€…ç­‰ä¿¡æ¯ã€‚åœ¨ Linux ä¸­ï¼Œå…ƒæ•°æ®ä¸­çš„ inode å·ï¼ˆinode æ˜¯æ–‡ä»¶å…ƒæ•°æ®çš„ä¸€éƒ¨åˆ†ä½†å…¶å¹¶ä¸åŒ…å«æ–‡ä»¶åï¼Œinode å·å³ç´¢å¼•èŠ‚ç‚¹å·ï¼‰æ‰æ˜¯æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†è€Œéæ–‡ä»¶åã€‚æ–‡ä»¶åä»…æ˜¯ä¸ºäº†æ–¹ä¾¿äººä»¬çš„è®°å¿†å’Œä½¿ç”¨ï¼Œç³»ç»Ÿæˆ–ç¨‹åºé€šè¿‡ inode å·å¯»æ‰¾æ­£ç¡®çš„æ–‡ä»¶æ•°æ®å—ã€‚è€Œæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥å¿«é€Ÿçš„å¯»æ‰¾åˆ°æ•°æ®å…ƒï¼Œé‚£å°±æ˜¯è½¯ç¡¬é“¾æ¥ï¼Œé“¾æ¥å®é™…ä¸Šå°±æ˜¯ä¸€ç§æ–‡ä»¶å…±äº«çš„æ–¹å¼ã€‚</p><p>é‚£ä¹ˆè½¯é“¾æ¥å’Œç¡¬é“¾æ¥çš„åŒºåˆ«åœ¨å“ªå‘¢ï¼Ÿ<sup id="fnref:7" class="footnote-ref"><a href="#fn:7" rel="footnote"><span class="hint--top hint--rounded" aria-label="linuxä¸­ç¡¬é“¾æ¥ä¸è½¯é“¾æ¥çš„åŒºåˆ«">[7]</span></a></sup></p><ol><li><strong>é¦–å…ˆï¼Œä¸¤è€…ä½œç”¨çš„å¯¹è±¡ä¸åŒï¼š</strong></li></ol><ul><li>ç¡¬é“¾æ¥ï¼Œåªèƒ½åº”ç”¨äºæ–‡ä»¶ï¼Œè€Œä¸èƒ½åº”ç”¨äºç›®å½•ï¼Œè€Œä¸”ä¸èƒ½è·¨æ–‡ä»¶ç³»ç»Ÿï¼ˆå³åˆ†åŒºï¼‰ï¼›</li><li>è½¯ï¼ˆç¬¦å·ï¼‰é“¾æ¥ï¼Œå¯ä»¥åº”ç”¨äºæ–‡ä»¶ï¼Œè€Œä¸”å¯ä»¥åº”ç”¨äºç›®å½•å’Œå¯è·¨æ–‡ä»¶ç³»ç»Ÿï¼ˆåˆ†åŒºï¼‰ã€‚</li></ul><ol start="2"><li><strong>å…¶æ¬¡ï¼Œä¸¤è€…çš„ä½œç”¨åŸç†ä¸åŒï¼š</strong></li></ol><ul><li>ç¡¬é“¾æ¥ä¸­ï¼Œå‡å¦‚è¯´Aæ–‡ä»¶æ˜¯Bæ–‡ä»¶çš„ç¡¬è¿æ¥æ–‡ä»¶ï¼Œé‚£ä¹ˆAå’ŒBçš„inodeèŠ‚ç‚¹å·ç›¸åŒï¼Œå³ä¸€ä¸ªinodeèŠ‚ç‚¹å¯¹åº”ä¸¤ä¸ªä¸åŒçš„æ–‡ä»¶åï¼Œä¸¤ä¸ªæ–‡ä»¶åæŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶ï¼ŒAå’ŒBå¯¹æ–‡ä»¶ç³»ç»Ÿæ¥è¯´æ˜¯å®Œå…¨å¹³ç­‰çš„ï¼Œç¡¬é“¾æ¥ä¸­ä¸€ä¸ªinodeå·å¯ä»¥å¯¹åº”å¤šä¸ªæ–‡ä»¶ã€‚å¦‚æœåˆ é™¤å…¶ä¸­ä»»ä½•ä¸€ä¸ªæ–‡ä»¶ï¼Œå¦å¤–ä¸€ä¸ªæ–‡ä»¶è¿˜èƒ½è¿æ¥æ•°æ®å—ï¼Œè¿˜æ˜¯æœ‰æ•ˆçš„æ–‡ä»¶ï¼Œåªæ˜¯å¯¹åº”çš„inodeèŠ‚ç‚¹å·å‡å°‘ï¼Œå…¶å®ƒå¹¶æ— å½±å“ã€‚åªæœ‰inodeèŠ‚ç‚¹å·å‡å°‘åˆ°0ï¼Œæ•°æ®å—æ‰ä¼šè¢«ç³»ç»Ÿå›æ”¶ã€‚</li><li>è€Œåœ¨è½¯é“¾æ¥ä¸­ï¼Œå‡å¦‚è¯´Aæ–‡ä»¶æ˜¯Bæ–‡ä»¶çš„è½¯è¿æ¥æ–‡ä»¶ï¼Œåˆ™Aå’ŒBçš„inodeèŠ‚ç‚¹å·ä¸åŒï¼Œæ¯åˆ›å»ºä¸€ä¸ªæ–°çš„è½¯é“¾æ¥ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹å·ã€‚è€ŒAçš„æ•°æ®å—ä¸­å­˜æ”¾çš„åªæ˜¯Bçš„è·¯å¾„åï¼ˆå¯ä»¥æ ¹æ®è¿™ä¸ªæ‰¾åˆ°Bçš„ç›®å½•é¡¹ï¼‰ã€‚Aå’ŒBä¹‹é—´æ˜¯â€œä¸»ä»â€å…³ç³»ï¼Œå¦‚æœBè¢«åˆ é™¤äº†ï¼ŒAä»ç„¶å­˜åœ¨ï¼ˆå› ä¸ºä¸¤ä¸ªæ˜¯ä¸åŒçš„æ–‡ä»¶ï¼‰ï¼Œä½†æŒ‡å‘çš„æ˜¯ä¸€ä¸ªæ— æ•ˆçš„é“¾æ¥ã€‚</li></ul><ol start="3"><li><strong>è¯­æ³•ä¸åŒï¼š</strong></li></ol><ul><li>ç¡¬é“¾æ¥çš„è¯­æ³•ï¼š<code>ln filename [linkname ]</code></li><li>è½¯é“¾æ¥çš„è¯­æ³•ï¼š<code>ln -s filename [linkname]</code></li></ul><hr /><p>æœ€åæ€»ç»“ä¸€ä¸‹ï¼š</p><ul><li>ç¡¬é“¾æ¥ï¼šä¸æ™®é€šæ–‡ä»¶æ²¡ä»€ä¹ˆä¸åŒï¼Œinode éƒ½æŒ‡å‘åŒä¸€ä¸ªæ–‡ä»¶åœ¨ç¡¬ç›˜ä¸­çš„åŒºå—ï¼›</li><li>è½¯é“¾æ¥ï¼š ä¿å­˜äº†å…¶ä»£è¡¨çš„æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œæ˜¯å¦å¤–ä¸€ç§æ–‡ä»¶ï¼Œåœ¨ç¡¬ç›˜ä¸Šæœ‰ç‹¬ç«‹çš„åŒºå—ï¼Œè®¿é—®æ•°æ®æ—¶ï¼Œå°†ç”¨æ•°æ®å—ä¸­æŒ‡å‘çš„æ–‡ä»¶è·¯å¾„è¿›è¡Œæ›¿æ¢ã€‚</li></ul><h1 id="å…¶å®ƒshellæŠ€å·§"><a class="markdownIt-Anchor" href="#å…¶å®ƒshellæŠ€å·§"></a> å…¶å®ƒshellæŠ€å·§</h1><h2 id="è¾“å…¥ç›¸ä¼¼æ–‡ä»¶å"><a class="markdownIt-Anchor" href="#è¾“å…¥ç›¸ä¼¼æ–‡ä»¶å"></a> è¾“å…¥ç›¸ä¼¼æ–‡ä»¶å</h2><p>ç”¨èŠ±æ‹¬å·æ‹¬èµ·æ¥çš„å­—ç¬¦ä¸²ä¹‹é—´å†ç”¨é€—å·è¿æ¥ï¼Œå¯ä»¥å®ç°è‡ªåŠ¨æ‰©å±•ï¼Œéå¸¸æœ‰ç”¨ã€‚èŠ±æ‹¬å·ä¸­çš„æ¯ä¸ªå­—ç¬¦éƒ½å¯ä»¥å’Œä¹‹åï¼ˆæˆ–ä¹‹å‰ï¼‰çš„å­—ç¬¦ä¸²è¿›è¡Œç»„åˆæ‹¼æ¥ï¼Œæ³¨æ„èŠ±æ‹¬å·å’Œå…¶ä¸­çš„é€—å·ä¸å¯ä»¥ç”¨ç©ºæ ¼åˆ†éš”ï¼Œå¦åˆ™ä¼šè¢«è®¤ä¸ºæ˜¯æ™®é€šçš„å­—ç¬¦ä¸²å¯¹å¾…ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">echo</span> &#123;one,two,three&#125;file</span><br>onefile twofile threefile<br><span class="hljs-meta"></span><br><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">echo</span> &#123;one,two,three&#125;&#123;1,2,3&#125;</span><br>one1 one2 one3 two1 two2 two3 three1 three2 three3<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæŠ€å·§æœ‰ä»€ä¹ˆå®é™…ç”¨å¤„å‘¢ï¼Ÿæœ€ç®€å•å®ç”¨çš„å°±æ˜¯ç»™ cp,mv,rm ç­‰å‘½ä»¤æ‰©å±•å‚æ•°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">$</span><span class="bash"> cp /search/code/file&#123;,.bak&#125;</span><br><span class="hljs-meta">#</span><span class="bash"> ç»™ file å¤åˆ¶ä¸€ä¸ªå«åš file.bak çš„å‰¯æœ¬</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">$</span><span class="bash"> rm file&#123;1,3,5&#125;.txt</span><br><span class="hljs-meta">#</span><span class="bash"> åˆ é™¤ file1.txt file3.txt file5.txt</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">$</span><span class="bash"> mv *.&#123;c,cpp&#125; src/</span><br><span class="hljs-meta">#</span><span class="bash"> å°†æ‰€æœ‰ .c å’Œ .cpp ä¸ºåç¼€çš„æ–‡ä»¶ç§»å…¥ src æ–‡ä»¶å¤¹</span><br></code></pre></td></tr></table></figure><h2 id="å‘½ä»¤å¿«æ·é”®"><a class="markdownIt-Anchor" href="#å‘½ä»¤å¿«æ·é”®"></a> å‘½ä»¤å¿«æ·é”®</h2><table><thead><tr><th style="text-align:left">å‘½ä»¤</th><th style="text-align:left">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left">ctrl+c</td><td style="text-align:left">å¼ºåˆ¶ç»ˆæ­¢å½“å‰å‘½ä»¤</td></tr><tr><td style="text-align:left">ctrl+l</td><td style="text-align:left">æ¸…å±</td></tr><tr><td style="text-align:left">ctrl+a</td><td style="text-align:left">å…‰æ ‡ç§»åŠ¨åˆ°å‘½ä»¤è¡Œé¦–</td></tr><tr><td style="text-align:left">ctrl+e</td><td style="text-align:left">å…‰æ ‡ç§»åŠ¨åˆ°å‘½ä»¤è¡Œå°¾</td></tr><tr><td style="text-align:left">ctrl+u</td><td style="text-align:left">ä»å…‰æ ‡æ‰€åœ¨çš„ä½ç½®åˆ é™¤åˆ°è¡Œé¦–</td></tr><tr><td style="text-align:left">ctrl+z</td><td style="text-align:left">æŠŠå‘½ä»¤æ”¾å…¥åå°</td></tr><tr><td style="text-align:left">ctrl+r</td><td style="text-align:left">åœ¨å†å²å‘½ä»¤ä¸­æœç´¢</td></tr><tr><td style="text-align:left">!n</td><td style="text-align:left">æ›¿æ¢æˆç¬¬næ¡å†å²å‘½ä»¤</td></tr><tr><td style="text-align:left">!!</td><td style="text-align:left">æ›¿æ¢æˆä¸Šä¸€æ¡å‘½ä»¤</td></tr><tr><td style="text-align:left">!å­—ç¬¦</td><td style="text-align:left">æ›¿æ¢æˆæœ€åä¸€æ¡ä»¥è¯¥å­—ç¬¦ä¸²å¼€å¤´çš„å‘½ä»¤</td></tr></tbody></table><h2 id="å‘½ä»¤è¿æ¥ç¬¦"><a class="markdownIt-Anchor" href="#å‘½ä»¤è¿æ¥ç¬¦"></a> å‘½ä»¤è¿æ¥ç¬¦</h2><ol><li><p><strong>; åˆ†å·</strong>ï¼šæ²¡æœ‰ä»»ä½•é€»è¾‘å…³ç³»çš„è¿æ¥ç¬¦ã€‚å½“å¤šä¸ªå‘½ä»¤ç”¨åˆ†å·è¿æ¥æ—¶ï¼Œå„å‘½ä»¤ä¹‹é—´çš„æ‰§è¡ŒæˆåŠŸä¸å¦å½¼æ­¤æ²¡æœ‰ä»»ä½•å½±å“ï¼Œéƒ½ä¼šä¸€æ¡ä¸€æ¡æ‰§è¡Œä¸‹å»ã€‚</p></li><li><p><strong>|| é€»è¾‘æˆ–</strong>ï¼šå½“ç”¨æ­¤è¿æ¥ç¬¦è¿æ¥å¤šä¸ªå‘½ä»¤æ—¶ï¼Œå‰é¢çš„å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œåˆ™åé¢çš„å‘½ä»¤ä¸ä¼šæ‰§è¡Œã€‚å‰é¢çš„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œåé¢çš„å‘½ä»¤æ‰ä¼šæ‰§è¡Œã€‚</p></li><li><p><strong>&amp;&amp; é€»è¾‘ä¸</strong>ï¼šå½“ç”¨æ­¤è¿æ¥ç¬¦è¿æ¥å¤šä¸ªå‘½ä»¤æ—¶ï¼Œå‰é¢çš„å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œæ‰ä¼šæ‰§è¡Œåé¢çš„å‘½ä»¤ï¼Œå‰é¢çš„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œåé¢çš„å‘½ä»¤ä¸ä¼šæ‰§è¡Œï¼Œä¸ || æ­£å¥½ç›¸åã€‚</p></li><li><p><strong>| ç®¡é“ç¬¦</strong>ï¼šå½“ç”¨æ­¤è¿æ¥ç¬¦è¿æ¥å¤šä¸ªå‘½ä»¤æ—¶ï¼Œå‰é¢å‘½ä»¤æ‰§è¡Œçš„æ­£ç¡®è¾“å‡ºï¼Œä¼šäº¤ç»™åé¢çš„å‘½ä»¤ç»§ç»­å¤„ç†ã€‚è‹¥å‰é¢çš„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œåˆ™ä¼šæŠ¥é”™ï¼Œè‹¥åé¢çš„å‘½ä»¤æ— æ³•å¤„ç†å‰é¢å‘½ä»¤çš„è¾“å‡ºï¼Œä¹Ÿä¼šæŠ¥é”™</p></li></ol><h2 id="å¤åˆ¶æ–‡æœ¬å†…å®¹"><a class="markdownIt-Anchor" href="#å¤åˆ¶æ–‡æœ¬å†…å®¹"></a> å¤åˆ¶æ–‡æœ¬å†…å®¹</h2><p>æœ‰æ—¶å€™ä¸å¥½åœ¨ç»ˆç«¯ç•Œé¢é‡Œï¼Œç”¨é¼ æ ‡æ“ä½œé€‰ä¸­å¹¶å¤åˆ¶æ–‡ä»¶é‡Œçš„æ–‡æœ¬å†…å®¹ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥å¤åˆ¶æ–‡ä»¶é‡Œçš„å†…å®¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æ–¹æ³•1ï¼Œåˆ©ç”¨é‡å®šå‘</span><br><span class="hljs-meta">$</span><span class="bash"> pbcopy &lt; file.txt</span><br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> æ–¹æ³•2ï¼Œåˆ©ç”¨ç®¡é“</span><br><span class="hljs-meta">$</span><span class="bash"> cat file.txt | pbcopy</span><br></code></pre></td></tr></table></figure><h1 id="bonus-ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#bonus-ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹"></a> Bonus: ç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹</h1><blockquote><p>å‚è€ƒé˜®ä¸€å³°å¤§ä½¬çš„è¿™ç¯‡åšå®¢ï¼š<a href="http://www.ruanyifeng.com/blog/2013/02/booting.html">è®¡ç®—æœºæ˜¯å¦‚ä½•å¯åŠ¨çš„</a><sup id="fnref:8" class="footnote-ref"><a href="#fn:8" rel="footnote"><span class="hint--top hint--rounded" aria-label="è®¡ç®—æœºæ˜¯å¦‚ä½•å¯åŠ¨çš„">[8]</span></a></sup></p></blockquote><h2 id="1bios"><a class="markdownIt-Anchor" href="#1bios"></a> 1.BIOS</h2><ul><li>è®¡ç®—æœºé€šç”µåï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯è¯»å–åˆ·å…¥ROMèŠ¯ç‰‡çš„å¼€æœºç¨‹åºï¼Œè¿™ä¸ªç¨‹åºå«åš(Basic Input/Output System)</li></ul><h2 id="2ç¡¬ä»¶è‡ªæ£€"><a class="markdownIt-Anchor" href="#2ç¡¬ä»¶è‡ªæ£€"></a> 2.ç¡¬ä»¶è‡ªæ£€</h2><ul><li>BIOSç¨‹åºé¦–å…ˆæ£€æŸ¥ï¼Œè®¡ç®—æœºç¡¬ä»¶èƒ½å¦æ»¡è¶³è¿è¡Œçš„åŸºæœ¬æ¡ä»¶ï¼Œè¿™å«åš&quot;ç¡¬ä»¶è‡ªæ£€&quot;ï¼ˆPower-On Self-Test)</li><li>å¦‚æœç¡¬ä»¶å‡ºç°é—®é¢˜ï¼Œä¸»æ¿ä¼šå‘å‡ºä¸åŒå«ä¹‰çš„èœ‚é¸£ï¼Œå¯åŠ¨ä¸­æ­¢ã€‚å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œå±å¹•å°±ä¼šæ˜¾ç¤ºå‡ºCPUã€å†…å­˜ã€ç¡¬ç›˜ç­‰ä¿¡æ¯ã€‚</li></ul><h2 id="3-å¯åŠ¨é¡ºåº"><a class="markdownIt-Anchor" href="#3-å¯åŠ¨é¡ºåº"></a> 3. å¯åŠ¨é¡ºåº</h2><ul><li>ç¡¬ä»¶è‡ªæ£€å®Œæˆåï¼ŒBIOSæŠŠæ§åˆ¶æƒè½¬äº¤ç»™ä¸‹ä¸€é˜¶æ®µçš„å¯åŠ¨ç¨‹åºã€‚</li><li>è¿™æ—¶ï¼ŒBIOSéœ€è¦çŸ¥é“ï¼Œ&quot;ä¸‹ä¸€é˜¶æ®µçš„å¯åŠ¨ç¨‹åº&quot;å…·ä½“å­˜æ”¾åœ¨å“ªä¸€ä¸ªè®¾å¤‡</li><li>BIOSéœ€è¦æœ‰ä¸€ä¸ªå¤–éƒ¨å‚¨å­˜è®¾å¤‡çš„æ’åºï¼Œæ’åœ¨å‰é¢çš„è®¾å¤‡å°±æ˜¯ä¼˜å…ˆè½¬äº¤æ§åˆ¶æƒçš„è®¾å¤‡ã€‚è¿™ç§æ’åºå«åš&quot;å¯åŠ¨é¡ºåº&quot;ï¼ˆBoot Sequenceï¼‰</li><li>BIOSæŒ‰ç…§&quot;å¯åŠ¨é¡ºåº&quot;ï¼ŒæŠŠæ§åˆ¶æƒè½¬äº¤ç»™æ’åœ¨ç¬¬ä¸€ä½çš„å‚¨å­˜è®¾å¤‡ã€‚</li><li>è¿™æ—¶ï¼Œè®¡ç®—æœºè¯»å–è¯¥è®¾å¤‡çš„ç¬¬ä¸€ä¸ªæ‰‡åŒºï¼Œä¹Ÿå°±æ˜¯è¯»å–æœ€å‰é¢çš„512ä¸ªå­—èŠ‚ã€‚å¦‚æœè¿™512ä¸ªå­—èŠ‚çš„æœ€åä¸¤ä¸ªå­—èŠ‚æ˜¯0x55å’Œ0xAAï¼Œè¡¨æ˜è¿™ä¸ªè®¾å¤‡å¯ä»¥ç”¨äºå¯åŠ¨ï¼›å¦‚æœä¸æ˜¯ï¼Œè¡¨æ˜è®¾å¤‡ä¸èƒ½ç”¨äºå¯åŠ¨ï¼Œæ§åˆ¶æƒäºæ˜¯è¢«è½¬äº¤ç»™&quot;å¯åŠ¨é¡ºåº&quot;ä¸­çš„ä¸‹ä¸€ä¸ªè®¾å¤‡ã€‚</li><li>è¿™æœ€å‰é¢çš„512ä¸ªå­—èŠ‚ï¼Œå°±å«åš&quot;ä¸»å¼•å¯¼è®°å½•&quot;ï¼ˆMaster boot recordï¼Œç¼©å†™ä¸ºMBRï¼‰</li></ul><h2 id="4-ä¸»å¼•å¯¼è®°å½•çš„ç»“æ„"><a class="markdownIt-Anchor" href="#4-ä¸»å¼•å¯¼è®°å½•çš„ç»“æ„"></a> 4. ä¸»å¼•å¯¼è®°å½•çš„ç»“æ„</h2><ul><li><p>&quot;ä¸»å¼•å¯¼è®°å½•&quot;åªæœ‰512ä¸ªå­—èŠ‚ï¼Œæ”¾ä¸äº†å¤ªå¤šä¸œè¥¿ã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ï¼Œå‘Šè¯‰è®¡ç®—æœºåˆ°ç¡¬ç›˜çš„å“ªä¸€ä¸ªä½ç½®å»æ‰¾æ“ä½œç³»ç»Ÿã€‚</p><ul><li><p>ï¼ˆ1ï¼‰ ç¬¬1-446å­—èŠ‚ï¼šæ˜¯ç”¨æ¥è®°å½•ç³»ç»Ÿçš„å¯åŠ¨ä¿¡æ¯çš„,è°ƒç”¨æ“ä½œç³»ç»Ÿçš„æœºå™¨ç </p></li><li><p>ï¼ˆ2ï¼‰ ç¬¬447-510å­—èŠ‚(64ä¸ªå­—èŠ‚)ï¼šåˆ†åŒºè¡¨ï¼ˆPartition tableï¼‰ï¼Œåˆ†åŒºè¡¨çš„ä½œç”¨ï¼Œæ˜¯å°†ç¡¬ç›˜åˆ†æˆè‹¥å¹²ä¸ªåŒº</p></li><li><p>ï¼ˆ3ï¼‰ ç¬¬511-512å­—èŠ‚ï¼šä¸»å¼•å¯¼è®°å½•ç­¾åï¼ˆ0x55å’Œ0xAAï¼‰</p></li></ul></li></ul><h2 id="5-åˆ†åŒºè¡¨"><a class="markdownIt-Anchor" href="#5-åˆ†åŒºè¡¨"></a> 5. åˆ†åŒºè¡¨</h2><ul><li>ç£ç›˜åˆ†åŒºæ˜¯ä½¿ç”¨åˆ†åŒºç¼–è¾‘å™¨åœ¨ç£ç›˜ä¸Šåˆ’åˆ†å‡ ä¸ªé€»è¾‘éƒ¨åˆ†</li><li>ç£ç›˜ä¸€æ—¦åˆ’åˆ†æˆå¤šä¸ªåˆ†åŒºï¼Œä¸åŒç±»çš„ç›®å½•ä¸æ–‡ä»¶å¯ä»¥å­˜å‚¨è¿›ä¸åŒçš„åˆ†åŒºå†…</li><li>&quot;ä¸»å¼•å¯¼è®°å½•&quot;å› æ­¤å¿…é¡»çŸ¥é“å°†æ§åˆ¶æƒè½¬äº¤ç»™å“ªä¸ªåŒº</li><li>åˆ†åŒºè¡¨çš„é•¿åº¦åªæœ‰64ä¸ªå­—èŠ‚ï¼Œé‡Œé¢åˆåˆ†æˆå››é¡¹ï¼Œæ¯é¡¹16ä¸ªå­—èŠ‚ã€‚æ‰€ä»¥ï¼Œä¸€ä¸ªç¡¬ç›˜æœ€å¤šåªèƒ½åˆ†å››ä¸ªä¸€çº§åˆ†åŒºï¼Œåˆå«åš&quot;ä¸»åˆ†åŒº&quot;<ul><li>ï¼ˆ1ï¼‰ ç¬¬1ä¸ªå­—èŠ‚ï¼šå¦‚æœä¸º0x80ï¼Œå°±è¡¨ç¤ºè¯¥ä¸»åˆ†åŒºæ˜¯æ¿€æ´»åˆ†åŒºï¼Œæ§åˆ¶æƒè¦è½¬äº¤ç»™è¿™ä¸ªåˆ†åŒºã€‚å››ä¸ªä¸»åˆ†åŒºé‡Œé¢åªèƒ½æœ‰ä¸€ä¸ªæ˜¯æ¿€æ´»çš„ã€‚</li><li>ï¼ˆ2ï¼‰ ç¬¬2-4ä¸ªå­—èŠ‚ï¼šä¸»åˆ†åŒºç¬¬ä¸€ä¸ªæ‰‡åŒºçš„ç‰©ç†ä½ç½®ï¼ˆæŸ±é¢ã€ç£å¤´ã€æ‰‡åŒºå·ç­‰ç­‰ï¼‰ã€‚</li><li>ï¼ˆ3ï¼‰ ç¬¬5ä¸ªå­—èŠ‚ï¼šä¸»åˆ†åŒºç±»å‹ï¼Œæ¯”å¦‚FAT32ã€NTFSç­‰ã€‚</li><li>ï¼ˆ4ï¼‰ ç¬¬6-8ä¸ªå­—èŠ‚ï¼šä¸»åˆ†åŒºæœ€åä¸€ä¸ªæ‰‡åŒºçš„ç‰©ç†ä½ç½®ã€‚</li><li>ï¼ˆ5ï¼‰ ç¬¬9-12å­—èŠ‚ï¼šè¯¥ä¸»åˆ†åŒºç¬¬ä¸€ä¸ªæ‰‡åŒºçš„é€»è¾‘åœ°å€ã€‚</li><li>ï¼ˆ6ï¼‰ ç¬¬13-16å­—èŠ‚ï¼šä¸»åˆ†åŒºçš„æ‰‡åŒºæ€»æ•°ã€‚</li></ul></li></ul><h2 id="6-ç¡¬ç›˜å¯åŠ¨"><a class="markdownIt-Anchor" href="#6-ç¡¬ç›˜å¯åŠ¨"></a> 6. ç¡¬ç›˜å¯åŠ¨</h2><ul><li>è®¡ç®—æœºçš„æ§åˆ¶æƒå°±è¦è½¬äº¤ç»™ç¡¬ç›˜çš„æŸä¸ªåˆ†åŒºäº†</li><li>å››ä¸ªä¸»åˆ†åŒºé‡Œé¢ï¼Œåªæœ‰ä¸€ä¸ªæ˜¯æ¿€æ´»çš„ã€‚è®¡ç®—æœºä¼šè¯»å–æ¿€æ´»åˆ†åŒºçš„ç¬¬ä¸€ä¸ªæ‰‡åŒºï¼Œå«åš&quot;å·å¼•å¯¼è®°å½•&quot;ï¼ˆVolume boot recordï¼Œç¼©å†™ä¸ºVBRï¼‰</li><li>&quot;å·å¼•å¯¼è®°å½•&quot;çš„ä¸»è¦ä½œç”¨æ˜¯ï¼Œå‘Šè¯‰è®¡ç®—æœºï¼Œæ“ä½œç³»ç»Ÿåœ¨è¿™ä¸ªåˆ†åŒºé‡Œçš„ä½ç½®ã€‚ç„¶åï¼Œè®¡ç®—æœºå°±ä¼šåŠ è½½æ“ä½œç³»ç»Ÿäº†ã€‚</li></ul><h2 id="7-æ“ä½œç³»ç»Ÿ"><a class="markdownIt-Anchor" href="#7-æ“ä½œç³»ç»Ÿ"></a> 7. æ“ä½œç³»ç»Ÿ</h2><ul><li>æ§åˆ¶æƒè½¬äº¤ç»™æ“ä½œç³»ç»Ÿåï¼Œæ“ä½œç³»ç»Ÿçš„å†…æ ¸é¦–å…ˆè¢«è½½å…¥å†…å­˜ã€‚</li><li>ä»¥Linuxç³»ç»Ÿä¸ºä¾‹ï¼Œå…ˆè½½å…¥<code>/boot</code>ç›®å½•ä¸‹é¢çš„<code>kernel</code>ã€‚å†…æ ¸åŠ è½½æˆåŠŸåï¼Œç¬¬ä¸€ä¸ªè¿è¡Œçš„ç¨‹åºæ˜¯<code>/sbin/init</code>ã€‚å®ƒæ ¹æ®é…ç½®æ–‡ä»¶ï¼ˆDebianç³»ç»Ÿæ˜¯/etc/initabï¼‰äº§ç”Ÿinitè¿›ç¨‹ã€‚è¿™æ˜¯Linuxå¯åŠ¨åçš„ç¬¬ä¸€ä¸ªè¿›ç¨‹ï¼Œpidè¿›ç¨‹ç¼–å·ä¸º1ï¼Œå…¶ä»–è¿›ç¨‹éƒ½æ˜¯å®ƒçš„åä»£</li><li>ç„¶åï¼Œ<code>init</code>çº¿ç¨‹åŠ è½½ç³»ç»Ÿçš„å„ä¸ªæ¨¡å—ï¼Œæ¯”å¦‚çª—å£ç¨‹åºå’Œç½‘ç»œç¨‹åºï¼Œç›´è‡³æ‰§è¡Œ<code>/bin/login</code>ç¨‹åºï¼Œè·³å‡ºç™»å½•ç•Œé¢ï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ã€‚</li></ul><hr /><section class="footnotes"><h1>å¤‡æ³¨/å‚è€ƒ</h1><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://www.cnblogs.com/zxRPI/p/7872413.html">ctrl+z ä»¥åæ€ä¹ˆæ¢å¤æŒ‚èµ·çš„è¿›ç¨‹</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.jianshu.com/p/745a4cb32c47">linux è¿œç¨‹ä¸»æœºåå°è¿è¡Œä»»åŠ¡ æŒ‚èµ·è„šæœ¬</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:3" class="footnote-text"><span><a href="https://mp.weixin.qq.com/s/UwgHGSSnJhiYnDISxGQXag">Linuxå¼€å‘å°æŠ€å·§</a><a href="#fnref:3" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:4" class="footnote-text"><span><a href="https://www.phpernote.com/linux/1431.html">linuxä¸­ç»™ alias æ·»åŠ è‡ªå®šä¹‰çš„å‚æ•°</a><a href="#fnref:4" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:5" class="footnote-text"><span><a href="https://mp.weixin.qq.com/s/QyERReOEIBC5T4580ffVHw">linuxæ€»ç»“</a><a href="#fnref:5" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:6" class="footnote-text"><span><a href="https://www.linuxprobe.com/soft-and-hard-links.html">è½¯é“¾æ¥å’Œç¡¬é“¾æ¥çš„åŒºåˆ«</a><a href="#fnref:6" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:7" class="footnote-text"><span><a href="http://www.178linux.com/53101">linuxä¸­ç¡¬é“¾æ¥ä¸è½¯é“¾æ¥çš„åŒºåˆ«</a><a href="#fnref:7" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:8" class="footnote-text"><span><a href="http://www.ruanyifeng.com/blog/2013/02/booting.html">è®¡ç®—æœºæ˜¯å¦‚ä½•å¯åŠ¨çš„</a><a href="#fnref:8" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é™¤å¤•å¤œæµ…è°ˆ</title>
    <link href="/2022/01/31/2022-01/2022-01-31%20%E9%99%A4%E5%A4%95%E5%A4%9C%E6%B5%85%E8%B0%88/"/>
    <url>/2022/01/31/2022-01/2022-01-31%20%E9%99%A4%E5%A4%95%E5%A4%9C%E6%B5%85%E8%B0%88/</url>
    
    <content type="html"><![CDATA[<p>å“ˆå“ˆï¼Œè¿™è¿˜æ˜¯ç¬¬ä¸€æ¬¡åœ¨é™¤å¤•å¤œå†™ç‚¹ä¸œè¥¿å‘¢ï¼Œä¹Ÿç®—æ˜¯åˆ›çºªå½•å§ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202201312130421.jpeg" alt="" /></p><p>ä¸»è¦å‰ä¸€å‘¨åˆšæŠŠå­¦æ ¡é‡Œçš„ä½œä¸šå¿™å®Œï¼Œç„¶åè¿™ä¸€å‘¨å°±æœ¬æ€§æš´éœ²ï¼Œå¼€å§‹æ‘†çƒ‚èººå¹³ï¼Œç–¯ç‹‚æ²‰è¿·æ¸¸æˆï¼Œè‚†æ„åœ°æŒ¥éœæ—¶é—´ï¼Œæ˜æ˜ä¹‹å‰éƒ½åˆ¶å®šå¥½å‡æœŸè®¡åˆ’ï¼Œè¦åŠ å¼ºè‡ªæˆ‘çš„ï¼Œå¯æ¶ï¼Œéš¾é“ï¼Œwa ta shiï¼Œåˆè¦é‡è¹ˆè¦†è¾™å—ï¼Ÿ</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202201312139874.jpeg" alt="" /></p><p>æ˜å¤©å¤§å¹´åˆä¸€ï¼Œæ–°çš„ä¸€å¹´ï¼Œæ–°çš„å¼€å§‹ï¼Œå°±ç®—ä¼¤ç—•ç´¯ç´¯ï¼Œå°±ç®—è·Œå€’å¤±è´¥ï¼Œæˆ‘ä¹Ÿè¦å‰è¿›ï¼Œæˆ‘ä¹Ÿè¦æˆ˜æ–—ï¼Œta ta kai, yi zi mo ta ta kai !</p><p>è‡³äºä»Šæ™šçš„å‰©ä½™æ—¶é—´ï¼Œæ™šä¸Šå¹´å¤œé¥­ä¹Ÿå–äº†é…’ï¼Œå°±å¥½å¥½ä¼‘æ¯å§ï¼Œçœ‹çœ‹bilibiliçš„æ‹œå¹´çºªï¼Œå†æŠŠå¤©é™ä¹‹ç‰©çš„å‰§åœºç‰ˆç»™è¡¥äº†ï¼Œç¡ä¸ªå¥½è§‰ï¼Œæ˜å¤©å†å‡ºå‘~</p><p>æœ€åï¼Œç¥å¤§å®¶æ–°æ˜¥å¿«ä¹ï¼Œè™å¹´å¤§å‰~</p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202202010930000.jpeg" alt="è™å¹´" style="zoom:67%;" />]]></content>
    
    
    <categories>
      
      <category>ç”Ÿæ´»</category>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚è°ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C++æŒ‡é’ˆé‚£äº›äº‹</title>
    <link href="/2022/01/17/2022-01/2022-01-17%20C++%E6%8C%87%E9%92%88%E9%82%A3%E4%BA%9B%E4%BA%8B/"/>
    <url>/2022/01/17/2022-01/2022-01-17%20C++%E6%8C%87%E9%92%88%E9%82%A3%E4%BA%9B%E4%BA%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>æŒ‡é’ˆçœŸçš„è®©äººåˆçˆ±åˆæ¨ï¼Œæ¯å½“è‡ªå·±è®¤ä¸ºå·²ç»å‚æ‚Ÿä¸€äºŒï¼Œç°å®æ€»æ˜¯ç‹ ç‹ åœ°æ‰“äº†æˆ‘è„¸ï¼Œä¸æ˜¯å¿˜äº†è¿™ä¸ªï¼Œå°±æ˜¯å¿˜äº†é‚£ä¸ªã€‚å› æ­¤è¶è¿™ä¸ªæœºä¼šï¼Œå†æ¸©ä¹ å›é¡¾ä¸‹C/C++é‡ŒæŒ‡é’ˆçš„ç›¸å…³è¯­æ³•çŸ¥è¯†ï¼Œå¹¶è®°å½•ä¸‹æ¥ä»¥ä¾¿æ—¥åå¤ä¹ ã€‚</p><h1 id="åŸºæœ¬çŸ¥è¯†"><a class="markdownIt-Anchor" href="#åŸºæœ¬çŸ¥è¯†"></a> åŸºæœ¬çŸ¥è¯†</h1><h2 id="æŒ‡é’ˆåŸºæœ¬æ¦‚å¿µ"><a class="markdownIt-Anchor" href="#æŒ‡é’ˆåŸºæœ¬æ¦‚å¿µ"></a> æŒ‡é’ˆåŸºæœ¬æ¦‚å¿µ</h2><p>åœ¨Cè¯­è¨€ä¸­ï¼Œæ¯å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œç³»ç»Ÿå°±ä¼šä¸ºå˜é‡åˆ†é…ä¸€å—å†…å­˜ï¼Œè€Œå†…å­˜æ˜¯æœ‰åœ°å€çš„ã€‚Cè¯­è¨€ä¸­ï¼Œé‡‡ç”¨è¿ç®—ç¬¦ &amp; æ¥è·å–å˜é‡çš„åœ°å€ã€‚</p><p><strong>æŒ‡é’ˆæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„å˜é‡ï¼Œç”¨äºå­˜å‚¨å˜é‡çš„åœ°å€</strong>ã€‚å½“æŒ‡é’ˆå˜é‡èµ‹å€¼ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨è¿ç®—ç¬¦ * ï¼ˆè§£å¼•ç”¨è¿ç®—ç¬¦ï¼‰ï¼Œå–å¾—æŒ‡é’ˆæ‰€æŒ‡å‘åœ°å€çš„å€¼ï¼Œç®€å•ç”¨æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">int</span>* p;  <span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªæŒ‡é’ˆpï¼Œç±»å‹ä¸º int;</span><br><span class="hljs-keyword">int</span> num = <span class="hljs-number">10</span>;<span class="hljs-comment">// å®šä¹‰ä¸€ä¸ª int å˜é‡</span><br><br>p = &amp;b;<span class="hljs-comment">//å°† p æŒ‡å‘ b</span><br><br>cout &lt;&lt; <span class="hljs-string">&quot;å˜é‡ num çš„åœ°å€ä¸º &quot;</span> &lt;&lt; p &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;å˜é‡ num çš„åœ°å€ä¸º &quot;</span> &lt;&lt; (&amp;num) &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;å˜é‡ num çš„å€¼ä¸º&quot;</span> &lt;&lt; num &lt;&lt; endl;<br>cout &lt;&lt; <span class="hljs-string">&quot;å˜é‡ num çš„å€¼ä¸º&quot;</span> &lt;&lt; *p &lt;&lt; endl; <span class="hljs-comment">// *p è¡¨ç¤ºæŒ‡é’ˆpä¸­å­˜å‚¨çš„åœ°å€æ‰€å¯¹åº”çš„å€¼ï¼›</span><br><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šåœ¨ C++ åˆ›å»ºæŒ‡é’ˆæ—¶ï¼Œè®¡ç®—æœºå°†ä¼šåˆ†é…ç”¨æ¥å­˜å‚¨åœ°å€çš„å†…å­˜ï¼Œä½†ä¸ä¼šåˆ†é…ç”¨æ¥å­˜å‚¨æŒ‡é’ˆæ‰€æŒ‡å‘çš„æ•°æ®çš„å†…å­˜ ï¼Œä¸ºæ•°æ®åˆ†é…çš„ç©ºé—´æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç©ºé—´ï¼Œä¸å¯çœç•¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">int</span> *pt;<span class="hljs-comment">// å®šä¹‰ä¸€ä¸ªæŒ‡å‘ int ç±»å‹çš„æŒ‡é’ˆ pt;</span><br>*pt = <span class="hljs-number">23</span>;<span class="hljs-comment">// é”™è¯¯ï¼ŒæŒ‡é’ˆ pt æœªæŒ‡å‘ä»»ä½•åœ°å€ï¼Œ</span><br></code></pre></td></tr></table></figure><p>æ‰€ä»¥éœ€è¦è°¨è®°ä¸€ç‚¹ï¼Œåœ¨å¯¹æŒ‡é’ˆåº”ç”¨è§£å¼•ç”¨è¿ç®—ç¬¦(*) ä¹‹å‰ï¼Œå°†æŒ‡é’ˆåˆå§‹åŒ–ä¸ºä¸€ä¸ªç¡®å®šçš„ï¼Œé€‚å½“çš„åœ°å€ã€‚</p><h2 id="ç©ºæŒ‡é’ˆä¸é‡æŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#ç©ºæŒ‡é’ˆä¸é‡æŒ‡é’ˆ"></a> ç©ºæŒ‡é’ˆä¸é‡æŒ‡é’ˆ</h2><p>ç©ºæŒ‡é’ˆï¼šæ²¡æœ‰èµ‹å€¼çš„æŒ‡é’ˆå˜é‡ï¼ˆæ²¡æœ‰æŒ‡å‘å†…å­˜å˜é‡çš„åœ°å€ï¼‰ï¼Œå¯¹ç©ºæŒ‡é’ˆè¿›è¡Œæ“ä½œä¼šé€ æˆç¨‹åºçš„Core dumpï¼ˆæ®µé”™è¯¯ï¼‰ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">int</span>* p = <span class="hljs-number">0</span>;<br>*p = <span class="hljs-number">10</span>;<span class="hljs-comment">// è¿è¡ŒæŠ¥é”™</span><br></code></pre></td></tr></table></figure><p>é‡æŒ‡é’ˆï¼šæŒ‡é’ˆæŒ‡å‘å†…å­˜å·²é‡Šæ”¾ï¼Œä½†æŒ‡é’ˆçš„å€¼ä¸ä¼šè¢«æ¸…é›¶ï¼Œå¯¹é‡æŒ‡é’ˆæ“ä½œçš„ç»“æœä¸å¯é¢„çŸ¥ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤ºã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">int</span>* p = <span class="hljs-keyword">new</span> <span class="hljs-built_in"><span class="hljs-keyword">int</span></span>(<span class="hljs-number">3</span>);<br><span class="hljs-keyword">delete</span> p ;<br><span class="hljs-keyword">if</span> (p !=  <span class="hljs-literal">nullptr</span>) &#123;<span class="hljs-comment">// å·²ç»é‡Šæ”¾äº†å¯¹åº”å†…å­˜ç©ºé—´ï¼Œä½†æŒ‡é’ˆçš„å€¼è¿˜æ²¡æœ‰æ¸…é›¶ï¼Œæ­¤æ—¶æˆä¸ºé‡æŒ‡é’ˆ</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;not nullptr&quot;</span> &lt;&lt; endl;<br>&#125;<br>p = <span class="hljs-literal">nullptr</span>;<span class="hljs-comment">// é‡Šæ”¾æŒ‡é’ˆåï¼Œåº”å½“æ‰‹åŠ¨ç½®æŒ‡é’ˆä¸ºnullptr</span><br></code></pre></td></tr></table></figure><h2 id="sizeofçš„å‘"><a class="markdownIt-Anchor" href="#sizeofçš„å‘"></a> sizeofçš„å‘</h2><p>sizeof(x) ï¼Œå½“ x ä¸ºæŒ‡é’ˆå˜é‡æ—¶ï¼Œæ±‚å¾—çš„æ˜¯æŒ‡é’ˆç±»å‹çš„å¤§å°ï¼›å½“ x ä¸ºæ•°ç»„åæ—¶ï¼Œæ±‚å¾—çš„æ˜¯æ•°ç»„çš„å¤§å°ï¼ˆæ•°ç»„å…ƒç´ ä¸ªæ•° * æ•°ç»„å…ƒç´ ç±»å‹å¤§å°ï¼‰ã€‚</p><p><strong>æ³¨æ„</strong>ï¼šå½“æ•°ç»„ä½œä¸ºå‡½æ•°çš„å‚æ•°è¿›è¡Œä¼ é€’æ—¶ï¼Œæ•°ç»„è‡ªåŠ¨é€€åŒ–ä¸ºåŒç±»å‹çš„æŒ‡é’ˆã€‚å‚è€ƒä¸‹é¢ç¤ºä¾‹ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">get_size</span><span class="hljs-params">(<span class="hljs-keyword">int</span> data[])</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(data);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> data1[] = &#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>&#125;;<br>    <span class="hljs-keyword">int</span> size1 = <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(data1);    <span class="hljs-comment">// 20 ï¼ˆè¾“å‡ºçš„æ˜¯æ•°ç»„å¤§å°)</span><br>    <br>    <span class="hljs-keyword">int</span>* data2 = data1;<br>    <span class="hljs-keyword">int</span> size2 = <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(data2);    <span class="hljs-comment">// 8 (64ä½æœºå™¨ï¼‰ è¾“å‡ºçš„æ˜¯æŒ‡é’ˆå¤§å°</span><br>    <br>    <span class="hljs-keyword">int</span> size3 = <span class="hljs-built_in">get_size</span>(data1);  <span class="hljs-comment">// 8 (64ä½æœºå™¨ï¼‰</span><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="æŒ‡é’ˆä¸æ•°ç»„"><a class="markdownIt-Anchor" href="#æŒ‡é’ˆä¸æ•°ç»„"></a> æŒ‡é’ˆä¸æ•°ç»„</h1><ul><li>æ•°ç»„åç”¨æ³•ä¸Š ç±»ä¼¼äºä¸€ä¸ªæŒ‡é’ˆå¸¸é‡ï¼ŒæŒ‡å‘æ•°ç»„é¦–å…ƒç´ çš„åœ°å€</li><li>å¯¹äºæŒ‡é’ˆpï¼Œ p+1 çš„è·¨åº¦ï¼Œå³ç§»åŠ¨pä¸€æ¬¡å¢åŠ çš„å­—èŠ‚æ•°å¤§å°ï¼Œç­‰äºæŒ‡é’ˆpæ‰€æŒ‡å…ƒç´ ç±»å‹çš„å¤§å°<ul><li>å¯¹äºint *pï¼Œå¢åŠ 4å­—èŠ‚</li><li>å¯¹äºdouble *p ï¼Œå¢åŠ 8å­—èŠ‚</li><li>å¯¹äºint (* p)[3)ï¼Œå¢åŠ  3 * 4 = 12 å­—èŠ‚ï¼Œå› ä¸ºpæŒ‡å‘çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•´ä¸ªæ•°ç»„çš„å¤§å°ä¸º3ã€*4 = 12å­—èŠ‚</li><li>å¯¹äºint* * pï¼Œå¢åŠ 8å­—èŠ‚ï¼ˆ64ä½ç³»ç»Ÿï¼‰ï¼Œå› ä¸ºpæŒ‡å‘çš„æ˜¯ä¸€ä¸ªint*æŒ‡é’ˆï¼Œè€ŒæŒ‡é’ˆå¤§å°ä¸º8å­—èŠ‚</li></ul></li><li>å¯¹äºnewçš„ä½¿ç”¨ï¼Œé€šå¸¸æ˜¯å’ŒæŒ‡é’ˆç»“åˆåœ¨ä¸€èµ·ï¼Œå¯¹äº Type* p ï¼ˆTypeä»£è¡¨æŸç§ç±»å‹ï¼‰ï¼Œé€šå¸¸newæ˜¯æœ‰ä¸¤ç§ç”¨æ³•<ul><li><code>Type* p = new Type( )</code>ï¼Œåªåˆ†é…å•ä¸ªTypeçš„å†…å­˜ï¼Œnewè¿”å›çš„ä¹Ÿæ˜¯è¿™ä¸ªTypeçš„å†…å­˜åœ°å€<ul><li>è·å–å¯¹åº”å…ƒç´ ï¼Œé€šå¸¸ä½¿ç”¨ *pï¼Œä½†æ˜¯ p[0] ä¹Ÿæ˜¯åŒæ ·çš„æ•ˆæœï¼›ä½¿ç”¨ p[1] çš„è¯ï¼Œä¼šè®¿é—®è¶…å‡ºäº†æˆ‘ä»¬åˆ†é…çš„å†…å­˜ï¼Œå¯èƒ½å¸¦æ¥ä¸å¯é¢„çŸ¥çš„åæœ</li></ul></li><li><code>Type* p = new Type[n]</code>ï¼Œåˆ†é…nä¸ª Typeçš„å†…å­˜ï¼Œnewè¿”å›çš„æ˜¯Typeæ•°ç»„é¦–å…ƒç´ çš„åœ°å€<ul><li>è·å–å¯¹åº”å…ƒç´ ï¼Œé€šå¸¸ä½¿ç”¨ p[i]ï¼Œè·å–ä¸‹æ ‡ä¸º i çš„å…ƒç´ </li></ul></li></ul></li></ul><hr /><p>è¿™æ ·çš„è¯æœ‰è¿™æ ·ä¸€ä¸ªç–‘æƒ‘ï¼Œå¦‚ä¸‹æ–¹å›¾ç‰‡ä¸­æ ‡çº¢åŒºåŸŸï¼Œå¯ä»¥æœ‰ç”³è¯·ä¸€ä¸ªintçš„å¤§å°ï¼Œç”³è¯·ä¸€ä¸ªæŒ‡é’ˆçš„å¤§å°ï¼Œå¦‚ä½•å•ç‹¬ç”³è¯·ä¸€ä¸ªæ•°ç»„å¯¹è±¡ï¼Ÿ</p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202201221755705.png" alt="" style="zoom: 50%;" /></center><p>ä¼¼ä¹å¹¶æ²¡æœ‰ç›¸å¯¹åº”çš„æ–¹å¼ï¼Œå› ä¸ºç”³è¯·ä¸€ä¸ªæ•°ç»„çš„ç©ºé—´å·²ç»ç”¨ <code>int* p = new int[3]</code> è¡¨è¾¾äº†ï¼Œå…¶å®è¿™ä¸ªé—®é¢˜æœ‰ç‚¹ç±»ä¼¼é’»ç‰›è§’å°–ï¼Œæˆ–è€…è¯´è‡ªä»¥ä¸ºæœ‰è¿™æ ·çš„å¯¹ç§°è§„å¾‹åœ¨ã€‚ä½†åœ¨å®é™…ä½¿ç”¨ä¸­å¹¶ä¸æ¨èä½¿ç”¨new å’Œ deleteï¼Œå¯¹äºæ•°ç»„çš„éœ€æ±‚ï¼Œä½¿ç”¨vector&lt; T&gt; å°±è¡Œäº†ï¼›è¿™é‡Œåªæ˜¯ä¸ºäº†æ¢è®¨ç ”ç©¶è¯­æ³•é—®é¢˜ã€‚</p><h1 id="æŒ‡é’ˆå¸¸é‡ä¸å¸¸é‡æŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#æŒ‡é’ˆå¸¸é‡ä¸å¸¸é‡æŒ‡é’ˆ"></a> æŒ‡é’ˆå¸¸é‡ä¸å¸¸é‡æŒ‡é’ˆ</h1><p><strong>æŒ‡é’ˆå¸¸é‡</strong>ï¼šæŒ‡é’ˆç±»å‹çš„å¸¸é‡ã€‚è¡¨ç¤ºè¿™ä¸ªæŒ‡é’ˆå˜é‡ç”¨constä¿®é¥°åæˆäº†å¸¸é‡ï¼Œå˜é‡çš„å€¼ä¸èƒ½æ”¹å˜å³ä¸èƒ½æŒ‡å‘å…¶ä»–åœ°å€ï¼Œä½†æ˜¯æŒ‡é’ˆæ‰€æŒ‡å‘åœ°å€é‡Œçš„å€¼æ˜¯å¯ä»¥ä¿®æ”¹çš„ã€‚åŒæ—¶æ³¨æ„è¿™æ˜¯ä¸ªå¸¸é‡ï¼Œæ‰€ä»¥åœ¨å®šä¹‰çš„æ—¶å€™è¦åˆå§‹åŒ–ã€‚</p><p><strong>å¸¸é‡æŒ‡é’ˆ</strong>ï¼šæŒ‡é’ˆå˜é‡æŒ‡å‘çš„ç±»å‹ä¸ºå¸¸é‡ç±»å‹ï¼Œå³æŒ‡é’ˆæŒ‡å‘åœ°å€é‡Œçš„å€¼ä¸å¯ä»¥ä¿®æ”¹ã€‚</p><p>å…·ä½“ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">int</span> a = <span class="hljs-number">10</span>, b = <span class="hljs-number">20</span>;<br><span class="hljs-keyword">int</span> * <span class="hljs-keyword">const</span> p1 = &amp;a;<span class="hljs-comment">// p1æ˜¯æŒ‡é’ˆå¸¸é‡</span><br>*p1 = <span class="hljs-number">30</span>;   <span class="hljs-comment">// p1æŒ‡å‘çš„åœ°å€æ˜¯ä¸€å®šçš„ï¼Œä½†å…¶å†…å®¹å¯ä»¥ä¿®æ”¹</span><br><span class="hljs-comment">// p1 = &amp;b;// p1æŒ‡é’ˆå¸¸é‡ä¸èƒ½æŒ‡å‘å…¶ä»–å˜é‡çš„åœ°å€</span><br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> *p2 = &amp;a; <span class="hljs-comment">// p2æ˜¯å¸¸é‡æŒ‡é’ˆ</span><br><span class="hljs-comment">// int const *p2 = &amp;a; // å’Œä¸Šä¸€è¡Œç­‰ä»·</span><br>p2 = &amp;b; <span class="hljs-comment">// p2å¯ä»¥æŒ‡å‘å…¶ä»–åœ°å€ï¼Œä½†æ˜¯å†…å®¹ä¸å¯ä»¥æ”¹å˜</span><br><span class="hljs-comment">// *p2 = 10; // p2å¸¸é‡æŒ‡é’ˆï¼Œæ‰€æŒ‡å‘åœ°å€çš„å€¼ä¸å¯ä»¥ä¿®æ”¹</span><br><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> * <span class="hljs-keyword">const</span> p3 = &amp;a;<span class="hljs-comment">// p3æ—¢æ˜¯æŒ‡é’ˆå¸¸é‡åˆæ˜¯å¸¸é‡æŒ‡é’ˆ</span><br><span class="hljs-comment">// p3 = &amp;b;// p3ä¸èƒ½æŒ‡å‘å…¶ä»–åœ°å€</span><br><span class="hljs-comment">// *p3 = 30;// p3æ‰€æŒ‡å‘åœ°å€çš„å€¼ä¸èƒ½ä¿®æ”¹</span><br></code></pre></td></tr></table></figure><p>æœ‰æ—¶å€™æŒ‡é’ˆå¸¸é‡å’Œå¸¸é‡æŒ‡é’ˆå‚»å‚»åˆ†ä¸æ¸…ï¼Œæ•™å¤§å®¶ä¸€ä¸ªå°æŠ€å·§ï¼Œ<strong>å°±æ˜¯çœ‹ const  åœ¨ * çš„å“ªä¸€ä¾§</strong>ï¼Œå¦‚æœconst åœ¨ * å·¦ä¾§ï¼Œè¡¨æ˜const é è¿‘æ‰€æŒ‡å‘çš„å˜é‡ç±»å‹ï¼Œå³æ‰€æŒ‡å‘çš„å˜é‡æ˜¯ä¸ªå¸¸é‡ï¼Œä¹Ÿå°±æ˜¯å¸¸é‡æŒ‡é’ˆï¼›å¦‚æœ const åœ¨ * çš„å³ä¾§ï¼Œè¡¨æ˜ const é è¿‘æŒ‡é’ˆå˜é‡åï¼Œæ‰€ä»¥è¿™ä¸ªæŒ‡é’ˆå˜é‡æ˜¯ä¸ªå¸¸é‡ï¼Œä¹Ÿå°±æ˜¯æŒ‡é’ˆå¸¸é‡ã€‚</p><h1 id="å‡½æ•°åä¸å‡½æ•°æŒ‡é’ˆ"><a class="markdownIt-Anchor" href="#å‡½æ•°åä¸å‡½æ•°æŒ‡é’ˆ"></a> å‡½æ•°åä¸å‡½æ•°æŒ‡é’ˆ</h1><p>å°±åƒå®šä¹‰ int å˜é‡æ—¶ï¼Œä¼šåœ¨å†…å­˜é‡Œåˆ†é…ä¸€ä¸ª4å­—èŠ‚çš„ç©ºé—´å­˜å‚¨è¯¥å˜é‡ï¼Œå¯¹åº”æœ‰ä¸€ä¸ªåœ°å€ï¼›å½“å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°åï¼ŒåŒæ ·éœ€è¦åœ¨å†…å­˜ä¸­åˆ†é…ç©ºé—´è¿›è¡Œå­˜å‚¨ï¼Œè°ƒç”¨å‡½æ•°å°±åƒä½¿ç”¨å˜é‡ä¸€æ ·éœ€è¦ä¸€ä¸ªåœ°å€æ¥å”¯ä¸€çš„æŒ‡å‘å®ƒï¼Œæ‰€ä»¥æ¯ä¸ªå‡½æ•°éƒ½éœ€è¦ä¸€ä¸ªåœ°å€æ¥å”¯ä¸€æ ‡è¯†è‡ªå·±ï¼Œä¹Ÿå°±æ˜¯æ‰€è¯´çš„å…¥å£åœ°å€ã€‚</p><p>å‡½æ•°åæ ‡è¯†æ˜ å°„è¯¥å‡½æ•°çš„å…¥å£åœ°å€ï¼Œè€Œå‡½æ•°æŒ‡é’ˆæ˜¯æŒ‡å‘å‡½æ•°å…¥å£åœ°å€çš„æŒ‡é’ˆå˜é‡ï¼ˆè®°ä½äº†å‡½æ•°åæœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªæŒ‡é’ˆç±»å‹ï¼‰ã€‚</p><p>æœ‰äº†æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡åï¼Œå¯ä»¥ç”¨å‡½æ•°æŒ‡é’ˆå˜é‡è°ƒç”¨å‡½æ•°ï¼Œå°±åƒç”¨æŒ‡é’ˆå˜é‡æ“ä½œå…¶ä»–ç±»å‹å˜é‡ä¸€æ ·ã€‚å‡½æ•°æŒ‡é’ˆä¸»è¦æœ‰ä¸¤ä¸ªç”¨é€”ï¼šè°ƒç”¨å‡½æ•°å’Œåšå‡½æ•°çš„å‚æ•°ã€‚</p><hr /><p>æˆ‘ä»¬éƒ½çŸ¥é“åœ¨è°ƒç”¨å‡½æ•°çš„æ—¶å€™æœ‰å‡½æ•°åå°±å¤Ÿäº†ï¼Œæ¯”å¦‚fun(2)ï¼Œä½†ç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šè¿›è¡Œæ‰€è°“çš„&quot;<strong>Function-to-pointer conversion</strong>&quot;ï¼Œä¹Ÿå°±æ˜¯æŠŠå‡½æ•°åéšå¼è½¬æ¢æˆå‡½æ•°æŒ‡é’ˆç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¦é€šè¿‡å‡½æ•°æŒ‡é’ˆæ¥è°ƒç”¨å‡½æ•°ï¼Œæ‰€ä»¥å¦‚æœä½ åœ¨è°ƒç”¨å‡½æ•°çš„æ—¶å€™å†™æˆ(&amp;fun)(2)ä¹Ÿæ˜¯ä¸€æ ·èƒ½å·¥ä½œçš„ï¼Œå› ä¸º&amp;funå®é™…ä¸Šå°±æ˜¯è¿”å›ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆã€‚å‚ç…§ä¸‹é¢ä¾‹å­ï¼Œåªæ˜¯è¿™ç§å†™æ³•å¾ˆä¸å¸¸è§ï¼Œå³ä½¿ä½ ä¸æ˜¾å¼çš„å†™å‡º&amp;çš„è¯ç¼–è¯‘å™¨ä¹Ÿä¼šéšå¼çš„è¿›è¡Œè½¬æ¢ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">fun</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a)</span></span><br><span class="hljs-function"></span>&#123;<br>    cout&lt;&lt;<span class="hljs-string">&quot;fun&quot;</span>&lt;&lt;endl;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;fun=%p\n&quot;</span>,fun);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;*fun=%p\n&quot;</span>,*fun);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;&amp;fun=%p\n&quot;</span>,&amp;fun);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;*******fun=%p\n&quot;</span>,*******fun);<br><br>    <span class="hljs-built_in"><span class="hljs-keyword">void</span></span>(*p1)(<span class="hljs-keyword">int</span>)=fun;<span class="hljs-comment">// å‡½æ•°æŒ‡é’ˆp1ï¼Œfunè¿›è¡Œä¸€æ¬¡éšå¼è½¬æ¢</span><br>    <span class="hljs-built_in"><span class="hljs-keyword">void</span></span>(*p2)(<span class="hljs-keyword">int</span>)=*fun;<span class="hljs-comment">// funè¿›è¡Œäº†ä¸¤æ¬¡éšå¼è½¬æ¢</span><br>    <span class="hljs-built_in"><span class="hljs-keyword">void</span></span>(*p3)(<span class="hljs-keyword">int</span>)=&amp;fun;<span class="hljs-comment">// æ˜¾ç¤ºè½¬æ¢æˆå‡½æ•°æŒ‡é’ˆ</span><br><span class="hljs-comment">//    void(*p4)(int)=&amp;&amp;fun; // ä¸å¯ä»¥ï¼Œè¿ç»­å–ä¸¤æ¬¡åœ°å€ï¼Œå°±å˜æˆäº†å‡½æ•°æŒ‡é’ˆçš„æŒ‡é’ˆç±»å‹</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;p1=%p\n&quot;</span>, p1);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;p2=%p\n&quot;</span>, p2);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;p3=%p\n&quot;</span>, p3);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ­£å¦‚ä¸Šé¢ä»£ç ç¤ºä¾‹æ‰€ç¤ºï¼Œå…¶å®å³ä½¿ä½ å†™æˆ(* fun)(2)ä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„ï¼Œè¿™æ˜¯å› ä¸ºå½“ç¼–è¯‘å™¨çœ‹åˆ°funçš„æ—¶å€™å‘ç°å®ƒå‰é¢æ²¡æœ‰&amp;ï¼Œ<strong>ä¹Ÿå°±æ˜¯å¦‚æœæ²¡æœ‰å°†å‡½æ•°åæ˜¾ç¤ºåœ°è½¬æ¢æˆæŒ‡é’ˆï¼Œé‚£ä¹ˆä»–å°±ä¼šéšå¼åœ°è½¬æ¢æˆæŒ‡é’ˆ</strong>ï¼Œå½“è½¬æ¢å®Œä¹‹åå‘ç°å‰é¢åˆæœ‰ä¸€ä¸ª * è¿™æ—¶å€™ä¹Ÿå°±æ˜¯è¦è¿›è¡Œæ‰€è°“çš„&quot;è§£å¼•ç”¨&quot;æ“ä½œï¼Œä¹Ÿå°±æ˜¯å–å‡º * æŒ‡é’ˆé‡Œçš„å€¼ï¼Œè€Œé‚£ä¹ˆå€¼å®é™…ä¸Šä¹Ÿå°±å‡½æ•°åfunï¼Œè¿™æ ·ä¸€æ¬¡éšå¼æ¢ç„¶åå†æ¥ä¸€æ¬¡è§£å¼•ç”¨å®é™…ä¸Šç›¸å½“äºä»€ä¹ˆä¹Ÿæ²¡åšï¼Œæ‰€ä»¥ç³»ç»Ÿè¿˜ä¼šå†è¿›è¡Œä¸€æ¬¡éšå¼çš„&quot;Function-to-pointer conversion&quot;ï¼Œæ‰€ä»¥å³ä½¿ä½ å†™æˆ(************fun)(2)ä¹Ÿä¼šæ­£å¸¸è¿è¡Œï¼Œå’Œåˆšæ‰çš„ä¸€ä¸ªé“ç†ï¼Œåªæ˜¯å¤šåšäº†å‡ æ¬¡åå¤çš„è½¬è§£æ“ä½œè€Œå·²ï¼Œéƒ½æ˜¯ç¼–è¯‘å™¨è‡ªå·±å®Œæˆçš„ã€‚</p><hr /><p>åæ¥åˆå­¦ä¹ åˆ°äº†å®šä¹‰æŸä¸ªç±»çš„éé™æ€æˆå‘˜å‡½æ•°æŒ‡é’ˆçš„æ–¹å¼ï¼ŒçœŸæ˜¯åˆâ€œæ¶¨å§¿åŠ¿â€äº†~ ä¾‹å¦‚<code>typedef void (MyClass:: *ClassFunc)();</code>è¿™æ˜¯å®šä¹‰äº†<code>MyClass</code>ç±»çš„éé™æ€æˆå‘˜å‡½æ•°æŒ‡é’ˆï¼Œå³<code>ClassFunc</code>å®šä¹‰çš„å˜é‡åªèƒ½æ¥æ”¶<code>MyClass</code>çš„éé™æ€æˆå‘˜å‡½æ•°ã€‚</p><p>è€Œè°ƒç”¨çš„æ–¹å¼ä¹Ÿæ¯”è¾ƒå¥‡ç‰¹ï¼Œå› ä¸ºæ˜¯ç»‘å®šçš„æ˜¯ç±»çš„éé™æ€æˆå‘˜å‡½æ•°ï¼Œæ‰€ä»¥å°±éœ€è¦è¯¥ç±»çš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡æ¥è¿›è¡Œè°ƒç”¨ï¼Œæ‰€ä»¥è°ƒç”¨å½¢å¼ä¸º<code>(m. *p)() æˆ– (p_m-&gt; *p )()</code>ï¼Œå…¶ä¸­åˆ†åˆ«æ˜¯<code>m</code>ä¸ºå¯¹è±¡å®ä¾‹ï¼Œ<code>p_m</code>ä¸ºå¯¹è±¡æŒ‡é’ˆï¼Œ<code>p</code> æ˜¯ <code>ClassFunc</code> çš„ä¸€ä¸ªå®ä¾‹ï¼ˆå³å‡½æ•°æŒ‡é’ˆï¼‰ï¼ŒåŠ ä¸€ä¸ª * å¯ä»¥ç†è§£ä¸ºæŠŠæŒ‡é’ˆè½¬æ¢æˆäº†å‡½æ•°åï¼Œè¿™æ ·å°±å’Œæ­£å¸¸è°ƒç”¨æˆå‘˜å‡½æ•°çš„æƒ…å†µä¸€è‡´äº†ï¼ˆè¿™æ˜¯æˆ‘ä¸ªäººçš„ç†è§£å“ˆã€‚ã€‚ã€‚ï¼‰</p><p>æ›´è¯¦ç»†çš„æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span>&#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">func</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;func&quot;</span> &lt;&lt; endl;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">func2</span><span class="hljs-params">()</span> </span>&#123;<br>        cout &lt;&lt; <span class="hljs-string">&quot;func2&quot;</span> &lt;&lt; endl;<br>    &#125;<br>&#125;;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">func3</span><span class="hljs-params">()</span> </span>&#123;<br>    cout &lt;&lt; <span class="hljs-string">&quot;func3&quot;</span> &lt;&lt; endl;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">void</span> <span class="hljs-params">(MyClass:: *ClassFunc)</span><span class="hljs-params">()</span></span>;      <span class="hljs-comment">// å®šä¹‰MyClassç±»çš„ éé™æ€æˆå‘˜å‡½æ•°æŒ‡é’ˆ</span><br><span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">void</span> <span class="hljs-params">(* NormalFunc)</span><span class="hljs-params">()</span></span>;              <span class="hljs-comment">// å®šä¹‰æ™®é€šå‡½æ•°æŒ‡é’ˆ</span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>    MyClass m;<br>    MyClass* p_m = &amp;m;<br>    ClassFunc p = &amp;MyClass::func;<span class="hljs-comment">// è¿™é‡Œ &amp; ä¸èƒ½å°‘ï¼Œä¸æ¸…æ¥šä¸ºä»€ä¹ˆè¿™é‡Œæ²¡æœ‰éšå¼è½¬æ¢ï¼Œå¯èƒ½æ˜¯ç±»æˆå‘˜å‡½æ•°ç‰¹åˆ«ä¸€ç‚¹ï¼Ÿ</span><br><br>    (m.*p)();           <span class="hljs-comment">// æ­£å¸¸è°ƒç”¨</span><br>    (p_m-&gt;*p)();        <span class="hljs-comment">// æ­£å¸¸è°ƒç”¨</span><br><br>    <span class="hljs-comment">// NormalFunc a = MyClass::func;        // ç¼–è¯‘ä¸é€šè¿‡</span><br>    NormalFunc b = MyClass::func2;          <span class="hljs-comment">// ç¼–è¯‘é€šè¿‡ï¼Œç±»çš„é™æ€æˆå‘˜å‡½æ•°å¯ä»¥è¢«æ™®é€šå‡½æ•°æŒ‡é’ˆæ¥æ”¶</span><br>    NormalFunc c = func3;                   <span class="hljs-comment">// ç¼–è¯‘é€šè¿‡</span><br>    <span class="hljs-built_in">b</span>();<br>    <span class="hljs-built_in">c</span>();<br><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h1><p>[1] <a href="https://www.cnblogs.com/Esfog/archive/2012/04/23/2467249.html">C/C++çš„å‡½æ•°åå’Œå‡½æ•°æŒ‡é’ˆçš„å…³ç³»å‰–æ - Esfog - åšå®¢å›­</a></p><p>[2] <a href="https://www.jb51.net/article/54220.htm">æ•°ç»„åä¸æ•°ç»„æŒ‡é’ˆã€æŒ‡é’ˆæ•°ç»„</a></p><p>[3] <a href="https://juejin.cn/post/6923743288407097351">C++ æŒ‡é’ˆè¯¦è®²ã€åŠæŒ‡é’ˆä¸æ•°ç»„ - æ˜é‡‘</a></p><p>[4] <a href="https://www.bilibili.com/video/BV16T4y1w7wm?p=7">è§£å†³å…¨éƒ¨Cè¯­è¨€æŒ‡é’ˆçš„é—®é¢˜_å“”å“©å“”å“©</a></p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>C++</category>
      
    </categories>
    
    
    <tags>
      
      <tag>C++</tag>
      
      <tag>æŒ‡é’ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021å¹´ç»ˆæ€»ç»“</title>
    <link href="/2021/12/31/2021-12/2021-12-31%202021%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"/>
    <url>/2021/12/31/2021-12/2021-12-31%202021%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>ç°åœ¨æ˜¯2021å¹´12æœˆ31æ—¥19ç‚¹45åˆ†ï¼Œåå¤©çš„è¿™ä¸ªæ—¶å€™æˆ‘åº”è¯¥åœ¨è€ƒäº‘è®¡ç®—ï¼Œæ‰€ä»¥ä¿é™©èµ·è§ï¼Œæˆ‘è¿˜æ˜¯å…ˆå»å¤ä¹ å§ï¼Œå¹´ç»ˆæ€»ç»“å°±æ”¾åˆ°è€ƒå®Œè¯•å†è¡¥ä¸Š~</p><center><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2F5b0988e595225.cdn.sohucs.com%2Fimages%2F20190816%2Fc1bb1f88cc334de5bfdb433c1766f830.png&refer=http%3A%2F%2F5b0988e595225.cdn.sohucs.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1643543259&t=b6769fbb96552656e2b401a1e9d5feea" alt="" style="zoom:50%;" /></center><hr /><p>ä»Šå¤©æ˜¯2022å¹´1æœˆ2æ—¥ï¼Œç°åœ¨æˆ‘å·²ç»è€ƒå®Œäº†å²è¯—çº§éš¾åº¦çš„ç®—æ³•åˆ†æä¸è®¾è®¡ï¼Œä»¥åŠå·®ç‚¹æ²¡å†™å®Œçš„äº‘è®¡ç®—ã€‚ç­‰åˆ°æˆ‘å¿ƒæƒ…å¹³å¤ä¸‹æ¥ï¼Œä¹Ÿæ—¶å€™è¡¥äº¤è¿™ä»½å¹´ç»ˆæ€»ç»“äº†ã€‚</p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202201022151747.jpeg" alt="çœ‹å¼€äº†" style="zoom:40%;" /></center><h1 id="å®ä¹ "><a class="markdownIt-Anchor" href="#å®ä¹ "></a> å®ä¹ </h1><h2 id="å®ä¹ ç»å†ç®€ä»‹"><a class="markdownIt-Anchor" href="#å®ä¹ ç»å†ç®€ä»‹"></a> å®ä¹ ç»å†ç®€ä»‹</h2><p>ä»å»å¹´11æœˆå¼€å§‹ï¼Œæˆ‘å°±å»äº†å­—èŠ‚å®ä¹ ï¼Œè€Œæˆªè‡³ä»Šå¹´å¼€å­¦9æœˆä»½æ‰ç¦»èŒï¼Œå†é™¤å»ä¸­é—´è¯·å‡ä¸€ä¸ªå¤šæœˆå›å­¦æ ¡åšæ¯•è®¾ï¼Œç®—èµ·æ¥ä¹Ÿå¿«å®ä¹ äº†9ä¸ªæœˆï¼Œä¸ç¦ä»¤äººæ„Ÿå¹æ—¶é—´çœŸçš„è¿‡å¾—å¤ªå¿«äº†ï¼Œä¸‹é¢æˆ‘å°±ç®€å•ä»‹ç»ä¸€ä¸‹è‡ªå·±çš„å®ä¹ ç»å†å§ã€‚æˆ‘æ‰€åœ¨éƒ¨é—¨æ˜¯æŠ–éŸ³å›½é™…ç‰ˆï¼ˆä¹Ÿå°±æ˜¯Tiktokï¼‰çš„å¹¿å‘Šä¸­å°Global Ads Infraï¼Œè´Ÿè´£å¹¿å‘ŠæŠ•æ”¾çš„ç›¸å…³ä¸šåŠ¡ï¼Œä¹Ÿç®—æ˜¯æ¯”è¾ƒæ ¸å¿ƒçš„éƒ¨é—¨äº†ï¼Œæ¯•ç«Ÿå¹¿å‘Šè¥æ”¶æ˜¯æµé‡å˜ç°çš„é‡è¦é€”ç»ã€‚</p><p>åœ¨å®ä¹ æœŸé—´ï¼Œçš„ç¡®æ˜¯å­¦ä¹ åˆ°äº†ä¸å°‘å¹¿å‘Šçš„ç›¸å…³çŸ¥è¯†ï¼Œä»é›¶å¼€å§‹äº†è§£ç›¸å…³ä¸šåŠ¡ï¼Œè®°å¾—ä¸€å¼€å§‹ç¢°åˆ°çš„å¹¿å‘Šç›¸å…³çš„é™Œç”Ÿåè¯æœ‰æ»¡æ»¡ä¸€é¡µï¼Œå¯¹å…·ä½“çš„å¹¿å‘ŠæŠ•æ”¾æµç¨‹ä¹Ÿæ˜¯äº‘é‡Œé›¾é‡Œï¼Œä¸çŸ¥æ‰€è¸ªã€‚åˆ°åæ¥ï¼Œå¾…ä¹…äº†ï¼Œä¹Ÿæ¸æ¸ç†Ÿæ‚‰èµ·æ¥ï¼Œæ˜ç™½äº†å¤§è‡´æµç¨‹ï¼Œå¤§ä½“çš„æ¨¡å—æ¶æ„ï¼Œå½“ç„¶ä¹Ÿéå¸¸æµ…æ˜¾ï¼Œåªæ˜¯å¯¹å„ä¸ªåŠŸèƒ½æ¨¡å—äº†è§£ä¸ªå¤§æ¦‚ã€‚ä»ç¡¬çœ‹æºç ï¼Œåˆ°å¢åŠ åŠŸèƒ½ç‚¹ï¼Œè¿›è¡Œæµ‹è¯•ï¼Œå¼€ABæµ‹è¯•å®éªŒï¼Œå†åˆ°æäº¤è‡ªå·±çš„PRé€šè¿‡Reviewï¼Œæœ€ç»ˆä»£ç ä¸Šçº¿ï¼Œè¿™ä¸€è¿‡ç¨‹ä¸‹æ¥ä¹Ÿè®©æˆ‘äº›è®¸äº†è§£äº†å¤§å‚çš„é¡¹ç›®å¼€å‘æµç¨‹ã€‚</p><p>ç„¶åå†è°ˆè°ˆæˆ‘ä¸ªäººçš„å·¥ä½œå§ï¼Œä¸€å¼€å§‹æˆ‘æ˜¯ç»´æŠ¤ä¸€ä¸ªçº¿ä¸ŠæœåŠ¡çš„ç›‘æ§ç³»ç»Ÿï¼Œç®€å•æ¥è¯´å°±æ˜¯åœ¨çº¿ä¸ŠæœåŠ¡é‡Œå¢åŠ æ‰“ç‚¹é€»è¾‘ï¼Œç„¶åå†å¦ä¸€ä¸ªç¨‹åºé‡Œè¿›è¡Œæµå¤„ç†ï¼Œå®æ—¶è¾“å‡ºç›¸å…³ç›‘æ§æŒ‡æ ‡ï¼Œä¸è¿‡å› ä¸ºä»£ç ä½¿ç”¨scalaå†™çš„ï¼Œæˆ‘ä¹Ÿä¸æ˜¯å¾ˆç†Ÿï¼Œæ‰€ä»¥åªæ˜¯ç®€å•ä¿®æ”¹äº†ä¸€ä¸‹é€»è¾‘ï¼Œä¿®å¤Bugã€‚è€å®è¯´ï¼Œå› ä¸ºè¿™ä¸ªé¡¹ç›®æ˜¯2å¹´å‰çš„é¡¹ç›®äº†ï¼Œå¤§æ¦‚å¿«ä¸€å¹´æ²¡äººåœ¨ç»´æŠ¤äº†ï¼Œæ‰€ä»¥æ„Ÿè§‰é—®é¢˜è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œä½†æˆ‘ä¸ªäººåˆå› ä¸ºå®åŠ›ä¸è¶³ï¼Œæ— æ³•è¿›è¡Œé‡æ„ï¼Œå°±æ˜¯é‚£ç§çŸ¥é“æœ‰é—®é¢˜ï¼Œä½†åˆç»™ä¸å‡ºè§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥è¯´æ˜¯èœé¸¡è½æ³ªäº†ï¼Œæ‰€ä»¥æœ€åè¿™ä¸ªé¡¹ç›®ä¹Ÿå°±æ˜¯åšåˆ°äº†èƒ½è·‘çš„æ•ˆæœã€‚ä¸è¿‡è¿™ä¸ªç›‘æ§æœåŠ¡åæ¥ä¹Ÿæ²¡æœ‰è¢«æ€ä¹ˆé‡è§†ï¼Œæ²¡æœ‰ä»€ä¹ˆäººç”¨ï¼Œæ‰€ä»¥ä¹Ÿå°±è¿™æ ·äº†ï¼Œå› ä¸ºåæ¥æœ‰äº†æ›´é‡è¦çš„éœ€æ±‚è¦åšã€‚</p><p>ä¹‹åä¸»è¦è´Ÿè´£çš„å·¥ä½œæ˜¯æ­å»ºå®éªŒæŒ‡æ ‡ï¼Œä¸ºå¼€å‘åŒå­¦å®éªŒæµ‹è¯•æä¾›æŒ‡æ ‡å‚è€ƒï¼Œæµ‹è¯•æ–°å¢åŠŸèƒ½æ˜¯å¦å­˜åœ¨å¼‚å¸¸ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘å°±æ˜¯æ”¶é›†å„ä¸ªæœåŠ¡Ownerçš„éœ€æ±‚ï¼Œåœ¨å¯¹åº”æœåŠ¡çš„ä»£ç é‡Œå¢åŠ ç›¸å…³é€»è¾‘ï¼Œç„¶åæäº¤éœ€æ±‚ç»™å®éªŒæŒ‡æ ‡å¹³å°ï¼Œå†è®©ä»–ä»¬åšå®Œæˆå®éªŒå¹³å°ä¸Šçš„å¼€å‘å·¥ä½œã€‚è¿™ä¸ªå·¥ä½œçš„ä¸»è¦éš¾ç‚¹ï¼Œå°±åœ¨äºè¦å»çœ‹å„ä¸ªæœåŠ¡çš„ä»£ç ï¼Œå¾—ç¨å¾®æ‡‚ç‚¹å…¶ä¸­è¿è¡Œæµç¨‹å’Œé€»è¾‘ï¼Œç„¶åå†åˆé€‚çš„åœ°æ–¹åŠ ä¸Šæ•°æ®æ‰“ç‚¹ï¼Œå†™çš„ä»£ç å…¶å®ä¸å¤šï¼Œè¿˜æœ‰å°±æ˜¯å¤„ç†é€»è¾‘éœ€è¦å†™ä¸ªFlink SQLï¼Œç„¶åå†æŠŠéœ€æ±‚æ•´ç†ç»™æ–‡æ¡£æäº¤ç»™å®éªŒå¹³å°çš„åŒå­¦ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯æ”¶é›†éœ€æ±‚ï¼Œçœ‹ä»£ç äº†è§£é€»è¾‘ï¼Œä»¥åŠå’Œå…¶ä»–éƒ¨é—¨çš„åŒå­¦æ‰“äº¤é“ï¼Œå¯¹æ¥å·¥ä½œéœ€æ±‚ï¼Œè™½ç„¶é‡å¤æ€§å·¥ä½œæŒºå¤šï¼Œä½†ä¹Ÿæœ‰ä¸€å®šçš„æ”¶è·ã€‚</p><p>æœ€åçš„è¯ï¼Œæ˜¯å¯¹ä¸€ä¸ªçº¿ä¸ŠæœåŠ¡åšäº†å°ä¼˜åŒ–ï¼Œä¸»è¦åœ¨mentorçš„æŒ‡å¯¼ä¸‹ï¼Œä¼˜åŒ–äº†Goè¯­è¨€é‡ŒMapåºåˆ—åŒ–çš„é—®é¢˜ï¼Œç•¥å¾®é™ä½äº†åœ¨çº¿æœåŠ¡æœºå™¨çš„CPUå’Œå†…å­˜ä½¿ç”¨ç‡ã€‚è¿™ä¸ªå·¥ä½œå¯¹æˆ‘æ¥è¯´ï¼Œæ„Ÿè§‰å—ç›ŠåŒªæµ…ï¼Œå­¦ä¹ åˆ°äº†æ€ä¹ˆå»è¿›è¡Œæµ‹è¯•ï¼Œæ€§èƒ½ä¼˜åŒ–çœ‹å“ªäº›æŒ‡æ ‡ï¼Œæ€ä¹ˆçœ‹ï¼Œæœ€åå‡ºäº†ä¸€ä»½æ–¹æ¡ˆæŠ¥å‘Šï¼Œè™½ç„¶ä¹Ÿæ¯”è¾ƒç®€å•å§ï¼Œä½†ä¹Ÿå—åˆ°äº†å¤§å®¶çš„è‚¯å®šï¼Œå¯¹æˆ‘æ¥è¯´ï¼Œæ„Ÿè§‰è¿˜æ˜¯å¾ˆä¸é”™çš„ï¼Œå°±æ˜¯é‚£ç§ä½ åšçš„å·¥ä½œåˆ‡å®æœ‰æ•ˆï¼Œæ˜¯è‚‰çœ¼å¯è§çš„ï¼Œè€Œæ²¡æœ‰ç™½è´¹ï¼Œå°±æ„Ÿè§‰å®ç°äº†è‡ªå·±çš„ä¸€ç‚¹ä»·å€¼ã€‚</p><h2 id="å®ä¹ æ”¶è·ä¸æ„Ÿå—"><a class="markdownIt-Anchor" href="#å®ä¹ æ”¶è·ä¸æ„Ÿå—"></a> å®ä¹ æ”¶è·ä¸æ„Ÿå—</h2><p>æ€»çš„æ¥è¯´ï¼Œè¿™ä»½å®ä¹ ç»å†æˆ‘è®¤ä¸ºè¿˜æ˜¯éå¸¸å®è´µçš„ï¼Œæ— è®ºæ˜¯mentorè¿˜æ˜¯å…¶ä»–åŒäº‹ï¼Œéƒ½ååˆ†å‹å–„ï¼Œä¹Ÿéƒ½å¾ˆæœ‰èƒ½åŠ›ï¼Œç»™äº†æˆ‘ä¸å°‘å¸®åŠ©å’ŒæŒ‡å¯¼ã€‚ä¸è¿‡å®ä¹ æœŸé—´ï¼Œä»£ç å†™çš„ä¸å¤šï¼Œæ–‡æ¡£å€’æ˜¯å†™äº†ä¸å°‘â€¦â€¦æ‰€ä»¥æˆ‘æ„Ÿè§‰è‡ªå·±çš„ä»£ç èƒ½åŠ›æˆ–è®¸æ²¡æœ‰æå‡å¤šå°‘ï¼Œä½†æ˜¯çœ¼ç•Œå’Œè§†é‡æ˜¯æ‹“å±•å¼€é˜”äº†ï¼Œæ¥è§¦äº†è§£åˆ°é¡¹ç›®çš„å¼€å‘æµç¨‹ï¼Œå­¦ä¹ å¦‚ä½•ä¸äººåˆä½œæ²Ÿé€šäº¤æµï¼Œæ€ç»´æ–¹å¼ä¹Ÿå‘ç”Ÿäº†æ”¹å˜ï¼Œå¼€å§‹é‡è§†æ—¶é—´è§„åˆ’ï¼Œä¼°ç®—å·¥ä½œé‡ï¼Œå…³æ³¨å·¥ä½œäº§å‡ºã€‚è¿˜æœ‰ä¸€ä¸ªå¾ˆå¤§çš„æ”¶è·å°±æ˜¯å­¦ä¹ ä½¿ç”¨é£ä¹¦äº†ï¼Œåˆ°ç°åœ¨ï¼Œé£ä¹¦ä¹Ÿæˆäº†æˆ‘çš„ç¬”è®°ä¸»åŠ›ï¼Œæå‡äº†æˆ‘ä¸å°‘å­¦ä¹ æ•ˆç‡ã€‚</p><p>è¿˜æœ‰ç‰¹åˆ«æ·±çš„æ„Ÿè§¦å°±æ˜¯ï¼Œæ„Ÿè§‰è‡ªå·±çœŸçš„å¥½èœï¼Œå¾ˆå¤šåœ°æ–¹éƒ½ä¸ä¼šï¼Œä¸æ‡‚ï¼Œæ²¡å•¥çªå‡ºçš„èƒ½åŠ›ï¼Œè·Ÿæ­£å¼å‘˜å·¥çœŸçš„å·®è·å¾ˆå¤§ï¼Œè§‰å¾—è‡ªå·±åœ¨å­¦æ ¡é‡Œè™½ç„¶è€ƒè¯•èƒ½æ‹¿é«˜åˆ†ï¼Œä½†æ˜¯åˆ°äº†å®é™…å¼€å‘ä¸­ï¼Œè‡ªå·±çš„èƒ½åŠ›çœŸçš„æ˜¯è¿œè¿œä¸è¶³ï¼Œæ²¡æœ‰è¿‡ç¡¬çš„ä»£ç èƒ½åŠ›ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ¶æ„æ€ç»´ï¼Œå¯èƒ½ä¹Ÿå°±åŸºç¡€é©¬é©¬è™è™å§ã€‚ä¹Ÿæ­£æ˜¯å¦‚æ­¤ï¼Œè®©æˆ‘ä¸‹å®šå†³å¿ƒï¼Œå›åˆ°å­¦æ ¡åï¼Œä¸€å®šè¦å»æŠŠè¿™äº›æ¬ ç¼ºçš„èƒ½åŠ›éƒ½ç»™è¡¥èµ·æ¥ã€‚</p><h2 id="è‡ªæˆ‘åæ€ä¸æ€»ç»“"><a class="markdownIt-Anchor" href="#è‡ªæˆ‘åæ€ä¸æ€»ç»“"></a> è‡ªæˆ‘åæ€ä¸æ€»ç»“</h2><p>åœ¨å®ä¹ çš„å¤´ä¸¤ä¸ªæœˆè¿˜å¥½ï¼Œè¿˜ä¿æŒç€ä¸€ç§æ¯”è¾ƒé«˜æ˜‚çš„æ–—å¿—ï¼Œä½†æ˜¯ä¹‹åå¯èƒ½æ˜¯çƒ­æƒ…æ•£å»äº†ï¼Œå°±é™·å…¥äº†ä¸€ç§æ‡’æ•£çš„çŠ¶æ€ï¼Œæ¯å¤©ç›¸å½“äºæ˜¯æ‰“å¡ä¸Šç­å®ä¹ ï¼ŒæŒ‰éƒ¨å°±ç­å®Œæˆè‡ªå·±çš„å·¥ä½œä»»åŠ¡ï¼Œä¹Ÿæ²¡æœ‰æƒ³ç€å†å¤šå»å­¦ä¹ æ–°æŠ€æœ¯å•¥çš„ï¼Œå¯èƒ½å°±å¯¼è‡´æˆ‘æˆé•¿å¾—æ¯”è¾ƒæ…¢ï¼ˆè‡ªæˆ‘æ„Ÿè§‰ï¼‰ã€‚</p><p>åœ¨å®ä¹ æœŸé—´ï¼Œæˆ‘è¿˜æŸ“ä¸Šäº†ä¸€å¤§æ¶ä¹ ï¼Œé‚£å°±æ˜¯ç†¬å¤œç©æ‰‹æœºã€ç©ç”µè„‘ã€‚æ›¾ç»æˆ‘ä¹Ÿè®¤ä¸ºè¶…è¿‡12ç‚¹ä¸ç¡è§‰å°±æ˜¯ç½ªå¤§æ¶æï¼Œå¯¹èº«ä½“ä¼šé€ æˆæå¤§å±å®³ï¼Œä¼šç»™è‡ªå·±å¸¦æ¥æå¤§çš„è´Ÿç½ªæ„Ÿã€‚ä½†æ˜¯åœ¨å®ä¹ ç‹¬å±…æœŸé—´ï¼Œå„ç§ç†¬å¤œåˆ°2ã€3ç‚¹ï¼Œç”šè‡³å¥½å‡ æ¬¡ç†¬å¤œåˆ°6ç‚¹å¤šç¡ï¼Œ10ç‚¹èµ·ä¸Šç­ï¼Œè®°å¾—æƒ…å†µæœ€ä¸¥é‡çš„ä¸€æ¬¡ï¼Œå½“æ—¶æ•´ä¸ªäººè„‘è¢‹æ˜æ˜æ²‰æ²‰çš„ï¼Œåˆ°äº†å…¬å¸ä¸€ç‚¹çŠ¶æ€éƒ½æ²¡æœ‰ï¼Œå·¥ä½œæ•ˆç‡æå·®ã€‚è€Œç†¬å¤œå¸¦æ¥çš„è¿é”ååº”å°±æ˜¯ï¼Œç¡çœ ä¸è¶³ï¼Œæ™šèµ·ä¸åƒæ—©é¥­ï¼Œä¸æˆ‘ä¹‹å‰çš„ä½œæ¯å¤§ç›¸å¾„åº­ï¼Œä¹Ÿé€ æˆäº†æˆ‘å®ä¹ æœŸé—´çŠ¶æ€ä¸ä½³ï¼Œéƒ½æ²¡å……æ²›çš„ç²¾ç¥ï¼Œè¿˜è°ˆä½•å­¦ä¹ å’Œå·¥ä½œå‘¢ï¼Ÿå†åŠ ä¸Šæ¯é€¢å‘¨æœ«å¿…ç‚¹å¤–å–ï¼Œä¸å¤ªæ³¨æ„é¥®é£Ÿï¼Œå¯¼è‡´é‚£æ®µæœŸé—´èº«ä½“çŠ¶å†µä¸å®¹ä¹è§‚ï¼Œæ˜æ˜¾å¯ä»¥æ„Ÿè§‰åˆ°ä¸å¦‚ä»å‰ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œè¯¥åæ€çš„æœ‰ä¸¤ç‚¹ï¼Œä¸€ä¸ªæ˜¯å¿ƒæ€ä¸Šï¼Œå®ä¹ æœŸé—´è¿˜æ˜¯ç¼ºä¹ä¸€ç§ç§¯æå­¦ä¹ çš„æ€åº¦ï¼Œæˆ–è€…è¯´å½“æ—¶ä¹Ÿæ²¡æœ‰æ˜ç¡®çš„ç›®æ ‡ï¼Œä¸çŸ¥é“è¦å­¦ä»€ä¹ˆï¼Œå¯ä»¥å­¦ä»€ä¹ˆï¼Œæ¯å¤©å°±åªæ˜¯å®Œæˆå·¥ä½œä»»åŠ¡ï¼Œæ²¡æœ‰èŠ±æ›´å¤šçš„æ—¶é—´æ¥æ‹“å±•å­¦ä¹ ï¼Œçš„ç¡®è¯¥å¥½å¥½åæ€åæ€ã€‚å¦ä¸€ä¸ªå°±æ˜¯èº«ä½“ä¸Šï¼Œå¦‚æœè¿è‡ªå·±çš„èº«ä½“ç…§é¡¾ä¸å¥½ï¼Œé‚£è¿˜è°ˆä»€ä¹ˆå…¶ä»–çš„å‘¢ï¼Ÿèº«ä½“æ˜¯é©å‘½çš„æœ¬é’±ï¼ŒåŒæ—¶è‰¯å¥½çš„å¥åº·çŠ¶æ€ä¹Ÿæ‰èƒ½æ›´å¥½åœ°æ”¯æ’‘å·¥ä½œå­¦ä¹ ï¼Œæé«˜æ•ˆç‡ï¼Œä»¥åçœŸçš„æ˜¯éœ€è¦ä¿æŒå¥åº·çš„ç”Ÿæ´»ä½œæ¯ï¼Œå¤šè¿åŠ¨ï¼Œå¤šå¥èº«ã€‚</p><h1 id="ç ”ç©¶ç”Ÿ"><a class="markdownIt-Anchor" href="#ç ”ç©¶ç”Ÿ"></a> ç ”ç©¶ç”Ÿ</h1><p>ä»Šå¹´ä¸‹åŠå¹´ï¼Œæˆ‘æˆä¸ºäº†åŒ—äº¬å¤§å­¦è½¯ä»¶ä¸å¾®ç”µå­å­¦é™¢çš„ç ”ç©¶ç”Ÿã€‚è€å®è¯´ï¼Œæ²¡æœ‰å¤ªå¤šå®æ„Ÿï¼Œå°±åƒæ˜¯è¢«ä¸€è‚¡æ½®æµæ¨è‡³æ­¤åœ°ã€‚ç®€å•è°ˆè°ˆåœ¨è½¯å¾®çš„å­¦ä¹ ç”Ÿæ´»å§ï¼Œè½¯å¾®åœ°æ–¹å¾ˆå°ï¼Œæˆ‘ä½çš„5å·æ¥¼ç¦»é£Ÿå ‚å’Œå®¿èˆéƒ½å¾ˆè¿‘ï¼Œä¸‹ä¸ªæ¥¼æ‹ä¸ªå¼¯å°±åˆ°äº†ï¼Œå¾ˆæ–¹ä¾¿ã€‚è½¯å¾®çš„é£Ÿå ‚æ¯”è¾ƒå°ï¼Œèœå¼ä¹Ÿæ¯”è¾ƒå›ºå®šï¼Œå‡ ä¸ªæœˆä¸‹æ¥ï¼Œæˆ‘çš„æ—©é¥­åŸºæœ¬ä¸Šå°±æ˜¯è‚‰é¥¼ã€ç´ é¥¼ã€åœŸè±†é¥¼ã€é…±é¦™é¥¼ã€åŸ¹æ ¹ç…é¸¡è›‹ã€è±†æµ†è¿™äº”æ ·é‡Œæ’åˆ—ç»„åˆï¼Œä¸è¿‡æˆ‘å¯¹åƒé¥­ä¹Ÿæ²¡è¿‡é«˜çš„è¦æ±‚ï¼Œæ‰€ä»¥ä¹Ÿéƒ½è¿˜èƒ½æ¥å—å§ã€‚</p><p>è½¯å¾®çš„è¯¾ç¨‹ï¼Œæ„Ÿè§‰æ€»ä½“ä¸Šå’Œ æœ¬ç§‘å·®åˆ«ä¸å¤§å§ï¼Œæ¯”è¾ƒå¤§çš„åŒºåˆ«å¯èƒ½å°±æ˜¯ï¼Œæˆäº†ç ”ç©¶ç”Ÿä¹‹åï¼Œè‡ªå­¦çš„æ—¶é—´å äº†å¤§é‡çš„è¯¾åæ—¶é—´ï¼Œé™¤äº†ä¸€äº›æ ¸å¿ƒè¯¾éœ€è¦è€ƒè¯•è€ƒæ ¸ï¼Œå…¶ä»–å¤šæ•°è¯¾ç¨‹æ˜¯ç±»ä¼¼äºå¤§ä½œä¸šçš„å½¢å¼è¿›è¡Œè€ƒæŸ¥ã€‚åœ¨è½¯å¾®ï¼Œä½ ä¼šé‡åˆ°å¤§ä½¬ï¼Œé‡åˆ°<s>å·ç‹</s>ï¼ˆåºŸå¯å¿˜é£Ÿçš„äººï¼‰ï¼Œé‡åˆ°åƒæˆ‘è¿™æ ·çš„ä½›ç³»çš„äººï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯å„å…·ç‰¹è‰²äº†ã€‚æˆ–è®¸æ˜¯ä¹‹å‰æœ‰è¿‡å®ä¹ ç»å†å§ï¼Œå’Œè®¸å¤šèƒ½äººã€ä¸“å®¶å…±äº‹è¿‡ï¼Œæ‰€ä»¥è™½ç„¶ä¹ŸçŸ¥é“è‡ªå·±å’Œåˆ«äººçš„å·®è·å¾ˆå¤§ï¼Œå€’ä¹Ÿæ²¡æœ‰å¤ªå¤§çš„å¿ƒç†å‹åŠ›äº†ï¼Œä¸€æ­¥ä¸€æ­¥è„šå°å˜›ï¼Œæ…¢æ…¢æ¥å§ï¼ŒæŠ—å‹è¿™ä¸€å—æˆ‘ä¸€ç›´å¯ä»¥çš„ï¼ˆå“ˆå“ˆï¼Œèººå¹³å°±ç›´è¯´~ï¼‰ã€‚</p><p>æ­¤å¤–ï¼Œæˆ‘åˆé‡è§†å…¶è‡ªå·±çš„å¥åº·äº†ã€‚å¼€å­¦ä»¥æ¥ï¼Œæˆ‘å°±åœ¨ç§¯æé”»ç‚¼äº†ï¼Œåœ¨å®¿èˆé‡ŒåšKeepï¼Œå®¤å¤–è·‘æ­¥ï¼Œå…¥å†¬ä¹‹åå°±åªå‰©ä¸‹å®¤å†…è¿åŠ¨äº†ã€‚ä½†ä¸å¹¸çš„æ—¶å€™ï¼Œ12æœˆåˆè…°éƒ¨å‡ºäº†ç‚¹é—®é¢˜ï¼Œä¹…åä¹‹åæ„Ÿåˆ°ç–¼ï¼Œå¯èƒ½æ˜¯è…°è‚ŒåŠ³æŸäº†ï¼Œåæ¥å»çœ‹äº†åŒ»ç”Ÿï¼Œå¼€äº†è¯è†å’Œè¯ä¸¸ï¼Œå‘Šè¯«æˆ‘ä¹‹åä¸èƒ½ä¹…åï¼Œæ¯åä¸€å°æ—¶ï¼Œå°±éœ€è¦èµ·æ¥æ´»åŠ¨ä¸€ä¼šå„¿ã€‚ä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæˆ‘çš„å¥èº«è®¡åˆ’ä¹Ÿä¸å¾—å·²æç½®äº†ï¼Œä¸è¿‡ä¹Ÿç®—æ˜¯ç»™æˆ‘æ•²å“äº†è­¦é’Ÿï¼Œæˆ‘çš„èº«ä½“çœŸçš„æ²¡æœ‰æˆ‘æƒ³è±¡ä¸­é‚£ä¹ˆä¹è§‚äº†ï¼Œå„ä½æœ‹å‹ï¼Œä¹Ÿè¦å¤šå¤šä¿é‡è‡ªå·±çš„èº«ä½“å•Šã€‚</p><h1 id="ç”Ÿæ´»"><a class="markdownIt-Anchor" href="#ç”Ÿæ´»"></a> ç”Ÿæ´»</h1><p>å†æ¥è°ˆè°ˆè¿™ä¸€å¹´æ¥çš„ç”Ÿæ´»å§ï¼Œå¹´åˆå› ä¸ºç–«æƒ…åŸå› æ²¡æœ‰é€‰æ‹©å›å®¶è¿‡å¹´ï¼Œäººç”Ÿç¬¬ä¸€æ¬¡åœ¨å¤–åœ°å’Œé©°å“¥ä¸€èµ·åœ¨è¿‡æ˜¥èŠ‚ï¼Œè®°å¾—åˆä¸€è¿˜æ˜¯åˆäºŒï¼Œåƒçš„è¿˜æ˜¯æ³¡é¢å“ˆå“ˆã€‚å¹´ååˆæ˜¯è¿‘3ä¸ªæœˆçš„å®ä¹ ï¼Œç„¶åå°±è¯·å‡ä¸€ä¸ªå¤šæœˆï¼Œå›å­¦æ ¡åšæ¯•è®¾å»äº†ã€‚åœ¨æœ€åçŸ­æš‚çš„æ—¥å­é‡Œï¼Œå’Œå¤§å­¦åŒå­¦ä»¬ç›¸æ‹¥è¿™æœ€åçš„æ—¶å…‰ï¼Œæ¯•ç«Ÿæ¯•ä¸šä¹‹åï¼Œå†æ¬¡ç›¸è§ä¸çŸ¥ä½•å¹´ä½•æœˆäº†ï¼Œä½†ç›¸ä¿¡æ€»ä¼šæœ‰é‡é€¢çš„ä¸€å¤©ï¼Œå°±è®©æˆ‘ä»¬åœ¨é‚£ä¸€å¤©åˆ°æ¥ä¹‹å‰ï¼Œå„è‡ªåŠªåŠ›æˆä¸ºæ›´å¥½çš„è‡ªå·±å§~</p><p>æ¯•ä¸šä¹‹åï¼Œåœ¨å®¶å‘†äº†ä¸€æ˜ŸæœŸä¹‹ååˆå›å…¬å¸å®ä¹ å»äº†ã€‚å†æ­¤åï¼Œå°±æ˜¯9æœˆä»½ç ”ç©¶ç”Ÿå¼€å­¦ï¼Œæ­£å¼æ‹‰å¼€äº†æˆ‘ç ”ç©¶ç”Ÿç”Ÿæ´»çš„åºå¹•ã€‚è¿˜è®°å¾—å½“æ—¶ä¸Šå­¦å‰ï¼Œç«‹ä¸‹ä¸€ä¸ªflagï¼Œ10æœˆå‰å¿…è„±å•ï¼Œæˆ–è®¸æ˜¯çœ‹åˆ°å‘¨å›´èº«è¾¹çš„äººéƒ½è„±å•è€Œæ„Ÿåˆ°ç„¦è™‘äº†ï¼Œæˆ–è®¸æ˜¯æ„Ÿåˆ°å¯‚å¯äº†ï¼Œæˆ–è®¸æ˜¯è®¤ä¸ºå†ä¸è°ˆä¸€åœºæ ¡å›­æ‹çˆ±ä»¥åå†ä¹Ÿæ²¡æœ‰æœºä¼šã€‚ä½†ç»“æœæ¥è¯´ï¼Œæˆ‘å¤±è´¥äº†ã€‚ç„¶åï¼Œç„¶åå°±æ²¡æœ‰åæ–‡äº†ã€‚æˆ–è®¸çœŸçš„æ˜¯å•èº«å¤ªä¹…äº†ï¼Œä¸çŸ¥é“å¿ƒåŠ¨åˆ°åº•æ˜¯æ€æ ·ä¸€ç§æ„Ÿè§‰ï¼Œä¸çŸ¥é“å–œæ¬¢ä¸€ä¸ªäººä½ è¯¥å»æ€ä¹ˆè¡ŒåŠ¨ï¼Œä¸çŸ¥é“æ€ä¹ˆå»çˆ±ä¸€ä¸ªäººã€‚æƒ³æƒ³è‡ªèº«çš„åŸå› ï¼Œé•¿ç›¸ä¸€èˆ¬ï¼Œèº«é«˜ä¸€èˆ¬ï¼Œä¸å¤ªä¼šè£…æ‰®ï¼Œç”Ÿæ´»å¸¸è¯†ä¹Ÿæœ‰æ¬ ç¼ºï¼ŒåŒæ—¶è¿˜æ˜¯ä¸ªçœ‹åŠ¨æ¼«çš„å®…ç”·ï¼Œè¿˜å¸¦æœ‰ç•¥å¾®çš„ä¸­äºŒï¼Œè¿˜å–œæ¬¢æ‰“æ¸¸æˆï¼Œé™¤äº†ç¨å¾®ï¼Œä¸€ä¸¢ä¸¢å¯¹å­¦ä¹ ä¸Šç‚¹å¿ƒå¤–ï¼Œä¼¼ä¹æ²¡æœ‰åˆ«çš„ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ï¼Œè¿™æ ·çš„äººè®¾çš„ç¡®å¸å¼•ä¸äº†åˆ«äººå•Šã€‚ä¸è¿‡åæ¥æˆ‘ä¹Ÿçœ‹å¼€äº†ï¼Œå†é‡åˆ°å¥¹ä¹‹å‰ï¼Œæˆ‘è¿˜æ˜¯ç»§ç»­åŠªåŠ›ï¼Œå¤šå¤šæå‡è‡ªå·±å§ï¼Œæˆä¸ºæ›´ä¼˜ç§€çš„äººã€‚</p><p>æ¥ç€è°ˆè°ˆæ¸¸æˆå§ï¼Œè¿™ä¸€å¹´ä¸»è¦ç©çš„è¿˜æ˜¯è‹±é›„è”ç›Ÿï¼Œæ¯å‘¨å…­æ™šæ›´æ˜¯æˆäº†å¼€é»‘æ—¶æ®µï¼Œä¹Ÿå°±ç©ç©å¤§ä¹±æ–—äº†ï¼Œä¸å…¶è¯´æ˜¯ç©æ¸¸æˆï¼Œæˆ–è®¸æ›´å¤šçš„æ˜¯äº«å—å’Œæœ‹å‹å¹æ°´æ—¶åˆ»å§ã€‚æ­¤å¤–è¿˜ç”¨æ¨¡æ‹Ÿå™¨ç©äº†å¥³ç¥å¼‚é—»å½•p5ä»¥åŠå…«æ–¹æ—…äººï¼Œæ„Ÿè§‰éƒ½æ˜¯ä¸é”™çš„æ¸¸æˆã€‚ä»¥åçš„è¯ï¼Œæ‰“ç®—æ˜¯ç­‰æœ‰é’±äº†ï¼Œæ•´ä¸Šå°å¼æœºï¼Œpsä¸»æœºï¼ŒSwitchï¼Œå¤§å±æ˜¾ç¤ºå™¨ï¼Œä¸è¿‡å¯èƒ½åˆ°äº†é‚£ä¸ªæ—¶å€™å¯èƒ½åè€Œæ²¡æœ‰ç©æ¸¸æˆçš„å¿ƒæ€äº†ï¼Œæƒ³ç©çš„æ—¶å€™ç©ä¸äº†ï¼Œèƒ½ç©çš„æ—¶å€™ä¸æƒ³ç©äº†æˆ–è€…è¿˜æ˜¯ç©ä¸äº†ï¼Œè¿™ä¹ˆæƒ³æ¥ï¼Œè¿˜æ˜¯æœ‰äº›è®¸çš„æ‚²ä¼¤å‘¢ã€‚</p><p>è¿˜èƒ½è¯´ç‚¹ä»€ä¹ˆå‘¢ï¼Œå“¦ï¼Œå¯¹äº†ï¼Œé‚£å°±æ˜¯æˆ‘æ„Ÿè§‰è‡ªå·±è¿˜æ˜¯æ²¡æœ‰é•¿å¤§ï¼Œæˆ–è€…è¯´ä¸å¤Ÿæˆç†Ÿï¼Œå¯¹äºäººæƒ…ä¸–æ•…ä¸å¤ªæ“…é•¿ï¼Œä¸æ“…äº¤é™…ï¼Œå¯¹ç”Ÿæ´»çš„ä¸€äº›å¸¸è¯†æˆ–è€…è¯´æ˜¯ç»†èŠ‚è¿˜ä¸äº†è§£ï¼Œæ„Ÿè§‰è‡ªå·±çš„å¿ƒæ€è¿˜æ˜¯å­©å­ä¸€æ ·ï¼Œä¸æ„¿å»æ€è€ƒæ›´å¤šçš„ä¸œè¥¿ï¼Œæˆ–è€…è¯´ä¸æƒ³å»æ‰¿æ‹…æŸäº›è´£ä»»ï¼Œåªæ˜¯ä»»ç”±ç”Ÿæ´»æ¨ç€è‡ªå·±å¾€å‰èµ°ï¼Œè€Œä¸æ˜¯è‡ªå·±æŒ‘èµ·æ‹…å­å¾€å‰è·‘ï¼Œå½“ç„¶ä¹Ÿæœ‰åšåŠªåŠ›åœ¨æ”¹å˜ï¼Œä½†ä¼¼ä¹è¿œè¿œä¸å¤Ÿã€‚å°±åƒæ˜¯å‘¨å›´çš„æœ‹å‹éƒ½æœ‰äº†å¤§äººæ¨¡æ ·ï¼Œè€Œæˆ‘è¿˜æ˜¯é‚£ä¸ªæ²‰æµ¸åœ¨è‡ªå·±ä¸–ç•Œé‡Œçš„å°‘å¹´ã€‚æˆ‘å¸Œæœ›è‡ªå·±èƒ½é•¿å¤§ï¼Œä½†ä¹Ÿç•æƒ§ç€é•¿å¤§ã€‚æˆ‘å¾ˆç„¦è™‘ï¼Œä½†åˆå¾ˆä½›ç³»ï¼Œå°±åƒæ˜¯è–›å®šè°”çš„çŒ«ä¸€èˆ¬ï¼Œå¤„åœ¨ä¸€ä¸ªå åŠ æ€ã€‚</p><p>å†è°ˆè°ˆä¸€äº›ä¸ªäººçš„ä½“ä¼šæ„Ÿæ‚Ÿå§ï¼š</p><ol><li>èº«ä½“å¥åº·æ˜¯ç¬¬ä¸€ä½ã€‚</li><li>å¤šå…³çˆ±è‡ªå·±çš„çˆ¶æ¯ã€‚</li><li>å¤šçè§†è‡ªå·±çš„æœ‹å‹ã€‚</li><li>å­¦ä¼šæ¢ä½æ€è€ƒã€‚</li><li>ä¸€æ—¥ä¸‰çœå¾èº«ã€‚</li><li>å­¦æ— æ­¢å¢ƒï¼Œç»ˆèº«å­¦ä¹ ã€‚</li></ol><h1 id="ç›®æ ‡"><a class="markdownIt-Anchor" href="#ç›®æ ‡"></a> ç›®æ ‡</h1><p>æœ€åè‡ªç„¶æ˜¯è®¾å®šæ¥å¹´çš„ç›®æ ‡å•¦ï¼Œè¿™é‡Œç®€ç•¥åœ°åˆ—å‡ºäº†ä¸€äº›ç›®æ ‡ï¼š</p><ol><li>æ­å»ºå¥½è‡ªå·±çš„åšå®¢ç½‘ç«™ï¼›</li><li>æŒç»­å†™åšå®¢ï¼Œå°½é‡ä¿æŒæ¯å‘¨ä¸€ç¯‡ï¼Œç›®æ ‡å…¨å¹´50ç¯‡ä»¥ä¸Šï¼›</li><li>å†™ç•ªå‰§å›é¡¾ï¼Œå›é¡¾è‡ªå·±çš„çœ‹ç•ªå†å²ï¼Œä¹Ÿç®—æ˜¯ç»™è‡ªå·±çƒ­çˆ±è¿™ä¹ˆä¹…çš„äºŒæ¬¡å…ƒä¸€ä¸ªæ€»ç»“äº¤ä»£å§ã€‚å¯ä»¥çš„è¯å†å‰ªè¾‘ä¸€äº›ç‰‡æ®µï¼Œæœ€ååšä¸€ä¸ªAMVæˆ–è€…MADå‡ºæ¥ï¼›</li><li>C++ å¼€å‘å­¦ä¹ ï¼ŒåŒ…æ‹¬è¯­æ³•å’Œé¡¹ç›®ï¼ˆæ¯”å¦‚å†™ä¸€ä¸ªç½‘ç«™ï¼ŒæœåŠ¡å™¨ï¼‰ï¼›stackflowä¸Šè§£å†³C++ é—®é¢˜ï¼Œæ£€éªŒè‡ªå·±çš„çŸ¥è¯†æˆæœï¼Œç›®æ ‡Reputation è¿‡500ï¼›</li><li>ç®—æ³•å¼ºåŒ–ï¼Œåˆ·é¢˜ï¼Œç›®æ ‡Leecode 300é¢˜ï¼›</li><li>ä¹¦ç±é˜…è¯»</li></ol><ul><li>è®¡ç®—æœºç›¸å…³ä¹¦ç± 10æœ¬ï¼›;</li><li>æ–‡å­¦ç±»å°è¯´ç­‰ 5æœ¬ï¼›</li><li>å…¶ä»–æ‚é¡¹ï¼ˆé‡‘èç†è´¢ã€ä¼ è®°ã€ä¸ºäººå¤„ä¸–ç­‰ï¼‰3~5æœ¬ï¼›</li></ul><ol start="7"><li>å¥èº«ï¼Œç›®æ ‡æ‹¥æœ‰è…¹è‚Œï¼›å¢å¼ºä¸Šè‚¢åŠ›é‡ï¼Œå¢å¼ºèƒŒéƒ¨ã€æ ¸å¿ƒåŠ›é‡ï¼Œç›®æ ‡å¼•ä½“å‘ä¸Šåš10ä¸ªä»¥ä¸Šï¼›</li><li>å‚åŠ ä¸€æ¬¡å¤§å‹æ¯”èµ›å¹¶è·å¥–ï¼Œæ»¡è¶³æ¯•ä¸šèµ„æ ¼ï¼›</li><li>æ—¥è¯­ç»§ç»­å­¦ä¹ ï¼Œå¯ä»¥åšåˆ°åŸºæœ¬çš„å¬å’Œè¯´ã€‚</li></ol><h1 id="ç»“è¯­"><a class="markdownIt-Anchor" href="#ç»“è¯­"></a> ç»“è¯­</h1><p>å†™å†™åœåœï¼Œç¼ç¼è¡¥è¡¥ï¼Œæœ€åæ˜¯åœ¨2022å¹´1æœˆ7æ—¥å›å®¶çš„é«˜é“ä¸Šï¼Œå®Œæˆäº†è¿™ç¯‡å¹´åº¦æ€»ç»“ï¼Œçªç„¶æ„Ÿè§‰è‡ªå·±åˆè¡Œäº†å‘¢ï¼Œå“ˆå“ˆã€‚å¸Œæœ›åœ¨æ–°çš„ä¸€å¹´äº†ï¼Œè‡ªå·±èƒ½æœ‰æ›´å¤§çš„æˆé•¿å§ï¼Œä¹Ÿè¡·åœ°ç¥æ„¿å„ä½æˆä¸ºæ›´å¥½çš„è‡ªå·±~</p>]]></content>
    
    
    <categories>
      
      <category>ç”Ÿæ´»</category>
      
      <category>å¹´åº¦æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ‚è°ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æˆ‘çš„æœ€ä½³æ—¥å¿—å®è·µ</title>
    <link href="/2021/12/25/2021-12/2021-12-25%20%E6%88%91%E7%9A%84%E6%9C%80%E4%BD%B3%E6%97%A5%E5%BF%97%E5%AE%9E%E8%B7%B5/"/>
    <url>/2021/12/25/2021-12/2021-12-25%20%E6%88%91%E7%9A%84%E6%9C%80%E4%BD%B3%E6%97%A5%E5%BF%97%E5%AE%9E%E8%B7%B5/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><blockquote><p>æœ¬æ–‡è¯‘è‡ªï¼š<a href="https://tuhrig.de/my-logging-best-practices/">https://tuhrig.de/my-logging-best-practices/</a></p></blockquote><p>å¦‚æœä½ æ˜¯ä¸€ååç«¯å¼€å‘è€…ï¼Œé‚£ä¹ˆæ—¥å¿—å°±ç›¸å½“äºä½ çš„åº”ç”¨çš„çª—å£ã€‚ä¸åƒå‰ç«¯ï¼Œé™¤äº†æ—¥å¿—æ¶ˆæ¯å¤–æ²¡æœ‰å¤ªå¤šåˆ«çš„ä¸œè¥¿ã€‚æ¥ä¸‹æ¥å°†ä»‹ç»ä¸€äº›æˆ‘ä¸ªäººå†™æ—¥å¿—æ—¶çš„æŒ‡å¯¼æ€æƒ³ã€‚</p><h1 id="log-after-not-before"><a class="markdownIt-Anchor" href="#log-after-not-before"></a> Log After, not before</h1><p>å›æƒ³ä»¥ä¸‹ä»¥å‰ï¼Œæ¯è‰˜èˆ¹éƒ½ä¼šæœ‰ä¸€æœ¬èˆªæµ·æ—¥å¿—ï¼Œå°±åƒæ—¥è®°ä¸€æ ·ï¼Œè®°å½•ç€æ¯å¤©å‘ç”Ÿçš„é‡è¦äº‹æƒ…ã€‚å°±åƒä¸€æœ¬ä¼ ç»Ÿçš„èˆªæµ·æ—¥å¿—ï¼Œæˆ‘ä»¬åº”è¯¥è®°å½•å·²ç»å‘ç”Ÿçš„äº‹æƒ…ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬å°†è¦åšçš„äº‹æƒ…ã€‚</p><p>ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// don&#x27;t do that</span><br>log.<span class="hljs-built_in">info</span>(<span class="hljs-string">&quot;Making request to REST API&quot;</span>)<br>restClient.<span class="hljs-built_in">makeRequest</span>()<br> <br><span class="hljs-comment">// do that</span><br>restClient.<span class="hljs-built_in">makeRequest</span>()<br>log.<span class="hljs-built_in">info</span>(<span class="hljs-string">&quot;Made request to REST API&quot;</span>)<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ª log å£°æ˜å¹¶æ²¡æœ‰ç»™å‡ºå¤ªå¤šä¿¡æ¯ã€‚å½“è¯»åˆ°å®ƒçš„æ—¶å€™ï¼Œä½ å¹¶ä¸çŸ¥é“RESTè°ƒç”¨æ˜¯å¦æˆåŠŸã€‚è€Œä¸ºäº†çŸ¥é“æ˜¯å¦è°ƒç”¨æˆåŠŸï¼Œä½ å¿…é¡»å¯»æ‰¾æ˜¯å¦å­˜åœ¨å¼‚å¸¸ã€‚å½“ä½ è¯»åˆ°è¿™æ¡logï¼Œä½†æ˜¯å´æ²¡æœ‰æ‰¾åˆ°ç›¸åº”çš„ exception å¼‚å¸¸ï¼Œä½ å°†ä¼šå›°æƒ‘ä¸€æ•´å¤©ã€‚</p><blockquote><p>è¿™é‡Œæ„Ÿè§‰æ²¡å¤ªç¿»è¯‘æ˜ç™½ï¼Œå¯ä»¥å¯¹ç…§åŸæ–‡çœ‹ï¼šThe first log statement doesnâ€™t tell much. When reading it, you will not know if the REST call was successful or not. To do so you must look for the absence of an exception. And if you read this log but miss the subsequent exception you will be confused for the rest of the day (trust me).</p></blockquote><p>ç¬¬äºŒä¸ª log æ–¹å¼åˆ™å¥½äº†è®¸å¤šã€‚å®ƒæ¸…æ¥šåœ°è¡¨æ˜äº†åˆšåˆšçš„æ“ä½œæˆåŠŸäº†ã€‚å¦‚æœRESTè°ƒç”¨å¤±è´¥äº†ï¼Œä½ å°†çœ‹ä¸åˆ°è¿™æ¡ logï¼Œè€Œæ˜¯ä¼šæœ‰ä¸€ä¸ª exceptionã€‚</p><p>æˆ‘å°†å¯¹æ‰€æœ‰ <strong>INFO</strong> æ—¥å¿—éµå®ˆè¿™æ¡è§„åˆ™ï¼Œç„¶åå¯¹äº <strong>DEBUG</strong> æ¥è¯´ä¼šç”Ÿæˆ exceptionsã€‚</p><h1 id="separate-parameters-and-messages"><a class="markdownIt-Anchor" href="#separate-parameters-and-messages"></a> Separate parameters and messages</h1><p>ä¸€ä¸ªå…¸å‹çš„ log å°å¿ƒåŒ…å«ä¸¤ç§ç±»å‹çš„æ•°æ®ï¼Œä¸€ç§æ˜¯æ‰‹å†™çš„æ¶ˆæ¯ï¼Œæ¥å£°æ˜æ¥ä¸‹æ¥çš„æ¶ˆæ¯å†…å®¹ã€‚å¦ä¸€ç§ç±»å‹æ•°æ®åˆ™æ˜¯ä¸€ç³»åˆ—åŒ…å«åœ¨ä¹‹å‰æ“ä½œä¸­çš„å‚æ•°ã€‚ä½ åº”è¯¥åŒºåˆ†è¿™ä¸¤éƒ¨åˆ†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// don&#x27;t do that</span><br>restClient.<span class="hljs-built_in">makeRequest</span>()<br>log.<span class="hljs-built_in">info</span>(<span class="hljs-string">&quot;Made request to &#123;&#125; on REST API.&quot;</span>, url)<br> <br><span class="hljs-comment">// do that</span><br>restClient.<span class="hljs-built_in">makeRequest</span>()<br>log.<span class="hljs-built_in">info</span>(<span class="hljs-string">&quot;Made request to REST API. [url=&#123;&#125;]&quot;</span>, url)<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ç§ log æ¶ˆæ¯æœ‰ä¸€äº›ç¼ºç‚¹ã€‚å®ƒæ˜¯éš¾ä»¥è§£æçš„ï¼Œæ¯”å¦‚ä»–å¯¹äº Grok pattern</p><p>æ¥è¯´ã€‚æ‰€ä»¥åœ¨æˆ‘ä»¬çš„æ—¥å¿—å·¥å…·ä¸­ï¼Œè‡ªåŠ¨æŠ½å– IDs æˆ–è€…å…¶ä»–å‚æ•°å°±ä¼šå˜å¾—æ›´å›°éš¾ã€‚å¹¶ä¸”å®ƒä¹Ÿæ˜¯éš¾ä»¥é˜…è¯»çš„ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªéå¸¸é•¿çš„ URL åœ¨æœ«ç«¯å¸¦æœ‰ä¸€ç³»åˆ—å‚æ•°ã€‚è¯¥æ¡ log æ¶ˆæ¯çš„ä¸€åŠå°±è¶…è¿‡äº†ä½ çš„å±å¹•ã€‚åŒæ—¶ï¼Œè¿™ä¸ª log ä¹Ÿæ˜¯éš¾ä»¥æ‰©å±•çš„ã€‚å¦‚æœä½ æƒ³æ·»åŠ å¦ä¸€ä¸ªå‚æ•°ï¼ˆæ¯”å¦‚ä½¿ç”¨çš„ HTTP æ–¹æ³•ï¼‰ä½ å°±å¿…é¡»é‡å†™æ•´ä¸ªå¥å­ã€‚</p><p>ç¬¬äºŒä¸ªç‰ˆæœ¬å°±æ²¡æœ‰ä»¥ä¸Šçš„ç¼ºç‚¹ã€‚å®ƒæ˜¯éå¸¸å®¹æ˜“è§£æçš„ï¼Œå› ä¸ºå®ƒæœ‰æ¸…æ™°çš„ç»“æ„ã€‚ä½ åœ¨å¥å­çš„å‰éƒ¨åˆ†å°±èƒ½çœ‹åˆ°æ•´ä¸ªå¥å­çš„å†…å®¹ã€‚å¹¶ä¸”ä¹Ÿååˆ†å®¹æ˜“æ‰©å±•ï¼Œåªéœ€è¦åœ¨åˆ—è¡¨é‡Œæ·»åŠ å¦ä¸€ä¸ªå‚æ•°ã€‚</p><h1 id="distinguish-between-warning-and-error"><a class="markdownIt-Anchor" href="#distinguish-between-warning-and-error"></a> Distinguish between WARNING and ERROR</h1><p>æ˜¾ç„¶ï¼Œæœ‰å¤šç§çº§åˆ«çš„ log æ˜¯æœ‰å®ƒå­˜åœ¨çš„åŸå› çš„ï¼Œä½ åº”è¯¥é€‚å½“åœ°ä½¿ç”¨å®ƒä»¬ã€‚åœ¨ <strong>WARNING</strong> å’Œ <strong>ERROR</strong> ä¹‹é—´å­˜åœ¨æ˜æ˜¾çš„åŒºåˆ«ã€‚</p><p>å¦‚æœä½ åšä¸€äº›æ“ä½œå¹¶ä¸”åˆ‡å®ç”Ÿæ•ˆäº†ï¼Œä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œè¿™å°±æ˜¯ WARNINGã€‚å½“å¦‚æœä½ åšäº†ä¸€äº›æ“ä½œï¼Œå®ƒå¹¶æ²¡æœ‰ç”Ÿæ•ˆï¼Œé‚£å°±æ˜¯ä¸€ä¸ª ERRORã€‚</p><p>å†æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">try</span> &#123;<br>    restClient.<span class="hljs-built_in">makeRequest</span>()<br>    log.<span class="hljs-built_in">info</span>(<span class="hljs-string">&quot;Made request to REST API. [url=&#123;&#125;]&quot;</span>, url)<br>&#125; <span class="hljs-built_in"><span class="hljs-keyword">catch</span></span>(e: UnauthorizedException) &#123;<br>    log.<span class="hljs-built_in">warn</span>(<span class="hljs-string">&quot;Request to REST API was rejected because user is unauthorized. [url=&#123;&#125;, result=&#123;&#125;]&quot;</span>, url, result)<br>&#125; <span class="hljs-built_in"><span class="hljs-keyword">catch</span></span>(e: Exception) &#123;<br>    log.<span class="hljs-built_in">error</span>(<span class="hljs-string">&quot;Request to REST API failed. [url=&#123;&#125;, exception=&#123;&#125;]&quot;</span>, url, exception)<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ª REST è°ƒç”¨å¯èƒ½æœ‰ä¸‰ç§è¾“å‡ºæƒ…å†µï¼š</p><ul><li>å®ƒå¯ä»¥æ­£å¸¸å·¥ä½œã€‚é‚£å°±ä¼šæœ‰ä¸€ä¸ª INFO è¾“å‡ºã€‚</li><li>å½“å®ƒå¤±è´¥äº†ï¼Œé‡åˆ°äº†ä¸€ä¸ªé¢„æœŸå¤–çš„å¼‚å¸¸ï¼Œé‚£å°±æ˜¯ä¸€ä¸ª ERRORã€‚</li><li>å½“å®ƒå¯¼è‡´äº†ä¸€äº›é¢„æœŸå†…çš„å¼‚å¸¸ï¼Œé‚£å°±æ˜¯ WARNINGã€‚</li></ul><p>æ‰€ä»¥åœ¨ WARNING çš„ä¾‹å­ä¸­ï¼Œä½ åšäº†ä¸€äº›äº‹æƒ…ï¼Œä½†ä½ æ²¡æœ‰å®Œç¾åœ°åšå¥½ã€‚è€Œåœ¨ ERROR ä¸­ï¼Œä½ å¹¶æ²¡æœ‰åšäº‹æƒ…ã€‚</p><p>å¦å¤–æ³¨æ„ï¼Œä¸€ä¸ª WARNINGï¼ˆå½“ç„¶ ERROR ä¹Ÿæ˜¯ï¼‰æ˜¯ä¸€ä¸ªè°ƒç”¨åŠ¨ä½œã€‚å¦‚æœæ²¡æœ‰äººéœ€è¦å¯¹æ­¤åšå‡ºååº”æˆ–è€…è¦åšäº›ä»€ä¹ˆï¼Œé‚£ä¹ˆä½ ä¹Ÿå°±ä¸å¿…å» log è¾“å‡º WARNINGã€‚</p><h1 id="info-is-for-business-debug-for-technology"><a class="markdownIt-Anchor" href="#info-is-for-business-debug-for-technology"></a> INFO is for business, DEBUG for technology</h1><p>INFO æ—¥å¿—åº”è¯¥çœ‹èµ·æ¥åƒä¸€æœ¬ä¹¦ï¼Œå®ƒå‘Šè¯‰ä½ å‘ç”Ÿäº†ä»€ä¹ˆï¼Œè€Œä¸æ˜¯å¦‚ä½•å‘ç”Ÿçš„ã€‚è¿™æ„å‘³ç€ INFO æ›´é€‚åˆäºä¸šåŠ¡é€»è¾‘æ¶ˆæ¯ï¼Œç›¸æ¯”äºæŠ€æœ¯ç»†èŠ‚æ¥è¯´ã€‚æŠ€æœ¯ç›¸å…³çš„æ¶ˆæ¯åº”è¯¥ä½¿ç”¨ DEBUGã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">INFO  | User registered <span class="hljs-keyword">for</span> newsletter. [user=<span class="hljs-string">&quot;Thomas&quot;</span>, email=<span class="hljs-string">&quot;thomas@tuhrig.de&quot;</span>]<br>INFO  | Newsletter send to user. [user=<span class="hljs-string">&quot;Thomas&quot;</span>]<br>INFO  | User unsubscribed from newsletter. [user=<span class="hljs-string">&quot;Thomas&quot;</span>, email=<span class="hljs-string">&quot;thomas@tuhrig.de&quot;</span>]<br></code></pre></td></tr></table></figure><p>ä¸Šé¢ INFO ç±»å‹çš„æ—¥å¿—ï¼Œä»æˆ‘ä»¬ä¸šåŠ¡é€»è¾‘çš„è§†è§’å‘Šè¯‰ä½ å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">DEBUG | Saved user to newsletter list. [user=<span class="hljs-string">&quot;Thomas&quot;</span>, email=<span class="hljs-string">&quot;thomas@tuhrig.de&quot;</span>]<br>DEBUG | Send welcome mail. [user=<span class="hljs-string">&quot;Thomas&quot;</span>, email=<span class="hljs-string">&quot;thomas@tuhrig.de&quot;</span>]<br>INFO  | User registered <span class="hljs-keyword">for</span> newsletter. [user=<span class="hljs-string">&quot;Thomas&quot;</span>, email=<span class="hljs-string">&quot;thomas@tuhrig.de&quot;</span>]<br>DEBUG | Started cron job to send newsletter of the day. [subscribers=24332]<br>INFO  | Newsletter send to user. [user=<span class="hljs-string">&quot;Thomas&quot;</span>]<br>INFO  | User unsubscribed from newsletter. [user=<span class="hljs-string">&quot;Thomas&quot;</span>, email=<span class="hljs-string">&quot;thomas@tuhrig.de&quot;</span>]<br></code></pre></td></tr></table></figure><p>æ¯ä¸ªä¸šåŠ¡ç”¨ä¾‹éƒ½ä¼šå¯¼è‡´ä¸€æ¡ INFO æ—¥å¿—è¾“å‡ºã€‚æ­¤å¤–ï¼Œä¼šæœ‰ DEBUG æ—¥å¿—æ¥ç»™å‡ºæ›´å¤šç»†èŠ‚ä¿¡æ¯ï¼Œæ¥æè¿°å¤„ç†è¿‡ç¨‹ã€‚</p><h1 id="much-more"><a class="markdownIt-Anchor" href="#much-more"></a> Much more</h1><p>å½“ç„¶ï¼Œå¯¹äºå¥½çš„æ—¥å¿—æ¥è¯´è¿˜æœ‰è®¸å¤šå€¼å¾—åšçš„ã€‚ä½ è¿˜éœ€è¦è€ƒè™‘ tracing, log aggregation and metrics ã€‚ä½†å½“æåŠå¦‚ä½•ä¹¦å†™æ—¶ï¼Œæˆ‘éå¸¸æ¨èä¸Šé¢çš„è§„åˆ™ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¼–ç¨‹æŠ€å·§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ—¥å¿—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½è¿ç®—çš„â€œå¥‡æ·«æŠ€å·§â€</title>
    <link href="/2021/12/18/2021-12/2021-12-18%20%E4%BB%8B%E7%BB%8D%E4%BD%8D%E8%BF%90%E7%AE%97/"/>
    <url>/2021/12/18/2021-12/2021-12-18%20%E4%BB%8B%E7%BB%8D%E4%BD%8D%E8%BF%90%E7%AE%97/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><blockquote><p>åŸæ–‡æ¥æºï¼š<a href="https://catonmat.net/low-level-bit-hacks">https://catonmat.net/low-level-bit-hacks</a></p></blockquote><p>ä»‹ç»ä¸€äº›ä½è¿ç®—çš„æŠ€å·§ï¼Œæ¯”å¦‚å¯¹åº”è®¡ç®—ä¸€ä¸ªäºŒè¿›åˆ¶æ•´æ•°ä¸­ 1 bitçš„ä¸ªæ•°ï¼Œä¸æ˜¯é€šè¿‡å¾ªç¯éå†æ¯ä¸€bit æ˜¯å¦ä¸º1ï¼Œè€Œæ˜¯å¯ä»¥é€‰æ‹©ä¸€äº› tricky çš„ä½è¿ç®—æ¥å®Œæˆã€‚</p><p>å…ˆæ¥ä»‹ç»ä¸€ä¸‹æœ¬æ–‡ä¸­æ‰€ä½¿ç”¨çš„ä¸€äº›ä½è¿ç®—æ“ä½œç¬¦ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">&amp;    -  bitwise and  ä½ä¸<br>|    -  bitwise or     ä½æˆ–<br>^    -  bitwise xor    å¼‚æˆ–<br>~    -  bitwise not    å–å<br>&lt;&lt;   -  bitwise shift left    å·¦ç§»<br><span class="hljs-meta">&gt;</span><span class="bash">&gt;   -  bitwise <span class="hljs-built_in">shift</span> right  å³ç§»</span><br></code></pre></td></tr></table></figure><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œè¡¨ç¤ºçš„æ•°å­—å‡ä¸º 8 bit æœ‰ç¬¦å·æ•´æ•°ï¼ˆä½†æ˜¯ä¸Šè¿°è¿™äº›æ“ä½œæ˜¯å¯ä»¥åœ¨ä»»æ„é•¿åº¦çš„æœ‰ç¬¦å·æ•´æ•°ä¸Šæ‰§è¡Œçš„ï¼‰ï¼Œå¹¶ç”¨ â€˜xâ€™ æ¥è¡¨ç¤ºï¼Œè€Œä½è¿ç®—è®¡ç®—åçš„ç»“æœç”¨ â€˜yâ€™ æ¥è¡¨ç¤ºã€‚ å…¶ä¸­ â€˜xâ€™ çš„æ¯ä¸€bitï¼Œä½¿ç”¨ b<sub>7</sub>, b<sub>6</sub>, b<sub>5</sub>, b<sub>4</sub>, b<sub>3</sub>, b<sub>2</sub>, b<sub>1</sub>, b<sub>0</sub> æ¥è¡¨ç¤ºï¼Œb<sub>7</sub> æ˜¯æƒé‡æœ€é«˜ä½ï¼ˆåœ¨ç¬¦å·æ•°é‡Œå°±æ˜¯ç¬¦å·ä½ï¼‰ï¼Œb<sub>0</sub> æ˜¯æƒé‡æœ€å°çš„ä½ã€‚</p><p>æ¥ä¸‹æ¥ä¼šå…ˆåŸºæœ¬çš„bit hacks ä»‹ç»ï¼Œç„¶åé€æ¸æ·±å…¥åˆ°æ›´é«˜æ•ˆçš„æ–¹æ³•ã€‚</p><h1 id="1-æ£€éªŒä¸€ä¸ªæ•´æ•°çš„å¥‡å¶æ€§"><a class="markdownIt-Anchor" href="#1-æ£€éªŒä¸€ä¸ªæ•´æ•°çš„å¥‡å¶æ€§"></a> 1. æ£€éªŒä¸€ä¸ªæ•´æ•°çš„å¥‡å¶æ€§</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs C#">if ((x &amp; 1) == 0) &#123;<br>  x is even<br>&#125;<br>else &#123;<br>  x is odd<br>&#125;<br></code></pre></td></tr></table></figure><p>ç›¸ä¿¡å¾ˆå¤šäººéƒ½å·²ç»çœ‹åˆ°è¿‡ä¸Šè¿°çš„æŠ€å·§ï¼Œå…¶æœ€åŸºæœ¬çš„æ€æƒ³å°±æ˜¯å¦‚æœä¸€ä¸ªæ•´æ•°æ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆå®ƒçš„æœ€ä½ä½ b<sub>0</sub> å°±ä¸º1ã€‚é€šè¿‡ å°† â€˜xâ€™ å’Œ 1 è¿›è¡Œ <strong>AND-ing</strong> æ“ä½œï¼Œå¿½ç•¥å…¶ä»–bitsï¼Œåªå…³æ³¨ b<sub>0</sub> å³å¯ï¼Œå¦‚æœç»“æœä¸º0 è¡¨ç¤º â€˜xâ€™ æ˜¯å¶æ•°ï¼Œç»“æœä¸º1 è¡¨ç¤º â€˜xâ€™ æ˜¯å¥‡æ•°ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚æ•°å­—43ï¼ŒäºŒè¿›åˆ¶è¡¨ç¤ºä¸º00101011ï¼Œé€šè¿‡ä¸ 1 è¿›è¡Œ <strong>AND-ing</strong> æ“ä½œï¼Œæ¸…é™¤æ›´é«˜ä½çš„æ•°å€¼è€Œåªä¿ç•™ b<sub>0</sub> ï¼Œæœ€ç»ˆå‰©ä½™ç»“æœä¸º 1 å°±è¡¨ç¤ºæ•´æ•°ä¸ºå¥‡æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs C#">    00101011<br>&amp;   00000001   (note: 1 is the same as 00000001)<br>    --------<br>    00000001<br></code></pre></td></tr></table></figure><p>å†ä¸¾ä¸€ä¸ªå¶æ•°çš„ä¾‹å­98ï¼Œå…¶äºŒè¿›åˆ¶è¡¨ç¤ºä¸º1100010ã€‚åœ¨ <strong>AND-ing</strong> æ“ä½œåï¼Œæœ€ç»ˆç»“æœä¸º0ï¼Œå› æ­¤98æ˜¯ä¸€ä¸ªå¶æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs C#">    01100010<br>&amp;   00000001<br>    --------<br>    00000000<br></code></pre></td></tr></table></figure><h1 id="2-æ£€éªŒç¬¬nä½-bit-æ˜¯å¦ç½®1"><a class="markdownIt-Anchor" href="#2-æ£€éªŒç¬¬nä½-bit-æ˜¯å¦ç½®1"></a> 2. æ£€éªŒç¬¬nä½ bit æ˜¯å¦ç½®1</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs C#">if (x &amp; (1&lt;&lt;n)) &#123;<br>  n-th bit is set<br>&#125;<br>else &#123;<br>  n-th bit is not set<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨å…ˆå‰çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†é€šè¿‡ <code>ï¼ˆx &amp; 1ï¼‰</code>æ¥æ£€éªŒç¬¬ä¸€ä½ b0 æ˜¯å¦ç½®1ï¼Œè¿™ä¸ªæŠ€å·§å¯ä»¥é€šè¿‡æ”¹å–„å®ç°æ£€éªŒç¬¬nä½æ˜¯å¦ç½®1ã€‚ä¸»è¦åšæ³•å°±æ˜¯å°† 1 å·¦ç§»nä¸ªä½ç½®ï¼Œç„¶ååšç›¸åŒçš„<strong>AND</strong> æ“ä½œï¼Œå°†é™¤äº†ç¬¬nä½çš„å…¶ä»–bitsæ¸…0ã€‚</p><p>ä¸‹é¢æ¼”ç¤ºäº†å½“ä½ å°† 1 å·¦ç§»ä¸åŒä½æ•°çš„ç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs C#">1         00000001    (same as 1&lt;&lt;0)<br>1&lt;&lt;1      00000010<br>1&lt;&lt;2      00000100<br>1&lt;&lt;3      00001000<br>1&lt;&lt;4      00010000<br>1&lt;&lt;5      00100000<br>1&lt;&lt;6      01000000<br>1&lt;&lt;7      10000000<br></code></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œæˆ‘ä»¬å°† â€˜xâ€™ ä¸  å·¦ç§»nä½çš„ æ•°å­—1 è¿›è¡Œ AND æ“ä½œï¼Œå°±å¯ä»¥ä¿ç•™ 'xâ€™ä¸Šç¬¬nä½bit ï¼ˆå¯¹äº b0 æ¥è¯´æ˜¯ç¬¬0ä½ï¼‰è€Œå°†å…¶ä»–bit æ¸…é›¶ã€‚æ‰€ä»¥å¦‚æœæœ€ç»ˆç»“æœä¸º0ï¼Œè¡¨æ˜å¯¹åº”bit æ˜¯0ï¼Œæœ€ç»ˆç»“æœä¸ä¸º0ï¼Œè¡¨æ˜å¯¹åº”bitç½®ä¸º1ã€‚</p><p>æ¥ä¸‹æ¥ç»™å‡ºä¸€äº›ä¾‹å­ï¼Œæ¯”å¦‚è¯´ 122 çš„ç¬¬3rd bit æ˜¯å¦ç½®ä¸º1ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>122 &amp; (1&lt;&lt;3)</code>æ¥å®ç°ï¼Œå…·ä½“æ¥è¯´å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs C#">    01111010<br>&amp;   00001000<br>    --------<br>    00001000<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ€ç»ˆç»“æœä¸ä¸º0ï¼Œå› æ­¤122 å¯¹åº”çš„ 3rd bit æ˜¯ç½®ä¸º1çš„ã€‚</p><p>æ³¨æ„ï¼šåœ¨æœ¬æ–‡ä¸­ï¼Œbit çš„ä½æ•°ä¸‹æ ‡ä»0å¼€å§‹ï¼Œä¹Ÿå°±æ˜¯ç¬¬0ä½bitï¼Œç¬¬1ä½bit ï¼Œâ€¦ï¼Œ ç¬¬7ä½ bitã€‚</p><h1 id="3-å°†ç¬¬nä½-bit-ç½®-1"><a class="markdownIt-Anchor" href="#3-å°†ç¬¬nä½-bit-ç½®-1"></a> 3. å°†ç¬¬nä½ bit ç½® 1</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs C#">y = x | (1 &lt;&lt; n)<br></code></pre></td></tr></table></figure><p>è¿™ä¸ª bit hack ç»“åˆäº†å·¦ç§» (1&lt;&lt;n) å’Œ <strong>OR</strong> è¿ç®—çš„æŠ€å·§ï¼Œ<code>y = x | (1&lt;&lt;n)</code>é€šè¿‡å’Œä¸€ä¸ªç¬¬nä½ ç½®1 çš„æ•°å€¼è¿›è¡Œ <strong>OR</strong> è¿ç®—å°±å¯ä»¥ä½¿å¾— â€˜xâ€™ çš„ç¬¬nä½ ç½®1ã€‚å› ä¸ºå’Œ 0 è¿›è¡Œ OR-ing æ•°å€¼ä¿æŒä¸å˜ï¼Œå’Œ 1 è¿›è¡Œ OR-ing å¯¹åº”bitå˜ä¸º1ï¼ˆå¦‚æœä¸æ˜¯1çš„è¯ï¼‰ã€‚</p><p>åŒæ ·ç»™å‡ºä¸€ä¸ªä¾‹å­ï¼Œå¯¹äºæ•°120ï¼Œæˆ‘ä»¬å¸Œæœ›å°†å…¶ 2nd bit ç½®ä¸º1ï¼Œå¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs C#">    01111000    (120 in binary)<br>|   00000100    (1&lt;&lt;2)<br>    --------<br>    01111100<br></code></pre></td></tr></table></figure><h1 id="4-å°†ç¬¬nä½-bit-ç½®-0"><a class="markdownIt-Anchor" href="#4-å°†ç¬¬nä½-bit-ç½®-0"></a> 4. å°†ç¬¬nä½ bit ç½® 0</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs C#">y = x &amp; ~(1&lt;&lt;n)<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªbit hack ä¸»è¦é€šè¿‡<code>y = x &amp; ~(1&lt;&lt;n)</code>å®ç°ï¼Œ<code>~(1&lt;&lt;n)</code>èµ·åˆ°çš„ä½œç”¨æ˜¯å°†é™¤äº†ç¬¬nä½ç½®0ï¼Œå…¶ä½™ä½ç½®1ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ ·ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs C#">~1        11111110  (same as ~(1&lt;&lt;0))<br>~(1&lt;&lt;1)   11111101<br>~(1&lt;&lt;2)   11111011<br>~(1&lt;&lt;3)   11110111<br>~(1&lt;&lt;4)   11101111<br>~(1&lt;&lt;5)   11011111<br>~(1&lt;&lt;6)   10111111<br>~(1&lt;&lt;7)   01111111<br></code></pre></td></tr></table></figure><p>å†é€šè¿‡ AND-ing æ“ä½œï¼Œå°±å¯ä»¥ä½¿å¾—å°† â€˜xâ€™ çš„ç¬¬nä½ç½®0ï¼Œå› ä¸º AND-ing ä¸­æœ‰ä¸ª bit ä¸º0ï¼Œç»“æœ bit å°±ä¸º0ã€‚ä¸‹é¢ç»™å‡ºæ•°127ï¼Œå°†ç¬¬4ä½ bit ç½®0çš„ä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs C#">    01111111    (127 in binary)<br>&amp;   11101111    (~(1&lt;&lt;4))<br>    --------<br>    01101111<br></code></pre></td></tr></table></figure><h1 id="5-åè½¬ç¬¬nä½-bit"><a class="markdownIt-Anchor" href="#5-åè½¬ç¬¬nä½-bit"></a> 5. åè½¬ç¬¬nä½ bit</h1><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">y</span> = x ^ (<span class="hljs-number">1</span>&lt;&lt;n)<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªbit hack ä¸»è¦å®ç°æ–¹å¼ä¸º<code>y = x ^ (1&lt;&lt;n)</code>ï¼Œç»“åˆäº†å·¦ç§»å’ŒXOR è¿ç®—ã€‚<code>(1&lt;&lt;n)</code>å°†å¯¹åº”çš„ç¬¬nä½ç½®1ï¼Œè€Œé€šè¿‡ XOR è¿ç®—ï¼Œå¦‚æœ â€˜xâ€™ ç¬¬nä½ä¸º0ï¼Œå°±ä¼šå˜ä¸º1ï¼Œå¦‚æœç¬¬nä½ä¸º1ï¼Œå°±ä¼šå˜ä¸º0ï¼Œä»è€Œå®ç°åè½¬çš„æ•ˆæœã€‚</p><p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªä¾‹å­ï¼Œå°† 01110101 çš„ç¬¬5ä½è¿›è¡Œåè½¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs C#">    01110101<br>^   00100000<br>    --------<br>    01010101<br></code></pre></td></tr></table></figure><h1 id="6-å°†æœ€å³è¾¹çš„1-bitç½®ä¸º0"><a class="markdownIt-Anchor" href="#6-å°†æœ€å³è¾¹çš„1-bitç½®ä¸º0"></a> 6. å°†æœ€å³è¾¹çš„1-bitç½®ä¸º0</h1><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">y</span> = x &amp; (x-<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p>è¯¥æ–¹å¼ä¸»è¦é€šè¿‡<code>y = x &amp; (x-1)</code>æ¥å®ç°ã€‚æ¯”å¦‚å¯¹äºä¸€ä¸ªæ•´æ•° 001010<strong>1</strong>0ï¼ˆæœ€å³è¾¹çš„1ç”¨é»‘ä½“æ ‡å‡ºï¼‰ï¼Œå½“å°†æœ€åè¾¹çš„1-bitç½®ä¸º0åï¼Œå°±å˜æˆäº†001010<strong>0</strong>0ï¼ˆå¯¹åº”ä½å˜æˆäº†0ï¼‰ã€‚</p><p>è¿™é‡Œç»™å‡ºæ›´å¤šçš„ä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs C#">    01011000    (x)<br>&amp;   01010111    (x-1)<br>    --------<br>    01010000<br><br>    10000000    (x = -128)<br>&amp;   01111111    (x-1 = 127 (with overflow))<br>    --------<br>    00000000<br><br>    11111111    (x = all bits 1)<br>&amp;   11111110    (x-1)<br>    --------<br>    11111110<br><br>    00000000    (x = no rightmost 1-bits)<br>&amp;   11111111    (x-1)<br>    --------<br>    00000000<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªå¯èƒ½çš„åœºæ™¯ï¼š</p><ol><li>è¯¥æ•´æ•°å€¼å­˜åœ¨ä¸€ä¸ªæœ€å³è¾¹çš„1-bitã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“è¯¥æ•°å€¼å‡å»1åï¼Œä¼šå°†è¯¥äºŒè¿›åˆ¶æ•°çš„æœ€å³è¾¹çš„1-bitç½®ä¸º0ï¼ŒåŒæ—¶å…¶å³è¾¹æ‰€æœ‰ä½ä½çš„0å˜æˆ1ï¼ˆå°±æ˜¯ä¸€ä¸ªå‡æ³•å¾—åˆ°çš„ç»“æœï¼‰ã€‚è¿™ä¸ªå‡æ³•æ“ä½œå¾—åˆ°çš„ç»“æœï¼Œç›¸å½“äºå·²ç»æŠŠæœ€å³è¾¹çš„1-bitç½®0ï¼Œç„¶åå†é€šè¿‡å’ŒåŸå§‹å€¼è¿›è¡ŒAND-ing æ“ä½œï¼Œå°±å¯ä»¥æŠŠä½ä½çš„1éƒ½ç½®ä¸º0ã€‚</li><li>å½“è¯¥äºŒè¿›åˆ¶æ•°ä¸å­˜åœ¨ä¸€ä¸ªæœ€å³è¾¹çš„ 1-bitï¼ˆå…¨ä¸º0ï¼‰ã€‚é‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‡1åä¼šä¸‹æº¢ï¼Œå³æ‰€æœ‰ bit ç½®ä¸º 1 ï¼Œé‚£ä¹ˆå†å’ŒåŸå§‹å€¼ï¼ˆå…¨0ï¼‰è¿›è¡ŒAND-ingæ“ä½œå¾—åˆ°çš„ä¹Ÿè¿˜æ˜¯0ã€‚</li></ol><h1 id="7-åªä¿ç•™æœ€å³è¾¹çš„-1-bit"><a class="markdownIt-Anchor" href="#7-åªä¿ç•™æœ€å³è¾¹çš„-1-bit"></a> 7. åªä¿ç•™æœ€å³è¾¹çš„ 1-bit</h1><p class='note note-info'>y = x & (-x)</p><p>è¯¥æ–¹æ³•é€šè¿‡<code>y = x &amp; (-x)</code>å®ç°ï¼Œå°†åªä¿ç•™ x çš„æœ€å³è¾¹çš„ 1-bit ï¼ŒæŠŠå…¶ä»–ä½éƒ½ç½®ä¸º0ã€‚æ¯”å¦‚å¯¹äº 01010<strong>1</strong>00 (æœ€å³ä¾§ 1 ç”¨é»‘ä½“æ ‡å‡º)ï¼Œå¾—åˆ°çš„ç»“æœä¸º 00000<strong>1</strong>00ã€‚</p><p>è¿™é‡Œå†ç»™å‡ºæ›´å¤šçš„ä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs C#">    01110000  (x)<br>&amp;   10010000  (-x)<br>    --------<br>    00010000<br><br>    00000001  (x)<br>&amp;   11111111  (-x)<br>    --------<br>    00000001<br><br>    10000000  (x = -128)<br>&amp;   10000000  (-x = -128)<br>    --------<br>    10000000<br><br>    11111111  (x = all bits one)<br>&amp;   00000001  (-x)<br>    --------<br>    00000001<br><br>    00000000  (x = all bits 0, no rightmost 1-bit)<br>&amp;   00000000  (-x)<br>    --------<br>    00000000<br></code></pre></td></tr></table></figure><p><strong>æ¥ä¸‹æ¥æ¢è®¨å…¶å®ç°åŸç†ã€‚ä¸»è¦å°±æ˜¯ä¾èµ–äºåœ¨è®¡ç®—æœºä¸­ï¼Œ -x ï¼ˆå¯¹åº”çš„è´Ÿæ•°ï¼‰è·Ÿ ~x+1 ï¼ˆæŒ‰ä½å–åååŠ 1ï¼‰ æ˜¯ä¸€æ ·çš„ã€‚</strong></p><p>ä¸å¦¨è®¾ x æœ€å³è¾¹çš„ 1-bit ä¸ºb<sub>i</sub>ï¼Œä»¥ä¸‹æ ‡ i ä¸ºç•Œï¼Œå°† b<sub>i</sub> å·¦ä¾§çš„ bits ä½è®¾ä¸º b<sub>i+1</sub>, â€¦, b<sub>n</sub>ï¼Œå°† b<sub>i</sub> å³ä¾§çš„æ‰€æœ‰ bits ä½è®¾ä¸º b<sub>i-1</sub>, b<sub>i-2</sub> , â€¦ , b<sub>0</sub> ï¼ˆä½äºå³ä¾§çš„å…¨ä¸º 0 ï¼Œå› ä¸º b<sub>i</sub> æ˜¯æœ€å³ä¾§çš„ 1 ï¼‰ã€‚</p><p>ç°åœ¨å½“æˆ‘è®¡ç®— -x ï¼Œé¦–å…ˆåšå–åæ“ä½œ ~x ï¼Œä¹Ÿå°±æ˜¯å°† b<sub>i</sub> ç½®ä¸º0ï¼Œ b<sub>i-1</sub>â€¦b<sub>0</sub> éƒ½ç½®ä¸º 1ï¼Œå°† b<sub>i+1</sub> â€¦ b<sub>n</sub> ç­‰ä½è¿›è¡Œåè½¬ã€‚ç„¶ååšåŠ  1 æ“ä½œã€‚å› ä¸º b<sub>i-1</sub>â€¦b<sub>0</sub> éƒ½ä¸º1ï¼Œæ‰€ä»¥åŠ  1 åä¼šæƒ³ b<sub>i</sub> è¿›ä½ï¼ˆå› ä¸º b<sub>i</sub> æ˜¯ç¬¬ä¸€ä¸ª 0 bit ï¼‰ã€‚</p><p>æ­¤æ—¶æˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œå¯¹äº -x ï¼Œb<sub>i+1</sub> â€¦ b<sub>n</sub> ç­‰ä½åè½¬äº†ï¼Œ b<sub>i</sub> ä¾ç„¶ä¿æŒä¸å˜ï¼Œb<sub>i-1</sub>â€¦b<sub>0</sub> ä¹Ÿä¾ç„¶å…¨ä¸º 0 ã€‚æ‰€ä»¥ç°åœ¨å°† x ä¸ -x è¿›è¡Œ AND-ing æ“ä½œï¼Œå°±å¯ä»¥ä½¿å¾— b<sub>i+1</sub> â€¦ b<sub>n</sub> ç½®ä¸º 0 ï¼Œb<sub>i</sub> ä¿æŒ 1ï¼Œ b<sub>i-1</sub>â€¦b<sub>0</sub> ä¹Ÿå…¨ä¸º 0 ã€‚åªæœ‰ä¸€ä¸ª bit ä¿ç•™äº†ä¸‹æ¥ï¼Œå°±æ˜¯æœ€å³è¾¹çš„ 1-bit ã€‚</p><h1 id="8-å°†æœ€å³è¾¹-1-bit-å³ä¾§çš„æ‰€æœ‰ä½ä½-bit-ç½®-1"><a class="markdownIt-Anchor" href="#8-å°†æœ€å³è¾¹-1-bit-å³ä¾§çš„æ‰€æœ‰ä½ä½-bit-ç½®-1"></a> <strong>8. å°†æœ€å³è¾¹ 1-bit å³ä¾§çš„æ‰€æœ‰ä½ä½ bit ç½® 1</strong></h1><p class='note note-info'>y = x | (x-1)</p><p>å…·ä½“å®ç°å°±æ˜¯ <code>y = x | (x-1)</code> ã€‚è¿™ä¸ªç¿»è¯‘è¿‡æ¥æœ‰ç‚¹æ‹—å£ï¼Œç»™ä¸ªä¾‹å­å°±èƒ½ç†è§£äº†ï¼Œç»™å‡ºæ•° 010<strong>1</strong>0000 ï¼Œæ‰§è¡Œåå°±å¾—åˆ° 010<strong>11111</strong>ï¼ŒåŸæ¥æœ€å³è¾¹ 1-bit å³è¾¹çš„ä½ä½éƒ½ç½®ä¸º1 ã€‚æ¥ä¸‹æ¥çœ‹æ›´å¤šçš„ä¸€äº›ä¾‹å­ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs C#">    10111100  (x)<br>|   10111011  (x-1)<br>    --------<br>    10111111<br><br>    01110111  (x)<br>|   01110110  (x-1)<br>    --------<br>    01110111<br><br>    00000001  (x)<br>|   00000000  (x-1)<br>    --------<br>    00000001<br><br>    10000000  (x = -128)<br>|   01111111  (x-1 = 127)<br>    --------<br>    11111111<br><br>    11111111  (x = -1)<br>|   11111110  (x-1 = -2)<br>    --------<br>    11111111<br><br>    00000000  (x)<br>|   11111111  (x-1)<br>    --------<br>    11111111<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•çš„å®ç°åŸç†è·Ÿæ–¹æ³•6å¾ˆåƒï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸å†è¯æ˜äº†ã€‚</p><h1 id="9-ä¿ç•™æœ€å³è¾¹çš„-0-bit"><a class="markdownIt-Anchor" href="#9-ä¿ç•™æœ€å³è¾¹çš„-0-bit"></a> <strong>9. ä¿ç•™æœ€å³è¾¹çš„ 0-bit</strong></h1><p class='note note-info'>y = ~x & (x+1)</p><p>è¯¥æ–¹æ³•çš„å®ç°ä¸º<code>y = ~x &amp; (x+1)</code> ã€‚è¯¥æ–¹æ³•ä¸æ–¹æ³•7æ­£å¥½ç›¸åï¼Œå®ƒæ˜¯æ‰¾åˆ°æœ€å³ä¾§çš„ 0-bitï¼Œå°†å…¶ä»–ä½éƒ½ç½®ä¸º0ï¼Œå°†è¯¥ bit ç½®ä¸º 1 ã€‚è·ç¦»æ¥è¯´ï¼Œç»™å®šæ•° 10101<strong>0</strong>11ï¼Œç»è¿‡å¤„ç†åçš„ç»“æœä¸ºï¼Œ00000<strong>1</strong>00ã€‚å†ç»™å‡ºæ›´å¤šçš„ä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs C#">    01110111  (x)<br>    --------<br>    10001000  (~x)<br>&amp;   01111000  (x+1)<br>    --------<br>    00001000<br><br>    00000001  (x)<br>    --------<br>    11111110  (~x)<br>&amp;   00000010  (x+1)<br>    --------<br>    00000010<br><br>    10000000  (x = -128)<br>    --------<br>    01111111  (~x)<br>&amp;   10000001  (x+1)<br>    --------<br>    00000001<br><br>    11111111  (x = no rightmost 0-bit)<br>    --------<br>    00000000  (~x)<br>&amp;   00000000  (x+1)<br>    --------<br>    00000000<br><br>    00000000  (x)<br>    --------<br>    11111111  (~x)<br>&amp;   00000001  (x+1)<br>    --------<br>    00000001<br></code></pre></td></tr></table></figure><p><strong>æ¥ä¸‹æ¥ç»™å‡ºè¯æ˜</strong>ã€‚ä¸ä¹‹å‰ç±»ä¼¼ï¼Œä¸å¦¨è®¾æœ€å³è¾¹çš„ 0-bit è®¾ç½®ä¸º b<sub>i</sub> ï¼Œå°† b<sub>i</sub> å·¦ä¾§çš„ bits ä½è®¾ä¸º b<sub>i+1</sub>, â€¦, b<sub>n</sub>ï¼Œå°† b<sub>i</sub> å³ä¾§çš„æ‰€æœ‰ bits ä½è®¾ä¸º b<sub>i-1</sub>, b<sub>i-2</sub> , â€¦ , b<sub>0</sub> ï¼ˆä½äºå³ä¾§çš„å…¨ä¸º 1 ï¼Œå› ä¸º b<sub>i</sub> æ˜¯æœ€å³ä¾§çš„ 0 ï¼‰ã€‚</p><p>é‚£ä¹ˆå¯¹äº ~x æ¥è¯´ï¼Œå°†æ‰€æœ‰ä½è¿›è¡Œåè½¬ï¼ŒåŒ…æ‹¬æœ€å³ä¾§çš„ 0-bitï¼Œb<sub>i</sub> ä¹Ÿä» 0 å˜æˆäº† 1 ã€‚</p><p>å¯¹äº x+1 æ¥è¯´ï¼Œå› ä¸º b<sub>i-1</sub>, b<sub>i-2</sub> , â€¦ , b<sub>0</sub> å…¨ä¸º1ï¼ŒåŠ  1 ä¹‹åä¼šå‘ b<sub>i</sub> è¿›ä½ï¼Œå› æ­¤ b<sub>i</sub> ä¹Ÿå˜æˆäº† 1ï¼Œb<sub>i-1</sub>, b<sub>i-2</sub> , â€¦ , b<sub>0</sub> éƒ½å˜æˆäº†0ï¼Œè€Œé«˜ä½  b<sub>i+1</sub>, â€¦, b<sub>n</sub> ä¿æŒä¸å˜ã€‚</p><p>æ­¤æ—¶å†å°† ~x ä¸ x+1 è¿›è¡Œ AND-ing æ“ä½œï¼Œå°±åªæœ‰ b<sub>i</sub> ä½ä¿ç•™ä¸‹æ¥ï¼Œå…¶ä»–ä½å‡ä¸º 0 ã€‚</p><h1 id="10-å°†æœ€å³ä¾§çš„-0-bit-ç½®ä¸º1"><a class="markdownIt-Anchor" href="#10-å°†æœ€å³ä¾§çš„-0-bit-ç½®ä¸º1"></a> <strong>10. å°†æœ€å³ä¾§çš„ 0-bit ç½®ä¸º1</strong></h1><p class='note note-info'>y = x | (x+1)</p>è¯¥æ–¹æ³•å®ç°ä¸º `y = x | (x+1)`ã€‚ä¸»è¦å°±æ˜¯å°†æœ€å³ä¾§çš„ 0-bit ç½®ä¸º1ï¼Œä¾‹å¦‚å¯¹äºæ•° 10100**0**11 ç»è¿‡è¿ç®—åï¼Œå¾—åˆ°ç»“æœ 10100**1**11ã€‚ç»™å‡ºæ›´å¤šçš„ä¾‹å­ï¼š<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs C#">    10111100  (x)<br>|   10111101  (x+1)<br>    --------<br>    10111101<br><br>    01110111  (x)<br>|   01111000  (x+1)<br>    --------<br>    01111111<br><br>    00000001  (x)<br>|   00000010  (x+1)<br>    --------<br>    00000011<br><br>    10000000  (x = -128)<br>|   10000001  (x+1)<br>    --------<br>    10000001<br><br>    11111111  (x = no rightmost 0-bit)<br>|   00000000  (x+1)<br>    --------<br>    11111111<br><br>    00000000  (x)<br>|   00000001  (x+1)<br>    --------<br>    00000001<br></code></pre></td></tr></table></figure><p>æ­£ç¡®æ€§ä¹Ÿéå¸¸å¥½ç†è§£ã€‚x+1 çš„æ“ä½œå°†åŸæ¥ x çš„æœ€å³ä¾§çš„ 0-bitï¼Œ b<sub>i</sub> ç½®ä¸º1ï¼Œb<sub>i-1</sub>, b<sub>i-2</sub> , â€¦ , b<sub>0</sub> éƒ½å˜æˆäº†0ï¼Œè€Œé«˜ä½  b<sub>i+1</sub>, â€¦, b<sub>n</sub> ä¿æŒä¸å˜ã€‚æ­¤æ—¶å†å’Œ x åš OR-ing è¿ç®—ï¼Œå°±å¯ä»¥ä½¿å¾—åŸæ¥ x çš„æœ€å³ä¾§ 0-bit  b<sub>i</sub> ç½®ä¸º 1ã€‚</p><h1 id="bonus"><a class="markdownIt-Anchor" href="#bonus"></a> Bonus</h1><p>ä¸€ä¸ªç®€å•çš„Cè¯­è¨€å‡½æ•°ï¼Œå®ç°æ‰“å°ä¸€ä¸ªæ•°å­—çš„ä½8ä½ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">int_to_bin</span><span class="hljs-params">(<span class="hljs-keyword">int</span> num)</span> </span>&#123;<br>  <span class="hljs-keyword">char</span> str[<span class="hljs-number">9</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>  <span class="hljs-keyword">int</span> i;<br>  <span class="hljs-keyword">for</span> (i=<span class="hljs-number">7</span>; i&gt;=<span class="hljs-number">0</span>; i--) &#123;<br>    str[i] = (num&amp;<span class="hljs-number">1</span>)?<span class="hljs-string">&#x27;1&#x27;</span>:<span class="hljs-string">&#x27;0&#x27;</span>;<br>    num &gt;&gt;= <span class="hljs-number">1</span>;<br>  &#125;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s\n&quot;</span>, str);<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¼–ç¨‹æŠ€å·§</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ä½è¿ç®—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¤­åœ†æ›²çº¿å…¬é’¥æ¢å¤ç®—æ³•ä¸SM2ç¼–ç¨‹å®ç°</title>
    <link href="/2021/12/13/2021-12/2021-12-13%20%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E5%85%AC%E9%92%A5%E6%81%A2%E5%A4%8D%E7%AE%97%E6%B3%95%E4%B8%8ESM2%E7%BC%96%E7%A8%8B%E5%AE%9E%E7%8E%B0/"/>
    <url>/2021/12/13/2021-12/2021-12-13%20%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E5%85%AC%E9%92%A5%E6%81%A2%E5%A4%8D%E7%AE%97%E6%B3%95%E4%B8%8ESM2%E7%BC%96%E7%A8%8B%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="æ¤­åœ†æ›²çº¿å…¬é’¥æ¢å¤ç®—æ³•"><a class="markdownIt-Anchor" href="#æ¤­åœ†æ›²çº¿å…¬é’¥æ¢å¤ç®—æ³•"></a> æ¤­åœ†æ›²çº¿å…¬é’¥æ¢å¤ç®—æ³•</h1><p>åœ¨ä»¥å¤ªåŠä¸­ï¼Œäº¤æ˜“æ¶ˆæ¯ä¸­ä¸åŒ…å«â€œfromâ€å­—æ®µï¼ˆå³äº¤æ˜“å‘èµ·è€…çš„åœ°å€ï¼‰ï¼Œè¿™æ˜¯å› ä¸ºäº¤æ˜“å‘èµ·è€…çš„å…¬é’¥å¯ä»¥ç›´æ¥ä»ECDSAç­¾åä¸­è®¡ç®—å‡ºæ¥ã€‚è€Œä¸€æ—¦ä½ æœ‰å…¬é’¥ï¼Œå°±å¯ä»¥å¾ˆå®¹æ˜“åœ°è®¡ç®—å‡ºå¯¹åº”çš„åœ°å€ã€‚æ¢å¤ç­¾åè€…å…¬é’¥çš„è¿‡ç¨‹ç§°ä¸ºå…¬é’¥æ¢å¤ï¼Œå¯¹åº”çš„ç®—æ³•å³ä¸ºå…¬é’¥æ¢å¤ç®—æ³•ã€‚</p><p>æ¥ä¸‹æ¥æè¿°ä»¥å¤ªåŠä¸­å…¬é’¥æ¢å¤ç®—æ³•çš„è¿‡ç¨‹ã€‚</p><p>é¦–å…ˆæ ¹æ®ç»™å®š ECDSAç­¾åç®—æ³• ä¸­è®¡ç®—çš„å€¼ <strong>r</strong> å’Œ <strong>s</strong>ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å¾—åˆ°ä¸¤ä¸ªå¯èƒ½çš„å…¬é’¥ã€‚æˆ‘ä»¬æ ¹æ®ç­¾åä¸­çš„ <strong>x</strong> åæ ‡ <strong>r</strong> å€¼è®¡ç®—ä¸¤ä¸ªæ¤­åœ†æ›²çº¿ç‚¹ <strong>R</strong> å’Œ <strong>Râ€™</strong>ã€‚å¯¹äº r å€¼ï¼Œè®¡ç®—å®ƒå…³äº n çš„é€†å…ƒ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>r</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">r^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œå…¶ä¸­ n æ˜¯æ¤­åœ†æ›²çº¿çš„é˜¶æ•°ã€‚æœ€åè®¡ç®— e ï¼Œå®ƒæ˜¯æ¶ˆæ¯çš„æ•£åˆ—å€¼ã€‚ç„¶åå¯ä»¥å¾—åˆ°ä¸¤ä¸ªå¯èƒ½çš„å…¬é’¥ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mn>1</mn></msub><mo>=</mo><msup><mi>r</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>s</mi><mi>R</mi><mo>âˆ’</mo><mi>e</mi><mi>G</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">K_1 = r^{-1} (sR - eG)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">G</span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>K</mi><mn>2</mn></msub><mo>=</mo><msup><mi>r</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>s</mi><msup><mi>R</mi><mo mathvariant="normal">â€²</mo></msup><mo>âˆ’</mo><mi>e</mi><mi>G</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">K_2 = r^{-1} (sR&#x27; - eG)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">G</span><span class="mclose">)</span></span></span></span></span></p><p>å…¶ä¸­:</p><ul><li><p>K<sub>1</sub> å’Œ K<sub>2</sub> æ˜¯ç­¾åè€…å…¬é’¥çš„ä¸¤ç§å¯èƒ½æ€§</p></li><li><p>r<sup>-1</sup>æ˜¯ç­¾åçš„ r å€¼çš„é€†å…ƒ</p></li><li><p>s æ˜¯ç­¾åçš„ s å€¼</p></li><li><p>R å’Œ Râ€™ æ˜¯ä¸´æ—¶å…¬é’¥ Q çš„ä¸¤ç§å¯èƒ½æ€§</p></li><li><p>e æ˜¯æ¶ˆæ¯æ•£åˆ—çš„æœ€ä½ä½</p></li><li><p>G æ˜¯æ¤­åœ†æ›²çº¿ç”Ÿæˆç‚¹</p></li></ul><p>ä¸ºäº†ä½¿è®¡ç®—æ›´æœ‰æ•ˆç‡ï¼Œåœ¨ä»¥å¤ªåŠäº¤æ˜“ç­¾åé‡ŒåŒ…æ‹¬ä¸€ä¸ªå‰ç¼€å€¼ vï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬ä¸¤ä¸ªå¯èƒ½çš„Rå€¼ä¸­å“ªä¸€ä¸ªæ˜¯çœŸæ­£ä¸´æ—¶çš„å…¬é’¥ã€‚å¦‚æœ v æ˜¯å¶æ•°ï¼Œé‚£ä¹ˆRæ˜¯æ­£ç¡®çš„å€¼ã€‚å¦‚æœ v æ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆé€‰æ‹©Râ€™ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®—Rçš„ä¸€ä¸ªå€¼ã€‚è¿™ä¹Ÿå°±æ˜¯ä»¥å¤ªåŠäº¤æ˜“ä¸­ç­¾åæ•°æ®çš„ï¼ˆv, r, sï¼‰ã€‚</p><h2 id="æ¤­åœ†æ›²çº¿ä¸Šç‚¹çš„å‹ç¼©"><a class="markdownIt-Anchor" href="#æ¤­åœ†æ›²çº¿ä¸Šç‚¹çš„å‹ç¼©"></a> æ¤­åœ†æ›²çº¿ä¸Šç‚¹çš„å‹ç¼©</h2><p>åœ¨ä¸Šè¿°è¿‡ç¨‹ï¼Œæœ‰ä¸€ä¸ªåœ°æ–¹å¯èƒ½è¿˜æ²¡æœ‰è§£é‡Šæ¸…æ¥šï¼Œé‚£å°±æ˜¯ä¸ºä»€ä¹ˆä¸€ä¸ª x åæ ‡ä¼šå¯¹åº”æœ‰ä¸¤ä¸ªæ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ï¼Ÿå…¶å®è¿™é‡Œç”¨åˆ°äº†æ¤­åœ†æ›²çº¿ä¸Šç‚¹çš„å‹ç¼©å’Œè§£å‹ç¼©æ–¹æ³•ã€‚</p><p>æ ¹æ®æ¤­åœ†æ›²çº¿æ–¹ç¨‹ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“ x åæ ‡ï¼Œå°±å¯ä»¥é€šè¿‡æ–¹ç¨‹è®¡ç®—å‡º y åæ ‡ï¼Œè¿™æ ·å°±ä¸ç”¨åŒæ—¶ä¿å­˜xï¼Œyçš„å€¼ï¼Œå‡å°‘äº†å­˜å‚¨å’Œå¸¦å®½ã€‚ä½†æ˜¯å¦‚æœåªçŸ¥é“xï¼Œå¸¦å…¥æ–¹ç¨‹ä¼šæ±‚å‡ºä¸¤ä¸ªyï¼Œä¸€æ­£ä¸€è´Ÿï¼Œå¯¹åº”ä¸¤ä¸ªä¸åŒçš„ç‚¹ï¼Œæ‰€ä»¥è¿˜å¿…é¡»æœ‰ä¸€ä¸ªæ ‡å¿—æ¥åŒºåˆ«å®é™…ä½¿ç”¨çš„æ˜¯å“ªä¸ªã€‚åœ¨ä»¥å¤ªåŠä¸­å°±é‡‡ç”¨äº†å‹ç¼©å…¬é’¥æ ¼å¼ï¼Œå…·ä½“æ ¼å¼ä¸ºï¼š</p><ul><li>å‰ç¼€02 + x ï¼ˆå½“yä¸ºå¶æ•°ï¼‰</li><li>å‰ç¼€03 + x ï¼ˆå½“yä¸ºå¥‡æ•°ï¼‰</li></ul><p>ä¸ºä»€ä¹ˆyä¸€å®šæ˜¯ä¸€å¥‡ä¸€å¶å‘¢ï¼Œåˆšåˆšä¸æ˜¯è¯´ä¸€æ­£ä¸€è´Ÿå—ï¼Ÿ</p><p>å‡è®¾ y æ˜¯æ–¹ç¨‹çš„ä¸€ä¸ªè§£ï¼Œé‚£ä¹ˆ -y ä¹Ÿæ˜¯æ–¹ç¨‹çš„ä¸€ä¸ªè§£ï¼Œä½†åœ¨æ¨¡è¿ç®—çš„è§„åˆ™ä¸‹ï¼Œ<code>-y â‰¡ p - y (mod p)</code>ï¼Œæ‰€ä»¥ p-y ä¹Ÿæ˜¯æ–¹ç¨‹çš„è§£ï¼Œy-p ä¹Ÿæ˜¯æ–¹ç¨‹çš„è§£ï¼Œä½†æ˜¯åœ¨mod p çš„æœ‰é™åŸŸä¸­ï¼Œå–å€¼èŒƒå›´æ˜¯[0, p-1]ï¼Œæ²¡æœ‰è´Ÿæ•°ï¼Œæ‰€ä»¥ -y å’Œ y-p åœ¨æ¤­åœ†æ›²çº¿ä¸Šå–ä¸åˆ°ï¼Œæœ€ç»ˆå¾—åˆ°å°±æ˜¯ä¸¤ä¸ªè§£ y å’Œ p-yï¼Œå› ä¸ºpæ˜¯å¤§ç´ æ•°ï¼Œæ‰€ä»¥ y å’Œ p-y ä¸€å®šæ˜¯ä¸€å¥‡ä¸€å¶ã€‚</p><p>åœ¨<a href="http://www.oscca.gov.cn/sca/xxgk/2010-12/17/1002386/files/b791a9f908bb4803875ab6aeeb7b4e03.pdf">ã€ŠSM2æ¤­åœ†æ›²çº¿å…¬é’¥å¯†ç ç®—æ³•ã€‹</a>ä¸­ä¹Ÿè°ˆåŠäº†æ¤­åœ†æ›²çº¿ä¸Šç‚¹çš„å‹ç¼©å’Œè§£å‹ç¼©æ–¹æ³•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202112132204090.(null)" alt="æ¤­åœ†æ›²çº¿ä¸Šç‚¹çš„å‹ç¼©ä¸è§£å‹ç¼©" /></p><h2 id="æ¤­åœ†æ›²çº¿ç­¾åè¿‡ç¨‹"><a class="markdownIt-Anchor" href="#æ¤­åœ†æ›²çº¿ç­¾åè¿‡ç¨‹"></a> æ¤­åœ†æ›²çº¿ç­¾åè¿‡ç¨‹</h2><p>åœ¨æ¨å¯¼æ¤­åœ†æ›²çº¿å…¬é’¥ç®—æ³•ä¹‹å‰ï¼Œè¿˜éœ€è¦å…ˆå›é¡¾äº†è§£ä¸‹æ¤­åœ†æ›²çº¿çš„ç­¾åè¿‡ç¨‹ã€‚</p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202112132204793.(null)" alt="" style="zoom:67%;" /><ol><li>éšæœºé€‰æ‹©ä¸€ä¸ªä¸´æ—¶ç§é’¥ k å€¼ï¼ŒèŒƒå›´åœ¨ [1, n-1]ï¼Œå…¶ä¸­ n ä¸ºæ¤­åœ†æ›²çº¿çš„é˜¶æ•°</li><li>è®¡ç®—ä¸´æ—¶å…¬é’¥ kG = (x , y)</li><li>è®¡ç®— r å€¼ï¼Œ r = x mod nï¼Œå¦‚æœ r ä¸º0åˆ™è¿”å›ç¬¬1æ­¥é‡æ–°é€‰æ‹©ç§é’¥ k</li><li>è®¡ç®—æ¶ˆæ¯æ•£åˆ—å€¼ï¼Œe = H(m)</li><li>è®¡ç®— s å€¼ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo>=</mo><msup><mi>k</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>e</mi><mo>+</mo><mi>d</mi><mi>r</mi><mo stretchy="false">)</mo><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">s = k^{-1} (e + dr) \ mod \ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace">Â </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mord mathdefault">n</span></span></span></span>ï¼Œå…¶ä¸­ d æ˜¯ç­¾åè€…çš„ç§é’¥ï¼Œå¦‚æœç®—å¾— s ä¸º0åˆ™è¿”å›ç¬¬ä¸€æ­¥é‡æ–°é€‰æ‹© k</li><li>æœ€ç»ˆå¾—åˆ°ç­¾å (r, s)</li></ol><p>å¯¹åº”ç­¾åçš„éªŒè¯è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202112132204418.(null)" alt="æ¤­åœ†æ›²çº¿ç­¾åçš„éªŒè¯è¿‡ç¨‹" style="zoom:67%;" /><ol><li>æ£€éªŒ r, s æ˜¯å¦æ»¡è¶³å–å€¼èŒƒå›´ [1, n-1]</li><li>è®¡ç®—æ¶ˆæ¯æ•£åˆ—å€¼ï¼Œ e  = H(m)</li><li>è®¡ç®— s çš„é€†å…ƒï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mo>=</mo><msup><mi>s</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">w = s^{-1} \ mod\  n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mord mathdefault">n</span></span></span></span></li><li>è®¡ç®— <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub><mo>=</mo><mi>e</mi><mi>w</mi><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>n</mi><mi mathvariant="normal">ï¼Œ</mi><msub><mi>u</mi><mn>2</mn></msub><mo>=</mo><mi>r</mi><mi>w</mi><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">u_1 = ew \ mod \ nï¼Œu_2 = rw \ mod \ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace">Â </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mord mathdefault">n</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace">Â </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mord mathdefault">n</span></span></span></span></li><li>è®¡ç®— <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>u</mi><mn>1</mn></msub><mi>G</mi><mo>+</mo><msub><mi>u</mi><mn>2</mn></msub><mi>Q</mi></mrow><annotation encoding="application/x-tex">X = (x, y) = u_1G + u_2Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">Q</span></span></span></span>ã€‚ å…¶ä¸­Gæ˜¯ç”Ÿæˆå…ƒï¼ŒQæ˜¯ç­¾åè€…çš„å…¬é’¥ã€‚å¦‚æœXä¸ºæ— ç©·è¿œç‚¹åˆ™éªŒç­¾å¤±è´¥ã€‚</li><li>è®¡ç®— v = x mod n</li><li>å¦‚æœ v = r åˆ™éªŒç­¾æˆåŠŸï¼Œå¦åˆ™å¤±è´¥</li></ol><p>æ¤­åœ†æ›²çº¿ç­¾åå’ŒéªŒè¯çš„æ­£ç¡®æ€§è¯æ˜å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>â‰¡</mo><msup><mi>s</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>e</mi><mo>+</mo><mi>d</mi><mi>r</mi><mo stretchy="false">)</mo><mo>â‰¡</mo><msup><mi>s</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>e</mi><mo>+</mo><msup><mi>s</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>r</mi><mi>d</mi><mo>â‰¡</mo><mi>w</mi><mi>e</mi><mo>+</mo><mi>w</mi><mi>r</mi><mi>d</mi><mo>â‰¡</mo><msub><mi>u</mi><mn>1</mn></msub><mo>+</mo><msub><mi>u</mi><mn>2</mn></msub><mi>d</mi><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k â‰¡ s^{-1}(e + dr) â‰¡ s^{-1}e + s^{-1}rd â‰¡we + wrd â‰¡ u_1 + u_2d (mod \ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.947438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.864108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><msub><mi>u</mi><mn>1</mn></msub><mi>G</mi><mo>+</mo><msub><mi>u</mi><mn>2</mn></msub><mi>Q</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>u</mi><mn>1</mn></msub><mo>+</mo><msub><mi>u</mi><mn>2</mn></msub><mi>d</mi><mo stretchy="false">)</mo><mi>G</mi><mo>=</mo><mi>k</mi><mi>G</mi></mrow><annotation encoding="application/x-tex">X = u_1G + u_2Q = (u_1+u_2d)G = kG</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">Q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">d</span><span class="mclose">)</span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">G</span></span></span></span></span></p><p>å³éªŒç­¾æ—¶è®¡ç®—çš„Xä¸ç­¾åæ—¶çš„ä¸´æ—¶å…¬é’¥æ˜¯ç›¸ç­‰çš„ï¼Œå¯¹åº”çš„ x åæ ‡ä¹Ÿç›¸ç­‰ï¼Œæ‰€ä»¥éªŒç­¾æ—¶åˆ¤æ–­ v å€¼æ˜¯å¦ç­‰äº r å€¼å³å¯ã€‚</p><h2 id="æ¤­åœ†æ›²çº¿å…¬é’¥æ¢å¤ç®—æ³•æ¨å¯¼"><a class="markdownIt-Anchor" href="#æ¤­åœ†æ›²çº¿å…¬é’¥æ¢å¤ç®—æ³•æ¨å¯¼"></a> æ¤­åœ†æ›²çº¿å…¬é’¥æ¢å¤ç®—æ³•æ¨å¯¼</h2><p>å¥½çš„ï¼Œå‰åºå‡†å¤‡éƒ½å·²ç»å®Œæˆï¼Œç°åœ¨æ¥æ¨å¯¼å…¬é’¥æ¢å¤ç®—æ³•ï¼Œè¿™é‡Œä¸»è¦ç”¨åˆ°äº†ç­¾åè¿‡ç¨‹ä¸­çš„ç›¸å…³è®¡ç®—ã€‚</p><p>è®¾ä¸´æ—¶å…¬é’¥ä¸ºRï¼Œå³R = kG</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo>=</mo><msup><mi>k</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>e</mi><mo>+</mo><mi>d</mi><mi>r</mi><mo stretchy="false">)</mo><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>n</mi><mspace width="1em"/><mo>â‡’</mo><mspace width="1em"/><mi>k</mi><mo>=</mo><msup><mi>s</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>e</mi><mo>+</mo><mi>d</mi><mi>r</mi><mo stretchy="false">)</mo><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">s = k^{-1} (e + dr) \ mod \ n  \quad â‡’ \quad k = s^{-1} (e + dr) \ mod \ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace">Â </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mrel">â‡’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace">Â </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mord mathdefault">n</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mi>G</mi><mo>=</mo><msup><mi>s</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>e</mi><mo>+</mo><mi>d</mi><mi>r</mi><mo stretchy="false">)</mo><mtext>Â </mtext><mi>G</mi><mspace width="1em"/><mo>â‡’</mo><mspace width="1em"/><mi>R</mi><mo>=</mo><msup><mi>s</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>e</mi><mi>G</mi><mo>+</mo><mi>r</mi><mi>Q</mi><mo stretchy="false">)</mo><mspace width="1em"/><mo>â‡’</mo><mspace width="1em"/><mi>Q</mi><mo>=</mo><msup><mi>r</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>s</mi><mi>R</mi><mo>âˆ’</mo><mi>e</mi><mi>G</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">kG = s^{-1} (e + dr) \ G  \quad â‡’ \quad R = s^{-1}(eG+rQ) \quad â‡’ \quad Q = r^{-1}(sR-eG)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace">Â </span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mrel">â‡’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">Q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mrel">â‡’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">Q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">G</span><span class="mclose">)</span></span></span></span></span></p><p>å› ä¸ºé€šè¿‡ r å€¼å¯ä»¥è®¡ç®—é€†å…ƒ r<sup>-1</sup>ï¼Œs å€¼å·²çŸ¥ï¼Œæ¶ˆæ¯æ•£åˆ—eå’Œç”Ÿæˆå…ƒGå·²çŸ¥ï¼Œä¸´æ—¶å…¬é’¥ R å¯ä»¥é€šè¿‡ rï¼ˆå¯¹åº”å…¬é’¥çš„xåæ ‡ï¼‰åˆ©ç”¨æ¤­åœ†æ›²çº¿ä¸Šç‚¹çš„è§£å‹ç¼©æ–¹æ³•æ±‚è§£ï¼Œå› æ­¤å…¬é’¥ Q æ˜¯å¯ä»¥è¢«è®¡ç®—å‡ºæ¥çš„ã€‚</p><p>åœ¨ <a href="http://www.secg.org/sec1-v2.pdf">æ¤­åœ†æ›²çº¿æ ‡å‡†</a> ä¸­ä¹Ÿæè¿°äº†æ™®é€šæ¤­åœ†æ›²çº¿å…¬é’¥æ¢å¤ç®—æ³•çš„å®ç°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202112132204527.(null)" alt="æ¤­åœ†æ›²çº¿æ ‡å‡†ä¸­å®šä¹‰çš„å…¬é’¥æ¢å¤ç®—æ³•" /></p><h1 id="sm2å…¬é’¥æ¢å¤ç®—æ³•ç¼–ç¨‹å®ç°"><a class="markdownIt-Anchor" href="#sm2å…¬é’¥æ¢å¤ç®—æ³•ç¼–ç¨‹å®ç°"></a> SM2å…¬é’¥æ¢å¤ç®—æ³•ç¼–ç¨‹å®ç°</h1><p>å› ä¸ºSM2å…¬é’¥ç­¾åç®—æ³•å’Œä»¥å¤ªåŠä¸Šæ¤­åœ†æ›²çº¿çš„ç­¾åç®—æ³•ä¸å¤ªä¸€æ ·ï¼Œæ‰€ä»¥éœ€è¦å…ˆäº†è§£SM2çš„ç­¾åè¿‡ç¨‹ï¼Œç„¶åå†æ¨å¯¼SM2å¯¹åº”çš„å…¬é’¥æ¢å¤ç®—æ³•ã€‚</p><h2 id="sm2ç­¾åä¸éªŒè¯è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#sm2ç­¾åä¸éªŒè¯è¿‡ç¨‹"></a> SM2ç­¾åä¸éªŒè¯è¿‡ç¨‹</h2><p>æ ¹æ®å®˜æ–¹çš„ <a href="http://www.oscca.gov.cn/sca/xxgk/2010-12/17/1002386/files/b791a9f908bb4803875ab6aeeb7b4e03.pdf">SM2 æ¤­åœ†æ›²çº¿å…¬é’¥å¯†ç ç®—æ³•</a> å¯ä»¥æ‰¾åˆ°SM2ç®—æ³•çš„ç­¾åè¿‡ç¨‹ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202112132204885.(null)" alt="SM2ç­¾åè®¡ç®—è¿‡ç¨‹" /></p><ul><li>è®¾å¾…ç­¾åçš„æ¶ˆæ¯ä¸ºMï¼Œä¸ºäº†è·å–æ¶ˆæ¯Mçš„æ•°å­—ç­¾å(r,s)ï¼Œä½œä¸ºç­¾åè€…çš„ç”¨æˆ·Aåº”å®ç°ä»¥ä¸‹è¿ç®—æ­¥éª¤ï¼š</li></ul><ol><li>ç½®  <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>M</mi><mo stretchy="true">â€¾</mo></mover><mo>=</mo><msub><mi>Z</mi><mi>A</mi></msub><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><mi>M</mi></mrow><annotation encoding="application/x-tex">\overline{M} = Z_A || M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833300000000001em;vertical-align:0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord">âˆ£</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span></li><li>è®¡ç®—æ¶ˆæ¯æ•£åˆ—å€¼ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mover accent="true"><mi>M</mi><mo stretchy="true">â€¾</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e = H(\overline{M})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.13333em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œå¹¶å°†eçš„æ•°æ®ç±»å‹è½¬æ¢ä¸ºæ•´æ•°</li><li>ç”¨éšæœºæ•°å‘ç”Ÿå™¨äº§ç”Ÿéšæœºæ•° kï¼Œå–å€¼èŒƒå›´ [1, n-1]</li><li>è®¡ç®—æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ï¼ˆä¹Ÿå°±æ˜¯ä¸´æ—¶å…¬é’¥ï¼‰ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi><mi>G</mi></mrow><annotation encoding="application/x-tex">(x_1,y_1) = kG</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">G</span></span></span></span>ï¼Œå¹¶å°†<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>æ•°æ®ç±»å‹è½¬æ¢ä¸ºæ•´æ•°</li><li>è®¡ç®— <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mo>=</mo><mo stretchy="false">(</mo><mi>e</mi><mo>+</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">r = (e+x_1) \ mod \ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace">Â </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mord mathdefault">n</span></span></span></span>ï¼Œè‹¥ r = 0 æˆ– r+k = n åˆ™ è¿”å›ç¬¬3æ­¥ï¼Œé‡æ–°é€‰æ‹©k</li><li>è®¡ç®— <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msub><mi>d</mi><mi>A</mi></msub><msup><mo stretchy="false">)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mtext>Â </mtext><mo separator="true">â‹…</mo><mtext>Â </mtext><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mi>r</mi><mtext>Â </mtext><mo separator="true">â‹…</mo><mtext>Â </mtext><msub><mi>d</mi><mi>A</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">s = ((1 + d_A)^{-1} \ Â· \ (k-r\ Â·\ d_A ) ) \ mod \ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace">Â </span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace">Â </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mord mathdefault">n</span></span></span></span>ï¼Œè‹¥s = 0 åˆ™è¿”å›ç¬¬3æ­¥</li><li>å°†rã€sç±»å‹è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå¾—åˆ°æ¶ˆæ¯Mçš„ç­¾å(r, s)</li></ol><p>SM2æ•°å­—ç­¾åçš„ç®—æ³•æµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºã€‚</p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202112132204893.(null)" width="60%" height="60%" align="middle" > </center><p><strong>SM2éªŒè¯è¿‡ç¨‹</strong></p><ul><li>ä¸ºäº†æ£€éªŒæ”¶åˆ°æ¶ˆæ¯Mâ€™åŠå…¶æ•°å­—ç­¾å(râ€™,sâ€™)ï¼Œä½œä¸ºéªŒè¯è€…çš„ç”¨æˆ·Båº”å®ç°ä»¥ä¸‹è¿ç®—æ­¥éª¤ï¼š</li></ul><ol><li>æ£€éªŒ râ€™ æ˜¯å¦åœ¨ [1, n-1] èŒƒå›´å†…</li><li>æ£€éªŒ sâ€™ æ˜¯å¦åœ¨ [1, n-1] èŒƒå›´å†…</li><li>ç½®<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mover accent="true"><mi>M</mi><mo stretchy="true">â€¾</mo></mover><mo mathvariant="normal">â€²</mo></msup><mo>=</mo><msub><mi>Z</mi><mi>A</mi></msub><mtext>Â </mtext><mi mathvariant="normal">âˆ£</mi><mi mathvariant="normal">âˆ£</mi><mtext>Â </mtext><msup><mi>M</mi><mo mathvariant="normal">â€²</mo></msup></mrow><annotation encoding="application/x-tex">\overline{M}&#x27; = Z_A \ || \  M&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.025122em;vertical-align:0em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.025122em;"><span style="top:-3.3362300000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mord">âˆ£</span><span class="mord">âˆ£</span><span class="mspace">Â </span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span></span></span></span></li><li>è®¡ç®—æ¶ˆæ¯æ•£åˆ—å€¼ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><msup><mover accent="true"><mi>M</mi><mo stretchy="true">â€¾</mo></mover><mo mathvariant="normal">â€²</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e = H(\overline{M}&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.275122em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833300000000001em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span><span style="top:-3.80333em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.025122em;"><span style="top:-3.3362300000000005em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>ï¼Œå¹¶å°†eçš„æ•°æ®ç±»å‹è½¬æ¢ä¸ºæ•´æ•°</li><li>å°† râ€™ , sâ€™ æ•°æ®ç±»å‹è½¬æ¢ä¸ºæ•´æ•°ï¼Œè®¡ç®— <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>r</mi><mo mathvariant="normal">â€²</mo></msup><mo>+</mo><msup><mi>s</mi><mo mathvariant="normal">â€²</mo></msup><mo stretchy="false">)</mo><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">t = (r&#x27; + s&#x27;) \ mod \ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace">Â </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mord mathdefault">n</span></span></span></span></li><li>è®¡ç®—æ¤­åœ†æ›²çº¿ç‚¹ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msubsup><mi>x</mi><mn>1</mn><mo mathvariant="normal">â€²</mo></msubsup><mo separator="true">,</mo><msubsup><mi>y</mi><mn>1</mn><mo mathvariant="normal">â€²</mo></msubsup><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">[</mo><msup><mi>s</mi><mo mathvariant="normal">â€²</mo></msup><mo stretchy="false">]</mo><mi>G</mi><mo>+</mo><mo stretchy="false">[</mo><mi>t</mi><mo stretchy="false">]</mo><msub><mi>P</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">(x_1&#x27;, y_1&#x27;) = [s&#x27;]G + [t]P_A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4518920000000004em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">t</span><span class="mclose">]</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>è®¡ç®—<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>e</mi><mo mathvariant="normal">â€²</mo></msup><mo>+</mo><msubsup><mi>x</mi><mn>1</mn><mo mathvariant="normal">â€²</mo></msubsup><mo stretchy="false">)</mo><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">R = (e&#x27; + x_1&#x27;) \ mod \ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace">Â </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mord mathdefault">n</span></span></span></span>ï¼Œæ£€éªŒ R = râ€™ æ˜¯å¦æˆç«‹ï¼Œå¦‚æœæˆç«‹åˆ™éªŒè¯é€šè¿‡ï¼Œå¦åˆ™éªŒè¯ä¸é€šè¿‡</li></ol><p>SM2æ•°å­—ç­¾åçš„éªŒè¯è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202206020848485.png" width="60%" height="60%" align="middle" > </center><h2 id="sm2å…¬é’¥æ¢å¤ç®—æ³•"><a class="markdownIt-Anchor" href="#sm2å…¬é’¥æ¢å¤ç®—æ³•"></a> SM2å…¬é’¥æ¢å¤ç®—æ³•</h2><p>è·Ÿæ¤­åœ†æ›²çº¿ä¸­æ–¹æ³•ç±»ä¼¼ï¼Œä»SM2ç­¾åç®—æ³•çš„ç›¸å…³è®¡ç®—ä¸­ï¼Œå¯ä»¥æ¨å¯¼å‡ºå¯¹åº”çš„å…¬é’¥æ¢å¤ç®—æ³• ã€‚</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msub><mi>d</mi><mi>A</mi></msub><msup><mo stretchy="false">)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mtext>Â </mtext><mo separator="true">â‹…</mo><mtext>Â </mtext><mo stretchy="false">(</mo><mi>k</mi><mo>âˆ’</mo><mi>r</mi><mtext>Â </mtext><mo separator="true">â‹…</mo><mtext>Â </mtext><msub><mi>d</mi><mi>A</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>n</mi><mspace width="1em"/><mo>â‡’</mo></mrow><annotation encoding="application/x-tex">s = ((1 + d_A)^{-1} \ Â· \ (k-r\ Â·\ d_A ) ) \ mod \ n \quad â‡’  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace">Â </span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace">Â </span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace">Â </span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace">Â </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mrel">â‡’</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mspace width="1em"/><mi>k</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msub><mi>d</mi><mi>A</mi></msub><mo stretchy="false">)</mo><mi>s</mi><mo>+</mo><mi>r</mi><msub><mi>d</mi><mi>A</mi></msub><mo>=</mo><mo stretchy="false">(</mo><mi>s</mi><mo>+</mo><mo stretchy="false">(</mo><mi>s</mi><mo>+</mo><mi>r</mi><mo stretchy="false">)</mo><msub><mi>d</mi><mi>A</mi></msub><mo stretchy="false">)</mo><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">\quad k= (1+d_A)s + rd_A = (s + (s+r)d_A) \ mod \ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace">Â </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mord mathdefault">n</span></span></span></span></span></p><p>è®¾ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>=</mo><mi>k</mi><mi>G</mi><mspace width="1em"/><mspace width="1em"/><mi>t</mi><mo>=</mo><mi>r</mi><mo>+</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">R = kG \quad\quad t = r+s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">s</span></span></span></span>ï¼Œ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mi>s</mi><mo>+</mo><mo stretchy="false">(</mo><mi>s</mi><mo>+</mo><mi>r</mi><mo stretchy="false">)</mo><msub><mi>d</mi><mi>A</mi></msub><mo stretchy="false">)</mo><mi>G</mi><mspace width="1em"/><mo>â‡’</mo><mspace width="1em"/><mi>R</mi><mo>=</mo><mi>s</mi><mi>G</mi><mo>+</mo><mi>t</mi><msub><mi>P</mi><mi>A</mi></msub><mspace width="1em"/><mo>â‡’</mo><mspace width="1em"/><msub><mi>P</mi><mi>A</mi></msub><mo>=</mo><msup><mi>t</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>R</mi><mo>âˆ’</mo><mi>s</mi><mi>G</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">kG = (s+(s+r)d_A)G \quad â‡’ \quad R = sG+tP_A \quad â‡’ \quad P_A = t^{-1}(R-sG)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mrel">â‡’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault">t</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mrel">â‡’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">G</span><span class="mclose">)</span></span></span></span></span></p><p>å› ä¸ºrï¼Œså€¼å¯ä»¥è®¡ç®—å¾—åˆ°tï¼Œè¿›è€Œå¾—åˆ°tçš„é€†å…ƒ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>t</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">t^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>ï¼ŒR å¯ä»¥é€šè¿‡<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mi>r</mi><mo>âˆ’</mo><mi>e</mi><mtext>Â </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext>Â </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">x_1 = r - e \ mod \ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mspace">Â </span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mspace">Â </span><span class="mord mathdefault">n</span></span></span></span>ï¼Œå¹¶åˆ©ç”¨æ¤­åœ†æ›²çº¿çš„å‹ç¼©æ–¹æ³•è®¡ç®—å¾—åˆ°ã€‚så’ŒGä¹Ÿéƒ½å·²çŸ¥ï¼Œå› æ­¤ï¼Œæ˜¯å¯ä»¥è®¡ç®—å¾—åˆ°å…¬é’¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">P_A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><h2 id="ä»£ç ç»“æ„è¯´æ˜"><a class="markdownIt-Anchor" href="#ä»£ç ç»“æ„è¯´æ˜"></a> ä»£ç ç»“æ„è¯´æ˜</h2><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202112132204132.(null)" width="30%" height="30%" align="middle" > </center>é™„ä»¶ä»£ç ç»“æ„å¦‚ä¸Šå›¾æ‰€ç¤ºï¼š<ul><li>cryptoppï¼šè¯¥ç›®å½•æ˜¯å¼€æºåº“CryptoPP çš„æ–‡ä»¶ç›®å½•</li><li>testï¼šæµ‹è¯•æ–‡ä»¶ç›®å½•ï¼Œå­˜æ”¾æµ‹è¯•ç±»TestCryptoï¼Œä¸»è¦æµ‹è¯•CryptoPPçš„ç›¸å…³APIï¼Œæ¨¡æ‹Ÿæ¤­åœ†æ›²çº¿çš„ç­¾åã€éªŒè¯ä»¥åŠå…¬é’¥æ¢å¤ç®—æ³•ï¼›è¿˜æœ‰å°±æ˜¯æµ‹è¯•è‡ªå®šä¹‰å®ç°çš„SM2 çš„ç­¾åã€éªŒè¯ä»¥åŠå…¬é’¥æ¢å¤ç®—æ³•</li><li>utilï¼šè¯¥ç›®å½•ä¸‹ï¼Œutilç±»æ˜¯cryptoppæ–¹æ³•çš„å°è£…ï¼ŒSM2æ˜¯è‡ªå®šä¹‰å®ç°ç±»</li><li>main.cppï¼šå®ç°æµ‹è¯•å‡½æ•°</li></ul><h2 id="ç¼–ç¨‹å®ç°è¯´æ˜"><a class="markdownIt-Anchor" href="#ç¼–ç¨‹å®ç°è¯´æ˜"></a> ç¼–ç¨‹å®ç°è¯´æ˜</h2><p>å½“äº†è§£äº†ç®—æ³•åŸç†ä¹‹åï¼Œå®ç°èµ·æ¥å°±æ¯”è¾ƒå®¹æ˜“äº†ï¼Œåªè¦æ ¹æ®å…¬å¼è¿›è¡Œç¼–ç¨‹å³å¯ã€‚åœ¨å®ç°ä¸Šå€ŸåŠ©äº†å¼€æºçš„CryptoPPåº“ï¼Œæ¥æ”¯æŒå¯†ç å­¦é‡Œä¸­åŸè¯­æ“ä½œï¼Œæ¯”å¦‚æœ‰é™åŸŸä¸Šçš„è®¡ç®—ï¼Œæ¤­åœ†æ›²çº¿ä¸Šç‚¹çš„è¿ç®—ç­‰ã€‚ä»£ç ä¸Šä¸»è¦æ˜¯å®ç°äº†ä¸€ä¸ª<code>SM2</code>ç±»ï¼Œå®šä¹‰äº†ç­¾åï¼ŒéªŒè¯å’Œå…¬é’¥æ¢å¤ç®—æ³•ï¼Œå…·ä½“çš„ä»£ç å®ç°è¿™é‡Œä¸å†å±•ç¤ºï¼Œå¯è§ä»£ç é™„ä»¶ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// å€ŸåŠ©CryptoPPå¼€æºåº“ å®ç° SM2ç®—æ³•</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SM2</span> &#123;</span><br><span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// ç­¾åï¼šè¾“å…¥çš„æ¶ˆæ¯å’Œè¾“å‡ºçš„ç­¾åæ•°æ®  å‡ä¸ºå­—èŠ‚æ ¼å¼ï¼Œç­¾åæ˜¯ç”±(r,s)å„32å­—èŠ‚æ‹¼æ¥å¾—åˆ°çš„</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Sign</span><span class="hljs-params">(<span class="hljs-keyword">const</span> std::string &amp;message, std::string &amp;signature)</span></span>;<br>    <span class="hljs-comment">// éªŒè¯ï¼šè¾“å…¥çš„æ¶ˆæ¯å’Œç­¾åå‡ä¸ºå­—èŠ‚æ ¼å¼ï¼Œè¾“å‡ºä¸ºboolå€¼</span><br>    <span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">Verify</span><span class="hljs-params">(<span class="hljs-keyword">const</span> std::string &amp;message, <span class="hljs-keyword">const</span> std::string &amp;signature)</span></span>;<br>    <span class="hljs-comment">// å…¬é’¥æ¢å¤ç®—æ³•ï¼Œè¾“å…¥æ¶ˆæ¯ï¼Œç­¾åï¼ˆr,sï¼‰ï¼Œyå€¼æ˜¯å¦ä¸ºå¥‡æ•°ï¼Œ è¾“å‡ºpubKey å­—èŠ‚æ ¼å¼ï¼Œç”±(x,y) å„32å­—èŠ‚æ‹¼æ¥è€Œæˆ</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">RecoverPublicKey</span><span class="hljs-params">(<span class="hljs-keyword">const</span> std::string &amp;message, <span class="hljs-keyword">bool</span> isOdd,</span></span><br><span class="hljs-params"><span class="hljs-function">                                 <span class="hljs-keyword">const</span> Integer &amp;r, <span class="hljs-keyword">const</span> Integer &amp;s, std::string &amp;pubKey)</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-keyword">private</span>:</span><br><span class="hljs-function">    std::shared_ptr&lt;ECP&gt; ecp;</span>                   <span class="hljs-comment">// SM2 å¯¹åº”çš„æ¤­åœ†æ›²çº¿</span><br>    std::shared_ptr&lt;Integer&gt; p;<br>    std::shared_ptr&lt;Integer&gt; a;<br>    std::shared_ptr&lt;Integer&gt; b;<br>    std::shared_ptr&lt;Integer&gt; privateKey;        <span class="hljs-comment">// ç§é’¥</span><br>    std::shared_ptr&lt;ECPPoint&gt; publicKey;        <span class="hljs-comment">// å…¬é’¥ï¼Œä»¥Pointè¡¨ç¤º</span><br>    std::shared_ptr&lt;ECPPoint&gt; generator;        <span class="hljs-comment">// ç”Ÿæˆå…ƒ ç‚¹</span><br>    std::shared_ptr&lt;Integer&gt; n;                 <span class="hljs-comment">// ç”Ÿæˆå…ƒ å¯¹åº”çš„é˜¶æ•°</span><br>    std::string ZA;                             <span class="hljs-comment">// æ‚å‡‘å€¼ï¼Œå­—èŠ‚å½¢å¼ ï¼šZA = H256(ENTL_A âˆ¥ ID_A âˆ¥ a âˆ¥ b âˆ¥ xG âˆ¥ yG âˆ¥ xA âˆ¥ yA)</span><br><br>    <span class="hljs-comment">// é»˜è®¤æ„é€ å‡½æ•°ï¼Œä½¿ç”¨å®˜æ–¹å‚æ•°</span><br>    <span class="hljs-built_in">SM2</span>();<br>    <span class="hljs-comment">// åˆå§‹åŒ–æ›²çº¿å‚æ•°ï¼Œä½¿ç”¨å®˜æ–¹å‚æ•°</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span>;<br>    <span class="hljs-comment">// è®¡ç®—æ‚å‡‘å€¼ ZA</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ComputeZA</span><span class="hljs-params">()</span></span>;<br>&#125;;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// æµ‹è¯• SM2 ç±»</span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">TestCrypto::Test_SM2</span><span class="hljs-params">()</span> </span>&#123;<br>    SM2 sm2;<br>    std::string message = <span class="hljs-string">&quot;message digest&quot;</span>;<br>    std::string signature;<br>    Integer k = Util::<span class="hljs-built_in">StringToInteger</span>(<span class="hljs-string">&quot;59276E27D506861A16680F3AD9C02DCCEF3CC1FA3CDBE4CE6D54B80DEAC1BC21&quot;</span>);<br>    sm2.<span class="hljs-built_in">Sign</span>(message, signature, k);<br><br>    Integer r = Util::<span class="hljs-built_in">StringToInteger</span>(Util::<span class="hljs-built_in">HexEncode</span>(signature.<span class="hljs-built_in">substr</span>(<span class="hljs-number">0</span>,<span class="hljs-number">32</span>)));<br>    Integer s = Util::<span class="hljs-built_in">StringToInteger</span>(Util::<span class="hljs-built_in">HexEncode</span>(signature.<span class="hljs-built_in">substr</span>(<span class="hljs-number">32</span>,<span class="hljs-number">32</span>)));<br><br>    <span class="hljs-comment">// æ‰“å°è¾“å‡ºï¼Œå¯¹ç…§çœŸå®æ•°æ®</span><br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”æµ‹è¯•SM2 ç­¾åç®—æ³•â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;çœŸå® r:&quot;</span> &lt;&lt; <span class="hljs-string">&quot;F5A03B0648D2C4630EEAC513E1BB81A15944DA3827D5B74143AC7EACEEE720B3&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;è®¡ç®— r:&quot;</span> &lt;&lt; Util::<span class="hljs-built_in">HexEncode</span>(signature.<span class="hljs-built_in">substr</span>(<span class="hljs-number">0</span>,<span class="hljs-number">32</span>)) &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;çœŸå® s:&quot;</span> &lt;&lt; <span class="hljs-string">&quot;B1B6AA29DF212FD8763182BC0D421CA1BB9038FD1F7F42D4840B69C485BBC1AA&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;è®¡ç®— s:&quot;</span> &lt;&lt; Util::<span class="hljs-built_in">HexEncode</span>(signature.<span class="hljs-built_in">substr</span>(<span class="hljs-number">32</span>,<span class="hljs-number">32</span>)) &lt;&lt; endl;<br><br><br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”æµ‹è¯•SM2 éªŒè¯ç­¾åâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;message: &quot;</span> &lt;&lt; message &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;r: &quot;</span> &lt;&lt; Util::<span class="hljs-built_in">IntegerToString</span>(r) &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;s: &quot;</span> &lt;&lt; Util::<span class="hljs-built_in">IntegerToString</span>(s) &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;ç­¾åéªŒè¯ç»“æœ: &quot;</span> &lt;&lt; boolalpha &lt;&lt; sm2.<span class="hljs-built_in">Verify</span>(message, signature ) &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”æµ‹è¯•SM2 å…¬é’¥æ¢å¤ç®—æ³•â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”&quot;</span> &lt;&lt; endl;<br><br>    std::string pubKey;<br>    sm2.<span class="hljs-built_in">RecoverPublicKey</span>(message,<span class="hljs-literal">false</span>, r, s,pubKey);<br>    <span class="hljs-function">ECP::Point <span class="hljs-title">P</span><span class="hljs-params">(Util::StringToInteger(Util::HexEncode(pubKey.substr(<span class="hljs-number">0</span>,<span class="hljs-number">32</span>))),</span></span><br><span class="hljs-params"><span class="hljs-function">                 Util::StringToInteger(Util::HexEncode(pubKey.substr(<span class="hljs-number">32</span>,<span class="hljs-number">32</span>))))</span></span>;<br>    cout &lt;&lt; <span class="hljs-string">&quot;çœŸå®å…¬é’¥ P.x:&quot;</span> &lt;&lt; <span class="hljs-string">&quot;09F9DF311E5421A150DD7D161E4BC5C672179FAD1833FC076BB08FF356F35020&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;æ¢å¤å…¬é’¥ P.x:&quot;</span> &lt;&lt; Util::<span class="hljs-built_in">IntegerToString</span>(P.x) &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;çœŸå®å…¬é’¥ P.y:&quot;</span> &lt;&lt; <span class="hljs-string">&quot;CCEA490CE26775A52DC6EA718CC1AA600AED05FBF35E084A6632F6072DA9AD13&quot;</span> &lt;&lt; endl;<br>    cout &lt;&lt; <span class="hljs-string">&quot;æ¢å¤å…¬é’¥ P.y:&quot;</span> &lt;&lt; Util::<span class="hljs-built_in">IntegerToString</span>(P.y) &lt;&lt; endl;<br>&#125;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•æ•°æ®æ¥è‡ªï¼š<a href="https://blog.csdn.net/beebeeyoung/article/details/91063358">SM2 è‡ªæ£€æ•°æ®</a></p><p>æµ‹è¯•ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202112132204273.(null)" alt="æµ‹è¯•ç»“æœè¾“å‡º" /></p><p class="note note-primary">ä»£ç ä¸Šä¼ è‡³Githubä»“åº“ï¼šhttps://github.com/2017zhangyuxuan/Learn-Blockchain</p><h1 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> å‚è€ƒèµ„æ–™</h1><p><a href="http://www.oscca.gov.cn/sca/xxgk/2010-12/17/1002386/files/b791a9f908bb4803875ab6aeeb7b4e03.pdf">SM2 æ¤­åœ†æ›²çº¿å…¬é’¥å¯†ç ç®—æ³•</a></p><p><a href="https://blog.csdn.net/beebeeyoung/article/details/91063358">SM2 è‡ªæ£€æ•°æ®</a></p><p><a href="http://www.gmbz.org.cn/main/viewfile/2018010802371372251.html">SM2 å®˜æ–¹å‚æ•°å®šä¹‰</a></p><p><a href="https://github.com/inoutcode/ethereum_book/blob/master/%E7%AC%AC%E4%B8%83%E7%AB%A0.asciidoc#%E7%AD%BE%E5%90%8D%E5%89%8D%E7%BC%80%E5%80%BCv%E5%92%8C%E5%85%AC%E9%92%A5%E6%81%A2%E5%A4%8D">ä»¥å¤ªåŠï¼šç­¾åå‰ç¼€å€¼ï¼ˆvï¼‰å’Œå…¬é’¥æ¢å¤</a></p><p><a href="https://www.cryptopp.com/docs/ref/class_integer.html">CryptoPP å®˜æ–¹æ–‡æ¡£</a></p><p><a href="http://www.secg.org/sec1-v2.pdf">æ¤­åœ†æ›²çº¿æ ‡å‡†</a></p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>å¯†ç å­¦</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SM2</tag>
      
      <tag>æ¤­åœ†æ›²çº¿å¯†ç ç®—æ³•</tag>
      
      <tag>å…¬é’¥æ¢å¤ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€æ¯”ç‰¹å¸ä¸“é¢˜04ã€‘æ¤­åœ†æ›²çº¿å¯†ç ç®—æ³•åœ¨æ¯”ç‰¹å¸ä¸­çš„åº”ç”¨</title>
    <link href="/2021/11/27/2021-11/2021-11-27%20%E6%AF%94%E7%89%B9%E5%B8%81%E4%B8%93%E9%A2%9804-%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%9C%A8%E6%AF%94%E7%89%B9%E5%B8%81%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/"/>
    <url>/2021/11/27/2021-11/2021-11-27%20%E6%AF%94%E7%89%B9%E5%B8%81%E4%B8%93%E9%A2%9804-%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%9C%A8%E6%AF%94%E7%89%B9%E5%B8%81%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h1><ul><li>ä¸åŒäºä»¥å¤ªåŠçš„è´¦æˆ·æ¨¡å‹ï¼Œæ¯”ç‰¹å¸é‡‡ç”¨çš„æ˜¯UTXOæ¨¡å‹ï¼Œæ¯”ç‰¹å¸çš„æ‰€æœ‰æƒæ˜¯é€šè¿‡<em>æ•°å­—å¯†é’¥ã€æ¯”ç‰¹å¸åœ°å€å’Œæ•°å­—ç­¾å</em>æ¥ç¡®å®šçš„ã€‚æ•°å­—å¯†é’¥å®é™…ä¸Šå¹¶ä¸å­˜å‚¨åœ¨ç½‘ç»œä¸­ï¼Œè€Œæ˜¯ç”±ç”¨æˆ·ç”Ÿæˆä¹‹åï¼Œå­˜å‚¨åœ¨ä¸€ä¸ªå«åš<em>é’±åŒ…</em>çš„æ–‡ä»¶æˆ–ç®€å•çš„æ•°æ®åº“ä¸­ã€‚ç”¨æˆ·é’±åŒ…ä¸­çš„æ•°å­—å¯†é’¥å®Œå…¨ç‹¬ç«‹äºæ¯”ç‰¹å¸åè®®ï¼Œå¯ç”±ç”¨æˆ·çš„é’±åŒ…è½¯ä»¶ç”Ÿæˆå¹¶ç®¡ç†ï¼Œè€Œæ— éœ€å‚ç…§åŒºå—é“¾æˆ–è®¿é—®äº’è”ç½‘ã€‚</li><li>å¯†é’¥æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œç”±ç§é’¥å’Œå…¬é’¥æ‰€ç»„æˆã€‚å…¬é’¥å°±åƒé“¶è¡Œçš„å¸å·ï¼Œè€Œç§é’¥å°±åƒé“¶è¡Œå¡çš„å¯†ç æˆ–æ”¯ç¥¨çš„ç­¾åã€‚æ¯”ç‰¹å¸çš„ç”¨æˆ·å¾ˆå°‘ä¼šç›´æ¥çœ‹åˆ°æ•°å­—å¯†é’¥ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå®ƒä»¬å­˜å‚¨åœ¨é’±åŒ…æ–‡ä»¶å†…ï¼Œç”±æ¯”ç‰¹å¸é’±åŒ…è½¯ä»¶è¿›è¡Œç®¡ç†ã€‚</li><li>åœ¨æ¯”ç‰¹å¸äº¤æ˜“çš„æ”¯ä»˜ç¯èŠ‚ï¼Œæ”¶æ¬¾äººçš„å…¬é’¥ç”±æ•°å­—æŒ‡çº¹è¡¨ç¤ºï¼Œç§°ä¸º<em>æ¯”ç‰¹å¸åœ°å€</em>ï¼Œå°±åƒæ”¯ç¥¨ä¸Šæ”¶æ¬¾äººåç§° ï¼ˆå³â€œä»˜ç»™è°çš„è´¦æˆ·â€ï¼‰ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¯”ç‰¹å¸åœ°å€ç”±å…¬é’¥ç”Ÿæˆå¹¶ä¸ä¹‹å¯¹åº”ã€‚ç„¶è€Œï¼Œå¹¶éæ‰€æœ‰æ¯”ç‰¹å¸åœ°å€éƒ½ä»£è¡¨å…¬é’¥ï¼› ä¹Ÿå¯ä»¥ä»£è¡¨å…¶ä»–æ”¯ä»˜å¯¹è±¡ï¼Œè­¬å¦‚è„šæœ¬ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ¯”ç‰¹å¸åœ°å€å°±å¯ä»¥æŠ½è±¡æˆèµ„é‡‘æ¥æ”¶è€…ï¼Œä½¿å¾—äº¤æ˜“æ›´çµæ´»ï¼Œå°±åƒçº¸è´¨æ”¯ç¥¨ï¼šå¯ä»¥æ”¯ä»˜åˆ°ä¸ªäººè´¦æˆ·æˆ–å…¬å¸è´¦æˆ·ï¼Œä¹Ÿå¯ä»¥æ”¯ä»˜è´¦å•å’Œç°é‡‘ã€‚æ¯”ç‰¹å¸åœ°å€æ˜¯å¯†é’¥è¢«ç”¨æˆ·èƒ½å¤Ÿçœ‹åˆ°çš„å”¯ä¸€å½¢å¼ï¼Œå› ä¸ºè¿™ä¸ªåœ°å€å°±æ˜¯éœ€è¦å‘Šè¯‰åˆ«äººçš„ã€‚</li><li>ä»¥ä¸Šæ˜¯å¯¹æ¯”ç‰¹å¸å’Œå¯†ç å­¦åº”ç”¨çš„ç®€å•æ¦‚è¿°ï¼Œè€Œæœ¬ç¯‡æ–‡ç« å°†é‡ç‚¹å…³æ³¨æ¤­åœ†æ›²çº¿å¯†ç ç®—æ³•åœ¨æ¯”ç‰¹å¸ä¸­çš„åº”ç”¨ï¼Œå°†ä»ä¸ä¹‹å¯†åˆ‡ç›¸å…³çš„å¯†é’¥ä¸åœ°å€ã€é’±åŒ…ã€äº¤æ˜“ä¸‰éƒ¨åˆ†ä»‹ç»ç›¸å…³å†…å®¹ã€‚</li></ul><h1 id="å¯†é’¥ä¸åœ°å€"><a class="markdownIt-Anchor" href="#å¯†é’¥ä¸åœ°å€"></a> å¯†é’¥ä¸åœ°å€</h1><ul><li>åœ¨æ¯”ç‰¹å¸ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ç”¨å…¬é’¥å¯†ç å­¦æŠ€æœ¯åˆ›å»ºä¸€ä¸ªå¯†é’¥å¯¹ï¼Œç”¨äºæ§åˆ¶å¯¹æ¯”ç‰¹å¸çš„è®¿é—®ã€‚å¯†é’¥å¯¹åŒ…æ‹¬ä¸€ä¸ªç§é’¥ï¼Œå’Œç”±å…¶è¡ç”Ÿå‡ºçš„å”¯ä¸€çš„å…¬é’¥ã€‚å…¬é’¥ç”¨äºæ¥æ”¶æ¯”ç‰¹å¸ï¼Œè€Œç§é’¥ç”¨äºæ”¯ä»˜æ—¶è¿›è¡Œäº¤æ˜“ç­¾åã€‚</li><li>æ¯”ç‰¹å¸æ­£æ˜¯ä½¿ç”¨æ¤­åœ†æ›²çº¿å¯†ç ç®—æ³•ä½œä¸ºå…¶å…¬é’¥å¯†ç å­¦çš„åŸºç¡€ã€‚</li></ul><h2 id="ç§é’¥ä¸å…¬é’¥ä¸åœ°å€"><a class="markdownIt-Anchor" href="#ç§é’¥ä¸å…¬é’¥ä¸åœ°å€"></a> ç§é’¥ä¸å…¬é’¥ä¸åœ°å€</h2><p>ä¸€ä¸ªæ¯”ç‰¹å¸é’±åŒ…ä¸­åŒ…å«ä¸€ç³»åˆ—çš„å¯†é’¥å¯¹ï¼Œæ¯ä¸ªå¯†é’¥å¯¹åŒ…æ‹¬ä¸€ä¸ªç§é’¥å’Œä¸€ä¸ªå…¬é’¥ã€‚ç§é’¥ï¼ˆ<em>k</em>ï¼‰æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œé€šå¸¸æ˜¯éšæœºé€‰å‡ºçš„ã€‚åŸºäºç§é’¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ¤­åœ†æ›²çº¿ä¹˜æ³•è¿™ä¸ªå•å‘å¯†ç å‡½æ•°äº§ç”Ÿä¸€ä¸ªå…¬é’¥ï¼ˆ<em>K</em>ï¼‰ã€‚åŸºäºå…¬é’¥ï¼ˆ<em>K</em>ï¼‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå•å‘å¯†ç å“ˆå¸Œå‡½æ•°ç”Ÿæˆæ¯”ç‰¹å¸åœ°å€ï¼ˆ<em>A</em>ï¼‰ã€‚ç§é’¥ã€å…¬é’¥å’Œæ¯”ç‰¹å¸åœ°å€ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111271547812.(null)" alt="ç§é’¥ã€å…¬é’¥å’Œæ¯”ç‰¹å¸åœ°å€ä¹‹é—´çš„å…³ç³»" /></p><h2 id="ç§é’¥"><a class="markdownIt-Anchor" href="#ç§é’¥"></a> ç§é’¥</h2><ul><li><p>ç§é’¥å°±æ˜¯ä¸€ä¸ªéšæœºé€‰å‡ºçš„æ•°å­—è€Œå·²ã€‚æ‹¥æœ‰å’Œæ§åˆ¶äº†ç§é’¥ï¼Œå°±ç›¸å½“äºæ§åˆ¶äº†è¯¥ç§é’¥å¯¹åº”çš„æ¯”ç‰¹å¸åœ°å€ä¸­çš„æ‰€æœ‰èµ„é‡‘ã€‚é€šè¿‡è¯æ˜æ¯”ç‰¹å¸äº¤æ˜“ä¸­èµ„é‡‘çš„æ‰€æœ‰æƒï¼Œç§é’¥å¯ä»¥ç”ŸæˆèŠ±è´¹è¯¥ç¬”èµ„é‡‘çš„ç­¾åã€‚</p></li><li><p><em><strong>ä»ä¸€ä¸ªéšæœºæ•°ç”Ÿæˆç§é’¥</strong></em> æ˜¯ç”Ÿæˆå¯†é’¥çš„ç¬¬ä¸€æ­¥ä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ­¥ï¼Œæ˜¯è¦æ‰¾åˆ°è¶³å¤Ÿå®‰å…¨çš„ç†µæºï¼Œå³éšæœºæ€§æ¥æºã€‚ç”Ÿæˆä¸€ä¸ªæ¯”ç‰¹å¸ç§é’¥åœ¨æœ¬è´¨ä¸Šä¸â€œåœ¨1åˆ°2<sup>256</sup>ä¹‹é—´é€‰ä¸€ä¸ªæ•°å­—â€æ— å¼‚ã€‚åªè¦é€‰å–çš„ç»“æœæ˜¯ä¸å¯é¢„æµ‹æˆ–ä¸å¯é‡å¤çš„ï¼Œé‚£ä¹ˆé€‰å–æ•°å­—çš„å…·ä½“æ–¹æ³•å¹¶ä¸é‡è¦ã€‚æ¯”ç‰¹å¸è½¯ä»¶ä½¿ç”¨æ“ä½œç³»ç»Ÿåº•å±‚çš„éšæœºæ•°ç”Ÿæˆå™¨æ¥äº§ç”Ÿ256ä½çš„ç†µï¼ˆéšæœºæ€§ï¼‰ã€‚</p></li><li><p>æ›´å‡†ç¡®åœ°è¯´ï¼Œç§é’¥å¯ä»¥æ˜¯1å’Œn-1ä¹‹é—´çš„ä»»ä½•æ•°å­—ï¼Œå…¶ä¸­næ˜¯ä¸€ä¸ªå¸¸æ•°ï¼ˆn=1.158 * 10<sup>77</sup>ï¼Œç•¥å°äº2<sup>256</sup>ï¼‰ï¼Œå¹¶è¢«å®šä¹‰ä¸ºç”±æ¯”ç‰¹å¸æ‰€ä½¿ç”¨çš„æ¤­åœ†æ›²çº¿çš„é˜¶ï¼ˆæ¯”ç‰¹å¸ä½¿ç”¨çš„æ˜¯ <strong>secp256k1</strong> æ ‡å‡†æ‰€å®šä¹‰çš„ä¸€ç§ç‰¹æ®Šçš„æ¤­åœ†æ›²çº¿å’Œä¸€ç³»åˆ—æ•°å­¦å¸¸æ•°ã€‚è¯¥æ ‡å‡†ç”±ç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢ ï¼ˆNISTï¼‰å»ºç«‹ï¼‰ã€‚è¦ç”Ÿæˆè¿™æ ·çš„ä¸€ä¸ªç§é’¥ï¼Œæˆ‘ä»¬éšæœºé€‰æ‹©ä¸€ä¸ª256ä½çš„æ•°å­—ï¼Œå¹¶æ£€æŸ¥å®ƒæ˜¯å¦å°äºn-1ã€‚ä»ç¼–ç¨‹çš„è§’åº¦æ¥çœ‹ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡åœ¨ä¸€ä¸ªå¯†ç å­¦å®‰å…¨çš„éšæœºæºä¸­å–å‡ºä¸€é•¿ä¸²éšæœºå­—èŠ‚ï¼Œå¯¹å…¶ä½¿ç”¨SHA256å“ˆå¸Œç®—æ³•è¿›è¡Œè¿ç®—ï¼Œè¿™æ ·å°±å¯ä»¥æ–¹ä¾¿åœ°äº§ç”Ÿä¸€ä¸ª256ä½çš„æ•°å­—ã€‚å¦‚æœè¿ç®—ç»“æœå°äºnï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªåˆé€‚çš„ç§é’¥ã€‚å¦åˆ™ï¼Œæˆ‘ä»¬å°±ç”¨å¦ä¸€ä¸ªéšæœºæ•°å†é‡å¤ä¸€æ¬¡ã€‚</p></li><li><h2 id="å…¬é’¥"><a class="markdownIt-Anchor" href="#å…¬é’¥"></a> å…¬é’¥</h2></li></ul><p>ä»¥ä¸€ä¸ªéšæœºç”Ÿæˆçš„ç§é’¥<em>k</em>ä¸ºèµ·ç‚¹ï¼Œå°†å…¶ä¹˜ä»¥æ›²çº¿ä¸Šä¸€ä¸ªé¢„å®šçš„ç‚¹ï¼Œå«åš<em>ç”Ÿæˆç‚¹G</em>å¾—åˆ°æ›²çº¿ä¸Šçš„å¦ä¸€ç‚¹ï¼Œè¿™å°±æ˜¯ç›¸åº”çš„å…¬é’¥ <em>K</em>ã€‚ç”Ÿæˆç‚¹æ˜¯secp256k1æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œæ¯”ç‰¹å¸å¯†é’¥çš„ç”Ÿæˆç‚¹éƒ½æ˜¯ç›¸åŒçš„ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><mo>=</mo><mi>k</mi><mo>âˆ—</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">K = k * G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span></span></span></span></span></p><p>å…¶ä¸­<em>k</em>æ˜¯ç§é’¥ï¼Œ<em>G</em>æ˜¯ç”Ÿæˆç‚¹ï¼Œåœ¨è¯¥æ›²çº¿ä¸Šæ‰€å¾—çš„ç‚¹<em>K</em>æ˜¯å…¬é’¥ã€‚å› ä¸ºæ‰€æœ‰æ¯”ç‰¹å¸ç”¨æˆ·çš„ç”Ÿæˆç‚¹æ˜¯ç›¸åŒçš„ï¼Œä¸€ä¸ªç§é’¥<em>k</em>ä¹˜ä»¥<em>G</em>å°†å¾—åˆ°ç›¸åŒçš„å…¬é’¥<em>K</em>ã€‚<em>k</em>å’Œ<em>K</em>ä¹‹é—´çš„å…³ç³»æ˜¯å›ºå®šçš„ï¼Œä½†åªèƒ½å•å‘è¿ç®—ï¼Œå³ä»<em>k</em>å¾—åˆ°<em>K</em>ã€‚è¿™å°±æ˜¯å¯ä»¥æŠŠæ¯”ç‰¹å¸åœ°å€ï¼ˆ<em>K</em>çš„è¡ç”Ÿï¼‰ ä¸ä»»ä½•äººå…±äº«è€Œä¸ä¼šæ³„éœ²ç§é’¥ï¼ˆ<em>k</em>ï¼‰çš„åŸå› ã€‚</p><p>å®ç°äº†æ¤­åœ†æ›²çº¿ä¹˜æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨éšæœºäº§ç”Ÿçš„ç§é’¥<em>k</em>å’Œä¸ç”Ÿæˆç‚¹<em>G</em>ç›¸ä¹˜å¾—åˆ°å…¬é’¥<em>K</em>ã€‚ä¸‹é¢ç»™å‡ºä¸€ä¸ªç®€å•ä¾‹å­ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Bash">k = 1E99423A4ED27608A15A2616A2B0E9E52CED330AC530EDCC32C8FFC6A526AEDD <br>K = k * G<br><br>å…¬é’¥Kè¢«å®šä¹‰ä¸ºä¸€ä¸ªç‚¹ K = (x, y) ï¼Œå…¶ä¸­ï¼š<br>x = F028892BAD7ED57D2FB57BF33081D5CFCF6F9ED3D3D7F159C2E2FFF579DC341A <br>y = 07CF33DA18BD734C600B96A72BBC4749D5141C90EC8AC328AE52DDFE2E505BDB<br></code></pre></td></tr></table></figure><h2 id="æ¯”ç‰¹å¸åœ°å€"><a class="markdownIt-Anchor" href="#æ¯”ç‰¹å¸åœ°å€"></a> æ¯”ç‰¹å¸åœ°å€</h2><p>æ¯”ç‰¹å¸åœ°å€å¯ç”±å…¬é’¥ç»è¿‡å•å‘å“ˆå¸Œç®—æ³•å¾—åˆ°ã€‚å¯†ç å­¦å“ˆå¸Œç®—æ³•æ˜¯ä¸€ç§å•å‘å‡½æ•°ï¼Œæ¥æ”¶ä»»æ„é•¿åº¦çš„è¾“å…¥äº§ç”ŸæŒ‡çº¹æˆ–å“ˆå¸Œã€‚å“ˆå¸Œå‡½æ•°åœ¨æ¯”ç‰¹å¸ä¸­è¢«å¹¿æ³›ä½¿ç”¨ ï¼šæ¯”ç‰¹å¸åœ°å€ã€è„šæœ¬åœ°å€ä»¥åŠåœ¨æŒ–çŸ¿ä¸­çš„å·¥ä½œé‡è¯æ˜ç®—æ³•ã€‚ç”±å…¬é’¥ç”Ÿæˆæ¯”ç‰¹å¸åœ°å€æ—¶ä½¿ç”¨çš„ç®—æ³•æ˜¯Secure Hash Algorithm (SHA)å’Œthe RACE Integ rity Primitives Evaluation Message Digest (RIPEMD)ï¼Œå…·ä½“æ¥è¯´æ˜¯SHA256å’ŒRIPEMD160ã€‚</p><p>ä»¥å…¬é’¥ <em>K</em> ä¸ºè¾“å…¥ï¼Œè®¡ç®—å…¶SHA256å“ˆå¸Œå€¼ï¼Œå¹¶ä»¥æ­¤ç»“æœè®¡ç®—RIPEMD160 å“ˆå¸Œå€¼ï¼Œå¾—åˆ°ä¸€ä¸ªé•¿åº¦ä¸º160ä½ï¼ˆ20å­—èŠ‚ï¼‰çš„æ•°å­—ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>=</mo><mi>R</mi><mi>I</mi><mi>P</mi><mi>E</mi><mi>M</mi><mi>D</mi><mn>160</mn><mo stretchy="false">(</mo><mi>S</mi><mi>H</mi><mi>A</mi><mn>256</mn><mo stretchy="false">(</mo><mi>K</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A = RIPEMD160(SHA256(K))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord">1</span><span class="mord">6</span><span class="mord">0</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault">A</span><span class="mord">2</span><span class="mord">5</span><span class="mord">6</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p>å…¬å¼ä¸­ï¼Œ<em>K</em>æ˜¯å…¬é’¥ï¼Œ<em>A</em>æ˜¯ç”Ÿæˆçš„æ¯”ç‰¹å¸åœ°å€ã€‚</p><p>é€šå¸¸ç”¨æˆ·è§åˆ°çš„æ¯”ç‰¹å¸åœ°å€æ˜¯ç»è¿‡â€œ<strong>Base58Check</strong>â€ç¼–ç çš„ï¼ˆå‚è§ä¸‹é¢çš„â€œBase58Check Encodingâ€ä¸€å›¾ï¼‰ï¼Œè¿™ç§ç¼–ç ä½¿ç”¨äº†58ä¸ªå­—ç¬¦ï¼ˆBase58æ•°å­—ç³»ç»Ÿï¼‰å’Œæ ¡éªŒç ï¼Œæé«˜äº†å¯è¯»æ€§ã€é¿å…æ­§ä¹‰å¹¶æœ‰æ•ˆé˜²æ­¢äº†åœ¨åœ°å€è½¬å½•å’Œè¾“å…¥ä¸­äº§ç”Ÿçš„é”™è¯¯ã€‚Base58Checkç¼–ç ä¹Ÿè¢«ç”¨äºæ¯”ç‰¹å¸çš„å…¶å®ƒåœ°æ–¹ï¼Œä¾‹å¦‚æ¯”ç‰¹å¸åœ°å€ã€ç§é’¥ã€åŠ å¯†çš„å¯†é’¥å’Œè„šæœ¬å“ˆå¸Œä¸­ï¼Œç”¨æ¥æé«˜å¯è¯»æ€§å’Œå½•å…¥çš„æ­£ç¡®æ€§ã€‚</p><center class="half"> <img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111271513682.(null)" width="300"></img><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111271513117.(null)" width="400"></img></center><hr /><ul><li><strong>WIF(Wallet import format)</strong> é’±åŒ…å¯¼å…¥æ ¼å¼ï¼Œ(ä¹Ÿè¢«ç§°ä¸ºç”µå­é’±åŒ…çš„å¯¼å‡ºæ ¼å¼)æ˜¯ä¸€ç§ç§æœ‰çš„ ESCDSA (æ¤­åœ†æ›²çº¿ç­¾åç®—æ³•) ç§˜é’¥ï¼Œæ„åœ¨ä½¿ç§é’¥æ›´å®¹æ˜“å¤åˆ¶ï¼Œç§é’¥çš„å„ç§å½¢å¼å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</li></ul><table><thead><tr><th>Type</th><th>Prefix</th><th>Description</th></tr></thead><tbody><tr><td>Raw</td><td>None</td><td>32å­—èŠ‚</td></tr><tr><td>Hex</td><td>None</td><td>64ä½Hexç¼–ç </td></tr><tr><td>WIF</td><td>5</td><td>ä½¿ç”¨Base58Checkè¿›è¡Œç¼–ç </td></tr><tr><td>WIF-compressed</td><td>K or L</td><td>ä½¿ç”¨Base58Checkè¿›è¡Œç¼–ç ï¼Œä½†åœ¨ç¼–ç å‰å¢åŠ åç¼€0x01</td></tr></tbody></table><table><thead><tr><th style="text-align:left">Format</th><th>Private key</th></tr></thead><tbody><tr><td style="text-align:left">Hex</td><td>1e99423a4ed27608a15a2616a2b0e9e52ced330ac530edcc32c8ffc6a526aedd</td></tr><tr><td style="text-align:left">WIF</td><td>5J3mBbAH58CpQ3Y5RNJpUKPE62SQ5tfcvU2JpbnkeyhfsYB1Jcn</td></tr><tr><td style="text-align:left">WIF-compressed</td><td>KxFC1jmwwCoACiCAWZ3eXa96mBM6tb3TYzGmf6YwgdGWZgawvrtJ</td></tr></tbody></table><ul><li>å…¬é’¥ä¹Ÿå¯ä»¥ç”¨å¤šç§ä¸åŒæ ¼å¼æ¥è¡¨ç¤ºï¼Œé€šå¸¸åˆ†ä¸ºéå‹ç¼©æ ¼å¼æˆ–å‹ç¼©æ ¼å¼å…¬é’¥è¿™ä¸¤ç§å½¢å¼ã€‚</li><li>æˆ‘ä»¬ä»å‰æ–‡å¯çŸ¥ï¼Œå…¬é’¥æ˜¯åœ¨æ¤­åœ†æ›²çº¿ä¸Šçš„ä¸€ä¸ªç‚¹ï¼Œç”±ä¸€å¯¹åæ ‡ï¼ˆxï¼Œyï¼‰ç»„æˆã€‚å…¬é’¥é€šå¸¸è¡¨ç¤ºä¸ºå‰ç¼€04ç´§æ¥ç€ä¸¤ä¸ª256ä½çš„æ•°å­—ã€‚å…¶ä¸­ä¸€ä¸ª256ä½æ•°å­—æ˜¯å…¬é’¥çš„xåæ ‡ï¼Œå¦ä¸€ä¸ª256ä½æ•°å­—æ˜¯yåæ ‡ã€‚å‰ç¼€04æ˜¯æ˜¯éå‹ç¼©æ ¼å¼å…¬é’¥ï¼Œ å‹ç¼©æ ¼å¼å…¬é’¥æ˜¯ä»¥02æˆ–è€…03å¼€å¤´ã€‚</li><li>æ­£å¦‚å‰é¢æ‰€è¯´ï¼Œä¸€ä¸ªå…¬é’¥æ˜¯ä¸€ä¸ªæ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹(x, y)ã€‚è€Œæ¤­åœ†æ›²çº¿å®é™…æ˜¯ä¸€ä¸ªæ•°å­¦æ–¹ç¨‹ï¼Œæ›²çº¿ä¸Šçš„ç‚¹å®é™…æ˜¯è¯¥æ–¹ç¨‹çš„ä¸€ä¸ªè§£ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“äº†å…¬é’¥çš„xåæ ‡ï¼Œå°±å¯ä»¥é€šè¿‡è§£æ–¹ç¨‹æ¥å¾—åˆ°yåæ ‡ã€‚è¿™å¯ä»¥è®©æˆ‘ä»¬åªå­˜å‚¨å…¬é’¥çš„xåæ ‡ï¼Œç•¥å»yåæ ‡ï¼Œä»è€Œå°†å…¬é’¥çš„å¤§å°å’Œå­˜å‚¨ç©ºé—´å‡å°‘äº†256ä½ã€‚è¿™æ ·æ¯ç¬”äº¤æ˜“éœ€è¦çš„å­—èŠ‚æ•°å°±ä¼šå‡å°‘è®¸å¤šï¼Œéšç€æ—¶é—´æ¨ç§»ï¼Œå°±èƒ½ä¿å­˜æ›´å¤šçš„äº¤æ˜“æ•°æ®ã€‚</li><li>æœªå‹ç¼©æ ¼å¼å…¬é’¥ä½¿ç”¨04ä½œä¸ºå‰ç¼€ï¼Œè€Œå‹ç¼©æ ¼å¼å…¬é’¥æ˜¯ä»¥02æˆ–03ä½œä¸ºå‰ç¼€ã€‚ä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ä¸ªå‰ç¼€ï¼šå½“<strong>æˆ‘ä»¬åœ¨ç´ æ•°pé˜¶çš„æœ‰é™åŸŸä¸Šä½¿ç”¨äºŒè¿›åˆ¶ç®—æœ¯è®¡ç®—æ¤­åœ†æ›²çº¿çš„æ—¶å€™ï¼Œyåæ ‡å¯èƒ½æ˜¯å¶æ•°æˆ–è€…å¥‡æ•°</strong>ã€‚å› æ­¤ï¼Œä¸ºäº†åŒºåˆ†yåæ ‡çš„ä¸¤ç§å¯èƒ½å€¼ï¼Œåœ¨ç”Ÿæˆå‹ç¼©æ ¼å¼å…¬é’¥æ—¶ï¼Œå¦‚æœyæ˜¯å¶æ•°ï¼Œåˆ™ä½¿ç”¨02ä½œä¸ºå‰ç¼€ï¼›å¦‚æœyæ˜¯å¥‡æ•°ï¼Œåˆ™ä½¿ç”¨03ä½œä¸ºå‰ç¼€ã€‚è¿™æ ·å°±å¯ä»¥è®©è½¯ä»¶èƒ½å¤Ÿæ ¹æ®xåæ ‡ï¼Œæ­£ç¡®æ¨å¯¼å‡ºå¯¹åº”çš„yåæ ‡ï¼Œä»è€Œå°†å…¬é’¥è§£å‹ç¼©ä¸ºåœ¨æ¤­åœ†æ›²çº¿ä¸Šç‚¹çš„å®Œæ•´åæ ‡ã€‚ä¸‹å›¾é˜é‡Šäº†å…¬é’¥å‹ç¼©çš„è¿‡ç¨‹ï¼š</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111271547830.(null)"  height="50%" width="50%" align="center"> </img></p><p class="note note-primary"> æ³¨æ„ï¼šå®é™…ä¸Šâ€œå‹ç¼©æ ¼å¼ç§é’¥â€æ˜¯ä¸€ç§åç§°ä¸Šçš„è¯¯å¯¼ï¼Œå› ä¸ºå½“ç§é’¥ä½¿ç”¨WIFå‹ç¼©æ ¼å¼å¯¼å‡ºæ—¶ï¼Œä¸ä½†æ²¡æœ‰å‹ç¼©ï¼Œåè€Œæ¯”â€œéå‹ç¼©æ ¼å¼â€ç§é’¥é•¿å‡ºä¸€ä¸ªå­—èŠ‚ã€‚è¿™ä¸ªå¤šå‡ºæ¥çš„ä¸€ä¸ªå­—èŠ‚æ˜¯ç§é’¥è¢«åŠ äº†åç¼€01ï¼Œç”¨ä»¥è¡¨æ˜è¯¥ç§é’¥æ˜¯æ¥è‡ªäºä¸€ä¸ªè¾ƒæ–°çš„é’±åŒ…ï¼Œåªèƒ½è¢«ç”¨æ¥ç”Ÿæˆå‹ç¼©å…¬é’¥ã€‚ç§é’¥å¹¶æ²¡æœ‰å‹ç¼©çš„ï¼Œä¹Ÿä¸èƒ½è¢«å‹ç¼©ã€‚â€œå‹ç¼©ç§é’¥â€å®é™…ä¸Šè¡¨ç¤ºâ€œåªèƒ½ç”Ÿæˆå‹ç¼©å…¬é’¥çš„ç§é’¥â€ï¼Œè€Œâ€œéå‹ç¼©ç§é’¥â€ç”¨æ¥è¡¨æ˜â€œåªèƒ½ç”Ÿæˆéå‹ç¼©å…¬é’¥çš„ç§é’¥â€ã€‚ä¸ºé¿å…æ›´å¤šè¯¯è§£ï¼Œåº”è¯¥åªå¯ä»¥è¯´å¯¼å‡ºæ ¼å¼ æ˜¯â€œWIFå‹ç¼©æ ¼å¼â€æˆ–è€…â€œWIFâ€ï¼Œè€Œä¸èƒ½è¯´è¿™ä¸ªç§é’¥æ˜¯â€œå‹ç¼©â€çš„ã€‚</p><h1 id="é’±åŒ…"><a class="markdownIt-Anchor" href="#é’±åŒ…"></a> é’±åŒ…</h1><ul><li>å¹¿ä¹‰ä¸Šï¼Œé’±åŒ…æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œä¸ºç”¨æˆ·æä¾›äº¤äº’ç•Œé¢ã€‚é’±åŒ…æ§åˆ¶ç”¨æˆ·èµ„é‡‘è®¿é—®æƒé™ï¼Œç®¡ç†å¯†é’¥å’Œåœ°å€ï¼Œè·Ÿè¸ªä½™é¢ä»¥åŠåˆ›å»ºå’Œç­¾åäº¤æ˜“ã€‚</li><li>ç‹­ä¹‰ä¸Šï¼Œâ€œé’±åŒ…â€æ˜¯æŒ‡ç”¨äºå­˜å‚¨å’Œç®¡ç†ç”¨æˆ·å¯†é’¥çš„æ•°æ®ç»“æ„ã€‚</li><li>åœ¨è¿™ä¸€å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ›´å…³æ³¨é’±åŒ…æ˜¯å¯†é’¥å®¹å™¨çš„è¿™ä¸€è§’åº¦ï¼Œæ¢ç´¢æ¤­åœ†æ›²çº¿ç®—æ³•åœ¨å…¶ä¸­çš„åº”ç”¨ã€‚</li></ul><h2 id="hdåˆ†å±‚é’±åŒ…"><a class="markdownIt-Anchor" href="#hdåˆ†å±‚é’±åŒ…"></a> HDåˆ†å±‚é’±åŒ…</h2><p>æ ¹æ®é’±åŒ…åŒ…å«çš„å¤šä¸ªå¯†é’¥ä¹‹é—´æ˜¯å¦æœ‰å…³ç³»ï¼Œä¸»è¦åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š</p><ul><li><p>ç¬¬ä¸€ç§ç±»å‹æ˜¯<em>éç¡®å®šæ€§é’±åŒ…ï¼ˆnondeterministic walletï¼‰</em>ï¼Œå…¶ä¸­æ¯ä¸ªå¯†é’¥éƒ½æ˜¯ä»éšæœºæ•°ç‹¬ç«‹ç”Ÿæˆçš„ã€‚å¯†é’¥å½¼æ­¤æ— å…³ã€‚</p></li><li><p>ç¬¬äºŒç§ç±»å‹æ˜¯ç¡®å®šæ€§é’±åŒ…ï¼ˆdeterministic walletï¼‰ï¼Œå…¶ä¸­æ‰€æœ‰çš„å¯†é’¥éƒ½æ˜¯ä»ä¸€ä¸ªä¸»å¯†é’¥æ´¾ç”Ÿå‡ºæ¥ï¼Œè¿™ä¸ªä¸»å¯†é’¥å³ä¸ºç§å­ï¼ˆseedï¼‰ã€‚è¯¥ç±»å‹é’±åŒ…ä¸­æ‰€æœ‰å¯†é’¥éƒ½ç›¸äº’å…³è”ï¼Œå¦‚æœæœ‰åŸå§‹ç§å­ï¼Œåˆ™å¯ä»¥å†æ¬¡ç”Ÿæˆå…¨éƒ¨å¯†é’¥ã€‚ç¡®å®šæ€§é’±åŒ…ä¸­ä½¿ç”¨äº†è®¸å¤šä¸åŒçš„å¯†é’¥æ¨å¯¼æ–¹æ³•ã€‚æœ€å¸¸ç”¨çš„æ¨å¯¼æ–¹æ³•æ˜¯ä½¿ç”¨æ ‘çŠ¶ç»“æ„ï¼Œç§°ä¸ºåˆ†å±‚ç¡®å®šæ€§ï¼ˆhierarchical deterministicï¼‰é’±åŒ…æˆ–HDé’±åŒ…ã€‚</p><ul><li>ç›¸æ¯”éšæœºï¼ˆä¸ç¡®å®šæ€§ï¼‰å¯†é’¥ï¼ŒHDé’±åŒ…æœ‰ä¸¤ä¸ªä¸»è¦çš„ä¼˜åŠ¿ã€‚ç¬¬ä¸€ï¼Œæ ‘çŠ¶ç»“æ„å¯ä»¥è¢«ç”¨æ¥è¡¨è¾¾é™„åŠ çš„ç»„ç»‡å«ä¹‰ï¼Œæ¯”å¦‚å­å¯†é’¥çš„ç‰¹å®šåˆ†æ”¯ç”¨æ¥æ¥æ”¶äº¤æ˜“æ”¶å…¥æ¬¾é¡¹ï¼Œå¦ä¸€ä¸ªåˆ†æ”¯ç”¨æ¥è´Ÿè´£æ¥æ”¶å¯¹å¤–ä»˜æ¬¾çš„æ‰¾é›¶ã€‚å¯†é’¥çš„åˆ†æ”¯ä¹Ÿå¯ä»¥ç”¨äºå…¬å¸è®¾ç½®ï¼Œå°†ä¸åŒçš„åˆ†æ”¯åˆ†é…ç»™éƒ¨é—¨ã€å­å…¬å¸ã€ç‰¹å®šåŠŸèƒ½æˆ–ä¼šè®¡ç±»åˆ«ã€‚</li><li>HDé’±åŒ…çš„ç¬¬äºŒä¸ªå¥½å¤„æ˜¯ï¼Œç”¨æˆ·å¯ä»¥åˆ›å»ºä¸€ç³»åˆ—å…¬é’¥ï¼Œè€Œä¸éœ€è¦è®¿é—®å¯¹åº”çš„ç§é’¥ã€‚è¿™æ ·ï¼ŒHDé’±åŒ…å°±èƒ½ç”¨åœ¨ä¸å®‰å…¨çš„æœåŠ¡å™¨ä¸Šï¼Œæˆ–è€…ä»…ä½œä¸ºæ¥æ”¶ç”¨é€”ï¼Œå®ƒä¸ºæ¯ä¸ªäº¤æ˜“å‘å¸ƒä¸åŒçš„å…¬é’¥ã€‚å…¬é’¥ä¸éœ€è¦è¢«é¢„å…ˆåŠ è½½æˆ–è€…æå‰è¡ç”Ÿï¼ŒæœåŠ¡å™¨ä¹Ÿä¸éœ€è¦æœ‰ç”¨æ¥æ”¯ä»˜çš„ç§é’¥ã€‚</li></ul></li></ul><hr /><p>HDé’±åŒ…å¯†é’¥çš„ç”Ÿæˆè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šé€šè¿‡è®°åŠ©è¯å’Œ Salt ç”ŸæˆRoot Seedç§å­ï¼Œå†é€šè¿‡HMAC-SHA512ï¼ˆå•å‘å“ˆå¸Œï¼‰ï¼Œè¾“å‡º512ä½bitsï¼Œå…¶ä¸­å·¦256ä½ä½œä¸ºä¸»ç§é’¥ï¼ˆé€šè¿‡æ¤­åœ†æ›²çº¿å¯†ç ç®—æ³•å¯ç”Ÿæˆä¸»å…¬é’¥ï¼Œé‡‡ç”¨çš„æ˜¯å‹ç¼©å…¬é’¥æ ¼å¼264bitsï¼‰ï¼Œå³256ä½ä½œä¸ºä¸»é“¾ç ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111271513500.(null)" width="70%" height="70%" alight="center"> </img></p><blockquote><p>HDé’±åŒ…çš„ç§å­ç”Ÿæˆè¿‡ç¨‹ï¼Œå¹¶æ²¡æœ‰æ¶‰åŠæ¤­åœ†æ›²çº¿å¯†ç ç®—æ³•ï¼Œå› æ­¤è¿™é‡Œä¸å†å±•å¼€ä»‹ç»ï¼Œå…·ä½“è¿‡ç¨‹å¯å‚è€ƒï¼š<br /><a href="https://github.com/tianmingyun/MasterBitcoin2CN/blob/master/ch05.md#523-%E4%BB%8E%E5%8A%A9%E8%AE%B0%E8%AF%8D%E7%94%9F%E6%88%90%E7%A7%8D%E5%AD%90">HDåˆ†å±‚é’±åŒ… ç§å­ç”Ÿæˆè¿‡ç¨‹</a></p></blockquote><h2 id="è¡ç”Ÿå­ç§˜é’¥"><a class="markdownIt-Anchor" href="#è¡ç”Ÿå­ç§˜é’¥"></a> è¡ç”Ÿå­ç§˜é’¥</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111271513760.(null)" width="60%" height="60%" aligh="center"> </img></p><ul><li>å­ç§˜é’¥çš„è¡ç”Ÿæ¨å¯¼å¦‚ä¸Šå›¾æ‰€ç¤ºï¼šçˆ¶å…¬é’¥ + çˆ¶é“¾ç  + ç´¢å¼•ä½œä¸ºè¾“å…¥ï¼Œ è¾“å‡º512bitsï¼Œå³256bitsä½œä¸ºå­é“¾ç ï¼›å·¦256bits ä¸ çˆ¶ç§˜é’¥ç»“åˆå¾—åˆ°å­ç§˜é’¥</li><li>è¡ç”Ÿå¾—åˆ°çš„å­ç§é’¥ï¼Œæ¨æ–­ä¸å‡ºå…„å¼Ÿå§å¦¹çš„ç§é’¥ï¼›å¦‚æœæ²¡æœ‰å­é“¾ç ï¼Œä¹Ÿæ— æ³•æ¨æ–­å‡ºå­™å¯†é’¥</li><li>å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„æ¨å¯¼å…¬å¼ï¼š</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs PowerShell">child_private_key == (parent_private_key + lefthand_hash_output) % G<br>child_public_key  == point( (parent_private_key + lefthand_hash_output) % G )<br>child_public_key  == point(child_private_key) == parent_public_key + point(lefthand_hash_output)<br></code></pre></td></tr></table></figure><ul><li><p>å¯ä»¥çœ‹åˆ°ï¼Œå­å…¬é’¥çš„æ¨å¯¼æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡ç§é’¥æ¨å¯¼ï¼Œä¸€ä¸ªæ˜¯ç›´æ¥é€šè¿‡å…¬é’¥æ¨å¯¼</p></li><li><p>æ­£å¦‚æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„ï¼Œå¯†é’¥è¡ç”Ÿå‡½æ•°å¯ä»¥è¢«ç”¨æ¥åˆ›é€ å¯†é’¥æ ‘ä¸Šä»»ä½•å±‚çº§çš„å­å¯†é’¥ï¼ŒåŸºäºä»¥ä¸‹ä¸‰ä¸ªè¾“å…¥é‡ï¼šå¯†é’¥ï¼Œé“¾ç ä»¥åŠæƒ³è¦çš„å­å¯†é’¥çš„ç´¢å¼•ã€‚</p><p>å¯†é’¥ä»¥åŠé“¾ç è¿™ä¸¤ä¸ªé‡è¦çš„éƒ¨åˆ†è¢«ç»“åˆä¹‹åï¼Œå°±å«åš</p><p><em>æ‰©å±•å¯†é’¥ï¼ˆextended keyï¼‰</em></p><p>ã€‚æœ¯è¯­â€œæ‰©å±•å¯†é’¥â€ä¹Ÿè¢«è®¤ä¸ºæ˜¯â€œå¯æ‰©å±•çš„å¯†é’¥â€ï¼Œå› ä¸ºè¿™ç§å¯†é’¥å¯ä»¥ç”¨æ¥è¡ç”Ÿå­å¯†é’¥ã€‚</p><ul><li>æ‰©å±•å¯†é’¥ç¼–ç ç”¨çš„ Base58Checkä½¿ç”¨ç‰¹æ®Šçš„ç‰ˆæœ¬å·ï¼ŒBase58ç¼–ç å­—ç¬¦å‰ç¼€åˆ†åˆ«ä¸ºâ€œxprvâ€å’Œâ€œxpubâ€</li></ul></li></ul><center class="half"> <img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111271513936.(null)" width="300"></img><img src="https://kwaj2xdt3y.feishu.cn/space/api/box/stream/download/asynccode/?code=MDYwZjYzODI5NTFjOThiYTQ3MzZiM2JhMjAyNWIxNTBfazRleGFLaGlDbFVMOHlsZzllb01uelhQVkJ3SUo5RnJfVG9rZW46Ym94Y256d2Z4M2ZhWWR1NDZmeEtiV2hJOHRlXzE2Mzc5OTcyMDk6MTYzODAwMDgwOV9WNA" width="300"></img></center><ul><li>ä¸Šé¢å·¦å›¾ä¸ºå¸¸è§„è¡ç”Ÿï¼Œç›´æ¥ä½¿ç”¨çˆ¶å…¬é’¥è¡ç”Ÿå­å…¬é’¥ï¼Œè¿™æ ·æ¨å¯¼çš„å¥½å¤„å°±æ˜¯ä¸ç”¨è®¿é—®ç§é’¥ï¼Œå°±èƒ½è¡ç”Ÿæ‰©å±•å‡ºå­å…¬é’¥ï¼Œç”¨äºæ”¶æ¬¾ï¼Œå¯ä»¥ç”¨åœ¨å®‰å…¨æ€§è¾ƒå¼±çš„webæœåŠ¡å™¨ä¸Š<ul><li>ä½†æ˜¯è¿™ç§å¸¸è§„çš„æ‰©å±•æ–¹å¼å­˜åœ¨çš„é—®é¢˜æ˜¯ï¼Œå½“ä¸€ä¸ªæ”»å‡»è€…å¾—åˆ°çˆ¶å…¬é’¥å’Œå¯¹åº”çš„é“¾ç æ—¶ï¼Œä»–å¯ä»¥è¡ç”Ÿæ‰©å±•å‡ºä¹‹åæ‰€æœ‰çš„å­å…¬é’¥å’Œå¯¹åº”é“¾ç ï¼Œå¦‚æœæ­¤æ—¶å†è·å¾—å­ç§é’¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ¨å¯¼å‡ºè¿™ä¸ªå­ç§é’¥ä¹‹åæ‰€æœ‰çš„ç§é’¥ï¼ˆå­™ç§é’¥ç­‰ï¼‰ï¼Œç”šè‡³å¯èƒ½ä¼šæ¨å¯¼å‡ºçˆ¶ç§é’¥</li></ul></li></ul><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">child_private_key == <span class="hljs-comment">(parent_private_key + lefthand_hash_output)</span> <span class="hljs-meta">%</span> G<br></code></pre></td></tr></table></figure><ul><li>å³å›¾ä¸ºå¼ºåŒ–è¡ç”Ÿï¼Œä¸ä½¿ç”¨çˆ¶å…¬é’¥ï¼Œç›´æ¥ç”¨çˆ¶ç§é’¥ + çˆ¶é“¾ç  + ç´¢å¼• ä½œä¸ºè¾“å…¥ï¼Œå¾—åˆ°è¾“å‡ºï¼ˆè¿™æ ·å°±ç®—å­å…¬é’¥å’Œå­é“¾ç æš´éœ²äº†ï¼Œä¹Ÿä¸èƒ½æ¨å¯¼å‡ºçˆ¶ç§é’¥ï¼‰<ul><li>ç®€å•æ¥è¯´ï¼Œå¦‚æœæƒ³åˆ©ç”¨xpubçš„ä¾¿æ·æ¥è¡ç”Ÿå…¬é’¥çš„åˆ†æ”¯ï¼Œåˆä¸æƒ³å†’æ³„éœ²é“¾ç çš„é£é™©ï¼Œ å°±è¯¥ä»å¼ºåŒ–çˆ¶å¯†é’¥ï¼Œè€Œä¸æ˜¯å¸¸è§„çˆ¶å¯†é’¥è¡ç”Ÿã€‚æœ€å¥½çš„æ–¹å¼æ˜¯ï¼Œä¸ºäº†é¿å…ä¸»å¯†é’¥æ³„éœ²ï¼Œä¸»å¯†é’¥æ‰€è¡ç”Ÿçš„ç¬¬ä¸€å±‚çº§çš„å­å¯†é’¥æ€»æ˜¯é€šè¿‡å¼ºåŒ–è¡ç”Ÿå¾—æ¥ã€‚</li></ul></li></ul><h1 id="äº¤æ˜“"><a class="markdownIt-Anchor" href="#äº¤æ˜“"></a> äº¤æ˜“</h1><ul><li>æ¯”ç‰¹å¸äº¤æ˜“æ˜¯æ¯”ç‰¹å¸ç³»ç»Ÿä¸­æœ€é‡è¦çš„éƒ¨åˆ†ã€‚æ¯”ç‰¹å¸ä¸­çš„å…¶ä»–ä¸€åˆ‡éƒ½æ˜¯ä¸ºäº†ç¡®ä¿äº¤æ˜“å¯ä»¥è¢«åˆ›å»ºã€åœ¨ç½‘ç»œä¸Šä¼ æ’­ã€éªŒè¯ï¼Œå¹¶æœ€ç»ˆæ·»åŠ åˆ°å…¨å±€äº¤æ˜“åˆ†ç±»è´¦æœ¬ï¼ˆåŒºå—é“¾ï¼‰ä¸­ã€‚æ¯”ç‰¹å¸äº¤æ˜“çš„æœ¬è´¨æ˜¯æ•°æ®ç»“æ„ï¼Œè¿™äº›æ•°æ®ç»“æ„æ˜¯å¯¹æ¯”ç‰¹å¸äº¤æ˜“å‚ä¸è€…ä»·å€¼ä¼ é€’çš„ç¼–ç ã€‚æ¯”ç‰¹å¸åŒºå—é“¾æ˜¯ä¸€æœ¬å…¨å±€å¤å¼è®°è´¦æ€»è´¦ç°¿ï¼Œæ¯ä¸ªæ¯”ç‰¹å¸äº¤æ˜“éƒ½æ˜¯åœ¨æ¯”ç‰¹å¸åŒºå—é“¾ä¸Šçš„ä¸€ä¸ªå…¬å¼€è®°å½•ã€‚</li><li>äº¤æ˜“ä¸»è¦çš„åŠŸèƒ½å°±æ˜¯å®ç°æ¯”ç‰¹å¸çš„è½¬ç§»ï¼Œè€Œå…¶å®ç°è¿‡ç¨‹å°±ç”¨åˆ°äº†å¯†ç å­¦æŠ€æœ¯ã€‚æ”¯ä»˜æ¯”ç‰¹å¸æ—¶ï¼Œæ¯”ç‰¹å¸çš„å½“å‰æ‰€æœ‰è€…éœ€è¦åœ¨äº¤æ˜“ä¸­æäº¤å…¶å…¬é’¥å’Œç­¾åï¼ˆæ¯æ¬¡äº¤æ˜“çš„ç­¾åéƒ½ä¸åŒï¼Œä½†éƒ½ç”±åŒä¸€ä¸ªç§é’¥ç”Ÿæˆï¼‰ã€‚é’ˆå¯¹å±•ç¤ºçš„å…¬é’¥å’Œç­¾åï¼Œæ¯”ç‰¹å¸ç½‘ç»œä¸­çš„æ‰€æœ‰äººéƒ½å¯ä»¥éªŒè¯è¯¥äº¤æ˜“æœ‰æ•ˆå¹¶äºˆä»¥æ¥å—ï¼Œä»è€Œç¡®è®¤æ”¯ä»˜è€…å¯¹è¯¥äº¤æ˜“ä¸­çš„æ¯”ç‰¹å¸çš„æ‰€æœ‰æƒã€‚</li><li>è¿™ä¸€å°èŠ‚ä¸­ï¼Œå°†ä»‹ç»äº¤æ˜“çš„åŸºæœ¬æ•°æ®ç»“æ„ï¼Œå…³æ³¨æ¯”ç‰¹å¸äº¤æ˜“è¿‡ç¨‹çš„å®ç°ï¼Œå¹¶èšç„¦å¯†ç å­¦æŠ€æœ¯çš„ä½¿ç”¨ã€‚</li></ul><h2 id="äº¤æ˜“çš„è¾“å‡º"><a class="markdownIt-Anchor" href="#äº¤æ˜“çš„è¾“å‡º"></a> äº¤æ˜“çš„è¾“å‡º</h2><p>æ¯ä¸€ç¬”æ¯”ç‰¹å¸äº¤æ˜“éƒ½ä¼šåˆ›é€ è¾“å‡ºï¼Œå¹¶è¢«æ¯”ç‰¹å¸æ­£æœ¬è®°å½•ä¸‹æ¥ã€‚å‡ ä¹æ‰€æœ‰çš„è¾“å‡ºï¼Œé™¤äº†ä¸€ä¸ªä¾‹å¤–ï¼ˆè§â€œæ•°æ®è¾“å‡ºæ“ä½œç¬¦â€ï¼ˆOP_RETURNï¼‰ï¼‰ï¼Œéƒ½èƒ½åˆ›é€ ç§°ä¸ºUTXOçš„æ¯”ç‰¹å¸å—ï¼Œç„¶åè¢«æ•´ä¸ªç½‘ç»œè¯†åˆ«ï¼Œä¾›æ‰€æœ‰è€…åœ¨æœªæ¥äº¤æ˜“ä¸­ä½¿ç”¨ã€‚</p><p>äº¤æ˜“è¾“å‡ºåŒ…å«ä¸¤éƒ¨åˆ†ï¼š</p><ul><li><p>ä¸€å®šé‡çš„æ¯”ç‰¹å¸ï¼Œé¢å€¼ä¸ºâ€œèªâ€ï¼ˆsatoshisï¼‰ ï¼Œæ˜¯æœ€å°çš„æ¯”ç‰¹å¸å•ä½ï¼›</p></li><li><p>ç¡®å®šèŠ±è´¹è¾“å‡ºæ‰€éœ€æ¡ä»¶çš„åŠ å¯†éš¾é¢˜ï¼ˆcryptographic puzzleï¼‰ï¼Œè¿™ä¸ªåŠ å¯†éš¾é¢˜ä¹Ÿè¢«ç§°ä¸ºé”å®šè„šæœ¬(locking script), è§è¯è„šæœ¬(witness script), æˆ–è„šæœ¬å…¬é’¥ (scriptPubKey)ã€‚</p><ul><li>åªæœ‰å‡ºç¤ºå¯¹åº”çš„è§£é”è„šæœ¬ï¼ŒæˆåŠŸæ‰§è¡Œé”å®šè„šæœ¬ï¼ˆç›¸å½“äºè¿›è¡Œç­¾åéªŒè¯çš„è¿‡ç¨‹ï¼‰ï¼Œæ‰èƒ½èŠ±è´¹è¿™ç¬”è¾“å‡º</li></ul></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs JSON"><span class="hljs-string">&quot;vout&quot;</span>: [<br>  &#123;<br>    <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-number">0.01500000</span>,<br>    <span class="hljs-attr">&quot;scriptPubKey&quot;</span>: <span class="hljs-string">&quot;OP_DUP OP_HASH160 ab68025513c3dbd2f7b92a94e0581f5d50f654e7 OP_EQUALVERIFY OP_CHECKSIG&quot;</span><br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-number">0.08450000</span>,<br>    <span class="hljs-attr">&quot;scriptPubKey&quot;</span>: <span class="hljs-string">&quot;OP_DUP OP_HASH160 7f9b1a7fb68d60c536c2fd8aeaa53a8f3cc025a8 OP_EQUALVERIFY OP_CHECKSIG&quot;</span>,<br>  &#125;<br>]<br></code></pre></td></tr></table></figure><h2 id="äº¤æ˜“çš„è¾“å…¥"><a class="markdownIt-Anchor" href="#äº¤æ˜“çš„è¾“å…¥"></a> äº¤æ˜“çš„è¾“å…¥</h2><p>äº¤æ˜“çš„è¾“å…¥åŒ…å«å››ä¸ªå…ƒç´ ï¼š</p><ul><li><p>ä¸€ä¸ªäº¤æ˜“IDï¼Œå¼•ç”¨åŒ…å«å°†è¦æ¶ˆè´¹çš„UTXOçš„äº¤æ˜“</p></li><li><p>ä¸€ä¸ªè¾“å‡ºç´¢å¼•ï¼ˆvoutï¼‰ï¼Œç”¨äºæ ‡è¯†æ¥è‡ªè¯¥äº¤æ˜“çš„å“ªä¸ªUTXOè¢«å¼•ç”¨ï¼ˆç¬¬ä¸€ä¸ªä¸ºé›¶ï¼‰</p></li><li><p>ä¸€ä¸ª scriptSigï¼ˆè§£é”è„šæœ¬ï¼‰ï¼Œæ»¡è¶³UTXOçš„æ¶ˆè´¹æ¡ä»¶ï¼Œè§£é”ç”¨äºæ”¯å‡º</p></li><li><p>ä¸€ä¸ªåºåˆ—å·ï¼Œç”¨äºæŒ‡å®šè¿™ç¬”è¾“å…¥çš„ç”Ÿæ•ˆæ—¶é—´</p></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs JSON"><span class="hljs-string">&quot;vin&quot;</span>: [<br>  &#123;<br>    <span class="hljs-attr">&quot;txid&quot;</span>: <span class="hljs-string">&quot;7957a35fe64f80d234d76d83a2a8f1a0d8149a41d81de548f0a65a8a999f6f18&quot;</span>,<br>    <span class="hljs-attr">&quot;vout&quot;</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;scriptSig&quot;</span> : <span class="hljs-string">&quot;3045022100884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb02204b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813[ALL] 0484ecc0d46f1918b30928fa0e4ed99f16a0fb4fde0735e7ade8416ab9fe423cc5412336376789d172787ec3457eee41c04f4938de5cc17b4a10fa336a8d752adf&quot;</span>,<br>    <span class="hljs-attr">&quot;sequence&quot;</span>: <span class="hljs-number">4294967295</span><br>  &#125;<br>]<br></code></pre></td></tr></table></figure><h2 id="æ•°å­—ç­¾å"><a class="markdownIt-Anchor" href="#æ•°å­—ç­¾å"></a> æ•°å­—ç­¾å</h2><p>åœ¨ä¸Šè¿°äº¤æ˜“çš„è¾“å…¥ä¸­æåˆ°äº†ä¸€ä¸ªå…³é”®å…ƒç´ è§£é”è„šæœ¬ï¼Œå®é™…ä¸Šè¿™å°±æ˜¯åº”ç”¨äº†æ¤­åœ†æ›²çº¿å¯†ç ç®—æ³•çš„æ•°å­—ç­¾åã€‚åœ¨æ¯”ç‰¹å¸çš„ECDSAç®—æ³•çš„å®ç°ä¸­ï¼Œè¢«ç­¾åçš„â€œæ¶ˆæ¯â€æ˜¯äº¤æ˜“ï¼Œæˆ–æ›´ç¡®åˆ‡åœ°è¯´æ˜¯äº¤æ˜“ä¸­ç‰¹å®šæ•°æ®å­é›†çš„å“ˆå¸Œå€¼ã€‚ç­¾åå¯†é’¥æ˜¯ç”¨æˆ·çš„ç§é’¥ï¼Œç»“æœå°±æ˜¯ç­¾åï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>i</mi><mi>g</mi><mo>=</mo><msub><mi>F</mi><mrow><mi>s</mi><mi>i</mi><mi>g</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>F</mi><mrow><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi></mrow></msub><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>d</mi><mi>A</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Sig = F_{sig}(F_{hash}(m),  d_A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">h</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><ul><li><p><em>dA</em> æ˜¯ç­¾åç§é’¥</p></li><li><p><em>m</em> æ˜¯äº¤æ˜“ï¼ˆæˆ–å…¶éƒ¨åˆ†æ•°æ®ï¼‰</p></li><li><p><em>Fhash</em> æ˜¯æ•£åˆ—å‡½æ•°</p></li><li><p><em>Fsig</em> æ˜¯ç­¾åç®—æ³•</p></li><li><p><em>Sig</em> æ˜¯ç»“æœç­¾å</p></li></ul><p>å‡½æ•°<em>Fsig</em> äº§ç”Ÿç”±ä¸¤ä¸ªå€¼ç»„æˆçš„ç­¾åSigï¼Œé€šå¸¸ç§°ä¸ºRå’ŒSï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>i</mi><mi>g</mi><mo>=</mo><mi mathvariant="normal">ï¼ˆ</mi><mi>R</mi><mi mathvariant="normal">ï¼Œ</mi><mi>S</mi><mi mathvariant="normal">ï¼‰</mi></mrow><annotation encoding="application/x-tex">Sig = ï¼ˆRï¼ŒSï¼‰</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">ï¼ˆ</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord cjk_fallback">ï¼‰</span></span></span></span></span></p><p>ç°åœ¨å·²ç»è®¡ç®—äº†ä¸¤ä¸ªå€¼Rå’ŒSï¼Œå®ƒä»¬å°±ä½¿ç”¨ä¸€ç§ç§°ä¸º<em>å¯åˆ†è¾¨ç¼–ç è§„åˆ™Distinguished Encoding Rules</em>æˆ–<em>DER</em>çš„å›½é™…æ ‡å‡†ç¼–ç æ–¹æ¡ˆï¼Œåºåˆ—åŒ–ä¸ºå­—èŠ‚æµï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨äº¤æ˜“è¾“å…¥çš„JSONå­—ç¬¦ä¸²ä¸­çœ‹åˆ°çš„é‚£æ ·ã€‚</p><hr /><p><strong>ç­¾ååºåˆ—åŒ–ï¼ˆDERï¼‰</strong></p><p>æˆ‘ä»¬å†æ¥ä¹‹å‰åœ¨äº¤æ˜“è¾“å…¥ä¸­å±•ç¤ºçš„ä¸€ä¸ªè§£é”è„šæœ¬ï¼Œå…¶ä¸­ä»¥ä¸‹DERç¼–ç ç­¾åï¼š</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">3045022100884</span>d<span class="hljs-number">142</span>d<span class="hljs-number">86652</span>a<span class="hljs-number">3</span>f<span class="hljs-number">47</span>ba<span class="hljs-number">4746</span>ec<span class="hljs-number">719</span>bbfbd<span class="hljs-number">040</span>a<span class="hljs-number">570</span>b<span class="hljs-number">1</span>deccbb<span class="hljs-number">6498</span><span class="hljs-keyword">c</span><span class="hljs-number">75</span><span class="hljs-keyword">c</span><span class="hljs-number">4</span>ae<span class="hljs-number">24</span>cb<span class="hljs-number">02204</span>b<span class="hljs-number">9</span>f<span class="hljs-number">039</span>ff<span class="hljs-number">08</span>df<span class="hljs-number">09</span>cbe<span class="hljs-number">9</span>f<span class="hljs-number">6</span>addac<span class="hljs-number">960298</span>cad<span class="hljs-number">530</span>a<span class="hljs-number">863</span>ea<span class="hljs-number">8</span>f<span class="hljs-number">53982</span><span class="hljs-keyword">c</span><span class="hljs-number">09</span>db<span class="hljs-number">8</span>f<span class="hljs-number">6e381301</span><br></code></pre></td></tr></table></figure><p>è¯¥ç­¾åæ˜¯ç”¨æˆ·é’±åŒ…ç”Ÿæˆçš„Rå’ŒSå€¼çš„åºåˆ—åŒ–å­—èŠ‚æµï¼Œè¯æ˜å¯¹åº”ç”¨æˆ·æ‹¥æœ‰æˆæƒèŠ±è´¹è¯¥è¾“å‡ºçš„ç§é’¥ã€‚ åºåˆ—åŒ–æ ¼å¼åŒ…å«ä»¥ä¸‹9ä¸ªå…ƒç´ ï¼š</p><ul><li><p><em>0x30</em>è¡¨ç¤ºDERåºåˆ—çš„å¼€å§‹</p></li><li><p><em>0x45</em> - åºåˆ—çš„é•¿åº¦ï¼ˆ69å­—èŠ‚ï¼‰</p></li><li><p><em>0x02</em> - ä¸€ä¸ªæ•´æ•°å€¼</p></li><li><p><em>0x21</em> - æ•´æ•°çš„é•¿åº¦ï¼ˆ33å­—èŠ‚ï¼‰</p></li><li><p><em>00884d142d86652a3f47ba4746ec719bbfbd040a570b1deccbb6498c75c4ae24cb</em> - Rå€¼</p></li><li><p><em>0x02</em> - æ¥ä¸‹æ¥æ˜¯ä¸€ä¸ªæ•´æ•°</p></li><li><p><em>0x20</em> - æ•´æ•°çš„é•¿åº¦ï¼ˆ32å­—èŠ‚ï¼‰</p></li><li><p><em>4b9f039ff08df09cbe9f6addac960298cad530a863ea8f53982c09db8f6e3813</em> - Så€¼</p></li><li><p>åç¼€ï¼ˆ<em>0x01</em>ï¼‰æŒ‡ç¤ºä½¿ç”¨çš„å“ˆå¸Œçš„ç±»å‹ï¼ˆSIGHASH_ALLï¼‰</p></li></ul><hr /><p><strong>éªŒè¯ç­¾å</strong></p><ul><li>è¦éªŒè¯ç­¾åï¼Œå¿…é¡»æœ‰ç­¾åï¼ˆ<em>R</em>å’Œ<em>S</em>ï¼‰ã€åºåˆ—åŒ–äº¤æ˜“å’Œå…¬é’¥ï¼ˆå¯¹åº”äºç”¨äºåˆ›å»ºç­¾åçš„ç§é’¥ï¼‰ã€‚æœ¬è´¨ä¸Šï¼Œç­¾åçš„éªŒè¯æ„å‘³ç€â€œåªæœ‰ç”Ÿæˆæ­¤å…¬é’¥çš„ç§é’¥çš„æ‰€æœ‰è€…ï¼Œæ‰èƒ½åœ¨æ­¤äº¤æ˜“ä¸Šäº§ç”Ÿæ­¤ç­¾åã€‚â€</li><li>ç­¾åéªŒè¯ç®—æ³•é‡‡ç”¨æ¶ˆæ¯ï¼ˆäº¤æ˜“æˆ–å…¶éƒ¨åˆ†çš„å“ˆå¸Œå€¼ï¼‰ã€ç­¾åè€…çš„å…¬é’¥å’Œç­¾åï¼ˆRå’ŒSå€¼ï¼‰ï¼Œå¦‚æœç­¾åå¯¹è¯¥æ¶ˆæ¯å’Œå…¬é’¥æœ‰æ•ˆï¼Œåˆ™è¿”å› TRUE å€¼ã€‚</li></ul><h2 id="äº¤æ˜“è„šæœ¬"><a class="markdownIt-Anchor" href="#äº¤æ˜“è„šæœ¬"></a> äº¤æ˜“è„šæœ¬</h2><p>æ­£å¦‚ä¹‹å‰å†…å®¹æåˆ°çš„ï¼Œé”å®šè„šæœ¬å’Œè§£é”è„šæœ¬æ­£æ˜¯ç»„æˆæ•°å­—ç­¾åå’Œç­¾åéªŒè¯è¿‡ç¨‹çš„å…³é”®æ•°æ®ã€‚</p><ul><li>é”å®šè„šæœ¬ï¼šé”å®šè„šæœ¬æ˜¯ä¸€ä¸ªæ”¾ç½®åœ¨äº¤æ˜“è¾“å‡ºä¸Šé¢çš„èŠ±è´¹æ¡ä»¶â€”â€”å®ƒæŒ‡å®šäº†ä»ŠåèŠ±è´¹è¿™ç¬”è¾“å‡ºå¿…é¡»è¦æ»¡è¶³çš„æ¡ä»¶ã€‚ ç”±äºé”å®šè„šæœ¬å¾€å¾€å«æœ‰ä¸€ä¸ªå…¬é’¥æˆ–æ¯”ç‰¹å¸åœ°å€ï¼ˆå…¬é’¥å“ˆå¸Œå€¼ï¼‰ï¼Œåœ¨å†å²ä¸Šå®ƒæ›¾è¢«ç§°ä¸º<em>è„šæœ¬å…¬é’¥scriptPubKey</em>ã€‚</li><li>è§£é”è„šæœ¬ï¼šè§£é”è„šæœ¬æ˜¯è¿™æ ·ä¸€ä¸ªè„šæœ¬ï¼Œå®ƒâ€œè§£å†³â€æˆ–æ»¡è¶³ç”±é”å®šè„šæœ¬æ”¾ç½®åœ¨è¾“å‡ºä¸Šçš„æ¡ä»¶ï¼Œå¹¶å…è®¸ä½¿ç”¨è¾“å‡ºã€‚è§£é”è„šæœ¬æ˜¯æ¯ä¸€ç¬”æ¯”ç‰¹å¸äº¤æ˜“è¾“å…¥çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸”å¾€å¾€å«æœ‰ä¸€ä¸ªç”±ç”¨æˆ·çš„æ¯”ç‰¹å¸é’±åŒ…ï¼ˆé€šè¿‡ç”¨æˆ·çš„ç§é’¥ï¼‰ç”Ÿæˆçš„æ•°å­—ç­¾åã€‚ç”±äºè§£é”è„šæœ¬å¸¸å¸¸åŒ…å«ä¸€ä¸ªæ•°å­—ç­¾åï¼Œå› æ­¤å®ƒæ›¾è¢«ç§°ä½œ<em>è„šæœ¬ç­¾åScriptSig</em>ã€‚</li><li>å½“ç»“åˆé”å®šè„šæœ¬å’Œè§£é”è„šæœ¬ï¼Œåœ¨å †æ ˆä¸­æ‰§è¡Œè„šæœ¬ï¼Œå¦‚æœå †æ ˆä¸­æœ€åå‰©ä½™çš„ç»“æœä¸ºâ€œTRUEâ€ï¼Œè¡¨æ˜è§£é”è„šæœ¬ä¸­ç­¾åè·Ÿé”å®šè„šæœ¬ä¸­çš„å…¬é’¥å“ˆå¸Œæ˜¯ç›¸åŒ¹é…çš„ï¼Œå³ç”¨äºç­¾åçš„ç§é’¥è·Ÿå…¬é’¥æ˜¯åŒ¹é…çš„ã€‚å…¶ä¸­ï¼Œç­¾åéªŒè¯çš„è¿™ä¸ªéªŒè¯æ“ä½œæ­£æ˜¯é”å®šè„šæœ¬ä¸­ â€œ<strong>OP_CHECKSIG</strong>â€ æ‰€æ‰§è¡Œçš„ï¼Œå³æ¯”å¯¹æ¶ˆæ¯ï¼ˆäº¤æ˜“æˆ–å…¶éƒ¨åˆ†çš„å“ˆå¸Œå€¼ï¼‰ã€ç­¾åè€…çš„å…¬é’¥å’Œç­¾åï¼ˆRå’ŒSå€¼ï¼‰ã€‚</li></ul><hr /><p><strong>è„šæœ¬æ‰§è¡Œ</strong></p><ul><li>åœ¨æœ€åˆç‰ˆæœ¬çš„æ¯”ç‰¹å¸å®¢æˆ·ç«¯ä¸­ï¼Œè§£é”è„šæœ¬å’Œé”å®šè„šæœ¬æŒ‰é¡ºåºè¿èµ·æ¥æ‰§è¡Œã€‚å‡ºäºå®‰å…¨å› ç´ è€ƒè™‘ï¼Œåœ¨2010å¹´å‘ç”Ÿäº†æ”¹å˜ï¼Œå› ä¸ºå­˜åœ¨ä¸€ä¸ªæ¼æ´ï¼Œå…è®¸æ ¼å¼é”™è¯¯çš„è§£é”è„šæœ¬å°†æ•°æ®æ¨é€åˆ°å †æ ˆå¹¶æŸåé”å®šè„šæœ¬ã€‚è€Œåœ¨å½“å‰çš„æ–¹æ¡ˆä¸­ï¼Œè„šæœ¬æ˜¯å•ç‹¬æ‰§è¡Œçš„ï¼Œåœ¨ä¸¤æ¬¡æ‰§è¡Œä¹‹é—´ä¼ è¾“å †æ ˆï¼Œå¦‚ä¸‹æ‰€è¿°ã€‚<ul><li>é¦–å…ˆï¼Œä½¿ç”¨å †æ ˆæ‰§è¡Œå¼•æ“æ‰§è¡Œè§£é”è„šæœ¬ã€‚å¦‚æœè§£é”è„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æœªæŠ¥é”™ï¼ˆä¾‹å¦‚ï¼šæ²¡æœ‰ç•™ä¸‹â€œdanglingâ€æ“ä½œç ï¼‰ï¼Œåˆ™å¤åˆ¶ä¸»å †æ ˆï¼Œå¹¶æ‰§è¡Œé”å®šè„šæœ¬ã€‚å¦‚æœä»è§£é”è„šæœ¬ä¸­å¤åˆ¶è€Œæ¥çš„å †æ ˆæ•°æ®æ‰§è¡Œé”å®šè„šæœ¬çš„ç»“æœä¸ºâ€œTRUE&quot;ï¼Œé‚£ä¹ˆè§£é”è„šæœ¬å°±æˆåŠŸåœ°æ»¡è¶³äº†é”å®šè„šæœ¬æ‰€è®¾ç½®çš„æ¡ä»¶ï¼Œå› æ­¤ï¼Œè¯¥è¾“å…¥æ˜¯ä¸€ä¸ªèƒ½ä½¿ç”¨è¯¥UTXOçš„æœ‰æ•ˆæˆæƒã€‚å¦‚æœåˆå¹¶è„šæœ¬æ‰§è¡Œåçš„ç»“æœæ˜¯â€TRUEâ€œä»¥å¤–çš„ä»»ä½•ç»“æœï¼Œè¾“å…¥éƒ½æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºå®ƒä¸èƒ½æ»¡è¶³UTXOä¸­æ‰€è®¾ç½®çš„ä½¿ç”¨è¯¥ç¬”èµ„é‡‘çš„æ¡ä»¶ã€‚</li></ul></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111271513603.(null)" alt="ç»“åˆscriptSigå’ŒscriptPubKeyæ‰§è¡Œè„šæœ¬" /></p><p class="note note-info"> å…·ä½“è„šæœ¬åœ¨å †æ ˆä¸­çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå¯å‚è€ƒï¼š<a href="https://github.com/tianmingyun/MasterBitcoin2CN/blob/master/ch06.md#644-p2pkhpay-to-public-key-hash">P2PKH è„šæœ¬æ‰§è¡Œæµç¨‹</a></p><h1 id="æ€»ç»“"><a class="markdownIt-Anchor" href="#æ€»ç»“"></a> æ€»ç»“</h1><p>æ¯”ç‰¹å¸ç³»ç»Ÿä¸­å¤§é‡ä½¿ç”¨äº†å¯†ç å­¦æŠ€æœ¯ï¼Œä¾‹å¦‚ä½¿ç”¨æ¤­åœ†æ›²çº¿å¯†ç ç®—æ³•ç”Ÿæˆå¯†é’¥å’Œå…¬é’¥ï¼Œä»¥åŠäº¤æ˜“ä¸­çš„æ•°å­—ç­¾åå’ŒéªŒè¯ï¼Œç¡®ä¿æ¯”ç‰¹å¸çš„æ‰€æœ‰è€…åœ¨è¿›è¡Œè½¬è´¦æ“ä½œã€‚å¯†ç å­¦å®ç°äº†æ¯”ç‰¹å¸çš„è®¸å¤šæœ‰è¶£ç‰¹æ€§ï¼ŒåŒ…æ‹¬å»ä¸­å¿ƒåŒ–ä¿¡ä»»å’Œæ§åˆ¶ã€æ‰€æœ‰æƒè®¤è¯å’ŒåŸºäºå¯†ç å­¦è¯æ˜çš„å®‰å…¨æ¨¡å‹ã€‚å¯ä»¥è¯´ï¼Œå¯†ç å­¦æ˜¯æ¯”ç‰¹å¸å®ç°çš„ä¸€å¤§åŸºçŸ³ã€‚</p><p class="note note-success"> æ›´å¤šæ¯”ç‰¹å¸çŸ¥è¯†å¯å‚è€ƒæˆ‘çš„è¿™ä¸ªGithubé¡¹ç›®ï¼š<a href="https://github.com/2017zhangyuxuan/Learn-Blockchain">æ¯”ç‰¹å¸ç³»ç»Ÿ C++ å®ç°</a></p><h1 id="å‚è€ƒèµ„æ–™é™„å½•"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™é™„å½•"></a> å‚è€ƒèµ„æ–™é™„å½•</h1><p><a href="https://github.com/tianmingyun/MasterBitcoin2CN">ã€Šç²¾é€šæ¯”ç‰¹å¸ã€‹ä¸­æ–‡ç”µå­ä¹¦</a></p><p><a href="https://zhuanlan.zhihu.com/p/21298725">æ¯”ç‰¹å¸ï¼ˆåœ°å€ã€ç§é’¥ï¼‰å‹ç¼©ä¸éå‹ç¼©çš„åŒºåˆ«</a></p><p><a href="https://github.com/tianmingyun/MasterBitcoin2CN/blob/master/ch05.md#523-%E4%BB%8E%E5%8A%A9%E8%AE%B0%E8%AF%8D%E7%94%9F%E6%88%90%E7%A7%8D%E5%AD%90">HDåˆ†å±‚é’±åŒ… ç§å­ç”Ÿæˆè¿‡ç¨‹</a></p><p><a href="https://github.com/tianmingyun/MasterBitcoin2CN/blob/master/ch06.md#644-p2pkhpay-to-public-key-hash">P2PKH è„šæœ¬æ‰§è¡Œæµç¨‹</a></p><p><a href="https://bitcoin.stackexchange.com/questions/72657/signature-verification-in-python-using-compressed-public-key">Signature verification in python using compressed public key</a></p><p><a href="https://medium.com/@bitaps.com/exploring-bitcoin-signing-the-p2pkh-input-b8b4d5c4809c">Exploring Bitcoin: signing the P2PKH input</a></p><p><a href="https://www.jianshu.com/p/a560e0605ff2">æ¯”ç‰¹å¸ç§é’¥ï¼Œå…¬é’¥å’Œåœ°å€çš„å…³ç³»</a></p><p><a href="https://live.blockcypher.com/">åœ¨çº¿æœç´¢äº¤æ˜“è®°å½•ã€åŒºå—ä¿¡æ¯ï¼ˆå„ç§æ•°å­—è´§å¸ï¼‰</a></p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>æ¯”ç‰¹å¸</category>
      
      <category>å¯†ç å­¦</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Bitcoin</tag>
      
      <tag>ECDSA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SM4ç®—æ³•ä»‹ç»ä¸ä»£ç å®ç°</title>
    <link href="/2021/11/13/2021-11/2021-11-13%20SM4/"/>
    <url>/2021/11/13/2021-11/2021-11-13%20SM4/</url>
    
    <content type="html"><![CDATA[<h1 id="sm4ç®—æ³•ä»‹ç»"><a class="markdownIt-Anchor" href="#sm4ç®—æ³•ä»‹ç»"></a> SM4ç®—æ³•ä»‹ç»</h1><h2 id="åŠ å¯†è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#åŠ å¯†è¿‡ç¨‹"></a> åŠ å¯†è¿‡ç¨‹</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111131454563.(null)" alt="SM4åŠ å¯†è¿‡ç¨‹" /></p><ul><li>é¦–å…ˆå·¦ä¾§æè¿°äº†SM4åŠ å¯†çš„æ•´ä½“æµç¨‹ï¼š</li></ul><ol><li>è¾“å…¥çš„ä¸€ä¸ªæ¶ˆæ¯åˆ†ç»„ä¸º128bitsï¼Œåˆ’åˆ†æˆ4ä¸ªå°å—ï¼Œæ¯ä¸ªå°å—32bits</li><li>è¿™å››ä¸ªå°å—ç»è¿‡32è½®åŠ å¯†å¤„ç†</li><li>åŠ å¯†å¤„ç†åï¼Œå†ç»è¿‡ä¸€æ¬¡Permutationç½®æ¢ï¼Œå¾—åˆ°æœ€ç»ˆåŠ å¯†ç»“æœ</li></ol><ul><li>å³ä¾§æè¿°å…¶ä¸­ä¸€è½®çš„åŠ å¯†è¿‡ç¨‹ï¼Œå…¶ä»–è½®å‡½æ•°åŠ å¯†è¿‡ç¨‹æ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯è½®å¯†é’¥ä¸åŒï¼š</li></ul><ol><li>X_3 å…ˆåè·Ÿ X_2 ã€X_1 è¿›è¡Œå¼‚æˆ–  â€”â€” â‘ </li><li>â‘  å¾—åˆ°çš„ç»“æœå†ä¸è½®å¯†é’¥ RK_i è¿›è¡Œå¼‚æˆ–  â€”â€” â‘¡</li><li>â‘¡ å¾—åˆ°çš„è®°è¿‡ä¸º32bitsï¼Œå†åˆ†æˆ4ç»„8bitsï¼Œæ¯ä¸€ç»„8bits ä½¿ç”¨ç›¸åŒçš„S-Boxè¿›è¡Œæ›¿æ¢ï¼Œå¾—åˆ°æ–°çš„8bits   â€”â€” â‘¢</li><li>â‘¢ å¾—åˆ°çš„4ç»„8bitsé‡æ–°æ‹¼æ¥å¾—åˆ°32bitsï¼Œå°†è¿™32bitså¤åˆ¶æˆ5ä»½è¾“å…¥ï¼Œç¬¬1ä»½å¾ªç¯å·¦ç§»2ä½ï¼Œç¬¬2ä»½å¾ªç¯å·¦ç§»10ä½ï¼Œç¬¬3ä»½å¾ªç¯å·¦ç§»18ä½ï¼Œç¬¬4ä»½å¾ªç¯å·¦ç§»24ä½ï¼Œç¬¬5ä»½ä¸æ”¹åŠ¨ç›´æ¥è¾“å‡º â€”â€” â‘£</li><li>â‘£ çš„å¾—åˆ°çš„5ä»½è¾“å‡ºçš„32bitsä¸X_0 ä¸€èµ·è¿›è¡Œå¼‚æˆ– â€”â€” â‘¤</li><li>æœ€ç»ˆå¾—åˆ°è¾“å‡º Xâ€™_3 å°±æ˜¯ â‘¤ çš„è¾“å‡ºï¼Œå…¶ä»–è¾“å‡ºXâ€™_0 = X_1 ï¼Œ Xâ€™_1 = X_2ï¼Œ Xâ€™_2 = X_3</li></ol><p>ç”¨å…¬å¼è¿›è¡Œæè¿°å¦‚ä¸‹æ‰€ç¤ºï¼Œå…¶ä¸­Sä»£è¡¨ä½¿ç”¨S-boxè¿›è¡Œæ›¿æ¢ï¼ŒLè¡¨ç¤ºçº¿æ€§å‡½æ•°æ‰§è¡Œå¾ªç¯å·¦ç§»çš„æ“ä½œ</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>X</mi><mn>0</mn><mo mathvariant="normal">â€²</mo></msubsup><mo>=</mo><msub><mi>X</mi><mn>1</mn></msub><mspace linebreak="newline"></mspace><msubsup><mi>X</mi><mn>1</mn><mo mathvariant="normal">â€²</mo></msubsup><mo>=</mo><msub><mi>X</mi><mn>2</mn></msub><mspace linebreak="newline"></mspace><msubsup><mi>X</mi><mn>2</mn><mo mathvariant="normal">â€²</mo></msubsup><mo>=</mo><msub><mi>X</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">X&#x27;_0 = X_1  \\X&#x27;_1 = X_2\\X&#x27;_2 = X_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>X</mi><mn>3</mn><mo mathvariant="normal">â€²</mo></msubsup><mo>=</mo><msub><mi>X</mi><mn>0</mn></msub><mo>âŠ•</mo><mi>L</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mn>3</mn></msub><mo>âŠ•</mo><msub><mi>X</mi><mn>2</mn></msub><mo>âŠ•</mo><msub><mi>X</mi><mn>1</mn></msub><mo>âŠ•</mo><mi>R</mi><msub><mi>K</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X&#x27;_3 =X_0âŠ• L( S (X_3 âŠ• X_2 âŠ• X_1 âŠ• RK_i))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>B</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>b</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mo stretchy="false">(</mo><msub><mi>b</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>S</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>S</mi><mi>b</mi><mi>o</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>S</mi><mi>b</mi><mi>o</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>S</mi><mi>b</mi><mi>o</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>S</mi><mi>b</mi><mi>o</mi><mi>x</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex"> A=(a_0,a_1,a_2,a_3), B=(b_0,b_1,b_2,b_3)  \\ (b_0,b_1,b_2,b_3) = S(A)= (Sbox(a_0),Sbox(a_1),Sbox(a_2),Sbox(a_3))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">b</span><span class="mord mathdefault">o</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">b</span><span class="mord mathdefault">o</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">b</span><span class="mord mathdefault">o</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">b</span><span class="mord mathdefault">o</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>b</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>b</mi><mn>3</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">(</mo><mn>32</mn><mi>b</mi><mi>i</mi><mi>t</mi><mi>s</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>C</mi><mo>=</mo><mi>L</mi><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mi>B</mi><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>B</mi><mo>&lt;</mo><mo>&lt;</mo><mn>2</mn><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>B</mi><mo>&lt;</mo><mo>&lt;</mo><mn>10</mn><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>B</mi><mo>&lt;</mo><mo>&lt;</mo><mn>18</mn><mo stretchy="false">)</mo><mo>âŠ•</mo><mo stretchy="false">(</mo><mi>B</mi><mo>&lt;</mo><mo>&lt;</mo><mn>24</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">B=(b_0,b_1,b_2,b_3), C (32bits) \\ C = L(B) = B âŠ• (B&lt;&lt;2) âŠ•(B&lt;&lt;10) âŠ•(B&lt;&lt;18)âŠ•(B&lt;&lt;24)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord">3</span><span class="mord">2</span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">8</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord">4</span><span class="mclose">)</span></span></span></span></span></p><p class='note note-success'>  é€šè¿‡è§‚å¯ŸSM4åŠ å¯†è¿‡ç¨‹å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¸€è½®åŠ å¯†ä¸­ï¼Œæœ‰3ä¸ªè¾“å‡ºå®Œå…¨ç­‰åŒäº3ä¸ªè¾“å…¥ï¼Œåªæœ‰ä¸€ä¸ªè¾“å‡ºéœ€è¦ç»è¿‡ä¸€äº›å¤æ‚æ“ä½œï¼Œå³è®¡ç®—X'_3ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œè§£å¯†æ—¶ï¼Œåªéœ€è¦è®¡ç®—åŸæ¥çš„X_0ï¼Œè€Œè¿™å¯ä»¥é€šè¿‡ç°æœ‰çš„è¾“å‡ºå¾—åˆ°çš„ï¼ˆå…·ä½“æ“ä½œè§ä¸‹é¢çš„è§£å¯†è¿‡ç¨‹ï¼‰ã€‚</p><h2 id="è§£å¯†è¿‡ç¨‹"><a class="markdownIt-Anchor" href="#è§£å¯†è¿‡ç¨‹"></a> è§£å¯†è¿‡ç¨‹</h2><ul><li>åœ¨äº†è§£äº†SM4ä¸€è½®çš„åŠ å¯†è¿‡ç¨‹åï¼Œä¸éš¾å¾—å‡ºä¸€è½®çš„è§£å¯†è¿‡ç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111131519980.png" alt="SM4è§£å¯†è¿‡ç¨‹" /></p><ul><li>åŒæ ·å·¦ä¾§æè¿°äº†SM4è§£å¯†çš„æ•´ä½“æµç¨‹ï¼š</li></ul><ol><li>è¾“å…¥çš„ä¸€ä¸ªå¯†æ–‡Cä¸º128bitsï¼Œåˆ’åˆ†æˆ4ä¸ªå°å—ï¼Œæ¯ä¸ªå°å—32bits</li><li>å¯¹è¿™å››ä¸ªå°å—ç»è¿‡ä¸€æ¬¡Permutationç½®æ¢</li><li>å¯¹ç½®æ¢ç»“æœè¿›è¡Œ32è½®ç±»ä¼¼çš„è§£å¯†å¤„ç†ï¼Œå¾—åˆ°æœ€ç»ˆçš„æ˜æ–‡è¾“å‡º</li></ol><ul><li>å…·ä½“æè¿°ä¸€è½®çš„è§£å¯†è¿‡ç¨‹ï¼Œè¿›è¡Œ32è½®ç±»ä¼¼çš„è§£å¯†æ“ä½œï¼Œå…¶ä¸­Xâ€™_0å¯¹åº”åŠ å¯†è¿‡ç¨‹ä¸­çš„è¾“å…¥X_1ï¼ŒXâ€™_1å¯¹åº”è¾“å…¥X_2ï¼ŒXâ€™_2å¯¹åº”è¾“å…¥X_3ï¼Œæ‰€ä»¥é‡ç‚¹è®¡ç®—å¾—åˆ°åŸæ¥è¾“å…¥çš„X_0ï¼Œä¸‹é¢ç›´æ¥ç”¨å…¬å¼æ¥è¡¨ç¤ºè®¡ç®—è¿‡ç¨‹</li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><msubsup><mi>X</mi><mn>0</mn><mo mathvariant="normal">â€²</mo></msubsup><mspace width="2em"/><msub><mi>X</mi><mn>2</mn></msub><mo>=</mo><msubsup><mi>X</mi><mn>1</mn><mo mathvariant="normal">â€²</mo></msubsup><mspace width="2em"/><msub><mi>X</mi><mn>3</mn></msub><mo>=</mo><msubsup><mi>X</mi><mn>2</mn><mo mathvariant="normal">â€²</mo></msubsup></mrow><annotation encoding="application/x-tex">X_1 = X&#x27;_0     \qquad X_2 = X&#x27;_1 \qquad X_3 = X&#x27;_2     </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:2em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub><mo>=</mo><msubsup><mi>X</mi><mn>3</mn><mo mathvariant="normal">â€²</mo></msubsup><mo>âŠ•</mo><mi>L</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">(</mo><msubsup><mi>X</mi><mn>2</mn><mo mathvariant="normal">â€²</mo></msubsup><mo>âŠ•</mo><msubsup><mi>X</mi><mn>1</mn><mo mathvariant="normal">â€²</mo></msubsup><mo>âŠ•</mo><msubsup><mi>X</mi><mn>0</mn><mo mathvariant="normal">â€²</mo></msubsup><mo>âŠ•</mo><mi>R</mi><msub><mi>K</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X_0 =X&#x27;_3âŠ• L( S (X&#x27;_2 âŠ• X&#x27;_1 âŠ• X&#x27;_0 âŠ• RK_i))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p><p><strong>å…¶ä¸­Lçº¿æ€§å‡½æ•°è·ŸS-boxç½®æ¢ éƒ½è·ŸåŠ å¯†è¿‡ç¨‹ä¸­ä¸€è‡´ï¼›ä½†éœ€è¦æ³¨æ„çš„æ˜¯è§£å¯†è¿‡ç¨‹ä¸­ï¼Œè½®å¯†é’¥çš„ä½¿ç”¨æ¬¡åºæ˜¯ï¼ˆ31, 30, â€¦, 1,0ï¼‰ï¼Œè·ŸåŠ å¯†è¿‡ç¨‹ä½¿ç”¨çš„è½®å¯†é’¥æ¬¡åºæ­£å¥½æ˜¯ç›¸åçš„</strong></p><h2 id="è½®å¯†é’¥ç”Ÿæˆ"><a class="markdownIt-Anchor" href="#è½®å¯†é’¥ç”Ÿæˆ"></a> è½®å¯†é’¥ç”Ÿæˆ</h2><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111131454839.(null)" alt="è½®å¯†é’¥ç”Ÿæˆ" /></p><ul><li>è½®å¯†é’¥ç”Ÿæˆè¿‡ç¨‹å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå…¶ä¸­Kä»£è¡¨çš„æ˜¯16å­—èŠ‚çš„å¯†é’¥ï¼Œå…¬å¼é‡Œçš„Sç”¨çš„å’ŒåŠ å¯†è¿‡ç¨‹ä¸­ç›¸åŒçš„Sbox</li></ul><h1 id="cå®ç°sm4åŠ å¯†ä¸è§£å¯†"><a class="markdownIt-Anchor" href="#cå®ç°sm4åŠ å¯†ä¸è§£å¯†"></a> C++å®ç°SM4åŠ å¯†ä¸è§£å¯†</h1><h2 id="å®ç°ç›®æ ‡"><a class="markdownIt-Anchor" href="#å®ç°ç›®æ ‡"></a> å®ç°ç›®æ ‡</h2><ol><li>ä½¿ç”¨C++å®ç°SM4ç®—æ³•çš„åŠ å¯†å’Œç»“æœï¼Œå®ç°åŒ…æ‹¬ECBã€CBCä¸¤ç§åŠ å¯†æ¨¡å¼ã€‚å¹¶æä¾›å‘½ä»¤â¾æ¥â¼å¯¹â¼†è¿›åˆ¶â½‚ä»¶ è¿›â¾åŠ /è§£å¯†ã€‚</li><li>å®ç°å¯¹pngå›¾åƒæ–‡ä»¶çš„åŠ å¯†ï¼Œåªå¯¹å›¾åƒæ•°æ®éƒ¨åˆ†è¿›è¡ŒåŠ å¯†ï¼Œä½¿å¾—å¯¹åŠ å¯†pngæ–‡ä»¶åä»èƒ½ä»¥pngæ ¼å¼æ‰“å¼€</li></ol><h2 id="å‘½ä»¤è¡Œæ ¼å¼è¯´æ˜"><a class="markdownIt-Anchor" href="#å‘½ä»¤è¡Œæ ¼å¼è¯´æ˜"></a> å‘½ä»¤è¡Œæ ¼å¼è¯´æ˜</h2><ul><li>ç”Ÿæˆçš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ä¸º AppliedCryptographyï¼Œå…±æœ‰ä»¥ä¸‹å‡ ç§å¯é€‰é…ç½®<ul><li>-encï¼šè¿›è¡ŒåŠ å¯†æ“ä½œ</li><li>-decï¼šè¿›è¡Œè§£å¯†æ“ä½œ</li><li>-modeï¼šæŒ‡å®šåŠ å¯†/è§£å¯†æ“ä½œï¼Œå…¶åè·Ÿç€ecbæˆ–è€…cbcï¼ˆå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé»˜è®¤ä¸ºecbæ¨¡å¼ï¼‰</li><li>-pngï¼šæŒ‡å®šè¾“å…¥å’Œè¾“å‡ºæ–‡ä»¶ä¸ºpngæ ¼å¼ï¼ˆå¯¹pngæ–‡ä»¶åšç‰¹æ®Šå¤„ç†ï¼ŒåªåŠ å¯†æ•°æ®å—éƒ¨åˆ†ï¼‰ï¼›å¦‚æœæŒ‡å®šäº†ï¼Œè¯·ä¿è¯æ–‡ä»¶çš„åç¼€åä»¥.pngæ ¼å¼ç»“å°¾</li><li>-inï¼šè¾“å…¥æ–‡ä»¶çš„è·¯å¾„ï¼Œè¯·ä½¿ç”¨ç›¸å¯¹è·¯å¾„</li><li>-outï¼šè¾“å‡ºæ–‡ä»¶çš„è·¯å¾„ï¼Œè¯·ä½¿ç”¨ç›¸å¯¹è·¯å¾„</li><li>-keyï¼šæŒ‡å®šå¯†é’¥ï¼Œé»˜è®¤ä¸º&quot;123456&quot;</li><li>-ivï¼šæŒ‡å®šåˆå§‹åŒ–å‘é‡ï¼Œé»˜è®¤ä¸º&quot;123456&quot;</li><li>-testï¼šå¦‚æœæŒ‡å®šäº†ï¼Œæ‰§è¡Œæµ‹è¯•å‡½æ•°</li></ul></li></ul><p class='note note-warning'>1. é…ç½®çš„å‘½ä»¤è¯·ç”¨å°å†™ <br>2. ä¸€äº›é…ç½®ä¹‹åè¯·ç´§è·Ÿå¯¹åº”çš„å‚æ•°å€¼ <br>3. è¾“å…¥å’Œè¾“å‡ºçš„è·¯å¾„è¯·ç”¨ç›¸å¯¹è·¯å¾„ <br></p><ul><li>å‚è€ƒçš„æµ‹è¯•å‘½ä»¤å¦‚ä¸‹</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æµ‹è¯•cbcæ¨¡å¼åŠ å¯†pngæ–‡ä»¶</span><br>./AppliedCryptography -enc -mode cbc -png -in logo.png -out test.png -iv 123456 -key 123456<br>./AppliedCryptography -dec -mode cbc -png -in test.png -out dec_test.png -iv 123456 -key 123456<br><span class="hljs-meta">#</span><span class="bash"> æµ‹è¯•ecbåŠ å¯†æ–‡ä»¶</span><br>./AppliedCryptography -enc -mode ecb -in test.txt -out ecb_test.txt -iv 123456 -key 123456<br>./AppliedCryptography -dec -mode ecb -in ecb_test.txt -out dec_test.txt -iv 123456 -key 123456<br></code></pre></td></tr></table></figure><h2 id="ä»£ç ç»“æ„è¯´æ˜"><a class="markdownIt-Anchor" href="#ä»£ç ç»“æ„è¯´æ˜"></a> ä»£ç ç»“æ„è¯´æ˜</h2><p>é¦–å…ˆè¯´æ˜è¿›è¡Œä»£ç ç›®å½•çš„è¯´æ˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111131454890.(null)" width="40%" height="40%" ></center><p align="middle"><font size="2" color="grey">ä»£ç ç›®å½•ç»“æ„</font></p><ul><li>é¡¹ç›®ä½¿ç”¨CMake æ„å»ºï¼Œbuildç›®å½•æ˜¯æ„å»ºç›®å½•ï¼Œbuild/output/binä¸‹æ˜¯å¯¹åº”å¯æ‰§è¡Œæ–‡ä»¶çš„è¾“å‡ºç›®å½•ï¼Œbuild/output/bin/test ç›®å½•ä¸‹å­˜æ”¾æµ‹è¯•ç”¨çš„ç›¸å…³æ–‡ä»¶</li><li>Cmake-build-debugï¼šä½¿ç”¨CLion ç¼–è¯‘æ„å»ºæ—¶ç”Ÿæˆçš„ç›®å½•</li><li>FirstWorkï¼šä¸»è¦ç›®å½•ï¼Œsm4å¯¹åº”æºä»£ç æ˜¯ç®—æ³•çš„å…·ä½“å®ç°ï¼›testå¯¹åº”çš„æ˜¯æµ‹è¯•ç›¸å…³æ–¹æ³•ï¼Œä¸»è¦ç”¨äºæµ‹è¯•ç®—æ³•çš„æ­£ç¡®æ€§</li><li>hash-libraryï¼šä¸€ä¸ªç®€å•çš„ç¬¬ä¸‰æ–¹åº“ï¼Œå°è£…äº†hashæ“ä½œå’Œhexç¼–ç å’Œè§£ç ç­‰æ“ä½œ</li><li>utilï¼šå…¶ä¸­utilæ˜¯ä¸€ä¸ªå·¥å…·ç±»ï¼Œä¸»è¦å°è£…äº†ä¸€äº›è¾…åŠ©å‡½æ•°</li><li>main.cppï¼šç¨‹åºå…¥å£ï¼Œä¸»è¦å®ç°äº†è§£æå‘½ä»¤è¡Œå‚æ•°ï¼Œæ‰§è¡Œå¯¹åº”çš„æ“ä½œ</li></ul><h2 id="å®ç°ç›¸å…³è¯´æ˜"><a class="markdownIt-Anchor" href="#å®ç°ç›¸å…³è¯´æ˜"></a> å®ç°ç›¸å…³è¯´æ˜</h2><ul><li><p>åœ¨<code>sm4.h</code>å’Œ<code>sm4.cpp</code>ä¸­å®ç°äº†SM4ç®—æ³•ï¼Œå…·ä½“å®ç°é€»è¾‘åªè¦æ˜¯æ‹†åˆ†æˆå¤šä¸ªå­å‡½æ•°</p><ul><li>Lçº¿æ€§å‡½æ•°å’ŒSboxæ›¿æ¢å‡½æ•°å®ç°</li><li>è½®å¯†é’¥ç”Ÿæˆ</li><li><code>SM4EncRound</code>å’Œ<code>SM4DecRound</code>å®ç°ä¸€è½®çš„åŠ å¯†å’Œè§£å¯†</li><li><code>Encryption</code>å’Œ<code>Decryption</code>å®ç°128bitsè¾“å…¥çš„åŠ å¯†å’Œè§£å¯†</li><li><code>EncFile</code>å’Œ<code>DecFile</code>å®ç°æ–‡ä»¶çš„åŠ å¯†å’Œè§£å¯†</li><li><code>EncPNG</code>å’Œ<code>DecPNG</code>å®ç°å¯¹pngæ ¼å¼æ–‡ä»¶çš„åŠ å¯†å’Œè§£å¯†</li></ul></li><li><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œpngå›¾ç‰‡æ–‡ä»¶ï¼Œæœ‰è‡ªå·±çš„å›ºå®šæ ¼å¼ï¼Œä¸»è¦ä¸ºå¤´éƒ¨8å­—èŠ‚å›ºå®šç­¾åï¼ŒåŠ å…¶ä»–æ•°æ®å—çš„ç»“æ„ï¼Œæ‰€ä»¥è§£ææ—¶è¦å¾—åˆ°çœŸæ­£çš„æ•°æ®å—ï¼ˆIDAT)ï¼Œå¯¹è¿™ä¸€éƒ¨åˆ†è¿›è¡ŒåŠ å¯†ï¼Œè¿™æ ·æ‰èƒ½åŠ å¯†åä¾ç„¶èƒ½å¤Ÿä»¥pngæ–¹å¼æ‰“å¼€ï¼Œå…·ä½“çš„PNGæ ¼å¼å‚è€ƒï¼š<a href="https://blog.csdn.net/einsteinlike/article/details/41803193">PNGæ ¼å¼è¯´æ˜</a></p></li><li><p>æµ‹è¯•å‡½æ•°ä¸»è¦æœ‰4ä¸ª</p><ul><li><code>TestAll()</code> ï¼šè¿›è¡Œæ‰€æœ‰æµ‹è¯•</li><li><code>TestEncDec()</code>ï¼š æµ‹è¯•SM4 å•æ¬¡åŠ è§£å¯†128bits</li><li><code>TestEncDecFileECB()</code>ï¼š æµ‹è¯•SM4 åŠ å¯†å’Œè§£å¯†æ–‡ä»¶ ECBæ¨¡å¼</li><li><code>TestEncDecFileCBC()</code>ï¼š æµ‹è¯•SM4 åŠ å¯†å’Œè§£å¯†æ–‡ä»¶ CBCæ¨¡å¼</li><li><code>TestEncDecPNG()</code>ï¼š æµ‹è¯•SM4 åŠ å¯†å’Œè§£å¯†PNGå›¾ç‰‡</li></ul></li></ul><p class='note note-info'>  ä»£ç å·²ä¸Šä¼ Githubä»“åº“ï¼šhttps://github.com/2017zhangyuxuan/AppliedCryptography <br></p><p class='note note-danger'>  ä½†æ˜¯å½“å‰ä»£ç è¿˜å­˜åœ¨é—®é¢˜æ˜¯ï¼Œå¤§ç«¯å’Œå°ç«¯çš„é—®é¢˜æ²¡æœ‰å½»åº•è§£å†³ï¼Œå¦‚æœå¯¹æ¯”ä¸€äº›å®˜æ–¹å®ç°ï¼ŒåŠ å¯†ç»“æœæ˜¯ä¸åŒçš„ï¼Œå› ä¸ºæ—¶é—´åŸå› æ²¡æœ‰èƒ½æ’æŸ¥å‡ºæ¥ï¼Œåªèƒ½ä½œç½¢ã€‚æ‰€ä»¥ä»…ä»…æ˜¯æä¾›ä¸€äº›æ€è·¯ã€‚</p><center><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/hexo_img/èœç‹—.jpeg" width="40%" height="40%" align="middle" ></center><h1 id="å‚è€ƒé™„å½•"><a class="markdownIt-Anchor" href="#å‚è€ƒé™„å½•"></a> å‚è€ƒé™„å½•</h1><p>SM4ç®—æ³•åŸç† ï¼š<a href="https://blog.csdn.net/bird_tp/article/details/105988468">https://blog.csdn.net/bird_tp/article/details/105988468</a></p><p>SM4 å®ç°å‚è€ƒï¼š<a href="https://cryptopp.com/docs/ref/class_s_m4_1_1_base.html#details">https://cryptopp.com/docs/ref/class_s_m4_1_1_base.html#details</a></p><p><a href="https://blog.csdn.net/weixin_39672443/article/details/110806799">pngæ–‡ä»¶å¤´_å›¾ç‰‡æ ¼å¼çŸ¥è¯†PNG_weixin_39672443çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/einsteinlike/article/details/41803193">PNGæ ¼å¼è¯´æ˜</a></p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>å¯†ç å­¦</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SM4</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€æ¯”ç‰¹å¸ä¸“é¢˜03ã€‘éš”ç¦»è§è¯ã€é—ªç”µç½‘ç»œ</title>
    <link href="/2021/11/13/2021-11/2021-11-13%20%E6%AF%94%E7%89%B9%E5%B8%81%E4%B8%93%E9%A2%9803-%E9%9A%94%E7%A6%BB%E8%A7%81%E8%AF%81%E3%80%81%E9%97%AA%E7%94%B5%E7%BD%91%E7%BB%9C/"/>
    <url>/2021/11/13/2021-11/2021-11-13%20%E6%AF%94%E7%89%B9%E5%B8%81%E4%B8%93%E9%A2%9803-%E9%9A%94%E7%A6%BB%E8%A7%81%E8%AF%81%E3%80%81%E9%97%AA%E7%94%B5%E7%BD%91%E7%BB%9C/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>æœ€è¿‘é€šè¯»äº†ä¸€éã€Šç²¾é€šæ¯”ç‰¹å¸ã€‹ï¼Œå¯¹æ¯”ç‰¹å¸ä¸­è¿è¡Œæœºåˆ¶å’Œå®ç°åŸç†æœ‰äº†åˆæ­¥çš„è®¤è¯†å’Œäº†è§£ã€‚å…¶ä¸­éš”ç¦»è§è¯å’Œé—ªç”µç½‘ç»œæ˜¯æ­¤å‰å­¦ä¹ ä¸­é‡åˆ°åˆ°ä¸¤ä¸ªå›°æƒ‘ç‚¹ï¼Œç°åœ¨ä¹Ÿå¤§è‡´æœ‰æ‰€äº†è§£ï¼Œæ•…è€Œæœ¬ç¯‡æ–‡ç« å°±æ¥è°ˆè°ˆæˆ‘çš„ä¸ªäººç†è§£ï¼ŒåŸºæœ¬ä¸Šæ˜¯å¯¹ä¹¦é‡Œå…³é”®çŸ¥è¯†ç‚¹çš„æç‚¼å’Œæ€»ç»“ï¼Œä¸‹æ–¹ä¹Ÿç»™å‡ºäº†ç”µå­ä¹¦è¿æ¥ã€‚å¦‚æœ‰ä»»ä½•é”™è¯¯ï¼Œæ¬¢è¿æ‰¹è¯„æŒ‡å‡º~</p><p class='note note-info'><a href=https://github.com/tianmingyun/MasterBitcoin2CN>ç²¾é€šæ¯”ç‰¹å¸ç”µå­ä¹¦é“¾æ¥</a>  </p><h1 id="éš”ç¦»è§è¯"><a class="markdownIt-Anchor" href="#éš”ç¦»è§è¯"></a> éš”ç¦»è§è¯</h1><p>éš”ç¦»è§è¯æå‡ºçš„èƒŒæ™¯ï¼šéšç€æ¯”ç‰¹å¸ç«çƒ­å‘å±•ï¼Œç½‘ç»œä¸Šçš„äº¤æ˜“é‡è¶Šæ¥è¶Šå¤§ï¼Œè€Œç”±äºåŒºå—å¤§å°å—é™ï¼Œä¸€ä¸ªåŒºå—èƒ½æ‰“åŒ…çš„äº¤æ˜“æ•°é‡æ˜¯æœ‰ä¸€å®šé™åˆ¶çš„ï¼Œè€Œå‡ºå—é€Ÿåº¦é™å®šåœ¨10åˆ†é’Ÿä¸€æ¬¡ï¼Œè¿™å°±å¯¼è‡´æ— æ³•æ»¡è¶³äº¤æ˜“ååé‡çš„å¢é•¿ã€‚é‚£ä¹ˆéš”ç¦»è§è¯æå‡ºï¼ŒæŒ‘æˆ˜äº†äº¤æ˜“ç»“æ„ï¼Œä½¿å¾—ä¸€ä¸ªåŒºå—å¯ä»¥å®¹çº³æ›´å¤šçš„äº¤æ˜“ï¼Œä»è€Œæé«˜äº†äº¤æ˜“ååé‡ï¼Œå½“æ—¶éš”ç¦»è§è¯è¿˜æœ‰åˆ«çš„å¥½å¤„ï¼Œå¯ä»¥å»çœ‹ä¹¦ä¸­å†…å®¹<a href="https://github.com/tianmingyun/MasterBitcoin2CN/blob/master/ch07.md#781-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8%E9%9A%94%E7%A6%BB%E8%A7%81%E8%AF%81">éš”ç¦»è§è¯çš„å¥½å¤„</a>ã€‚å½“ç„¶æé«˜æ¯”ç‰¹å¸æ€§èƒ½ï¼ˆæ¯”å¦‚æé«˜äº¤æ˜“ååé‡ï¼‰çš„æ–¹æ³•è¿˜æœ‰å¾ˆå¤šï¼Œè¿™é‡Œä¸å†å±•å¼€ã€‚</p><p class='note note-primary'>éš”ç¦»è§è¯ç›¸å…³BIPæ–¹æ¡ˆ:<br>  <a href="https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki">BIP-141 éš”ç¦»è§è¯çš„å®šä¹‰</a>  <br>    <a href="https://github.com/bitcoin/bips/blob/master/bip-0144.mediawiki">BIP-144 éš”ç¦»è§è¯ç½‘ç»œåºåˆ—åŒ–</a></p><h2 id="å…³é”®çŸ¥è¯†"><a class="markdownIt-Anchor" href="#å…³é”®çŸ¥è¯†"></a> å…³é”®çŸ¥è¯†</h2><ul><li>åœ¨æ¯”ç‰¹å¸ç¯å¢ƒä¸­ï¼Œæ•°å­—ç­¾åæ˜¯è§è¯çš„<em>ä¸€ç§ç±»å‹</em>ï¼Œä½†æ›´å¹¿ä¹‰æ¥è¯´ï¼Œè§è¯æ˜¯æŒ‡èƒ½å¤Ÿæ»¡è¶³å¯¹UTXOæ–½åŠ çš„æ¡ä»¶å¹¶è§£é”è¯¥UTXOä»¥ä¾›æ¶ˆè´¹çš„ä»»ä½•è§£å†³æ–¹æ¡ˆã€‚æœ¯è¯­â€œè§è¯â€æ˜¯â€œè§£é”è„šæœ¬â€æˆ–â€œscriptSigâ€çš„æ›´ä¸€èˆ¬çš„æœ¯è¯­ã€‚</li><li>åœ¨å¼•å…¥éš”ç¦»è§è¯ä¹‹å‰ï¼Œäº¤æ˜“ä¸­çš„æ¯ä¸€ä¸ªè¾“å…¥åé¢ç´§è·Ÿç€çš„å°±æ˜¯è§£é”å®ƒçš„è§è¯æ•°æ®ã€‚è§è¯æ•°æ®ä½œä¸ºæ¯ä¸ªè¾“å…¥çš„ä¸€éƒ¨åˆ†åµŒå…¥åˆ°äº¤æ˜“ä¸­ã€‚æœ¯è¯­<em>éš”ç¦»è§è¯</em>ï¼ˆç®€ç§°<em>segwit</em>ï¼‰åªæ˜¯æŒ‡æŠŠç‰¹å®šè¾“å‡ºçš„ç­¾åæˆ–è§£é”è„šæœ¬éš”ç¦»å¼€ã€‚â€œå•ç‹¬çš„scriptSigâ€æˆ–â€œå•ç‹¬çš„ç­¾åâ€å°±æ˜¯å®ƒæœ€ç®€å•çš„å½¢å¼ã€‚</li><li>ä¹ä¸€çœ‹ï¼Œéš”ç¦»è§è¯ä¼¼ä¹åªæ˜¯å¯¹äº¤æ˜“æ„é€ æ–¹å¼çš„æ”¹å˜ï¼Œå±äºäº¤æ˜“çº§ç‰¹æ€§ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ã€‚å…¶å®ï¼Œéš”ç¦»è§è¯æ˜¯å¯¹å•ç‹¬çš„UTXOèŠ±è´¹æ–¹å¼çš„æ›´æ”¹ï¼Œå› æ­¤å¯ä»¥è¯´æ˜¯æ¯ä¸ªè¾“å‡ºå±‚é¢çš„ç‰¹æ€§ã€‚</li><li>å½“äº¤æ˜“ä½¿ç”¨UTXOæ—¶ï¼Œå¿…é¡»æä¾›ä¸€ä¸ªè§è¯ã€‚åœ¨ä¼ ç»Ÿçš„UTXOä¸­ï¼Œé”å®šè„šæœ¬è¦æ±‚è§è¯æ•°æ®<em>å†…åµŒ</em>åœ¨èŠ±è´¹UTXOçš„äº¤æ˜“çš„è¾“å…¥éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œéš”ç¦»è§è¯UTXOæŒ‡å®šäº†ä¸€ä¸ªé”å®šè„šæœ¬ï¼Œè¯¥è„šæœ¬å¯ä»¥ç”¨è¾“å…¥ä¹‹å¤–çš„è§è¯æ•°æ®ï¼ˆéš”ç¦»ï¼‰æ»¡è¶³ã€‚</li><li><strong>éš”ç¦»è§è¯æ˜¯ä¸€ä¸ªè½¯åˆ†å‰</strong></li></ul><h2 id="txid-å’Œ-wtxid"><a class="markdownIt-Anchor" href="#txid-å’Œ-wtxid"></a> TXID å’Œ WTXID</h2><ul><li>éš”ç¦»è§è¯çš„æœ€å¤§å¥½å¤„ä¹‹ä¸€å°±æ˜¯<strong>æ¶ˆé™¤äº†ç¬¬ä¸‰æ–¹äº¤æ˜“å»¶å±•æ€§</strong>ã€‚</li><li>åœ¨éš”ç¦»è§è¯ä¹‹å‰ï¼Œäº¤æ˜“å¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹å·§å¦™åœ°ä¿®æ”¹å…¶ç­¾åï¼Œåœ¨ä¸æ”¹å˜ä»»ä½•åŸºæœ¬å±æ€§ï¼ˆè¾“å…¥ï¼Œè¾“å‡ºï¼Œé‡‘é¢ï¼‰çš„æƒ…å†µä¸‹æ›´æ”¹å…¶äº¤æ˜“IDï¼ˆå“ˆå¸Œï¼‰ã€‚è¿™ä¸ºæ‹’ç»æœåŠ¡DOSæ”»å‡»ï¼Œä»¥åŠå¯¹æœ‰ç¼ºé™·çš„é’±åŒ…è½¯ä»¶çš„æ”»å‡»åˆ›é€ äº†æœºä¼šï¼Œè¿™äº›è½¯ä»¶å‡å®šæœªç»è¯å®çš„äº¤æ˜“å“ˆå¸Œæ˜¯ä¸å¯å˜çš„ã€‚</li><li>é€šè¿‡å¼•å…¥éš”ç¦»è§è¯ï¼Œäº¤æ˜“æœ‰ä¸¤ä¸ªæ ‡è¯†ç¬¦txidå’Œwtxidã€‚ä¼ ç»Ÿçš„txidæ˜¯åºåˆ—åŒ–äº¤æ˜“çš„åŒSHA256å“ˆå¸Œï¼Œæ²¡æœ‰è§è¯æ•°æ®ã€‚äº¤æ˜“çš„wtxidæ˜¯å…·æœ‰è§è¯æ•°æ®çš„äº¤æ˜“çš„æ–°åºåˆ—åŒ–æ ¼å¼çš„åŒSHA256å“ˆå¸Œã€‚</li><li>ä¼ ç»Ÿtxidçš„è®¡ç®—æ–¹å¼ä¸ééš”ç¦»è§è¯äº¤æ˜“å®Œå…¨ç›¸åŒã€‚ä½†æ˜¯ï¼Œç”±äºéš”ç¦»è§è¯äº¤æ˜“åœ¨æ¯ä¸ªè¾“å…¥ä¸­éƒ½æœ‰ç©ºçš„scriptSigï¼Œä¸å­˜åœ¨å¯ç”±ç¬¬ä¸‰æ–¹ä¿®æ”¹çš„äº¤æ˜“éƒ¨åˆ†ã€‚å› æ­¤ï¼Œåœ¨éš”ç¦»äº¤æ˜“ä¸­ï¼Œå³ä½¿äº¤æ˜“æœªç»ç¡®è®¤ï¼Œtxidä¹Ÿæ˜¯ä¸èƒ½è¢«ç¬¬ä¸‰æ–¹ä¿®æ”¹çš„ã€‚</li></ul><blockquote><p><strong>æç¤º</strong> éš”ç¦»è§è¯äº¤æ˜“æœ‰ä¸¤ä¸ªIDï¼štxidå’Œwtxidã€‚txidæ˜¯æ²¡æœ‰è§è¯æ•°æ®çš„äº¤æ˜“çš„å“ˆå¸Œï¼Œwtxidæ˜¯åŒ…å«è§è¯æ•°æ®çš„å“ˆå¸Œã€‚æ‰€æœ‰è¾“å…¥éƒ½æ˜¯éš”ç¦»è§è¯è¾“å…¥çš„äº¤æ˜“ï¼Œä¸å—ç¬¬ä¸‰æ–¹äº¤æ˜“å»¶å±•æ€§å½±å“ã€‚</p></blockquote><hr /><ul><li>TXIDçš„ç”Ÿæˆå’Œä¼ ç»Ÿæ–¹å¼ä¸€è‡´ï¼šæ˜¯å¯¹version, txins, txouts, nLocktimeåºåˆ—åŒ–åçš„æ•°æ®ï¼Œè¿›è¡Œä¸¤æ¬¡SHA256å“ˆå¸Œ</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">[nVersion][txins][txouts][nLockTime]<br></code></pre></td></tr></table></figure><ul><li>WTXIDçš„ç”Ÿæˆï¼šå¯¹version, marker, flag, txins, txouts, witness, nLocktimeåºåˆ—åŒ–åçš„æ•°æ®ï¼Œè¿›è¡Œä¸¤æ¬¡SHA256å“ˆå¸Œ</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">[nVersion][marker][flag][txins][txouts][witness][nLockTime]<br></code></pre></td></tr></table></figure><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111131049973.png" alt="TXIDä¸WTXIDçš„ç”Ÿæˆ" /></p><h2 id="éš”ç¦»è§è¯çš„æ•°æ®åˆ°åº•æ”¾åœ¨å“ªé‡Œ"><a class="markdownIt-Anchor" href="#éš”ç¦»è§è¯çš„æ•°æ®åˆ°åº•æ”¾åœ¨å“ªé‡Œ"></a> éš”ç¦»è§è¯çš„æ•°æ®åˆ°åº•æ”¾åœ¨å“ªé‡Œ</h2><p>åœ¨äº†è§£éš”ç¦»è§è¯çš„å¤§è‡´åŸç†åï¼Œæˆ‘å…¶å®è¿˜æ˜¯å­˜åœ¨ä¸€ä¸ªç–‘æƒ‘ï¼šæ—¢ç„¶è¯´è§è¯ç›¸å½“äºæ˜¯åŸæ¥çš„ç­¾åæ•°æ®ï¼ˆè§£é”è„šæœ¬ï¼‰ï¼Œä¸åŸæ¥çš„äº¤æ˜“æ•°æ®éš”ç¦»å¼€ï¼Œé‚£ä¹ˆè¿™äº›è§è¯æ•°æ®åˆ°åº•æ”¾åœ¨å“ªé‡Œäº†ï¼Ÿ</p><ul><li><p>é€šè¿‡<a href="https://www.jianshu.com/p/eef8e260b9f7">æ¯”ç‰¹å¸æ¢ç©¶ä¹‹éš”ç¦»è§è¯</a> è¿™ç¯‡æ–‡ç« ï¼Œäº†è§£åˆ°åŸæ¥çš„ç­¾åæ•°æ®æ”¾åˆ°äº†è§è¯æ•°æ®ä¸­ï¼Œè§è¯æ•°æ®åœ¨CTxIn æ˜¯ä¸€ä¸ªæ–°çš„å­—æ®µï¼Œä½†æ˜¯åªæœ‰åœ¨äº¤æ˜“è¢«åºåˆ—åŒ–ç½‘ç»œä¼ è¾“æ—¶æ‰å‚ä¸ï¼Œå‘¼åº”ä¸Šæ–‡è®¡ç®—TXIDæ—¶ï¼Œwitnessæ˜¯ä¸éœ€è¦åºåˆ—åŒ–çš„ï¼›</p></li><li><p>é€šè¿‡<a href="https://boinnex.com/what-is-segwit/">å¤–æ–‡- Segwitå¦‚ä½•å·¥ä½œçš„</a> è¿™ç¯‡æ–‡ç« ï¼Œè¿›ä¸€æ­¥äº†è§£åˆ°åœ¨ç”ŸæˆåŒºå—æ—¶ï¼Œè¾“å…¥çš„è§è¯æ•°æ®åŒæ ·æ„æˆä¸€æ£µMerkle Treeï¼Œå¹¶æŠŠrootæ”¾åˆ°äº†åŒºå—ä¸­çš„å¸åŸºäº¤æ˜“çš„outputçš„é”å®šè„šæœ¬ä¸­ï¼Œå…·ä½“åŸæ–‡æè¿°å¦‚ä¸‹å›¾ã€‚</p></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111131137534" alt="ScriptPubKey of Witness in coinbase " /></p><h1 id="é—ªç”µç½‘ç»œ"><a class="markdownIt-Anchor" href="#é—ªç”µç½‘ç»œ"></a> é—ªç”µç½‘ç»œ</h1><p>é—ªç”µç½‘ç»œå…¶å®ä¹Ÿæ˜¯ä¸€ç§æé«˜æ¯”ç‰¹å¸äº¤æ˜“æ€§èƒ½çš„æ–¹æ³•ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†å¤§é‡äº¤æ˜“æ”¾åˆ°æ¯”ç‰¹å¸åŒºå—é“¾ä¹‹å¤–è¿›è¡Œã€‚åœ¨å…·ä½“ä»‹ç»é—ªç”µç½‘ç»œæ˜¯å¦‚ä½•å·¥ä½œè¿è¡Œå‰ï¼Œè¿˜éœ€è¦å…ˆä»‹ç»çŠ¶æ€é€šé“ï¼Œæ”¯ä»˜é€šé“ï¼ŒHTLCå“ˆå¸Œæ—¶é—´é”åˆçº¦ç­‰æ¦‚å¿µã€‚</p><h2 id="çŠ¶æ€é€šé“å’Œæ”¯ä»˜é€šé“"><a class="markdownIt-Anchor" href="#çŠ¶æ€é€šé“å’Œæ”¯ä»˜é€šé“"></a> çŠ¶æ€é€šé“å’Œæ”¯ä»˜é€šé“</h2><p>åŸºæœ¬æ¦‚å¿µï¼š</p><ul><li><em>æ”¯ä»˜é€šé“Payment channels</em>æ˜¯åœ¨æ¯”ç‰¹å¸åŒºå—é“¾ä¹‹å¤–ï¼ŒåŒæ–¹äº¤æ¢æ¯”ç‰¹å¸äº¤æ˜“çš„æ— ä¿¡ä»»æœºåˆ¶ã€‚</li><li>å®é™…ä¸Šï¼Œ<em>é€šé“channel</em> ä¸€è¯æ˜¯ä¸€ä¸ªæ¯”å–»ã€‚çŠ¶æ€é€šé“æ˜¯åŒºå—é“¾å¤–ï¼Œç”±åŒæ–¹ä¹‹é—´çš„äº¤æ¢çŠ¶æ€ä»£è¡¨çš„è™šæ‹Ÿæ„æƒ³ã€‚å®é™…ä¸Šæ²¡æœ‰â€œé€šé“â€ï¼Œåº•å±‚æ•°æ®ä¼ è¾“æœºåˆ¶ä¹Ÿå¹¶ä¸æ˜¯é€šé“ã€‚æˆ‘ä»¬ä½¿ç”¨é€šé“è¿™ä¸ªæœ¯è¯­æ¥è¡¨ç¤ºé“¾å¤–åŒæ–¹ä¹‹é—´çš„å…³ç³»å’Œå…±äº«çŠ¶æ€ã€‚</li><li>æ”¯ä»˜é€šé“æ˜¯æ›´å¹¿æ³›çš„<em>çŠ¶æ€é€šé“state channel</em>æ¦‚å¿µçš„ä¸€éƒ¨åˆ†ï¼ŒçŠ¶æ€é€šé“ä»£è¡¨äº†é“¾å¤–çŠ¶æ€çš„å˜åŒ–ï¼Œé€šè¿‡æœ€ç»ˆåœ¨åŒºå—é“¾ä¸Šç»“ç®—å¾—åˆ°ä¿éšœã€‚æ”¯ä»˜é€šé“æ˜¯ä¸€ç§çŠ¶æ€é€šé“ï¼Œå…¶ä¸­è¢«æ”¹å˜çš„çŠ¶æ€æ˜¯è™šæ‹Ÿè´§å¸ä½™é¢ã€‚</li></ul><hr /><p>ã€Šç²¾é€šæ¯”ç‰¹å¸ã€‹ä¸­å¯¹æ”¯ä»˜é€šé“çš„æè¿°æ„Ÿè§‰è¿‡äºå¤æ‚ï¼Œè¿™é‡Œç”¨Bitcoin Developer Guideé‡Œçš„å¾®æ”¯ä»˜é€šé“æ¥ä¸¾ä¾‹è¯´æ˜ï¼Œåœ¨ä¹‹å‰åšå®¢[ã€æ¯”ç‰¹å¸ä¸“é¢˜02ã€‘Developer Guideå¯¼è¯»](<a href="https://2017zhangyuxuan.github.io/2021/10/11/2021-10-11%E6%AF%94%E7%89%B9%E5%B8%81%E4%B8%93%E9%A2%9802-Developer">https://2017zhangyuxuan.github.io/2021/10/11/2021-10-11æ¯”ç‰¹å¸ä¸“é¢˜02-Developer</a> Guide/) ä¹Ÿæœ‰ä»‹ç»ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111131147856.(null)" alt="å¾®æ”¯ä»˜é€šé“" /></p><ul><li>å…¶å·¥ä½œåŸç†å¤§ä½“ä¸Šå¯ä»¥è¿™æ ·æè¿°ï¼šAç»™Bæ‰“å·¥ï¼ŒBé¦–å…ˆä½¿ç”¨Aå’ŒBçš„ç­¾åï¼Œä½¿ç”¨P2SHçš„æ–¹å¼ï¼Œå‘é€ä¸€å®šé‡‘é¢åˆ°è„šæœ¬åœ°å€ï¼Œå¹¶å°†è¯¥äº¤æ˜“ç«‹å³ä¼ æ’­åˆ°æ¯”ç‰¹å¸ç½‘ç»œä¸Šï¼›ç„¶åBåˆ›é€ ç¬¬äºŒä¸ªäº¤æ˜“ï¼Œå¹¶ç”¨åˆ°åˆšåˆšAçš„ç­¾åï¼Œå…¶è¾“å…¥æ˜¯ç¬¬ä¸€ä¸ªäº¤æ˜“çš„è„šæœ¬åœ°å€ï¼Œè¾“å‡ºæ˜¯Bçš„åœ°å€ï¼ˆç›¸å½“äºå…¨é¢è¿”å›ç»™Bï¼‰ï¼Œç„¶åç»™è¿™ä¸ªäº¤æ˜“åŠ ä¸ŠLocktimeï¼Œæ¯”å¦‚è¯´ä¸€å¤©åæ‰èƒ½å¹¿æ’­è¿™ä¸ªäº¤æ˜“ã€‚ç„¶åAç»™Bå·¥ä½œä¸€éƒ¨åˆ†å†…å®¹åï¼ŒAè¦æ±‚Bå…ˆæ”¯ä»˜è¿™ä»½å·¥ä½œé‡çš„è–ªæ°´ï¼Œé‚£ä¹ˆBå°±åˆ›å»ºä¸€ä»½æ–°çš„äº¤æ˜“ï¼Œä»åŸæ¥å…¨é¢ç»™Bå˜æˆåˆ†å‡ºä¸€éƒ¨åˆ†é‡‘é¢ç»™Aï¼Œè¿™ä¸ªæ–°çš„äº¤æ˜“æ‹·è´ç»™Aï¼Œè¿™æ ·Aå°±å¯ä»¥å¹¿æ’­è¿™ä¸ªæ–°çš„äº¤æ˜“ä»è€Œè·å¾—è–ªæ°´ã€‚ï¼ˆå®é™…ä¸ŠAåªéœ€è¦åœ¨locktimeè¿‡æœŸå‰ï¼Œå¹¿æ’­æœ€åç‰ˆæœ¬çš„äº¤æ˜“å³å¯ï¼‰<ul><li>Båˆ›å»ºçš„ç¬¬ä¸€ç¬”äº¤æ˜“å’Œç¬¬äºŒç¬”äº¤æ˜“ï¼Œå¯ä»¥ç†è§£ä¸ºã€Šç²¾é€šæ¯”ç‰¹å¸ã€‹ä¸­çš„<em>æ³¨èµ„äº¤æ˜“funding transaction</em>æˆ–<em>é”šç‚¹äº¤æ˜“anchor transaction</em>ï¼šé€šè¿‡åœ¨åŒºå—é“¾ä¸Šé”å®šå…±äº«çŠ¶æ€çš„äº¤æ˜“ï¼Œåœ¨äº¤æ˜“ä¸¤æ–¹ä¹‹é—´å»ºç«‹äº†ä¸€ä¸ªçŠ¶æ€é€šé“ã€‚åœ¨æ”¯ä»˜é€šé“çš„ç¤ºä¾‹ä¸­ï¼Œé”å®šçš„çŠ¶æ€å³ä¸ºé€šé“çš„åˆå§‹ä½™é¢ï¼ˆä»¥è´§å¸è®¡ï¼‰</li><li>éšååŒæ–¹äº¤æ¢å·²ç­¾åçš„äº¤æ˜“ï¼Œè¿™è¢«ç§°ä¸º<em>æ‰¿è¯ºäº¤æ˜“commitment transactions</em>ã€‚æ‰¿è¯ºäº¤æ˜“ä¼šæ”¹å˜åˆå§‹çŠ¶æ€ã€‚è¿™äº›äº¤æ˜“æ˜¯æœ‰æ•ˆçš„äº¤æ˜“ï¼Œå› ä¸ºå®ƒä»¬<em>å¯ä»¥</em>è¢«ä»»ä½•ä¸€æ–¹æäº¤è¿›è¡Œç»“ç®—ï¼Œä½†æ˜¯åœ¨é€šé“å…³é—­ä¹‹å‰ï¼Œæ¯ä¸€æ–¹éƒ½ä¼šå°†å…¶åœ¨é“¾ä¸‹ä¿ç•™ã€‚</li><li>æœ€åï¼Œé€šé“å¯ä»¥åå•†å…³é—­ï¼Œå³å‘åŒºå—é“¾æäº¤æœ€åçš„<em>ç»“ç®—äº¤æ˜“settlement transaction</em>ï¼Œæˆ–è€…ç”±ä»»ä½•ä¸€æ–¹å•æ–¹é¢æäº¤æœ€åæ‰¿è¯ºäº¤æ˜“åˆ°é“¾ä¸Šã€‚</li></ul></li><li>ä¸ºä»€ä¹ˆé‡‡ç”¨æ”¯ä»˜é€šé“è¿™æ ·çš„æ–¹å¼å‘¢ï¼Œå› ä¸ºAè¯‰æ±‚æ˜¯åŠæ—¶æ”¯ä»˜è–ªæ°´ï¼Œä½†æ˜¯å› ä¸ºé‡å°ï¼ŒBä¸èƒ½æ¯æ¬¡éƒ½ç«‹å³åˆ›é€ ä¸€ä¸ªäº¤æ˜“å³åˆ»æ”¯ä»˜ï¼Œè¿™æ ·çš„äº¤æ˜“è´¹çš„æˆæœ¬å¤ªé«˜äº†ã€‚æ‰€ä»¥åˆ©ç”¨è¿™æ ·çš„æ–¹å¼ï¼Œæ—¢ç¡®ä¿äº†Açš„è–ªæ°´æ˜¯åŠæ—¶å¾—åˆ°ç¡®è®¤çš„ï¼Œåˆå¯ä»¥ä½¿å¾—åªéœ€ä¸€ä¸ªäº¤æ˜“å°±ä¸€æ¬¡æ€§æ”¯ä»˜è–ªæ°´</li><li>å®é™…ä¸Šï¼Œæ›´æ”¹äº¤æ˜“é‡‘é¢çš„è¾“å‡ºï¼Œè¿™ä¸ªæƒåˆ©æ˜¯åœ¨Bçš„ï¼Œå› ä¸ºBæœ‰Açš„ç­¾åä½†Aæ²¡æœ‰Bçš„ç­¾åï¼ŒAæ‹¿çš„æ˜¯ç»è¿‡Bç­¾ååçš„äº¤æ˜“å‰¯æœ¬ï¼ˆè¿™ä¸ªäº¤æ˜“è¢«Bç­¾åè¿‡äº†ï¼Œæ‰€ä»¥æ˜¯æœ‰æ•ˆçš„ï¼‰ã€‚æ‰€ä»¥Aèƒ½å®æ—¶ç¡®ä¿è‡ªå·±å¯¹åº”å·¥ä½œé‡çš„è–ªæ°´èƒ½åŠæ—¶æ”¯ä»˜ï¼Œå°±ç®—ä¸­é€”Bè·‘è·¯äº†ï¼Œä¹Ÿåªæ˜¯æŸå¤±ä¸€å°éƒ¨åˆ†å·¥ä½œé‡çš„è–ªæ°´ï¼Œä¹‹å‰çš„è–ªæ°´éƒ½å¯ä»¥å¾—åˆ°æ”¯ä»˜ã€‚è€Œå¯¹Bæ¥è¯´ï¼Œå¦‚æœAæ²¡æœ‰å·¥ä½œï¼Œé‚£Bä¹Ÿèƒ½åœ¨locktime è¿‡æœŸåæ‹¿å›è‡ªå·±çš„é’±ï¼ˆä¸è¿‡è¿™æ ·å°±éœ€è¦ç­‰å¾…ä¸€ä¸ªlocktimeçš„æ—¶é—´ï¼‰</li></ul><h2 id="htlcå“ˆå¸Œæ—¶é—´é”åˆçº¦"><a class="markdownIt-Anchor" href="#htlcå“ˆå¸Œæ—¶é—´é”åˆçº¦"></a> HTLCå“ˆå¸Œæ—¶é—´é”åˆçº¦</h2><p><a href="https://github.com/tianmingyun/MasterBitcoin2CN/blob/master/ch12.md#1255-%E5%93%88%E5%B8%8C%E6%97%B6%E9%97%B4%E9%94%81%E5%90%88%E7%BA%A6htlc">HTLC å“ˆå¸Œæ—¶é—´é”åˆçº¦</a> åŸæ–‡ä¸­ä»‹ç»å¾—æ¯”è¾ƒè¯¦ç»†äº†ï¼Œè¿™é‡Œç®€å•æ€»ç»“ä¸€ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> é€šè¿‡å¯†é’¥Rç”Ÿæˆå“ˆå¸Œå€¼H</span><br>H = Hash(R)<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å®ç°HTLCçš„è„šæœ¬å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</span><br>IF<br>Payment if you have the secret R<br>    HASH160 &lt;H&gt; EQUALVERIFY<br>ELSE<br>    # Refund after timeout.<br>    &lt;locktime&gt; CHECKLOCKTIMEVERIFY DROP<br>    &lt;Payer Public Key&gt; CHECKSIG<br>ENDIF<br></code></pre></td></tr></table></figure><ul><li>ä»»ä½•çŸ¥é“å¯†é’¥Rï¼Œå…¶å“ˆå¸Œå€¼ç­‰äºHçš„äººï¼Œéƒ½å¯ä»¥é€šè¿‡è¡Œä½¿IFè¯­å¥çš„ç¬¬ä¸€ä¸ªå­å¥æ¥å…‘æ¢è¯¥è¾“å‡ºã€‚</li><li>å¦‚æœå¯†é’¥Ræ²¡æœ‰è¢«é€éœ²ï¼ŒHTLCä¸­å†™æ˜äº†ï¼Œåœ¨ä¸€å®šæ•°é‡çš„åŒºå—ä¹‹åï¼Œä»˜æ¬¾äººå¯ä»¥ä½¿ç”¨IFè¯­å¥ä¸­çš„ç¬¬äºŒä¸ªå­å¥ç”³è¯·é€€æ¬¾ã€‚</li></ul><h2 id="é—ªç”µç½‘ç»œè¿è¡Œ"><a class="markdownIt-Anchor" href="#é—ªç”µç½‘ç»œè¿è¡Œ"></a> é—ªç”µç½‘ç»œè¿è¡Œ</h2><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111131152708.(null)" alt="" /></div><div class="group-image-wrap"><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202111131152805.(null)" alt="" /></div></div></div><p align="middle"><font size="2" color="grey">å·¦å›¾ï¼šæ”¯ä»˜é€šé“åˆå§‹çŠ¶æ€ï¼›å³å›¾ï¼šé—ªç”µç½‘ç»œè¿è¡Œæµç¨‹</font></p><p>æ¥ä¸‹æ¥è¯´æ˜ä¸€ä¸‹ï¼Œé—ªç”µç½‘ç»œæ˜¯å¦‚ä½•å·¥ä½œï¼š</p><ul><li>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰äº”ä¸ªå‚ä¸è€…ï¼šAlice, Bob, Carol, Diana, and Ericã€‚è¿™äº”åå‚ä¸è€…å·²ç»å½¼æ­¤ä¹‹é—´å¼€è®¾äº†æ”¯ä»˜é€šé“ã€‚Aliceå’ŒBobæœ‰æ”¯ä»˜é€šé“ã€‚Bobè¿æ¥Carolï¼ŒCarolè¿æ¥åˆ°Dianaï¼ŒDianaè¿æ¥Ericã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å‡è®¾æ¯ä¸ªé€šé“æ¯ä¸ªå‚ä¸è€…éƒ½æ³¨èµ„2ä¸ªæ¯”ç‰¹å¸èµ„é‡‘ï¼Œæ¯ä¸ªé€šé“çš„æ€»å®¹é‡ä¸º4ä¸ªæ¯”ç‰¹å¸ï¼Œä¹Ÿå°±æ˜¯å¦‚å·¦å›¾æ‰€ç¤ºçš„åˆå§‹çŠ¶æ€</li><li>Aliceæƒ³è¦æ”¯ä»˜ç»™Eric1ä¸ªæ¯”ç‰¹å¸ã€‚ä½†æ˜¯ï¼ŒAliceå¹¶æ²¡æœ‰ç›´æ¥è¿æ¥Ericçš„æ”¯ä»˜é€šé“ã€‚åˆ›å»ºæ”¯ä»˜é€šé“éœ€è¦æ³¨èµ„äº¤æ˜“ï¼Œè€Œè¿™ç¬”äº¤æ˜“å¿…é¡»é¦–å…ˆæäº¤ç»™æ¯”ç‰¹å¸åŒºå—é“¾ã€‚Aliceä¸æƒ³å»ºç«‹ä¸€ä¸ªæ–°çš„æ”¯ä»˜é€šé“è¿˜è¦æ”¯å‡ºæ›´å¤šçš„æ‰‹ç»­è´¹ã€‚é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡é—ªç”µç½‘ç»œæ¥è¿›è¡Œæ”¯ä»˜ã€‚</li></ul><ol><li>Aliceé€šè¿‡è·¯ç”±å‘ç°äº†ä¸€æ¡ä»Aliceåˆ°Ericçš„ä¸€æ¡æ”¯ä»˜è·¯ç”±ï¼Œç”±å¤šä¸ªæ”¯ä»˜é€šé“ç»„æˆã€‚æ­¤æ—¶Aliceå’ŒEricå¯ä»¥è¿›è¡Œé€šä¿¡ï¼ŒEricç”Ÿæˆä¸€ä¸ªå¯†é’¥Rï¼Œå¹¶è¿›è¡Œhashï¼Œå°†å“ˆå¸Œå€¼Hå‘é€ç»™Aliceã€‚</li><li>Aliceæ„é€ ä¸€ä¸ªHTLCï¼Œæ”¯ä»˜1.003BTCåˆ°å“ˆå¸ŒHï¼ˆå¤šå‡ºæ¥çš„0.003BTCæ˜¯ç»™è·¯ç”±ä¸Š3ä¸ªèŠ‚ç‚¹çš„è´¹ç”¨ï¼‰ï¼Œå¹¶å¯ä»¥åœ¨10åŒºå—å†…å¾—åˆ°é€€æ¬¾ã€‚Aliceå°†æ­¤HTLCæä¾›ç»™Bobï¼Œä»å’ŒBobä¹‹é—´çš„é€šé“ä½™é¢ä¸­æ‰£é™¤1.003æ¯”ç‰¹å¸ï¼Œå¹¶å°†å…¶æäº¤ç»™HTLCã€‚è¯¥HTLCå…·æœ‰ä»¥ä¸‹å«ä¹‰ï¼š<em>â€œå¦‚æœBobçŸ¥é“å¯†é’¥ï¼ŒAliceå°†å…¶é€šé“ä½™é¢çš„1.003æ”¯ä»˜ç»™Bobï¼Œæˆ–è€…å¦‚æœè¶…è¿‡10ä¸ªåŒºå—åï¼Œåˆ™é€€è¿˜å…¥Aliceçš„ä½™é¢â€</em>ã€‚</li><li>Bobæ„é€ ä¸€ä¸ªæ–°çš„HTLCï¼Œæ”¯ä»˜1.002BTCåˆ°å“ˆå¸ŒHï¼Œå¦‚æœCarolçŸ¥é“äº†å¯†é’¥Rï¼Œå¯ä»¥å»å–èµ°HTLCä¸­çš„1.002BTCï¼Œç„¶åBobä¹Ÿå¯ä»¥å–èµ°Aliceæä¾›çš„1.003BTCï¼Œç›¸å½“äºèµšå–äº†0.001BTCï¼›å¦‚æœCarolä¸èƒ½æä¾›å¯†é’¥ï¼ŒBobä¹Ÿå¯ä»¥åœ¨9ä¸ªåŒºå—æ—¶é—´å†…å–å›1.002BTC</li><li>Carolå‘Dianaæä¾›1.001BTCçš„HTLCï¼ŒåŒä¸Šé¢ä¸€æ ·</li><li>Dinanaå‘Ericæä¾›1.0BTCçš„HTLC</li><li>EricçŸ¥é“å¯†é’¥ï¼Œå‘Dianaå‡ºç¤ºäº†å¯†é’¥Rï¼Œå› æ­¤å–èµ°äº†HTLCä¸­çš„1.0BTC</li><li>Dianaä»EricçŸ¥é“äº†å¯†é’¥Rï¼Œå†å‘Carolå‡ºç¤ºå¯†é’¥Rï¼Œè·å¾—äº†1.001BTCï¼Œæ­¤æ—¶åœ¨Ericå’ŒDianaä¸­æ”¯ä»˜é€šé“ä¸­ï¼ŒDianaä½™é¢åªæœ‰1.0BTCäº†ï¼Œä½†åœ¨Carolå’ŒDianaçš„æ”¯ä»˜é€šé“ä¸­ï¼ŒDianaä½™é¢ä¸º3.001BTCï¼Œå¯¹æ¯”åŸæ¥çš„2+2ï¼Œèµšå–äº†0.001BTC</li><li>Carolå‘Dianaæ”¯ä»˜äº†1.001BTCï¼Œå†ä»Bobå¤„èµšå–äº†1.002BTCï¼Œèµšå–äº†0.001BTC</li><li>Bobå‘Carolæ”¯ä»˜äº†1.002BTCï¼Œä»Aliceå¤„èµšå–äº†1.003BTCï¼Œèµšå–äº†0.001BTC</li><li>æœ€ç»ˆAliceæ”¯ä»˜äº†1.003BTCï¼Œå®é™…ä¸Š1BTCè½¬è´¦ç»™äº†Ericï¼Œ0.003æ”¯ä»˜ç»™äº†è·¯ç”±ä¸Šçš„å…¶ä»–èŠ‚ç‚¹</li></ol>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>æ¯”ç‰¹å¸</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Bitcoin</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CryptoPP C++åº“å­¦ä¹ ä½¿ç”¨</title>
    <link href="/2021/11/01/2021-11/2021-11-01%20CryptoPP%E5%BA%93%E4%BD%BF%E7%94%A8/"/>
    <url>/2021/11/01/2021-11/2021-11-01%20CryptoPP%E5%BA%93%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><blockquote><p>å‚è€ƒä¹¦ç±ï¼šã€Šæ·±å…¥æµ…å‡ºCryptoPPå¯†ç å­¦åº“ã€‹<br />crypto++  å¯†ç å­¦åº“ ï¼š<a href="https://github.com/weidai11/cryptopp">https://github.com/weidai11/cryptopp</a><br />ç”µå­ä¹¦ä¸‹è½½ ï¼š<a href="https://gitee.com/locomotive_crypto">https://gitee.com/locomotive_crypto</a></p></blockquote><p>æœ€è¿‘åœ¨å­¦ä¹ æ¯”ç‰¹å¸ç›¸å…³æŠ€æœ¯ï¼Œåœ¨æ¯”ç‰¹å¸ç³»ç»Ÿä¸­ä½¿ç”¨å¤§é‡å“ˆå¸ŒåŠ å¯†ã€ç­¾åéªŒè¯ç­‰æ“ä½œï¼Œä¸ºäº†ç”¨ä»£ç æ¥æ¨¡æ‹Ÿå®ç°æ¯”ç‰¹å¸çš„è¿è¡Œè¿‡ç¨‹ï¼Œå­¦ä¹ ä¸€ä¸ªæ”¯æŒå¯†ç åŸè¯­æ“ä½œçš„ç¬¬ä¸‰æ–¹åº“æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚</p><p>æœ€ä¸ºçŸ¥åçš„å¯†ç å­¦ç›¸å…³å¼€æºåº“åº”è¯¥æ˜¯OpenSSLäº†ï¼Œä½†æ˜¯ç”±äºå®˜ç½‘æ˜¯ä¸€å †è‹±æ–‡ï¼Œå­¦ä¹ èµ·æ¥å¤ªåƒåŠ›ï¼Œåæ¥æœºç¼˜å·§åˆä¸‹å‘ç°äº†CryptoPPè¿™ä¸ªåº“ï¼Œè€Œä¸”è¿˜æœ‰ä¸“é—¨çš„ä¸­æ–‡ä¹¦ç±æ¥è®²è§£ä½¿ç”¨ï¼Œå› æ­¤å°±å†³å®šå­¦ä¹ CryptoPPåº“ï¼Œæœ¬ç¯‡è®ºæ–‡ä¹Ÿæ˜¯åŸºäºã€Šæ·±å…¥æµ…å‡ºCryptoPPå¯†ç å­¦åº“ã€‹é˜…è¯»ï¼Œæ•´ç†å‡ºå…³é”®ç« èŠ‚å†…å®¹ï¼Œä¾›å¤§å®¶å‚è€ƒå­¦ä¹ ã€‚</p><p class='note note-info'>1. CryptoPPåº“çš„å®‰è£…ä½¿ç”¨è¿™é‡Œä¸å†è¯¦ç»†è¯´æ˜ï¼Œè¯·å¤§å®¶è‡ªè¡Œæœç´¢ç½‘ä¸Šæ•™ç¨‹  <br>2. åæ¥çœ‹åˆ°OpenSSLä¹Ÿæœ‰ä¸€ä¸ªä¸­æ–‡æ‰‹å†Œå­¦ä¹ ç½‘ç«™ï¼Œä¹Ÿæ¨èç»™å¤§å®¶https://www.openssl.net.cn/</p><h1 id="string-å’Œ-secbyteblockç±»å‹äº’æ¢"><a class="markdownIt-Anchor" href="#string-å’Œ-secbyteblockç±»å‹äº’æ¢"></a> string å’Œ SecByteBlockç±»å‹äº’æ¢</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// SecByteBlock è½¬ string</span><br><br>SecByteBlock iv; ... <span class="hljs-comment">// C++-style cast </span><br><br>std::string token = std::<span class="hljs-built_in">string</span>(<span class="hljs-keyword">reinterpret_cast</span>&lt;<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>*&gt;(iv.<span class="hljs-built_in">data</span>()), iv.<span class="hljs-built_in">size</span>());<br><br><br><br><span class="hljs-comment">// string è½¬ SecByteBlock</span><br><br>std::string str; ... <span class="hljs-comment">// C++-style cast </span><br><br><span class="hljs-function">SecByteBlock <span class="hljs-title">sbb</span><span class="hljs-params">(<span class="hljs-keyword">reinterpret_cast</span>&lt;<span class="hljs-keyword">const</span> byte*&gt;(str.data()), str.size())</span></span>;<br></code></pre></td></tr></table></figure><h1 id="ç¬¬å››ç« -åˆè¯†cryptoppåº“"><a class="markdownIt-Anchor" href="#ç¬¬å››ç« -åˆè¯†cryptoppåº“"></a> ç¬¬å››ç«  åˆè¯†CryptoPPåº“</h1><h2 id="hexç¼–è§£ç å­—ç¬¦ä¸²"><a class="markdownIt-Anchor" href="#hexç¼–è§£ç å­—ç¬¦ä¸²"></a> Hexç¼–è§£ç å­—ç¬¦ä¸²</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;filters.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;hex.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> CryptoPP;<br><br><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br><br>    <span class="hljs-comment">// ç¬¬ä¸€ç§ç¼–ç æ–¹å¼</span><br><br>    HexEncoder hex;<br><br>    string str = <span class="hljs-string">&quot;I like&quot;</span>;<br><br>    string hexstr;<br><br>    hex.<span class="hljs-built_in">Detach</span>(<span class="hljs-keyword">new</span> <span class="hljs-built_in">StringSink</span>(hexstr));<br><br>    hex.<span class="hljs-built_in">Put</span>(<span class="hljs-keyword">reinterpret_cast</span>&lt;byte*&gt;(&amp;str[<span class="hljs-number">0</span>]),str.<span class="hljs-built_in">size</span>());  <span class="hljs-comment">// æ³¨æ„æ˜¯ä¼šè¿½åŠ å†™å…¥çš„</span><br><br>    cout &lt;&lt; <span class="hljs-string">&quot;str:&quot;</span> &lt;&lt; str &lt;&lt; endl;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;hexstr:&quot;</span> &lt;&lt; hexstr &lt;&lt; endl;<br><br><br><br>    <span class="hljs-comment">// ç¬¬äºŒç§ç¼–è§£ç å†™æ³•  Source -&gt; Filter -&gt; Sink  è¿™æ˜¯ä¸€ç§Pipelineçš„æ–¹å¼</span><br><br>    string encode,decode;<br><br>    <span class="hljs-function">StringSource <span class="hljs-title">enc</span><span class="hljs-params">(str, <span class="hljs-literal">true</span>, <span class="hljs-keyword">new</span> HexEncoder(<span class="hljs-keyword">new</span> StringSink(encode)))</span></span>;<br><br>    <span class="hljs-function">StringSource <span class="hljs-title">dec</span><span class="hljs-params">(hexstr, <span class="hljs-literal">true</span>, <span class="hljs-keyword">new</span> HexDecoder(<span class="hljs-keyword">new</span> StringSink(decode)))</span></span>;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;encode:&quot;</span>&lt;&lt;encode &lt;&lt; endl;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;decode:&quot;</span>&lt;&lt;decode &lt;&lt; endl;<br><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ç¬¬äº”ç« -éšæœºæ•°ç”Ÿæˆå™¨"><a class="markdownIt-Anchor" href="#ç¬¬äº”ç« -éšæœºæ•°ç”Ÿæˆå™¨"></a> ç¬¬äº”ç«  éšæœºæ•°ç”Ÿæˆå™¨</h1><p>ä¸»è¦å¯ä»¥å…³æ³¨GenerateBlockæ–¹æ³•ï¼Œç”ŸæˆæŒ‡å®šå­—èŠ‚é•¿åº¦çš„éšæœºæ•°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;osrng.h&gt;</span> <span class="hljs-comment">// å¯ä»¥ä½¿ç”¨ AutoSeededRandomPool ï¼Œè¯¥éšæœºå™¨ä¸ç”¨è®¾ç½®ç§å­</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;rng.h&gt;</span> <span class="hljs-comment">//åŒ…å«LC_RNGç®—æ³•çš„å¤´æ–‡ä»¶</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span> <span class="hljs-comment">//ä½¿ç”¨coutã€cin</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std; <span class="hljs-comment">//stdæ˜¯C++çš„å‘½åç©ºé—´</span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> CryptoPP; <span class="hljs-comment">//CryptoPPæ˜¯CryptoPPåº“çš„å‘½åç©ºé—´</span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> Array_Size 64</span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"></span>&#123;<br><br>    <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªLC_RNGéšæœºæ•°å‘ç”Ÿå™¨å¯¹è±¡ï¼Œå¹¶è®¾ç½®å…¶ç§å­</span><br><br>    <span class="hljs-function">LC_RNG  <span class="hljs-title">rng</span><span class="hljs-params">(time(<span class="hljs-number">0</span>))</span></span>;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;äº§ç”Ÿä¸€ä¸ªæ¯”ç‰¹çš„éšæœºæ•°ï¼š&quot;</span> &lt;&lt; rng.<span class="hljs-built_in">GenerateBit</span>() &lt;&lt; endl;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;äº§ç”Ÿä¸€ä¸ªå­—èŠ‚çš„éšæœºæ•°ï¼š&quot;</span> &lt;&lt; rng.<span class="hljs-built_in">GenerateByte</span>() &lt;&lt; endl;<br><br>    byte output[Array_Size + <span class="hljs-number">1</span>] = &#123;<span class="hljs-number">0</span>&#125;;<span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªç¼“å†²åŒº      </span><br><br><br><br>    <span class="hljs-comment">//äº§ç”ŸArray_Sizeå­—èŠ‚é•¿åº¦çš„éšæœºæ•°</span><br><br>    rng.<span class="hljs-built_in">GenerateBlock</span>(output, Array_Size);  <span class="hljs-comment">// è¿™é‡Œä¹Ÿå¯ç›´æ¥ä¼ å…¥SecByteBlock</span><br><br>    cout &lt;&lt; <span class="hljs-string">&quot;äº§ç”ŸArray_Sizeé•¿åº¦çš„éšæœºæ•°ï¼ˆåå…­è¿›åˆ¶ï¼‰ï¼š&quot;</span> &lt;&lt; endl;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; Array_Size; ++i)<br><br>    &#123;<span class="hljs-comment">//å°†è·å¾—çš„éšæœºæ•°è½¬æ¢æˆåå…­è¿›åˆ¶å¹¶è¾“å‡º</span><br><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02X&quot;</span>, output[i]);<br><br>    &#125;<br><br>    cout &lt;&lt; endl;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;äº§ç”Ÿä¸€ä¸ª100åˆ°1000ä¹‹é—´çš„éšæœºæ•°ï¼š&quot;</span> &lt;&lt; rng.<span class="hljs-built_in">GenerateWord32</span>(<span class="hljs-number">100</span>, <span class="hljs-number">1000</span>) &lt;&lt; endl;<br><br><br><br>    <span class="hljs-comment">//ä¸¢å¼ƒæ‰éšæœºæ•°å‘ç”Ÿå™¨æ¥ä¸‹æ¥äº§ç”Ÿçš„100ä¸ªå­—èŠ‚æ•°æ®</span><br><br>    rng.<span class="hljs-built_in">DiscardBytes</span>(<span class="hljs-number">100</span>);<br><br>    <span class="hljs-keyword">int</span> arry[] = &#123; <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span> &#125;;<br><br>    rng.<span class="hljs-built_in">Shuffle</span>(arry, arry + <span class="hljs-number">10</span>); <span class="hljs-comment">//æ‰“ä¹±æ•°ç»„arryä¸­å…ƒç´ çš„é¡ºåº</span><br><br>    <br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ç¬¬å…­ç« -hashå‡½æ•°"><a class="markdownIt-Anchor" href="#ç¬¬å…­ç« -hashå‡½æ•°"></a> ç¬¬å…­ç«  Hashå‡½æ•°</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;sha.h&gt;</span> <span class="hljs-comment">//ä½¿ç”¨SHA384</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;filters.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;hex.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span> <span class="hljs-comment">//ä½¿ç”¨coutã€cin</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std; <span class="hljs-comment">//stdæ˜¯C++çš„å‘½åç©ºé—´</span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> CryptoPP; <span class="hljs-comment">//CryptoPPæ˜¯CryptoPPåº“çš„å‘½åç©ºé—´</span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"></span>&#123;<br><br>    <span class="hljs-keyword">try</span><br><br>    &#123;<br><br>        SHA256 sha; <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªSHA256çš„ç±»å¯¹è±¡</span><br><br>        byte msg[] = <span class="hljs-string">&quot;I like cryptography very much&quot;</span>;<br><br><br><br>        <span class="hljs-comment">// ä½¿ç”¨pipelineèŒƒå¼</span><br><br>        <span class="hljs-function">SecByteBlock <span class="hljs-title">tmp</span><span class="hljs-params">(msg, <span class="hljs-keyword">sizeof</span>(msg)<span class="hljs-number">-1</span>)</span></span>;<br><br>        string r;<br><br>        <span class="hljs-function">StringSource <span class="hljs-title">s1</span> <span class="hljs-params">(tmp, tmp.size(),<span class="hljs-literal">true</span>,</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                         <span class="hljs-keyword">new</span> HashFilter(sha,    <span class="hljs-comment">// ä½¿ç”¨å…¶ä»–hashå‡½æ•°ï¼Œæ›´æ¢ä¸€ä¸‹ç±»å‹å³å¯</span></span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                         <span class="hljs-keyword">new</span> HexEncoder(</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                         <span class="hljs-keyword">new</span> StringSink(r))))</span></span>;<br><br>        cout &lt;&lt; r &lt;&lt; endl;<br><br>        r.<span class="hljs-built_in">clear</span>();  <span class="hljs-comment">// æ¸…ç©ºä¸€ä¸‹ï¼Œä¸ç„¶åé¢ä¼šè¿½åŠ </span><br><br><br><br>        <span class="hljs-comment">// è¿ç»­ä¸¤æ¬¡Hash256ï¼Œå†ç”¨Hexç¼–ç è¾“å‡º</span><br><br>        SHA256 sha2;<br><br>        <span class="hljs-function">StringSource <span class="hljs-title">s2</span> <span class="hljs-params">(<span class="hljs-string">&quot;I like cryptography very much&quot;</span>,<span class="hljs-literal">true</span>,</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                         <span class="hljs-keyword">new</span> HashFilter(sha,</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                         <span class="hljs-keyword">new</span> HashFilter(sha2,</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                         <span class="hljs-keyword">new</span> HexEncoder(</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                         <span class="hljs-keyword">new</span> StringSink(r)))) )</span></span>;<br><br>        cout &lt;&lt; r &lt;&lt; endl;<br><br><br><br>        <span class="hljs-function">SecByteBlock <span class="hljs-title">digest</span><span class="hljs-params">(sha.DigestSize())</span></span>; <span class="hljs-comment">//ç”³è¯·å†…å­˜ç©ºé—´ä»¥å­˜æ”¾æ¶ˆæ¯æ‘˜è¦</span><br><br>        <span class="hljs-comment">//CalculateDigest()ç›¸å½“äºUpdate()+Final()</span><br><br>        <span class="hljs-comment">// Updateç”¨æ¥å‘shaè¾“å…¥ï¼ŒFinalè®¡ç®—hashå€¼ï¼ŒåŒæ—¶é‡ç½®hashå‡½æ•°å†…éƒ¨çŠ¶æ€</span><br><br>        sha.<span class="hljs-built_in">CalculateDigest</span>(digest, msg, <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(msg) - <span class="hljs-number">1</span>);<br><br>        cout &lt;&lt; <span class="hljs-string">&quot;digest2=&quot;</span>;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">size_t</span> i = <span class="hljs-number">0</span>; i &lt; sha.<span class="hljs-built_in">DigestSize</span>(); ++i)<br><br>        &#123;<span class="hljs-comment">//ä»¥åå…­è¿›åˆ¶è¾“å‡ºHashå€¼</span><br><br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02X&quot;</span>, digest[i]);<br><br>        &#125;<br><br>        cout &lt;&lt; endl;<br><br><br><br>        <span class="hljs-comment">//è®¡ç®—msgæ¶ˆæ¯çš„Hashå€¼</span><br><br>        <span class="hljs-keyword">bool</span> res;<br><br>        res = sha.<span class="hljs-built_in">VerifyDigest</span>(digest, <span class="hljs-comment">//å¯èƒ½æŠ›å‡ºå¼‚å¸¸</span><br><br>                               msg, <span class="hljs-built_in"><span class="hljs-keyword">sizeof</span></span>(msg) - <span class="hljs-number">1</span>); <span class="hljs-comment">//å»æ‰å­—ç¬¦ä¸²æœ€åçš„&#x27;\0&#x27;</span><br><br>        cout &lt;&lt; <span class="hljs-string">&quot;res = &quot;</span> &lt;&lt; boolalpha &lt;&lt;res &lt;&lt; endl;  <span class="hljs-comment">// è¿™é‡Œçš„boolalpha æ˜¯ä¸ºäº†è¾“å‡ºboolå€¼trueæˆ–è€…false</span><br><br><br><br>    &#125;<br><br>    <span class="hljs-built_in"><span class="hljs-keyword">catch</span></span> (<span class="hljs-keyword">const</span> Exception&amp; e)<br><br>    &#123;<span class="hljs-comment">//å‡ºç°å¼‚å¸¸</span><br><br>        cout &lt;&lt; e.<span class="hljs-built_in">what</span>() &lt;&lt; endl; <span class="hljs-comment">//å¼‚å¸¸åŸå› </span><br><br>    &#125;<br><br><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ç¬¬åä¸€ç« -å…¬é’¥å¯†ç å­¦æ•°å­¦åŸºç¡€"><a class="markdownIt-Anchor" href="#ç¬¬åä¸€ç« -å…¬é’¥å¯†ç å­¦æ•°å­¦åŸºç¡€"></a> ç¬¬åä¸€ç«  å…¬é’¥å¯†ç å­¦æ•°å­¦åŸºç¡€</h1><h2 id="å¤§æ•´æ•°-ä¸-å¤§ç´ æ•°ç”Ÿæˆ"><a class="markdownIt-Anchor" href="#å¤§æ•´æ•°-ä¸-å¤§ç´ æ•°ç”Ÿæˆ"></a> å¤§æ•´æ•° ä¸ å¤§ç´ æ•°ç”Ÿæˆ</h2><ul><li>å¯ä»¥å†ç ”ç©¶ä¸€ä¸‹å¤§æ•´æ•°çš„ä¸€äº›ç”¨æ³•</li></ul><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;integer.h&gt;</span><span class="hljs-comment">//ä½¿ç”¨Integer</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span><span class="hljs-comment">//ä½¿ç”¨coutã€cin</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;osrng.h&gt;</span><span class="hljs-comment">//ä½¿ç”¨AutoSeededRandomPool</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;nbtheory.h&gt;</span><span class="hljs-comment">//ä½¿ç”¨PrimeAndGeneratorã€VerifyPrime</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<span class="hljs-comment">//stdæ˜¯C++çš„å‘½åç©ºé—´</span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> CryptoPP;<span class="hljs-comment">//CryptoPPæ˜¯CryptoPPåº“çš„å‘½åç©ºé—´</span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"></span>&#123;<br><br>    AutoSeededRandomPool rng; <span class="hljs-comment">// å®šä¹‰éšæœºæ•°å‘ç”Ÿå™¨å¯¹è±¡</span><br><br>    <span class="hljs-comment">// å®šä¹‰PrimeAndGeneratorå¯¹è±¡ï¼Œåˆ©ç”¨éšæœºæ•°å‘ç”Ÿå™¨rngäº§ç”Ÿç´ æ•°på’Œq</span><br><br>    <span class="hljs-comment">// è¦æ±‚äº§ç”Ÿçš„pæ˜¯1024æ¯”ç‰¹çš„ç´ æ•°ï¼Œqæ˜¯512æ¯”ç‰¹çš„ç´ æ•°</span><br><br>    <span class="hljs-function">PrimeAndGenerator <span class="hljs-title">pag</span><span class="hljs-params">(<span class="hljs-number">1</span>, rng, <span class="hljs-number">1024</span>, <span class="hljs-number">512</span>)</span></span>;<br><br>    Integer p = pag.<span class="hljs-built_in">Prime</span>(); <span class="hljs-comment">// è·å–ç´ æ•°pçš„å€¼</span><br><br>    Integer q = pag.<span class="hljs-built_in">SubPrime</span>(); <span class="hljs-comment">// è·å–ç´ æ•°qçš„å€¼</span><br><br>    Integer r = (p - <span class="hljs-number">1</span>) / q / <span class="hljs-number">2</span>; <span class="hljs-comment">// è®¡ç®—rçš„å€¼ï¼Œå› ä¸ºp=2*r*q+1ï¼Œdelta=1</span><br><br>    cout &lt;&lt; <span class="hljs-string">&quot;p(&quot;</span> &lt;&lt; p.<span class="hljs-built_in">BitCount</span>() &lt;&lt; <span class="hljs-string">&quot;)ï¼š&quot;</span> &lt;&lt; p &lt;&lt; endl; <span class="hljs-comment">// æ‰“å°pçš„å€¼åŠæ¯”ç‰¹æ•°</span><br><br>    cout &lt;&lt; <span class="hljs-string">&quot;q(&quot;</span> &lt;&lt; q.<span class="hljs-built_in">BitCount</span>() &lt;&lt; <span class="hljs-string">&quot;)ï¼š&quot;</span> &lt;&lt; q &lt;&lt; endl; <span class="hljs-comment">// æ‰“å°qçš„å€¼åŠæ¯”ç‰¹æ•°</span><br><br>    cout &lt;&lt; <span class="hljs-string">&quot;r(&quot;</span> &lt;&lt; r.<span class="hljs-built_in">BitCount</span>() &lt;&lt; <span class="hljs-string">&quot;)ï¼š&quot;</span> &lt;&lt; r &lt;&lt; endl; <span class="hljs-comment">// æ‰“å°rçš„å€¼åŠæ¯”ç‰¹æ•°</span><br><br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">VerifyPrime</span>(rng, r, <span class="hljs-number">10</span>)) <span class="hljs-comment">// éªŒè¯ræ˜¯å¦ä¸ºç´ æ•°</span><br><br>    &#123;<br><br>        cout &lt;&lt; <span class="hljs-string">&quot;ræ˜¯ç´ æ•°&quot;</span> &lt;&lt; endl; <span class="hljs-comment">// å¦‚æœrä¸ºç´ æ•°ï¼Œåˆ™è¾“å‡ºè¯¥ä¿¡æ¯</span><br><br>    &#125;<br><br>    <span class="hljs-keyword">else</span><br><br>    &#123;<br><br>        cout &lt;&lt; <span class="hljs-string">&quot;rä¸æ˜¯ç´ æ•°&quot;</span> &lt;&lt; endl; <span class="hljs-comment">// å¦‚æœrä¸ä¸ºç´ æ•°ï¼Œåˆ™è¾“å‡ºè¯¥ä¿¡æ¯</span><br><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ç¬¬åä¸‰ç« -æ•°å­—ç­¾å"><a class="markdownIt-Anchor" href="#ç¬¬åä¸‰ç« -æ•°å­—ç­¾å"></a> ç¬¬åä¸‰ç«  æ•°å­—ç­¾å</h1><p>ç”µå­ä¹¦ç»™å‡ºçš„å‚è€ƒæ˜¯ECNRæ•°å­—ç­¾åç®—æ³•</p><p><a href="https://www.cryptopp.com/wiki/Elliptic_Curve_Digital_Signature_Algorithm">ECDSAæ¤­åœ†æ›²çº¿ - Crypto++</a></p><p><a href="https://www.cryptopp.com/wiki/Elliptic_Curve_Digital_Signature_Algorithm">https://www.cryptopp.com/wiki/Elliptic_Curve_Digital_Signature_Algorithm</a> -ã€‹å…³äºå‹ç¼©å…¬é’¥çš„å®ç°å¯ä»¥å‚è€ƒ Compressed Point è¿™ä¸€éƒ¨åˆ†</p><h2 id="ç§é’¥å’Œå…¬é’¥ç”Ÿæˆ-ä¿å­˜"><a class="markdownIt-Anchor" href="#ç§é’¥å’Œå…¬é’¥ç”Ÿæˆ-ä¿å­˜"></a> ç§é’¥å’Œå…¬é’¥ç”Ÿæˆã€ä¿å­˜</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;integer.h&gt;</span><span class="hljs-comment">//ä½¿ç”¨Integer</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span><span class="hljs-comment">//ä½¿ç”¨coutã€cin</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;osrng.h&gt;</span><span class="hljs-comment">//ä½¿ç”¨AutoSeededRandomPool</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;eccrypto.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;oids.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;files.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;filters.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;filesystem&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;hex.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;base32.h&gt;</span></span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<span class="hljs-comment">//stdæ˜¯C++çš„å‘½åç©ºé—´</span><br><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> CryptoPP;<span class="hljs-comment">//CryptoPPæ˜¯CryptoPPåº“çš„å‘½åç©ºé—´</span><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ECDSA_Generate</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"></span>&#123;<br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    // æŒ‡å®š private exponent  32å­—èŠ‚éšæœºæ•°ï¼Œç”Ÿæˆå¯¹åº”çš„ç§é’¥</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    string exp = &quot;E4A6CFB431471CFCAE491FD566D19C87082CF9FA7722D7FA24B2B3F5669DBEFB&quot;;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    HexDecoder decoder;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    decoder.Put((byte*)&amp;exp[0], exp.size());</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    decoder.MessageEnd();</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    Integer x;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    x.Decode(decoder, decoder.MaxRetrievable());</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    privateKey.Initialize(ASN1::secp256r1(), x);</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">     */</span><br><br><br><br>    AutoSeededRandomPool prng;<br><br>    ECDSA&lt;ECP, SHA256&gt;::PrivateKey privateKey;<br><br><br><br>    privateKey.<span class="hljs-built_in">Initialize</span>( prng, ASN1::<span class="hljs-built_in">secp256k1</span>() );<br><br><br><br>    <span class="hljs-comment">/* ä½¿ç”¨ByteQueue æ–¹ä¾¿å°†å…¬ç§é’¥å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¦‚æœè¦æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œå¯ä»¥ä½¿ç”¨FileSink</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    ByteQueue queue;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    privateKey.Save(queue);</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    privateKey.Load(queue);</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    */</span><br><br><br><br>    <span class="hljs-comment">// éªŒè¯å¯†é’¥å¼ºåº¦</span><br><br>    <span class="hljs-keyword">bool</span> result = privateKey.<span class="hljs-built_in">Validate</span>( prng, <span class="hljs-number">3</span> );<br><br>    cout &lt;&lt; boolalpha &lt;&lt; result &lt;&lt; endl;<br><br><br><br>    Integer p = privateKey.<span class="hljs-built_in">GetPrivateExponent</span>();<br><br>    cout&lt;&lt; <span class="hljs-string">&quot;len:&quot;</span> &lt;&lt; p.<span class="hljs-built_in">BitCount</span>() &lt;&lt; <span class="hljs-string">&quot; Private Key:&quot;</span> &lt;&lt; p &lt;&lt; endl;<br><br>    string priHexKey;<br><br>    <span class="hljs-function">HexEncoder <span class="hljs-title">encoder</span><span class="hljs-params">(<span class="hljs-keyword">new</span> StringSink(priHexKey))</span></span>;<br><br>    p.<span class="hljs-built_in">Encode</span>(encoder, <span class="hljs-number">32</span>);<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;priHexKey:&quot;</span>&lt;&lt;priHexKey.<span class="hljs-built_in">size</span>() &lt;&lt; <span class="hljs-string">&quot;  &quot;</span> &lt;&lt; priHexKey &lt;&lt; endl;<br><br><br><br>    <span class="hljs-comment">// Save private key in PKCS #8 format</span><br><br>    <span class="hljs-function">FileSink <span class="hljs-title">fs1</span><span class="hljs-params">( <span class="hljs-string">&quot;../../../keys/private.ec.der&quot;</span>, <span class="hljs-literal">true</span> <span class="hljs-comment">/*binary*/</span> )</span></span>;<br><br>    privateKey.<span class="hljs-built_in">Save</span>( fs1 );<br><br><br><br>    <span class="hljs-comment">// Generate publicKey</span><br><br>    ECDSA&lt;ECP, CryptoPP::SHA256&gt;::PublicKey publicKey;<br><br>    privateKey.<span class="hljs-built_in">MakePublicKey</span>(publicKey);<br><br>    <span class="hljs-keyword">const</span> ECP::Point&amp; q = publicKey.<span class="hljs-built_in">GetPublicElement</span>();<br><br>    <span class="hljs-keyword">const</span> Integer&amp; qx = q.x;<br><br>    <span class="hljs-keyword">const</span> Integer&amp; qy = q.y;<br><br>    string qxHex, qyHex;<br><br>    <span class="hljs-function">HexEncoder <span class="hljs-title">encoderx</span><span class="hljs-params">(<span class="hljs-keyword">new</span> StringSink(qxHex))</span></span>;<br><br>    <span class="hljs-function">HexEncoder <span class="hljs-title">encodery</span><span class="hljs-params">(<span class="hljs-keyword">new</span> StringSink(qyHex))</span></span>;<br><br>    qx.<span class="hljs-built_in">Encode</span>(encoderx, <span class="hljs-number">32</span>);<br><br>    qy.<span class="hljs-built_in">Encode</span>(encodery, <span class="hljs-number">32</span>);<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;len:&quot;</span> &lt;&lt; qx.<span class="hljs-built_in">BitCount</span>() &lt;&lt; <span class="hljs-string">&quot; Public Point x:&quot;</span> &lt;&lt; qx &lt;&lt; endl;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;qxHex:&quot;</span> &lt;&lt; qxHex &lt;&lt; endl;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;len:&quot;</span> &lt;&lt; qy.<span class="hljs-built_in">BitCount</span>() &lt;&lt; <span class="hljs-string">&quot; Public Point y:&quot;</span> &lt;&lt; qy &lt;&lt; endl;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;qyHex:&quot;</span> &lt;&lt; qyHex &lt;&lt; endl;<br><br><br><br>    <span class="hljs-comment">// Save public key in X.509 format</span><br><br>    <span class="hljs-function">FileSink <span class="hljs-title">fs2</span><span class="hljs-params">( <span class="hljs-string">&quot;../../../keys/public.ec.der&quot;</span>, <span class="hljs-literal">true</span> <span class="hljs-comment">/*binary*/</span> )</span></span>;<br><br>    publicKey.<span class="hljs-built_in">Save</span>( fs2 );<br><br><br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç§é’¥å’Œå…¬é’¥çš„åŠ è½½-ç­¾åå’Œè®¤è¯"><a class="markdownIt-Anchor" href="#ç§é’¥å’Œå…¬é’¥çš„åŠ è½½-ç­¾åå’Œè®¤è¯"></a> ç§é’¥å’Œå…¬é’¥çš„åŠ è½½ã€ç­¾åå’Œè®¤è¯</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-comment">// å¤´æ–‡ä»¶å’Œä¸Šè¿°ä¸€æ ·</span><br><br><br><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">ECDSA_LOAD</span><span class="hljs-params">()</span></span>&#123;<br><br>    AutoSeededRandomPool prng;<br><br>    <span class="hljs-function">FileSource <span class="hljs-title">fs1</span><span class="hljs-params">( <span class="hljs-string">&quot;../../../keys/private.ec.der&quot;</span>, <span class="hljs-literal">true</span> <span class="hljs-comment">/*pump all*/</span> )</span></span>;<br><br>    <span class="hljs-function">FileSource <span class="hljs-title">fs2</span><span class="hljs-params">( <span class="hljs-string">&quot;../../../keys/public.ec.der&quot;</span>, <span class="hljs-literal">true</span> <span class="hljs-comment">/*pump all*/</span> )</span></span>;<br><br>    ECDSA&lt;ECP, SHA256&gt;::PrivateKey privateKey;<br><br>    ECDSA&lt;ECP, SHA256&gt;::PublicKey publicKey;<br><br>    <span class="hljs-comment">// åŠ è½½ç§é’¥ï¼Œ ç§é’¥æ ¼å¼ï¼šPKCS #8</span><br><br>    privateKey.<span class="hljs-built_in">Load</span>( fs1 );<br><br>    publicKey.<span class="hljs-built_in">Load</span>(fs2);<br><br><br><br>    <span class="hljs-comment">// ç”¨ç§é’¥è¿›è¡Œç­¾å</span><br><br>    ECDSA&lt;ECP, SHA256&gt;::<span class="hljs-function">Signer <span class="hljs-title">signer</span><span class="hljs-params">(privateKey)</span></span>;<br><br>    string message = <span class="hljs-string">&quot;Yoda said, Do or do not. There is no try.&quot;</span>;<br><br>    string signature;<br><br><br><br><br><br>    <span class="hljs-function">StringSource <span class="hljs-title">s</span><span class="hljs-params">( message, <span class="hljs-literal">true</span> <span class="hljs-comment">/*pump all*/</span>,</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                    <span class="hljs-keyword">new</span> SignerFilter( prng,</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                                      signer,</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                                      <span class="hljs-keyword">new</span> StringSink( signature )</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                    ) <span class="hljs-comment">// SignerFilter</span></span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">    )</span></span>; <span class="hljs-comment">// StringSource</span><br><br>    cout &lt;&lt; <span class="hljs-string">&quot;signature len:&quot;</span> &lt;&lt; signature.<span class="hljs-built_in">size</span>() &lt;&lt; <span class="hljs-string">&quot; output:&quot;</span> &lt;&lt; signature &lt;&lt; endl;<br><br><br><br>    <span class="hljs-comment">// å°†ç­¾åï¼ˆåŒ…å«Rï¼ŒSï¼‰è½¬æ¢æˆ DER æ ¼å¼</span><br><br>    std::string derSign;<br><br>    <span class="hljs-comment">// Make room for the ASN.1/DER encoding</span><br><br>    derSign.<span class="hljs-built_in">resize</span>(<span class="hljs-number">3</span>+<span class="hljs-number">3</span>+<span class="hljs-number">3</span>+<span class="hljs-number">2</span>+signature.<span class="hljs-built_in">size</span>());<br><br>    <span class="hljs-keyword">size_t</span> converted_size = <span class="hljs-built_in">DSAConvertSignatureFormat</span>(<br><br>            (byte*) (&amp;derSign[<span class="hljs-number">0</span>]), derSign.<span class="hljs-built_in">size</span>(), DSA_DER,<br><br>            (<span class="hljs-keyword">const</span> byte*) (signature.<span class="hljs-built_in">data</span>()), signature.<span class="hljs-built_in">size</span>(), DSA_P1363);<br><br>    derSign.<span class="hljs-built_in">resize</span>(converted_size);<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;DER len:&quot;</span> &lt;&lt; derSign.<span class="hljs-built_in">size</span>() &lt;&lt; <span class="hljs-string">&quot; DER:&quot;</span> &lt;&lt; derSign &lt;&lt; endl;<br><br>    string hexDER;<br><br>    <span class="hljs-function">StringSource <span class="hljs-title">toDER</span><span class="hljs-params">(derSign, <span class="hljs-literal">true</span>, <span class="hljs-keyword">new</span> HexEncoder(<span class="hljs-keyword">new</span> StringSink(hexDER)))</span></span>;<br><br>    cout &lt;&lt; <span class="hljs-string">&quot;DER hex:&quot;</span> &lt;&lt; hexDER &lt;&lt; endl;<br><br><br><br>    <br><br>    <span class="hljs-comment">// è¿›è¡ŒéªŒè¯</span><br><br>    <span class="hljs-keyword">bool</span> result;<br><br>    ECDSA&lt;ECP, SHA256&gt;::<span class="hljs-function">Verifier <span class="hljs-title">verifier</span><span class="hljs-params">(publicKey)</span></span>;<br><br>    <span class="hljs-function">StringSource <span class="hljs-title">ss</span><span class="hljs-params">( signature+message, <span class="hljs-literal">true</span> <span class="hljs-comment">/*pump all*/</span>,</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                     <span class="hljs-keyword">new</span> SignatureVerificationFilter(</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                             verifier,</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                             <span class="hljs-keyword">new</span> ArraySink( (byte*)&amp;result, <span class="hljs-keyword">sizeof</span>(result) )</span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">                     ) <span class="hljs-comment">// SignatureVerificationFilter</span></span></span><br><span class="hljs-params"><span class="hljs-function"></span></span><br><span class="hljs-params"><span class="hljs-function">    )</span></span>;<br><br><br><br>    <span class="hljs-comment">// ä¼ ç»Ÿçš„C æ–¹å¼ - å‡½æ•°è°ƒç”¨å½¢å¼</span><br><br><span class="hljs-comment">//    result = verifier.VerifyMessage( (const byte*)message.data(), message.size(), (const byte*)signature.data(), signature.size() );</span><br><br>    <span class="hljs-keyword">if</span>(result)<br><br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Verified signature on message&quot;</span> &lt;&lt; std::endl;<br><br>    <span class="hljs-keyword">else</span><br><br>        std::cerr &lt;&lt; <span class="hljs-string">&quot;Failed to verify signature on message&quot;</span> &lt;&lt; std::endl;<br><br><br><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>å¯†ç å­¦</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¬¬ä¸‰æ–¹åº“</tag>
      
      <tag>CryptoPP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ubuntu-arm aptæºé…ç½®</title>
    <link href="/2021/10/20/2021-10/2021-10-20%20Ubuntu-arm%20apt%E6%BA%90%E9%85%8D%E7%BD%AE/"/>
    <url>/2021/10/20/2021-10/2021-10-20%20Ubuntu-arm%20apt%E6%BA%90%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="é…ç½®ç¯å¢ƒ"><a class="markdownIt-Anchor" href="#é…ç½®ç¯å¢ƒ"></a> é…ç½®ç¯å¢ƒ</h1><p>PCï¼šM1 MacBook Air</p><p>è™šæ‹Ÿæœºè½¯ä»¶ï¼šParallel Desktop 16.5</p><p>è™šæ‹Ÿæœºæ“ä½œç³»ç»Ÿï¼š<a href="https://ubuntu.com/download/server/arm">Ubuntu Server 20.04 TLS</a></p><h1 id="é‡åˆ°é—®é¢˜"><a class="markdownIt-Anchor" href="#é‡åˆ°é—®é¢˜"></a> é‡åˆ°é—®é¢˜</h1><p>é¦–å…ˆå°±æ˜¯éšä¾¿æœç´¢äº†ä¸€ç¯‡ç½‘ä¸Šæ•™ç¨‹ï¼Œæ¥é…ç½®aptæºï¼Œæ¯”å¦‚è¿™ç¯‡</p><p><a href="https://blog.csdn.net/p1279030826/article/details/111640455">https://blog.csdn.net/p1279030826/article/details/111640455</a></p><p class='note note-info'>è¦æ³¨æ„è‡ªå·±çš„ubuntuç‰ˆæœ¬å’Œaptæºè®¾ç½®çš„ç‰ˆæœ¬ä¸€è‡´</p><p>ä½†æ˜¯ç„¶åå‘¢ï¼Œæ»¡æ€€æœŸå¾…æ‰§è¡Œ<code>sudo apt-get update</code> å´æŠ¥é”™äº†ã€‚ã€‚ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110201532536.png" alt="apt-get updateæŠ¥é”™ " /></p><p>å½“æ—¶å¾ˆéƒé—·å•Šï¼Œå› ä¸ºä¹‹å‰åœ¨windowsè™šæ‹Ÿæœºä¸Šé…ç½®çš„æ—¶å€™éƒ½å¥½ä½¿çš„ï¼Œæ€ä¹ˆåˆ°ä½ è¿™å°±æ‹‰èƒ¯äº†å‘¢ï¼Ÿ</p><p>åæ¥åœ¨ç½‘ä¸Šæ‰¾å„ç§èµ„æ–™ã€è§£å†³åŠæ³•ï¼Œæœ‰çš„è¯´æ˜¯ç½‘ç»œçš„é—®é¢˜ï¼Œæœ‰çš„è¯´æ˜¯DNSè§£æçš„é—®é¢˜ï¼Œä½†ç»è¿‡å„ç§å°è¯•éƒ½æ²¡æœ‰æ•ˆæœï¼Œåæ¥æ— å¥ˆæ”¾å¼ƒï¼Œå°±æ­¤ä½œç½¢ã€‚</p><h1 id="è§£å†³æ–¹æ¡ˆ"><a class="markdownIt-Anchor" href="#è§£å†³æ–¹æ¡ˆ"></a> è§£å†³æ–¹æ¡ˆ</h1><p>ä½†æ˜¯å¤©æ— ç»äººä¹‹è·¯ï¼Œå½“æˆ‘ç¬¬äºŒæ¬¡å†æ¬¡å°è¯•é…ç½®çš„æ—¶å€™ï¼Œç»ˆäºè®©æˆ‘æ‰¾åˆ°äº†æ­£ç¡®ç­”æ¡ˆï¼š<a href="https://zongxp.blog.csdn.net/article/details/90604966?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.no_search_link&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-1.no_search_link">è§£å†³æ–¹æ¡ˆ</a></p><p>é‡ç‚¹å°±æ˜¯åç¼€è¦åŠ ä¸Š-portsï¼Œè¿™æ ·å¯¹åº”çš„é•œåƒæºæ‰æ˜¯armæºï¼Œæ‰èƒ½é€‚é…M1çš„macç³»ç»Ÿã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">deb http://mirrors.aliyun.com/ubuntu-ports/ focal main restricted universe multiverse<br>deb-src http://mirrors.aliyun.com/ubuntu-ports/ focal main restricted universe multiverse<br>deb http://mirrors.aliyun.com/ubuntu-ports/ focal-security main restricted universe multiverse<br>deb-src http://mirrors.aliyun.com/ubuntu-ports/ focal-security main restricted universe multiverse<br>deb http://mirrors.aliyun.com/ubuntu-ports/ focal-updates main restricted universe multiverse<br>deb-src http://mirrors.aliyun.com/ubuntu-ports/ focal-updates main restricted universe multiverse<br>deb http://mirrors.aliyun.com/ubuntu-ports/ focal-proposed main restricted universe multiverse<br>deb-src http://mirrors.aliyun.com/ubuntu-ports/ focal-proposed main restricted universe multiverse<br>deb http://mirrors.aliyun.com/ubuntu-ports/ focal-backports main restricted universe multiverse<br>deb-src http://mirrors.aliyun.com/ubuntu-ports/ focal-backports main restricted universe multiverse<br></code></pre></td></tr></table></figure><p>â€‹</p><p>æ¢æºä¹‹åæ‰§è¡ŒæˆåŠŸï¼Œniceï¼</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110201533176.png" alt="apt-get updateæˆåŠŸ" /></p><h1 id="å°ç»“"><a class="markdownIt-Anchor" href="#å°ç»“"></a> å°ç»“</h1><p>æ€»çš„æ¥è¯´è¸©äº†ä¸ªå‘ï¼Œè€Œç©¶å…¶åŸå› ï¼Œè¿˜æ˜¯è‡ªå·±å¯¹è¿™ä¸ªapté…ç½®å‚æ•°æ²¡æœ‰ç†è§£åˆ°ä½ï¼Œä»…ä»…åªæ˜¯ç…§çŒ«ç”»è™ï¼Œå¤åˆ¶æ•™ç¨‹ï¼Œè€Œæ²¡æœ‰é¢†ä¼šå…¶ä¸­çš„çœŸæ„ã€‚åŒæ—¶å¯¹è¿™ä¸ªç³»ç»Ÿæ¶æ„arm å’Œ x86çš„å·®å¼‚æ²¡æœ‰æ·±åˆ»è®¤è¯†ï¼Œä¸åŒæ¶æ„ä¹‹é—´è½¯ä»¶è‚¯å®šæ˜¯éœ€è¦è¿›è¡Œé€‚é…çš„ï¼Œæ²¡æœ‰å¾ˆæ¸…æ¥šçš„è®¤è¯†åˆ°è¿™ä¸€ç‚¹ã€‚æ‰€ä»¥å‘¢ï¼Œå­¦æµ·æ— æ¶¯ï¼Œæˆ‘è¿˜å·®å¾—è¿œå‘¢~</p><div align='center'><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110251023808.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg" width="50%" height="50%" align="middle" ></div>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ubuntu</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€æ¯”ç‰¹å¸ä¸“é¢˜01ã€‘ç™½çš®ä¹¦å¯¼è¯»</title>
    <link href="/2021/10/16/2021-10/2021-10-16%20%E6%AF%94%E7%89%B9%E5%B8%81%E4%B8%93%E9%A2%9801-%E7%99%BD%E7%9A%AE%E4%B9%A6/"/>
    <url>/2021/10/16/2021-10/2021-10-16%20%E6%AF%94%E7%89%B9%E5%B8%81%E4%B8%93%E9%A2%9801-%E7%99%BD%E7%9A%AE%E4%B9%A6/</url>
    
    <content type="html"><![CDATA[<h1 id="è®ºæ–‡æ¦‚è¿°"><a class="markdownIt-Anchor" href="#è®ºæ–‡æ¦‚è¿°"></a> è®ºæ–‡æ¦‚è¿°</h1><p>è®ºæ–‡åœ°å€ï¼š<a href="https://bitcoin.org/bitcoin.pdf">https://bitcoin.org/bitcoin.pdf</a></p><p>ç”±äºåœ¨â€œåŸºäºä¿¡ä»»â€æ¨¡å¼ä¸‹çš„äº¤æ˜“ï¼Œå­˜åœ¨äº¤æ˜“æˆæœ¬å¢åŠ ã€é™åˆ¶äº†äº¤æ˜“é¢çš„å¤§å°å³é˜»æ–­å°é¢äº¤æ˜“ã€å•†å®¶æ¬ºè¯ˆè¡Œä¸ºç­‰é—®é¢˜ï¼Œæœ¬è®ºæ–‡æå‡ºè§£å†³æ–¹æ¡ˆå³æ¯”ç‰¹å¸ï¼Œè¿™æ˜¯ä¸€ä¸ªP2Påˆ†å¸ƒå¼çš„ç”µå­ç°é‡‘äº¤æ˜“ç½‘ç»œï¼Œä¾é hashå’ŒåŠ ç›–æ—¶é—´æˆ³ï¼Œä»¥åŠå·¥ä½œé‡è¯æ˜æœºåˆ¶ç­‰æ‰‹æ®µï¼Œè§£å†³äº†åŒé‡æ”¯ä»˜é—®é¢˜ï¼Œå¹¶åœ¨æå¤§ç¨‹åº¦ä¸Šä¿è¯äº†äº¤æ˜“çš„æœ‰æ•ˆæ€§ã€æ­£ç¡®æ€§ã€æŠ—ä¼ªæ€§ã€‚è®ºæ–‡ä¸­ä¹Ÿè¯¦ç»†ä»‹ç»äº†å®ç°æ‰€ç”¨åˆ°çš„æŠ€æœ¯ã€æœºåˆ¶ã€åŸç†ç­‰ã€‚</p><h1 id="ä¸»è¦æ”¶è·"><a class="markdownIt-Anchor" href="#ä¸»è¦æ”¶è·"></a> ä¸»è¦æ”¶è·</h1><p>ä¸ªäººæ„Ÿè§‰æœ€å¤§çš„æ”¶è·å°±æ˜¯å¯¹æ¯”ç‰¹å¸çš„è¿è¡Œæœºåˆ¶æœ‰äº†å¤§ä½“çš„è®¤è¯†ï¼Œäº†è§£äº†æ•´ä½“æµç¨‹ï¼Œè™½ç„¶å¯èƒ½ä¸€äº›æŠ€æœ¯çš„å®ç°ç»†èŠ‚è¿˜æ˜¯ä¸å¤Ÿæ˜æœ—ã€‚ä¸‹é¢å°±æ˜¯æˆ‘å¯¹å…¶ä¸­å„ä¸ªéƒ¨åˆ†çš„è®¤è¯†å’Œç†è§£ã€‚</p><ul><li>åœ¨å¼•è¨€ä»‹ç»éƒ¨åˆ†ï¼Œå¼•å‡ºäº†æ¯”ç‰¹å¸çš„äº§ç”ŸèƒŒæ™¯ï¼ŒåŸºäºç¬¬ä¸‰æ–¹æœºæ„çš„äº¤æ˜“å­˜åœ¨çš„ç§ç§é—®é¢˜ï¼Œå¹¶æå‡ºæ¯”ç‰¹å¸è¿™ä¸€è§£å†³æ–¹æ¡ˆã€‚ç„¶åæ¥ä¸‹æ¥çš„å„ä¸ªç« èŠ‚ä»‹ç»æ¯”ç‰¹å¸æ¶‰åŠçš„ä¸»è¦å…³é”®æŠ€æœ¯ã€‚</li><li>Transactionséƒ¨åˆ†æè¿°äº†äº¤æ˜“æ˜¯å¦‚ä½•è¢«è®°å½•çš„ï¼Œå…¶ä¸­è¿ç”¨äº†Hashå’Œå…¬ç§é’¥ï¼Œä½†ä»…ä»…è®°å½•æ˜¯æ— æ³•éªŒè¯äº¤æ˜“çš„æœ‰æ•ˆæ€§ï¼Œå³å­˜åœ¨åŒé‡æ”¯å‡ºé—®é¢˜ã€‚</li><li>Timestamp Serveréƒ¨åˆ†æè¿°äº†å…·ä½“æ¯ä¸ªèŠ‚ç‚¹ï¼ˆæœåŠ¡å™¨ï¼‰çš„å·¥ä½œï¼Œå³å¯¹å½¢æˆçš„åŒºå—è¿›è¡ŒHashï¼Œå¹¶åŠ ç›–ä¸Šæ—¶é—´æˆ³ï¼Œæ ¹æ®æ—¶åºè¿›è¡Œæ’åˆ—å½¢æˆé“¾ã€‚</li><li>Proof-of-Workéƒ¨åˆ†æè¿°äº†è¿›ä¸€æ­¥è¯´æ˜Timestamp serverçš„å®ç°ï¼Œå³ä½¿ç”¨å·¥ä½œè¯æ˜æœºåˆ¶ï¼Œé€šè¿‡æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„nonceæ¥è·å¾—è®°è´¦æƒï¼Œå› ä¸ºå¯»æ‰¾è¿™ä¸ªnonceä¾é CPUç®—åŠ›ï¼ŒCPUç®—åŠ›è¶Šé«˜æ‰¾åˆ°çš„æ¦‚ç‡è¶Šå¤§ï¼Œå³one-CPU-one-voteè§„åˆ™ï¼Œè§£å†³äº†å¤šæ•°å†³ç­–ä¸­çš„ä»£è¡¨é—®é¢˜ã€‚åŒæ—¶è¿™æ ·çš„æ–¹å¼ï¼Œä¹Ÿä¿è¯äº†å¦‚æœæ”»å‡»è€…æƒ³è¦ç¯¡æ”¹æŸä¸ªåŒºå—ï¼Œå°±å…ˆå¾—æŠŠè¿™ä¸ªåŒºå—ä¹‹åçš„åŒºå—éƒ½è¿›è¡Œä¿®æ”¹ï¼Œè€Œæ¯ä¸ªåŒºå—éƒ½æ˜¯éœ€è¦é å¤§é‡CPUç®—åŠ›æ¥æ‰¾åˆ°nonceï¼Œè·å¾—è®°è´¦æƒè¿›è¡Œä¿®æ”¹ï¼Œè¿™æ ·çš„æˆæœ¬æ˜¯å¾ˆå¤§çš„ã€‚</li><li>Networkéƒ¨åˆ†åˆ™æ˜¯æè¿°äº†æ¯”ç‰¹å¸ç½‘ç»œçš„å·¥ä½œæµç¨‹ã€‚å…¶ä¸­æåˆ°çš„ä¸€ä¸ªå¾ˆé‡è¦çš„åŸåˆ™å°±æ˜¯ï¼Œæ‰€æœ‰äººæ˜¯é»˜è®¤æœ€é•¿é“¾æ˜¯æœ€æ­£ç¡®çš„ã€‚è€Œæ­£æ˜¯æœ‰è¿™ä¸€å‰æï¼Œæ‰æœ‰äº†åªè¦ç½‘ç»œé‡Œè¶…è¿‡51%çš„ç®—åŠ›å±äºè¯šå®èŠ‚ç‚¹ï¼Œå°±èƒ½ä¿è¯åŒºå—é“¾é‡Œäº¤æ˜“ä¿¡æ¯çš„æ­£ç¡®æ€§ï¼Œå› ä¸ºè¯šå®èŠ‚ç‚¹çš„ç®—åŠ›è¶…è¿‡ä¸€åŠï¼Œç®—å¾—æ¯”æ”»å‡»èŠ‚ç‚¹å¿«ï¼Œé‚£ä¹ˆæœ€é•¿é“¾è‚¯å®šå±äºè¯šå®èŠ‚ç‚¹ä¸€æ–¹ã€‚</li><li>Incentiveéƒ¨åˆ†è¯´æ˜çš„æ˜¯æ¿€åŠ±æœºåˆ¶ï¼Œç»™äºˆæŠ¢åˆ°è®°è´¦æƒçš„èŠ‚ç‚¹ä¸€å®šçš„æ¯”ç‰¹å¸ï¼Œæ­£æ˜¯æœ‰è¿™æ ·çš„æ¿€åŠ±æœºåˆ¶ï¼Œå„ä¸ªèŠ‚ç‚¹æ‰ä¼šæ„¿æ„æŠ•å…¥ç®—åŠ›å»äº‰å¤ºè®°è´¦æƒï¼Œä¹Ÿæ‰èƒ½æ˜¯ä¹‹å‰çš„å·¥ä½œé‡è¯æ˜æœºåˆ¶æ­£å¸¸è¿è¡Œã€‚è¿˜æœ‰ä¸€ç§å°±æ˜¯ä»¥äº¤æ˜“æ‰‹ç»­è´¹çš„æ–¹å¼è¿›è¡Œå¥–åŠ±ã€‚</li><li>Reclaiming Disk Spaceéƒ¨åˆ†è¯´æ˜åŒºå—é“¾å¯ä»¥é€šè¿‡Merkel TreeæŠ€æœ¯æ–¹æ³•æ¥å‹ç¼©æ•°æ®ï¼Œå‡å°ç©ºé—´å­˜å‚¨ã€‚</li><li>Simplified Payment Verificationéƒ¨åˆ†åˆ™æ˜¯è¯´æ˜äº†å¦‚ä½•æ¥æ£€éªŒäº¤æ˜“çš„æœ‰æ•ˆæ€§ï¼Œå› ä¸ºåŸºäºä¹‹å‰æœ€é•¿é“¾æ€»æ˜¯æ­£ç¡®çš„åŸåˆ™ï¼Œ å› æ­¤åªè¦å‘ç½‘ç»œä¸Šçš„èŠ‚ç‚¹è¿›è¡Œè¯¢é—®ï¼Œæ‰¾åˆ°æœ€é•¿é“¾å°±å¯ä»¥éªŒè¯æ‰€æœ‰çš„æœ‰æ•ˆäº¤æ˜“è®°å½•ã€‚</li><li>Combining and Splitting Valueéƒ¨åˆ†æè¿°çš„æ˜¯å½¢æˆäº¤æ˜“çš„ç»†èŠ‚ï¼Œæ˜¯å¯ä»¥æœ‰å¤šä¸ªè¾“å…¥çš„ï¼Œè€Œè¾“å‡ºæœ€å¤šæ˜¯ä¸¤ä¸ªã€‚</li><li>Privacyéƒ¨åˆ†åˆ™æ˜¯è¯´æ˜æ¯”ç‰¹å¸ç½‘ç»œä¸­çš„éšç§ç›¸å…³é—®é¢˜ã€‚</li><li>Calculationséƒ¨åˆ†ç”¨å…·ä½“çš„æ•°å­¦è®¡ç®—æ¥è¯´æ˜äº†ï¼Œå½“ä¸€ä¸ªæ”»å‡»è€…åœ¨è½åæœ€é•¿é“¾Zä¸ªå—çš„æƒ…å†µä¸‹ï¼Œæƒ³è¦è¿½ä¸Šæœ€é•¿é“¾çš„æ¦‚ç‡ã€‚ç»“æœè¡¨æ˜ï¼Œå½“è½åçš„å—æ•°è¶Šå¤šï¼Œè¿½ä¸Šçš„æ¦‚ç‡å°±è¶Šå°ï¼Œä¹Ÿå°±ä¿è¯äº†åŒºå—é“¾çš„å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚</li><li>Conclusionéƒ¨åˆ†åˆ™æ˜¯æœ€åè¿›è¡Œäº†æ€»ç»“ã€‚</li></ul><h1 id="å­˜åœ¨ç–‘é—®"><a class="markdownIt-Anchor" href="#å­˜åœ¨ç–‘é—®"></a> å­˜åœ¨ç–‘é—®</h1><ul><li><strong>é—®é¢˜1ï¼šæ€ä¹ˆç†è§£æ•°å­—è´§å¸ä¸­çš„double-spending problemï¼Ÿ</strong></li></ul><p>ç”¨æ•°å­—è´§å¸äº¤æ˜“æ—¶ï¼Œæ˜¯ç”¨å…ˆå‰çš„äº¤æ˜“å’Œä¸‹ä¸€ä¸ªæ‹¥æœ‰è€…çš„å…¬é’¥åšHashï¼Œç„¶åç”¨æ‹¥æœ‰è€…çš„ç§é’¥è¿›è¡Œç­¾åå½¢æˆè¿™ä¸€æ¬¡äº¤æ˜“ï¼Œæ¯”å¦‚è¿™æ¬¡äº¤æ˜“Aæ”¯ä»˜ç»™B 1ä¸ªç”µå­è´§å¸ï¼Œç„¶åAçš„ä½™é¢åªæœ‰1ä¸ªç”µå­è´§å¸ï¼Œå¦‚æœæ²¡æœ‰ç¬¬ä¸‰æ–¹æœºæ„è¿›è¡Œç›‘ç®¡ï¼Œç¡®è®¤è¿™ä¸ªç”µå­è´§å¸å·²ç»äº¤æ˜“å‡ºå»äº†ï¼Œé‚£ä¹ˆAå¯ä»¥ç»§ç»­æ‹¿è¿™1ä¸ªç”µå­è´§å¸ç»§ç»­äº¤æ˜“ï¼Œè€Œæ¥å—è€…ä¹Ÿæ— æ³•ç¡®è®¤è¿™1ä¸ªç”µå­è´§å¸æ˜¯å¦çœŸæ­£çš„å±äºä»–ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ²¡æœ‰ç¬¬ä¸‰æ–¹ç›‘ç®¡æœºæ„ï¼Œä¹Ÿæ²¡æœ‰å¼•å…¥åŒºå—é“¾P2Pè¿™ä¸ªç½‘ç»œçš„è¯ï¼Œç›¸å½“äºå°±æ²¡æœ‰åŠæ³•ç¡®è®¤äº¤æ˜“çš„æœ‰æ•ˆæ€§ï¼Œè¿™é‡Œäº§ç”Ÿçš„äº¤æ˜“ä»…ä»…èµ·åˆ°ä¸€ä¸ªè®°å½•çš„ä½œç”¨ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110162135282" alt="äº¤æ˜“é“¾ç¤ºæ„å›¾" /></p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110162150429.png" alt="åŒé‡æ”¯å‡ºé—®é¢˜" /></p><ul><li>è¿›ä¸€æ­¥ï¼Œé‚£ä¹ˆæ¯”ç‰¹å¸æ˜¯æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜çš„å‘¢ï¼Ÿ</li></ul><p>æ¯”ç‰¹å¸å»ºç«‹èµ·äº†ä¸€ä¸ªç”¨å·¥ä½œé‡è¯æ˜æœºåˆ¶çš„P2Pç½‘ç»œï¼Œç½‘ç»œä¸Šçš„èŠ‚ç‚¹éƒ½å¯ä»¥è¿›è¡Œè®°è´¦ï¼ˆä¹Ÿå°±æ˜¯è®°å½•äº¤æ˜“ä¿¡æ¯ï¼‰ï¼Œè®°è´¦çš„æ–¹å¼æ˜¯åŸºäºåŒºå—é“¾æŠ€æœ¯ï¼ŒåŒºå—ä¸Šè®°å½•ç€ä¸€æ®µæ—¶é—´å†…çš„äº¤æ˜“ä¿¡æ¯ï¼Œç„¶åæŒ‰æ—¶åºç”¨é“¾ä¸²è”èµ·æ¥ï¼Œå°±æœ‰äº†æ‰€æœ‰çš„äº¤æ˜“ä¿¡æ¯ï¼›åŒæ—¶æœ€é•¿çš„åŒºå—é“¾æ˜¯è¢«ç½‘ç»œä¸Šçš„èŠ‚ç‚¹æ‰€å…±åŒè®¤å¯æ˜¯æ­£ç¡®çš„ï¼Œå³ç›¸å½“äºç¬¬ä¸‰æ–¹ç›‘ç®¡çš„ç¡®è®¤ä½œç”¨ï¼Œè¯æ˜æŸæ¬¡äº¤æ˜“æœ‰æ•ˆã€‚</p><p>ç”¨ä¸Šé¢çš„ä¾‹å­ç»§ç»­è¯´æ˜Açš„ä½™é¢åªæœ‰ä¸€ä¸ªï¼Œç„¶åä»–åˆåŒæ—¶å’ŒBã€Cè¿›è¡Œäº¤æ˜“ï¼Œè¿™ä¸¤æ¡äº¤æ˜“ä¿¡æ¯ä¼ æ’­åˆ°ç½‘ç»œä¸Šï¼Œå„ä¸ªèŠ‚ç‚¹è¿›è¡Œè®°å½•ã€‚æœ‰èŠ‚ç‚¹å…ˆæ”¶åˆ°Aç»™Bä¸€ä¸ªæ¯”ç‰¹å¸çš„æ¶ˆæ¯ï¼Œä»–ä»¬æ£€æŸ¥ä½™é¢ä¹‹åä¼šè‡ªåŠ¨å¿½ç•¥å¦å¤–ä¸€æ¡äº¤æ˜“æ¶ˆæ¯ï¼ˆè¿™ä¸ªæ£€æŸ¥åº”è¯¥æ˜¯åŸºäºä»–ä»¬å½“å‰çš„é“¾ï¼Ÿï¼‰ï¼›åŒæ ·ï¼Œä¼šæœ‰å…ˆæ”¶åˆ°Aç»™Cä¸€ä¸ªæ¯”ç‰¹å¸æ¶ˆæ¯çš„èŠ‚ç‚¹ï¼Œåœ¨æ£€æŸ¥ä½™é¢ä¹‹åä¹Ÿä¼šè‡ªåŠ¨å¿½ç•¥å¦å¤–ä¸€æ¡æ¶ˆæ¯ã€‚æ¥ä¸‹æ¥ç®—åŠ›æœ€é«˜çš„ï¼ˆCPUæœ€å¤šçš„ï¼‰èŠ‚ç‚¹è·å¾—è®°è´¦æƒï¼ŒæŠŠä»–è®°å½•çš„åŒºå—åŠ åˆ°ä¸»é“¾ä¸Šï¼Œç„¶åç½‘ç»œä¸Šå…¶ä»–èŠ‚ç‚¹éƒ½ä¼šä»¥ä¸»é“¾ä¸Šçš„äº¤æ˜“ä¿¡æ¯ä¸ºå‡†ã€‚å¦‚æœæ”¾å…¥ä¸»é“¾çš„äº¤æ˜“ä¿¡æ¯æ˜¯Aè½¬ç»™Bä¸€ä¸ªæ¯”ç‰¹å¸ï¼Œé‚£ä¹ˆBå°†ä¼šè·å¾—æ¯”ç‰¹å¸ï¼Œäº¤æ˜“çš„æœ‰æ•ˆæ€§å¾—åˆ°ç¡®è®¤ï¼›åŒç†ï¼Œå¦‚æœæ”¾å…¥ä¸»é“¾çš„äº¤æ˜“ä¿¡æ¯æ˜¯Aè½¬ç»™Cä¸€ä¸ªæ¯”ç‰¹å¸ï¼Œé‚£ä¹ˆCå°†ä¼šè·å¾—æ¯”ç‰¹å¸ã€‚</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110162150837.png" alt="åŒºå—é“¾è§£å†³åŒé‡æ”¯å‡ºé—®é¢˜" /></p><ul><li><p><strong>é—®é¢˜2</strong>ï¼šä¸è¿‡è¿™æ ·åˆå¼•å‡ºä¸€ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªä¸»é“¾æ˜¯æ€ä¹ˆç¡®å®šä¸‹æ¥ï¼Œæˆ–è€…è¯´æ‰¾åˆ°çš„å‘¢ï¼Ÿæ˜¯å‡è®¾å¤§éƒ¨åˆ†èŠ‚ç‚¹éƒ½æ˜¯æœ‰ç€ç›¸åŒçš„æœ€é•¿ä¸»é“¾ï¼Œç„¶åç›´æ¥åœ¨æœ¬åœ°çš„åŒºå—é“¾ä¸ŠåŠ ä¸Šæœ€æ–°çš„ï¼Œç„¶åæŠŠæ–°äº§ç”Ÿçš„åŒºå—ä¿¡æ¯å¹¿æ’­å‡ºå»ï¼Ÿç„¶åå†æ ¹æ®æœ€é•¿ä¸»é“¾æ­£ç¡®æ€§çš„å‡è®¾å‰æï¼Œå…¶ä»–èŠ‚ç‚¹æ ¹æ®è¯¥æœ€é•¿ä¸»é“¾æ›´æ–°æœ¬åœ°çš„åŒºå—é“¾</p></li><li><p><strong>é—®é¢˜3</strong>ï¼šåœ¨ä¸Šé¢çš„ä¾‹å­é‡Œï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ€ä¹ˆå»æ£€éªŒä¸€ä¸ªäº¤æ˜“é‡Œä»˜æ¬¾è€…çš„ä½™é¢ï¼Ÿæˆ–è€…è¯´æ€ä¹ˆæ‰¾åˆ°è¯¥ä»˜æ¬¾è€…ä¹‹å‰çš„æ‰€æœ‰äº¤æ˜“è®°å½•ï¼Ÿç”¨å…¬ç§é’¥çš„è¯å¥½åƒä¸å¤ªè¡Œï¼Œå› ä¸ºæ¯æ¬¡éƒ½å¯èƒ½å˜æ¢ã€‚è¿˜æ˜¯è¯´è¿™ä¸ªè´¦æˆ·æ˜¯å¯ä»¥ç›´æ¥æ‰¾åˆ°çš„ï¼Œé‚£éšç§æ€§æ˜¯æ€ä¹ˆä¿æŠ¤ï¼Ÿ</p></li><li><p>**é—®é¢˜4ï¼š**æ–‡ä¸­çš„ç½‘ç»œéƒ¨åˆ†æåˆ°äº†å®¹é”™æ€§ï¼Œå³æœ‰çš„ç½‘ç»œèŠ‚ç‚¹å¯èƒ½ä¼šä¸¢å¤±ä¹‹å‰çš„åŒºå—ä¿¡æ¯ï¼Œé‚£ä¹ˆè¿™äº›èŠ‚ç‚¹è¯¥æ€ä¹ˆæ‰¾åˆ°å½“å‰çš„æœ€é•¿ä¸»é“¾ï¼Ÿ</p><ul><li>æˆ‘ç†è§£æ¯æ¬¡ä¼ æ’­çš„åŒºå—éƒ½æ˜¯æœ€æ–°çš„åŒºå—ï¼ŒèŠ‚ç‚¹ä¼šå› æ­¤æ„è¯†åˆ°è‡ªå·±ä¸¢å¤±äº†åŒºå—ä¿¡æ¯ï¼ˆè¿™ä¸ªæ€ä¹ˆæ„è¯†åˆ°ä¹Ÿæ˜¯ä¸ªé—®é¢˜ï¼Œç”¨æœ€æ–°åŒºå—é‡Œçš„çš„prev hashæ¥éªŒè¯ï¼Ÿï¼‰ï¼Œé‚£ä¹ˆæ€ä¹ˆæ¥è·å–ä¸¢å¤±çš„åŒºå—ä¿¡æ¯å‘¢ï¼Ÿæ˜¯ä»æœ€æ–°åŒºå—å¹¿æ’­èŠ‚ç‚¹é‚£æ‹‰å–åŒºå—å—ï¼Ÿ</li></ul></li><li><p><strong>é—®é¢˜5</strong>ï¼šMerkel Treeå‰ªæå‹ç¼©çš„å…·ä½“å®ç°</p></li><li><p><strong>é—®é¢˜6</strong>ï¼šè®ºæ–‡é€šç¯‡ä»‹ç»äº†æ¯”ç‰¹å¸çš„å®ç°åŸç†ï¼Œé‚£ä¹ˆæ¯”ç‰¹å¸æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œç¼ºç‚¹å‘¢ï¼Ÿ</p></li><li><p><strong>é—®é¢˜7</strong>ï¼šåœ¨å­˜å‚¨éƒ¨åˆ†æåˆ°ï¼Œå› ä¸ºMerkel Treeçš„æŠ€æœ¯ï¼Œå­˜å‚¨å¹¶ä¸æ˜¯é—®é¢˜ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰å¯èƒ½ç”¨ä¼˜åŠ¿æ¥å¼¥è¡¥åŠ£åŠ¿ï¼Œåƒæ˜¯ç©ºé—´æ¢æ—¶é—´ï¼Ÿ</p></li></ul><h1 id="æ‰€æ€æ‰€æ„Ÿ"><a class="markdownIt-Anchor" href="#æ‰€æ€æ‰€æ„Ÿ"></a> æ‰€æ€æ‰€æ„Ÿ</h1><ul><li>æ¯”ç‰¹å¸æœ¬èº«æ²¡æœ‰ä»·å€¼ï¼Œä½†æ˜¯å´æœ‰ç€æ— æ¯”æ˜‚è´µçš„ä»·æ ¼ï¼Œç”šè‡³æœ‰å¤§é‡çš„ç”µåŠ›ã€ç®—åŠ›è€—è´¹åœ¨è¿™ä¸Šé¢ï¼Œè¿›è¡Œæ‰€è°“çš„â€œæŒ–çŸ¿â€ï¼Œä»ä¸­è·å¾—çœŸå®çš„é‡‘é’±è´¢å¯Œï¼Œè¿™å¯¹æˆ‘æ¥è¯´æœ‰äº›ä¸å¯æ€è®®ï¼Œéš¾ä»¥ç†è§£ã€‚æˆ‘è‡ªèº«ä¹Ÿè¯´ä¸å¤ªæ¸…æ¥šï¼Œå¯èƒ½è¿™æ˜¯ä¸ªå“²å­¦é—®é¢˜ï¼Ÿä¸€ä¸ªä»è®¡ç®—æœºé‡Œäº§ç”Ÿçš„ç”µå­è´§å¸ï¼Œå¯¹ç°å®ä¸–ç•Œæ²¡æœ‰å®è´¨æ€§çš„ä»·å€¼æˆ–è€…è¯´å®ç”¨æ€§ï¼Œä¸ºä»€ä¹ˆå´èƒ½è¢«äººä»¬è¿½æ§ï¼Œèµ‹äºˆäº†å¤©ä»·ï¼ŸæŠŠé‚£äº›èŠ±è´¹åœ¨æ‰¾éšæœºæ•°ã€æŒ–çŸ¿çš„ç”µåŠ›å’Œç®—åŠ›ç”¨åœ¨æ›´éœ€è¦çš„åœ°æ–¹ï¼Œä¼šä¸ä¼šèƒ½åˆ›é€ æœ‰å®é™…ä»·å€¼çš„äº‹ç‰©ï¼Ÿ</li><li>é€šè¿‡é˜…è¯»æœ¬ç¯‡è®ºæ–‡ï¼Œäº†è§£æ¯”ç‰¹å¸å¤§è‡´çš„å·¥ä½œæµç¨‹ï¼Œå®ç°åŸç†ï¼Œä¹Ÿè®¤è¯†åˆ°æ¯”ç‰¹å¸æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å»ä¸­å¿ƒåŒ–ï¼Œæ²¡æœ‰äº†ç¬¬ä¸‰æ–¹æœºæ„ï¼Œæ”¹å˜ä»¥å¾€â€œåŸºäºä¿¡ä»»â€çš„äº¤æ˜“æ¨¡å¼ï¼Œæˆ–è®¸æ­£æ˜¯è¿™ç§å»ä¸­å¿ƒåŒ–çš„ã€éšè”½çš„å¹¶ä¸”å¯é çš„äº¤æ˜“æ–¹å¼æ»¡è¶³äº†ä¸€å®šäººç¾¤çš„éœ€æ±‚ï¼ˆå¯èƒ½å¹¶ä¸æ­£å½“ï¼‰ï¼Œé€ƒç¦»æ”¿åºœç›‘ç®¡ï¼Œä»¥æˆ‘ä»¬çš„å›½æƒ…æ¥è¯´ï¼Œè¿™æ˜¯ä¸å¯æ¥å—çš„ï¼Œå¯¹å¤§éƒ¨åˆ†äººæˆ–è®¸ä¹Ÿä¸å¥½ç†è§£ã€‚ä½†æ˜¯åŒºå—é“¾è¿™ç§æŠ€æœ¯ï¼Œè¿™ç§å»ä¸­å¿ƒåŒ–çš„ç½‘ç»œä¸ä¸€å®šè¦è½åœ°åœ¨ç”µå­è´§å¸é‡Œï¼Œåº”è¯¥ä¼šæœ‰æ›´å¹¿é˜”çš„åº”ç”¨åœºæ™¯ï¼Œä¹Ÿéœ€è¦æˆ‘è‡ªå·±å†å­¦ä¹ äº†ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>æ¯”ç‰¹å¸</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Bitcoin</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€æ¯”ç‰¹å¸ä¸“é¢˜02ã€‘Developer Guideå¯¼è¯»</title>
    <link href="/2021/10/11/2021-10/2021-10-11%E6%AF%94%E7%89%B9%E5%B8%81%E4%B8%93%E9%A2%9802-Developer%20Guide/"/>
    <url>/2021/10/11/2021-10/2021-10-11%E6%AF%94%E7%89%B9%E5%B8%81%E4%B8%93%E9%A2%9802-Developer%20Guide/</url>
    
    <content type="html"><![CDATA[<blockquote><p>åŸæ–‡é˜…è¯»åœ°å€ï¼š<a href="https://developer.bitcoin.org/devguide/transactions.html">Bitcoin Developer Guide</a></p><p>é¢„è®¡é€šè¯»è€—æ—¶ï¼š12å°æ—¶ï¼ˆä¸ªäººæ•°æ®ï¼Œä»…ä¾›å‚è€ƒï¼‰</p><p>ä¸­æ–‡ç¿»è¯‘ï¼š</p><p><a href="https://www.8btc.com/books/834/bitcoin-developer-guide/_book/5/5.html">æ¯”ç‰¹å¸å¼€å‘è€…æŒ‡å—-å·´æ¯”ç‰¹å›¾ä¹¦</a></p><p><a href="https://www.bookstack.cn/read/bitcoin_developer_guide/README.md">ç®€ä»‹ - ã€Šæ¯”ç‰¹å¸å¼€å‘è€…æŒ‡å— | Bitcoin Developer Guideã€‹ - ä¹¦æ ˆç½‘ Â· BookStack</a></p></blockquote><h1 id="ç« èŠ‚æ¦‚è¿°"><a class="markdownIt-Anchor" href="#ç« èŠ‚æ¦‚è¿°"></a> ç« èŠ‚æ¦‚è¿°</h1><p>æ­¤æ¬¡é˜…è¯»çš„å†…å®¹æ˜¯æ¯”ç‰¹å¸Developer Guideï¼Œè¯¦ç»†ä»‹ç»äº†æ¯”ç‰¹å¸ä¸­å„ç§è®¾è®¡å’ŒæŠ€æœ¯ç»†èŠ‚ã€‚</p><ul><li>Block Chainï¼šä»‹ç»æ¯”ç‰¹å¸çš„ç»“æ„åŸºç¡€åŒºå—é“¾ï¼ŒåŒ…æ‹¬å·¥ä½œé‡è¯æ˜ï¼Œå—é«˜ä¸åˆ†å‰ï¼Œäº¤æ˜“æ•°æ®ï¼Œå…±è¯†è§„åˆ™æ”¹å˜å¼•èµ·åˆ†å‰ç­‰å†…å®¹ã€‚</li><li>Transactionï¼šè¯¦ç»†ä»‹ç»äº†æ¯”ç‰¹å¸ä¸­äº¤æ˜“çš„ç›¸å…³å†…å®¹ï¼Œé‡ç‚¹è¯´æ˜äº†äº¤æ˜“çš„ç»„æˆï¼Œäº¤æ˜“ä¸­çš„UTXOçš„ç±»å‹ï¼ˆä½¿ç”¨ä½•ç§æ”¯ä»˜æ–¹å¼P2PKHæˆ–è€…P2SHï¼‰ã€‚</li><li>Contractsï¼šè¿™é‡Œçš„åˆçº¦è·Ÿä»¥å¤ªåŠçš„æ™ºèƒ½åˆçº¦ä¸å¤ªä¸€æ ·ï¼Œæ„Ÿè§‰æ›´åƒæ˜¯æ¥è¯´æ˜äº¤æ˜“åŒæ–¹ï¼ˆé’ˆå¯¹äººè€Œä¸æ˜¯äº¤æ˜“ï¼‰è¯¥å¦‚ä½•è¿›è¡Œäº¤æ˜“ï¼Œåº”è¯¥éµå®ˆå“ªäº›è§„åˆ™ã€‚ä¸»è¦ä»‹ç»äº†æ‰˜ç®¡å’Œä»²è£ã€å¾®æ”¯ä»˜é€šé“ã€Coinjoinï¼ˆæ··å¸ï¼‰</li><li>Walletï¼šé’±åŒ…ç”¨æ¥ç®¡ç†å’ŒèŠ±è´¹UTXOï¼Œå› ä¸ºUTXOå®é™…å¯¹åº”çš„æ˜¯ä¸€ä¸ªhashåœ°å€ï¼Œå› æ­¤é’±åŒ…å®é™…å°±æ˜¯åœ¨ç®¡ç†å…¬ç§é’¥ï¼Œè¿™éƒ¨åˆ†å†…å®¹ä¹Ÿå°±æ›´å¤šåœ¨ä»‹ç»å…¬ç§é’¥çš„ç®¡ç†é—®é¢˜ã€‚</li><li>Payment Processingï¼šè¿™éƒ¨åˆ†é‡ç‚¹ä»‹ç»å¦‚ä½•ä½¿ç”¨æ¯”ç‰¹å¸è¿›è¡Œæ”¯ä»˜çš„ç›¸å…³é—®é¢˜ã€‚</li><li>Operating Modesï¼šä»‹ç»æ¯”ç‰¹å¸ä¸­å…¨èŠ‚ç‚¹å’ŒSPVå®¢æˆ·ç«¯ã€‚</li><li>P2P Networkï¼šè¿™éƒ¨åˆ†å°±æ˜¯è¯¦ç»†ä»‹ç»äº†æ¯”ç‰¹å¸è¿è¡Œåœ¨P2Pç½‘ç»œä¸­ç›¸å…³ç»†èŠ‚ï¼ŒåŒ…æ‹¬å¯¹ç­‰èŠ‚ç‚¹çš„å‘ç°ä¸é“¾æ¥ï¼Œå…¨èŠ‚ç‚¹çš„åˆå§‹åŒ–ï¼ŒåŒºå—ä¼ æ’­ç­‰ã€‚</li><li>Miningï¼šä»‹ç»äº†å•ç‹¬æŒ–çŸ¿å’ŒçŸ¿æ± æŒ–çŸ¿ä¸¤ç§æŒ–çŸ¿ï¼ˆæ·»åŠ æ–°çš„åŒºå—ï¼‰æ–¹å¼ã€‚</li></ul><h1 id="é‡ç‚¹å†…å®¹"><a class="markdownIt-Anchor" href="#é‡ç‚¹å†…å®¹"></a> é‡ç‚¹å†…å®¹</h1><blockquote><p>å¤§éƒ¨åˆ†æ˜¯é˜…è¯»å„ä¸ªæ¨¡å—æ—¶è®°å½•ä¸‹çš„é‡ç‚¹å†…å®¹ã€‚</p></blockquote><h2 id="block-chain-åŒºå—é“¾"><a class="markdownIt-Anchor" href="#block-chain-åŒºå—é“¾"></a> Block Chain åŒºå—é“¾</h2><ul><li>Block chainé‡ŒUTXOçš„ä½œç”¨ï¼Œåªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œè¿™ä¹Ÿè§£å†³äº†åŒèŠ±é—®é¢˜</li><li>Proof of worké‡Œä¹Ÿæ˜¯å……åˆ†åˆ©ç”¨äº†åŠ å¯†hashç®—æ³•é‡Œéšæœºçš„å¤©ç„¶ç‰¹æ€§ï¼Œhash numberä¸å¯é¢„çŸ¥<ul><li>æ¯2016å—è°ƒæ•´éš¾åº¦å€¼ï¼Œæ ¹æ®ç”Ÿæˆè¿™2016å—blockçš„æ—¶é—´æ¥è°ƒæ•´ï¼Œç†æƒ³æ—¶é—´æ˜¯1,209,600ç§’(two weeks).</li></ul></li><li>Transaction dataï¼šblocké‡Œçš„ç¬¬ä¸€ä¸ªäº¤æ˜“æ˜¯ä¸€ä¸ªcoinbaseäº¤æ˜“ï¼ˆç”±ç”Ÿæˆçš„åŒºå—å¥–åŠ±å’Œè¾“å…¥è¾“å‡ºè´¹ç”¨å·®ç»„æˆï¼‰ï¼Œé€šå¸¸åªæœ‰åœ¨100å—ä¹‹åï¼Œæ‰èƒ½è¢«èŠ±è´¹ä½¿ç”¨ï¼Œè¿™ä¹ˆåšçš„ç›®çš„æ˜¯å› ä¸ºåˆ†å‰æ¯”è¾ƒå¸¸è§ï¼Œé˜²æ­¢å› ä¸ºåˆ†å‰çš„åŸå› å¯¼è‡´åŸå…ˆçš„åŒºå—å¤±æ•ˆ<ul><li>æœ‰ä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚ä½•ä¿è¯å¿…é¡»è¦åœ¨100å—ä¹‹åæ‰èƒ½è¿›è¡ŒèŠ±è´¹ï¼Œæ˜¯åœ¨åˆ›å»ºblockçš„æ—¶å€™ï¼Œåˆ¤æ–­è¾“å…¥çš„UTXOæ‰€åœ¨çš„åŒºå—çš„æ·±åº¦è¶…è¿‡100å—ï¼Ÿ</li></ul></li><li>å…±è¯†è§„åˆ™æ”¹å˜ï¼šå…±è¯†è§„åˆ™æ”¹å˜ï¼Œä¼šæœ‰ä¸¤ç§ä¸åŒçš„æƒ…å½¢ï¼Œåˆ†åˆ«å¯¼è‡´ç¡¬åˆ†å‰å’Œè½¯åˆ†å‰ï¼Œä¸æ˜¯å¾ˆèƒ½ç†è§£å…¶ä¸­çš„å«ä¹‰ï¼ŒæŸ¥é˜…ç›¸å…³èµ„æ–™æœ‰äº†è¿›ä¸€æ­¥è®¤è¯†ã€‚ï¼ˆç°åœ¨æ¯”ç‰¹å¸çš„æ›´æ–°ï¼ŒåŸºæœ¬å°±æ˜¯è½¯åˆ†å‰ï¼‰</li></ul><blockquote><p><strong>å¸¸è§çš„ç†è§£æ˜¯â€œç¡¬åˆ†å‰å’Œè€ç‰ˆæœ¬è½¯ä»¶ä¸å…¼å®¹ã€è½¯åˆ†å‰å’Œè€ç‰ˆæœ¬å…¼å®¹â€</strong>ï¼Œè¿™ä¸ªå®šä¹‰æ˜¯<strong>ä¸å‡†ç¡®</strong>çš„ï¼Œä½†æ˜¯å¾ˆå¤šåœ°æ–¹å·²ç»åœ¨ç”¨äº†ã€‚ã€‚<br /><strong>ç¡¬åˆ†å‰çš„å®šä¹‰æ˜¯æ‰©å®½å…±è¯†è§„åˆ™</strong>ï¼Œå…è®¸åšä¹‹å‰ç¦æ­¢çš„äº‹æƒ…ï¼Œä»¥å‰æ— æ•ˆçš„äº¤æ˜“/åŒºå—åœ¨ç¡¬åˆ†å‰åä¼šå˜æˆæœ‰æ•ˆçš„ï¼›<strong>è½¯åˆ†å‰æ˜¯æ”¶ç´§å…±è¯†è§„åˆ™</strong>ï¼Œç¦æ­¢ä¹‹å‰å…è®¸åšçš„äº‹æƒ…ï¼Œä»¥å‰æœ‰æ•ˆçš„äº¤æ˜“åœ¨è½¯åˆ†å‰åå°±æ— æ•ˆäº†ã€‚<br />**è½¯/ç¡¬åˆ†å‰æ˜¯å…±è¯†è§„åˆ™çš„æ”¹å˜ï¼Œå’Œé“¾åˆ†å‰/é“¾é‡ç»„å®Œå…¨æ˜¯ä¸¤ç äº‹ï¼›è¿™ä¸¤å¯¹æ¦‚å¿µçš„å…³ç³»ç±»ä¼¼äºâ€œçº¢çƒ§/æ¸…è’¸â€ä¸â€œçƒ§ç³Š/å¤¹ç”Ÿâ€ã€‚**ä¸å½“éƒ¨ç½²çš„è½¯/ç¡¬åˆ†å‰éƒ½æœ‰å¯èƒ½å¯¼è‡´é“¾åˆ†å‰/é“¾é‡ç»„ã€‚<br />æ‰€ä»¥ï¼Œå¯ä»¥æƒ³è§ï¼š<br />ç¡¬åˆ†å‰ä¹‹åï¼Œå‡ ä¹ä¸€å®šä¼šäº§ç”Ÿè®©è€èŠ‚ç‚¹æ‹’ç»æ¥å—çš„åŒºå—ï¼Œæ‰€ä»¥ï¼Œç¡¬åˆ†å‰ä¼šç ´åå‰å‘å…¼å®¹æ€§ï¼›<br />è½¯åˆ†å‰ä¹‹åï¼Œäº§ç”Ÿçš„æ–°åŒºå—è‚¯å®šæ˜¯è€èŠ‚ç‚¹ä¹Ÿæ„¿æ„æ¥å—çš„ï¼Œå‰å‘å…¼å®¹æ€§å¾—ä»¥ä¿ç•™ã€‚</p></blockquote><ul><li>Detecting forks å‘ç°åˆ†å‰ï¼šé€šè¿‡ç›‘æ§åŒºå—é“¾å·¥ä½œé‡è¯æ˜è€Œå‘ç°ç¡¬åˆ†å‰çš„ä»£ç ï¼›ç›‘æ§æœ€è¿‘åŒºå—çš„ç‰ˆæœ¬å·</li></ul><h2 id="transactionäº¤æ˜“"><a class="markdownIt-Anchor" href="#transactionäº¤æ˜“"></a> Transactionäº¤æ˜“</h2><ul><li><strong>P2PKH</strong> å³ pay to public key hashï¼Œå‘å…¬é’¥å“ˆå¸Œåœ°å€æ”¯ä»˜<ul><li>äº¤æ˜“çš„è¾“å…¥ä½¿ç”¨ä¸€ä¸ªTXIDå’Œoutput index numberï¼ˆå¯¹äºoutputæ¥è¯´å¤„åœ¨äº¤æ˜“çš„å“ªä¸ªä½ç½®ï¼‰æ¥æ ‡è¯†ï¼Œç„¶åè¿˜æœ‰ä¸€ä¸ªç­¾åè„šæœ¬ï¼ŒéªŒè¯è¯¥inputå¯¹åº”çš„outputåŒ…å«çš„å…¬é’¥è„šæœ¬ï¼Œç”¨æ¥è¯æ˜è¿™ç¬”è¾“å…¥çš„é’±çš„ç¡®æ˜¯æœ¬äººæŒæœ‰</li><li>äº¤æ˜“çš„è¾“å‡ºåŒ…å«ä¸€ä¸ªéšå«çš„index numberï¼Œä»¥èªä¸ºå•ä½çš„ä½™é¢é‡ï¼Œä¸€ä¸ªå…¬é’¥è„šæœ¬</li><li>Bobè¦ä½¿ç”¨Aliceçš„æ”¯ä»˜ç»™ä»–çš„UTXOï¼ŒAliceåˆ›å»ºè½¬è´¦çš„Txäº¤æ˜“æ—¶éœ€è¦ç”¨åˆ°Bobçš„å…¬é’¥ï¼Œå› æ­¤Bobçš„å…¬ç§é’¥æ˜¯æå‰ç”Ÿæˆå¥½çš„ï¼Œä½¿ç”¨ECDSAæ¤­åœ†ç­¾åæ›²çº¿ç”Ÿæˆï¼›ç„¶åBobå°†å…¬é’¥hashï¼Œä½¿ç”¨Base58ç¼–ç åœ°å€ç‰ˆæœ¬ç¼–å·ã€å…¬é’¥å“ˆå¸Œã€é”™è¯¯æ ¡éªŒç ï¼Œç„¶åä¼ ç»™Aliceï¼ŒAliceå¯ä»¥è¿›è¡Œè§£ç å¾—åˆ°å…¬é’¥hashï¼Œå¹¶æ·»åŠ åˆ°äº¤æ˜“ä¸­ï¼Œä½œä¸ºoutputä¸­çš„pubkey scriptï¼Œæ¥æ ‡è¯†è¾“å‡ºåˆ°å“ªä¸ªåœ°å€ï¼›</li><li>è€Œå½“Bobéœ€è¦ä½¿ç”¨è¿™ä»½UTXOï¼Œå‘å¸ƒäº¤æ˜“æ—¶ï¼Œéœ€è¦æ„é€ inputï¼Œå¼•ç”¨Aliceåˆ›é€ çš„äº¤æ˜“TXï¼ˆå³TXIDå’Œå¯¹åº”çš„output index numberï¼‰ï¼Œè¿˜éœ€è¦åŒ…å«ä¸€ä¸ªç­¾åè„šæœ¬(signature scriptï¼‰ï¼Œè¿™ä¸ªç­¾åè„šæœ¬ç”¨æ¥éªŒè¯è¿™ç¬”è¾“å…¥çš„ç¡®æ˜¯Bobæ‰€æœ‰ã€‚è¿™ä¸ªç­¾åè„šæœ¬é‡ŒåŒ…å«äº†Bobçš„å…¬é’¥å’Œç­¾åï¼Œè€Œç­¾åçš„æ•°æ®åŒ…å«äº†Aliceåˆ›é€ çš„äº¤æ˜“TXIDå’Œindex numberï¼Œè¾“å‡ºç»™å…¶ä»–ç”¨æˆ·çš„pubkey scriptï¼Œè¾“å‡ºçš„ä½™é¢ã€‚è€Œè¾“å‡ºoutputï¼Œæ­£å¦‚ä¸Šè¿°æ‰€è¯´ï¼ŒåŒ…å«ä¸€ä¸ªéšå«çš„index numberï¼Œä»¥èªä¸ºå•ä½çš„ä½™é¢é‡ï¼Œä¸€ä¸ªå…¬é’¥è„šæœ¬ã€‚</li></ul></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110111350637.(null)" alt="" /></p><ul><li><p><strong>P2SH</strong>ï¼šæå‡ºP2SHçš„ç›®çš„ä¸»è¦æ˜¯å› ä¸ºåœ¨ä¹‹å‰çš„äº¤æ˜“ä¸­ï¼Œéƒ½æ˜¯ç”±å‘é€è€…è´Ÿè´£æŒ‡å®šèµå‡ºå¸çš„æ¡ä»¶ã€‚è¿™æ ·çš„è¯ï¼Œå¦‚æœèµå‡ºå¸çš„è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œè­¬å¦‚è¦ä½¿ç”¨MULTISIGï¼Œé‚£ä¹ˆå¯¹ä»˜é’±çš„ç”¨æˆ·ï¼Œä¹Ÿå°±æ˜¯ä¹°å®¶ï¼Œå°±ä¸å¤Ÿå‹å¥½ã€‚ä½¿ç”¨P2SHçš„æ–¹å¼ï¼Œå¯ä»¥ç”±å¸çš„æ¥æ”¶æ–¹è®¾è®¡å¥½æ‰§è¡Œçš„è„šæœ¬ï¼Œç„¶åä¸è®ºè„šæœ¬å¤šä¹ˆå¤æ‚ï¼Œå‘é€æ–¹åªéœ€è¦å°†å¸å‘é€åˆ°ä¸€ä¸ª20å­—èŠ‚çš„å“ˆå¸Œåœ°å€å°±è¡Œã€‚</p><ul><li>æœ‰å…³èµ„æ–™å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/46072343">P2SHæœºåˆ¶</a></li></ul></li><li><p>æ ‡å‡†çš„å…¬é’¥è„šæœ¬ç±»å‹ï¼šP2PKHã€P2SHã€Multisigã€Pubkeyã€Null Data</p></li><li><p>äº¤æ˜“ä¸­Locktimeå’ŒSequence numbersçš„è¯´æ˜</p><ul><li>Locktime, ä¹Ÿè¢«ç§°ä¸ºnLockTime, å®ƒå®šä¹‰äº†ä¸ªæœ€æ—©æ—¶é—´ï¼Œåªæœ‰è¿‡äº†è¿™ä¸ªæœ€æ—©æ—¶é—´ï¼Œè¿™ä¸ªtransactionå¯ä»¥è¢«å‘é€åˆ°æ¯”ç‰¹å¸ç½‘ç»œã€‚é€šå¸¸è¢«è®¾ç½®ä¸º0ï¼Œè¡¨ç¤ºtransactionä¸€åˆ›å»ºå¥½å°±é©¬ä¸Šå‘é€åˆ°æ¯”ç‰¹å¸ç½‘ç»œ</li><li>Sequence numbersç”¨æ¥ä½¿ç­¾åè€…æ›´æ–°äº¤æ˜“ï¼Œå¦‚æœsequence numbersè®¾ç½®æˆ0xffffffffæ—¶ï¼Œè¡¨æ˜æ›´æ–°å®Œæˆï¼Œå°±å¯ä»¥ç«‹å³ç”Ÿæ•ˆåŠ å…¥åˆ°æ¯”ç‰¹å¸åŒºå—ä¸­ï¼Œè¿™ä¸ªç”Ÿæ•ˆæ˜¯ä¸ç®¡Locktimeæ˜¯å¦è¿‡æœŸã€‚</li><li>å¦ä¸€ç§ç†è§£ï¼š<ul><li>LockTime ï¼šç»å¯¹æ—¶é—´ï¼Œç”¨çš„æ˜¯æ•´ä¸ªåŒºå—é“¾çš„é•¿åº¦ï¼Œæˆ–è€…æ—¶é—´æˆ³æ¥è¡¨è¾¾çš„ã€‚</li></ul></li></ul></li><li><p>Sequence Number : ç›¸å¯¹æ—¶é—´ï¼Œå½“å‰äº¤æ˜“æ‰€å¼•ç”¨çš„UTXOæ‰€åœ¨çš„å—ï¼ˆä¹Ÿå°±æ˜¯è¾“å…¥æ‰€åœ¨çš„å—ï¼‰ï¼Œåé¢è¿½åŠ äº†å¤šå°‘ä¸ªå—ã€‚</p></li><li><p>å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/43171481">æ·±å…¥æµ…å‡ºå¾®æ”¯ä»˜é€šé“</a></p></li></ul><h2 id="contractåˆçº¦"><a class="markdownIt-Anchor" href="#contractåˆçº¦"></a> contractåˆçº¦</h2><ul><li>ç»“åˆä¹‹å‰çš„P2SHæ–¹å¼ä¸­ï¼Œå¯¹multisigæœ‰äº†æ›´è¿›ä¸€æ­¥çš„ç†è§£ã€‚Aå‘Bä¹°ä¸œè¥¿ï¼ŒAä½¿ç”¨P2SHï¼ŒæŠŠé’±æ”¯ä»˜åˆ°ä¸€ä¸ªè„šæœ¬åœ°å€å¹¶ä½¿ç”¨2-of-3ç­¾åï¼ˆæ­¤æ—¶æ¯”ç‰¹å¸åªå±äºè¿™ä¸ªè„šæœ¬åœ°å€ï¼‰ï¼Œå½“Bå‘è´§äº†ï¼ŒAæ”¶åˆ°ç¡®è®¤æ²¡é—®é¢˜äº†ï¼Œé‚£ä¹ˆä½¿ç”¨Aå’ŒBçš„ç­¾åå°±å¯ä»¥æŠŠè„šæœ¬åœ°å€çš„UTXOè½¬ç»™Bçš„åœ°å€ã€‚å¦‚ä½•Aåæ‚”äº†ï¼Œä¸è‚¯æä¾›ç­¾åï¼Œé‚£ä¹ˆBå¯ä»¥æ‰¾ä»²è£æœºæ„Cï¼Œä½¿ç”¨Bå’ŒCçš„ç­¾åä¹Ÿèƒ½å°†è„šæœ¬åœ°å€çš„UTXOè½¬ç»™Bï¼›åŒç†Bå¦‚æœæ²¡æœ‰å‘è´§ï¼ŒAä¹Ÿèƒ½æ‰¾CæŠŠé’±è½¬å›ç»™Aã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç›¸æ¯”P2PKHç›´æ¥è½¬è´¦æ–¹å¼ï¼ŒP2SHç›¸å½“äºå¤šäº†ä¸€æ­¥éªŒè¯ç­‰å¾…ï¼ŒéªŒè¯æˆåŠŸäº†å†è½¬è´¦åˆ°ç”¨æˆ·åœ°å€ã€‚</li><li>Micropayment Channel å¾®æ”¯ä»˜é€šé“</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110111350785.(null)" alt="" /></p><ul><li><p>å…¶å·¥ä½œåŸç†å¤§ä½“ä¸Šå¯ä»¥è¿™æ ·æè¿°ï¼šAç»™Bæ‰“å·¥ï¼ŒBé¦–å…ˆä½¿ç”¨Aå’ŒBçš„ç­¾åï¼Œä½¿ç”¨P2SHçš„æ–¹å¼ï¼Œå‘é€ä¸€å®šé‡‘é¢åˆ°è„šæœ¬åœ°å€ï¼Œå¹¶å°†è¯¥äº¤æ˜“ç«‹å³ä¼ æ’­åˆ°æ¯”ç‰¹å¸ç½‘ç»œä¸Šï¼›ç„¶åBåˆ›é€ ç¬¬äºŒä¸ªäº¤æ˜“ï¼Œå¹¶ç”¨åˆ°åˆšåˆšAçš„ç­¾åï¼Œå…¶è¾“å…¥æ˜¯ç¬¬ä¸€ä¸ªäº¤æ˜“çš„è„šæœ¬åœ°å€ï¼Œè¾“å‡ºæ˜¯Bçš„åœ°å€ï¼ˆç›¸å½“äºå…¨é¢è¿”å›ç»™Bï¼‰ï¼Œç„¶åç»™è¿™ä¸ªäº¤æ˜“åŠ ä¸ŠLocktimeï¼Œæ¯”å¦‚è¯´ä¸€å¤©åæ‰èƒ½å¹¿æ’­è¿™ä¸ªäº¤æ˜“ã€‚ç„¶åAç»™Bå·¥ä½œä¸€éƒ¨åˆ†å†…å®¹åï¼ŒAè¦æ±‚Bå…ˆæ”¯ä»˜è¿™ä»½å·¥ä½œé‡çš„è–ªæ°´ï¼Œé‚£ä¹ˆBå°±åˆ›å»ºä¸€ä»½æ–°çš„äº¤æ˜“ï¼Œä»åŸæ¥å…¨é¢ç»™Bå˜æˆåˆ†å‡ºä¸€éƒ¨åˆ†é‡‘é¢ç»™Aï¼Œè¿™ä¸ªæ–°çš„äº¤æ˜“æ‹·è´ç»™Aï¼Œè¿™æ ·Aå°±å¯ä»¥å¹¿æ’­è¿™ä¸ªæ–°çš„äº¤æ˜“ä»è€Œè·å¾—è–ªæ°´ã€‚ï¼ˆå®é™…ä¸ŠAåªéœ€è¦åœ¨locktimeè¿‡æœŸå‰ï¼Œå¹¿æ’­æœ€åç‰ˆæœ¬çš„äº¤æ˜“å³å¯ï¼‰</p></li><li><p>ä¸ºä»€ä¹ˆé‡‡ç”¨è¿™æ ·çš„æ–¹å¼å‘¢ï¼Œå› ä¸ºAè¯‰æ±‚æ˜¯åŠæ—¶æ”¯ä»˜è–ªæ°´ï¼Œä½†æ˜¯å› ä¸ºé‡å°ï¼ŒBä¸èƒ½æ¯æ¬¡éƒ½ç«‹å³åˆ›é€ ä¸€ä¸ªäº¤æ˜“å³åˆ»æ”¯ä»˜ï¼Œè¿™æ ·çš„äº¤æ˜“è´¹çš„æˆæœ¬å¤ªé«˜äº†ã€‚æ‰€ä»¥åˆ©ç”¨è¿™æ ·çš„æ–¹å¼ï¼Œæ—¢ç¡®ä¿äº†Açš„è–ªæ°´æ˜¯åŠæ—¶å¾—åˆ°ç¡®è®¤çš„ï¼Œåˆå¯ä»¥ä½¿å¾—åªéœ€ä¸€ä¸ªäº¤æ˜“å°±ä¸€æ¬¡æ€§æ”¯ä»˜è–ªæ°´</p></li><li><p>å®é™…ä¸Šï¼Œæ›´æ”¹äº¤æ˜“é‡‘é¢çš„è¾“å‡ºï¼Œè¿™ä¸ªæƒåˆ©æ˜¯åœ¨Bçš„ï¼Œå› ä¸ºBæœ‰Açš„ç­¾åä½†Aæ²¡æœ‰Bçš„ç­¾åï¼ŒAæ‹¿çš„æ˜¯ç»è¿‡Bç­¾ååçš„äº¤æ˜“å‰¯æœ¬ï¼ˆè¿™ä¸ªäº¤æ˜“è¢«Bç­¾åè¿‡äº†ï¼Œæ‰€ä»¥æ˜¯æœ‰æ•ˆçš„ï¼‰ã€‚æ‰€ä»¥Aèƒ½å®æ—¶ç¡®ä¿è‡ªå·±å¯¹åº”å·¥ä½œé‡çš„è–ªæ°´èƒ½åŠæ—¶æ”¯ä»˜ï¼Œå°±ç®—ä¸­é€”Bè·‘è·¯äº†ï¼Œä¹Ÿåªæ˜¯æŸå¤±ä¸€å°éƒ¨åˆ†å·¥ä½œé‡çš„è–ªæ°´ï¼Œä¹‹å‰çš„è–ªæ°´éƒ½å¯ä»¥å¾—åˆ°æ”¯ä»˜ã€‚è€Œå¯¹Bæ¥è¯´ï¼Œå¦‚æœAæ²¡æœ‰å·¥ä½œï¼Œé‚£Bä¹Ÿèƒ½åœ¨locktime è¿‡æœŸåæ‹¿å›è‡ªå·±çš„é’±ï¼ˆä¸è¿‡è¿™æ ·å°±éœ€è¦ç­‰å¾…ä¸€ä¸ªlocktimeçš„æ—¶é—´ï¼‰</p></li><li><p>Coinjoinæ··å¸äº¤æ˜“ï¼Œå¢åŠ éšåŒ¿æ€§ï¼Œä¿æŠ¤éšç§ï¼Œå½“å’Œå…¶ä»–è¾“å…¥è¾“å‡ºæ··æ‚åœ¨ä¸€èµ·æ—¶ï¼Œåˆ«äººå°±éš¾ä»¥è¿½è¸ªè¾“å‡ºè®°å½•äº†</p></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110111350075.(null)" alt="" /></p><h2 id="walleté’±åŒ…"><a class="markdownIt-Anchor" href="#walleté’±åŒ…"></a> Walleté’±åŒ…</h2><ul><li>é’±åŒ…ç¨‹åºä¸»è¦å¯åˆ†ä¸ºä¸‰ä¸ªå­ç¨‹åºï¼Œä¸€ä¸ªç¨‹åºæ¥å‘å¸ƒå…¬é’¥ç”¨äºæ¥æ”¶æ¯”ç‰¹å¸ï¼Œè€Œå¦ä¸€ä¸ªç¨‹åºå¯¹äº¤æ˜“åšç­¾åæ¥èŠ±è´¹æ¯”ç‰¹å¸ï¼Œè¿˜æœ‰ä¸€ä¸ªç½‘ç»œç¨‹åºç”¨æ¥è·ŸP2Pç½‘ç»œäº¤äº’ã€‚æ›´å…·ä½“åœ°è¯´ï¼Œä¸€ä¸ªå®Œæ•´çš„é’±åŒ…ç¨‹åºåº”åŒ…æ‹¬è¿™äº›åŠŸèƒ½ï¼šç”Ÿæˆç§é’¥ï¼Œç”Ÿæˆå¯¹åº”çš„å…¬é’¥ï¼ŒæŒ‰ç…§éœ€è¦å¯¹å…¬é’¥è¿›è¡Œå‘å¸ƒï¼Œç›‘å¬ä»¥è¿™äº›å…¬é’¥ä½œä¸ºè¾“å‡ºçš„äº¤æ˜“ï¼Œåˆ›å»ºäº¤æ˜“å¹¶å¯¹å…¶è¿›è¡Œç­¾åï¼Œå¹¿æ’­å·²ç­¾åçš„äº¤æ˜“ã€‚</li><li>Wallet file æ˜¯å¯¹ç§é’¥è¿›è¡Œç®¡ç†ï¼›æè¿°äº†ç§é’¥å’Œå…¬é’¥çš„æ ¼å¼</li><li>å‚è€ƒï¼š<a href="https://blog.csdn.net/omnispace/article/details/79816141">æ•°å­—è´§å¸é’±åŒ… - åŠ©è®°è¯ åŠ HD é’±åŒ…å¯†é’¥åŸç†_omnispaceçš„åšå®¢-CSDNåšå®¢</a></li></ul><h2 id="payment-processing-æ”¯ä»˜å¤„ç†"><a class="markdownIt-Anchor" href="#payment-processing-æ”¯ä»˜å¤„ç†"></a> Payment Processing æ”¯ä»˜å¤„ç†</h2><ul><li>ä»‹ç»å››ç§æ”¯ä»˜æ¯”ç‰¹å¸çš„æ–¹å¼å’Œç›¸å…³çš„å…·ä½“ç»†èŠ‚ï¼ŒåŒ…æ‹¬æ˜æ–‡ï¼Œbitcoin:URIï¼ŒQRç ï¼Œæ–°çš„æ”¯ä»˜åè®®X.509</li><li>å…¶ä¸­æåˆ°ä¸€ç§â€œMerge Avoidanceåˆå¹¶è§„é¿â€çš„æ–¹æ³•æ¥ä¿æŠ¤ç”¨æˆ·éšç§ï¼Œè¯¥æ–¹æ³•å¤§ä½“çš„æ„æ€å°±æ˜¯è®©å‡å°‘å„ä¸ªè´¦æˆ·è¿æ¥åœ¨ä¸€èµ·çš„æ¬¡æ•°ï¼ˆæˆ–è€…è¯´å‡å°‘è¾“å…¥çš„ä¸ªæ•°ï¼‰ã€‚å› ä¸ºå½“ä½ ä½¿ç”¨UTXOä½œä¸ºè¾“å…¥è¿›è¡ŒèŠ±è´¹æ—¶ï¼ŒUTXOåŸå…ˆçš„ownerå°±å¯ä»¥è¿½æº¯è¿™æ¬¡äº¤æ˜“çš„ä¿¡æ¯ï¼Œè¾“å…¥çš„UTXOè¶Šå¤šé‚£ä¹ˆèƒ½è¿½æº¯åˆ°è¿™ç¬”äº¤æ˜“çš„äººå°±è¶Šå¤šï¼Œéšç§å°±ä¼šå—åˆ°å½±å“ã€‚ç”¨å®˜æ–¹çš„ä¾‹å­æ¥è¯´ï¼Œä½ æœ‰100ï¼Œ200ï¼Œ500ï¼Œ900çš„UTXOï¼Œç„¶åä½ ç°åœ¨éœ€è¦æ”¯ä»˜300BTCï¼Œé‚£ä¹ˆä½ è¯¥é€‰ç”¨500çš„UTXOæ¥è¿›è¡Œæ”¯ä»˜ï¼ˆè€Œä¸æ˜¯é€‰æ‹©100ï¼Œ200ä½œä¸ºè¾“å…¥ï¼Œä½“ç°äº†åˆå¹¶ï¼Œè§„é¿é£é™©ï¼‰ã€‚</li></ul><h2 id="operating-modesè¿è¡Œæ¨¡å¼"><a class="markdownIt-Anchor" href="#operating-modesè¿è¡Œæ¨¡å¼"></a> Operating Modesè¿è¡Œæ¨¡å¼</h2><ul><li>æ¯”ç‰¹å¸ä¸»è¦æœ‰ä¸¤ç§è¿è¡Œæ¨¡å¼ï¼šä¸€ä¸ªæ˜¯å…¨èŠ‚ç‚¹å®¢æˆ·ç«¯ï¼ˆåŒ…å«æ‰€æœ‰åŒºå—å’Œäº¤æ˜“ä¿¡æ¯ï¼‰ï¼Œä¸€ä¸ªæ˜¯SPVå®¢æˆ·ç«¯ï¼ˆåªä¿å­˜åŒºå—å¤´ä¿¡æ¯ï¼‰ã€‚SPVå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡è¯·æ±‚å…¨èŠ‚ç‚¹æ‹¿åˆ°ç›¸åº”çš„åŒºå—ä¿¡æ¯ï¼Œè¿›è¡ŒéªŒè¯ã€‚ç„¶è€ŒSPVå®¢æˆ·ç«¯æœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼Œä¸€ä¸ªæ˜¯å¯èƒ½ä¼šè¢«å…¨èŠ‚ç‚¹æ¬ºéª—ï¼Œè§£å†³åŠæ³•æ˜¯è¿æ¥å¤šä¸ªå…¨èŠ‚ç‚¹ï¼Œä¿è¯ä¸è¦å’Œè¯šå®èŠ‚ç‚¹æ–­å¼€é“¾æ¥äº†ï¼›å¦ä¸€ä¸ªæ˜¯å®¹æ˜“å—åˆ°æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œè§£å†³åŠæ³•æ˜¯å¸ƒéš†è¿‡æ»¤å™¨</li><li>å‚è€ƒï¼š<a href="https://shuwoom.com/?p=857">å¸ƒéš†è¿‡æ»¤å™¨(Bloom Filter)ã€SPVå’Œæ¯”ç‰¹å¸ - shuwoomçš„åšå®¢</a></li></ul><h2 id="p2pç½‘ç»œ"><a class="markdownIt-Anchor" href="#p2pç½‘ç»œ"></a> P2Pç½‘ç»œ</h2><ul><li>å› ä¸ºå…±è¯†è§„åˆ™ä¸åŒ…æ‹¬ç½‘ç»œï¼Œæ‰€ä»¥æœ‰å¯é€‰çš„ç½‘ç»œå’Œåè®®ã€‚è¿™é‡Œç”¨Bitcoin Coreä½œä¸ºå…¨èŠ‚ç‚¹ä»£è¡¨ï¼ŒBitcoinJä½œä¸ºSPVå®¢æˆ·ç«¯ä»£è¡¨ã€‚</li></ul><h3 id="peer-discovery"><a class="markdownIt-Anchor" href="#peer-discovery"></a> Peer Discovery</h3><ul><li>é¦–å…ˆé€šè¿‡è¯¢é—®DNS seedsæ¥è·å–å¯¹ç­‰ç½‘ç»œå…¶ä»–æœ‰æ•ˆè¿è¡Œçš„èŠ‚ç‚¹IPï¼Œå’Œå¯¹ç­‰èŠ‚ç‚¹å»ºç«‹è¿æ¥åï¼Œå¯ä»¥è·å–å¾—åˆ°æ›´å¤šçš„ç½‘ç»œèŠ‚ç‚¹IPã€‚æ­¤å¤–ï¼Œåœ¨ç¨‹åºä¸­ä¼šæœ‰ä¸€äº›å›ºå®šçš„é™æ€IPå¯ä»¥å°è¯•è¿æ¥ï¼Œæˆ–è€…ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·å°è¯•ä¸æŒ‡å®šIPè¿æ¥ã€‚</li></ul><h3 id="connecting-to-peers"><a class="markdownIt-Anchor" href="#connecting-to-peers"></a> Connecting to Peers</h3><ul><li>èŠ‚ç‚¹é€šè¿‡å‘é€versionæ¶ˆæ¯è¿æ¥åˆ°ä¸€ä¸ªå¯¹ç­‰èŠ‚ç‚¹ã€‚æ¶ˆæ¯version åŒ…å«äº†èŠ‚ç‚¹çš„ç‰ˆæœ¬ä¿¡æ¯ã€å—ä¿¡æ¯å’Œè·ç¦»è¿œç¨‹èŠ‚ç‚¹çš„æ—¶é—´ã€‚ä¸€æ—¦è¿™ä¸ªæ¶ˆæ¯è¢«å¯¹ç­‰èŠ‚ç‚¹æ”¶åˆ°ï¼Œå®ƒå¿…é¡»å›å¤ä¸€ä¸ªverackã€‚å¦‚æœå®ƒæ„¿æ„å»ºç«‹å¯¹ç­‰å…³ç³»ï¼Œå®ƒå°†å‘é€è‡ªå·±çš„versionæ¶ˆæ¯ã€‚</li><li>ä¸€æ—¦å»ºç«‹å¯¹ç­‰å…³ç³»ï¼ŒèŠ‚ç‚¹å¯ä»¥å‘è¿œç¨‹èŠ‚ç‚¹å‘é€getaddrå’Œaddræ¶ˆæ¯æ¥è·å¾—å…¶å®ƒçš„å¯¹ç­‰èŠ‚ç‚¹ä¿¡æ¯ã€‚ä¸ºäº†ç»´æŒä¸å¯¹ç­‰èŠ‚ç‚¹çš„è¿æ¥ï¼ŒèŠ‚ç‚¹é»˜è®¤æƒ…å†µä¸‹æ¯30åˆ†é’Ÿå†…ä¼šç»™å¯¹ç­‰èŠ‚ç‚¹è‡³å°‘å‘é€ä¸€æ¬¡ä¿¡æ¯ã€‚å¦‚æœè¶…è¿‡90åˆ†é’Ÿæ²¡æœ‰æ”¶åˆ°å›å¤ï¼ŒèŠ‚ç‚¹ä¼šè®¤ä¸ºè¿æ¥å·²ç»æ–­å¼€</li></ul><h3 id="initial-block-download"><a class="markdownIt-Anchor" href="#initial-block-download"></a> Initial Block Download</h3><ul><li>ä¸€ä¸ªå…¨èŠ‚ç‚¹åœ¨æ­£å¼å·¥ä½œæˆ–è€…æä¾›æœåŠ¡å‰ï¼Œéœ€è¦è¿›è¡Œåˆå§‹åŒ–ï¼ŒæŠŠé™¤äº†ç¡¬ç¼–ç ç”Ÿæˆçš„ç¬¬ä¸€ä¸ªåŒºå—å¤–çš„æ‰€æœ‰åŒºå—ä¸‹è½½ä¸‹æ¥ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯IBDã€‚</li><li>Block-First æ˜¯å…¶ä¸­ä¸€ç§ä¸‹è½½æ–¹å¼ï¼Œå‘ä¸€ä¸ªå¯¹ç­‰ç½‘ç»œèŠ‚ç‚¹è¿›è¡Œè¯¢é—®ï¼Œç›´æ¥ä¸‹è½½åŒºå—ï¼Œå…¶ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾<ul><li>ä¸‹è½½é€Ÿåº¦çš„é™åˆ¶ï¼šåªä»ä¸€ä¸ªåŒæ­¥èŠ‚ç‚¹ä¸‹è½½ï¼Œå—é™è¯¥èŠ‚ç‚¹çš„å¸¦å®½</li><li>é‡æ–°ä¸‹è½½ï¼šåŒæ­¥èŠ‚ç‚¹å¯èƒ½ä¼šå‘é€ä¸æ˜¯æœ€é•¿é“¾ä¸Šçš„åŒºå—ï¼Œå°±ä¼šå¯¼è‡´å¿«ç»“æŸæ—¶æ‰å‘ç°éœ€è¦é‡æ–°ä¸‹è½½</li><li>ç£ç›˜ç©ºé—´å ç”¨ï¼šå’Œâ€œé‡æ–°ä¸‹è½½â€ç›¸å…³ï¼Œä¸‹è½½æ—¶å¯èƒ½ä¼šå°†æ— ç”¨çš„åŒºå—ä¿å­˜åˆ°ç£ç›˜ï¼Œå ç”¨ç©ºé—´</li><li>å¤§é‡å†…å­˜ä½¿ç”¨ï¼šå› ä¸ºåŒæ­¥èŠ‚ç‚¹å‘é€è¿‡æ¥çš„åŒºå—å¯èƒ½æ˜¯æ— åºçš„ï¼Œæ‰€ä»¥éœ€è¦å…ˆä¿å­˜åˆ°å†…å­˜ä¸­ï¼Œç›´åˆ°æ¥æ”¶åˆ°çˆ¶å—æ‰èƒ½è¿›è¡ŒéªŒè¯</li></ul></li><li>Header-First çš„ä¸‹è½½æ–¹å¼ï¼Œè§£å†³äº†Block-Firstä¸­å››ä¸ªç¼ºé™·ï¼Œå®ƒçš„å·¥ä½œæ–¹å¼æ˜¯ï¼šå…ˆå‘åŒæ­¥èŠ‚ç‚¹ä¸‹è½½block headersï¼Œå½“éƒ¨åˆ†åœ°éªŒè¯headersæœ‰æ•ˆæ€§åï¼ŒIBDèŠ‚ç‚¹å°±å¯ä»¥å¹¶è¡Œåœ°åšä¸¤å¤©äº‹â€”â€”ä¸€ä¸ªæ˜¯ç»§ç»­å‘åŒæ­¥èŠ‚ç‚¹å‘é€è¯·æ±‚ä¸‹è½½headersï¼Œå¦ä¸€ä¸ªæ˜¯å‘å…¶ä»–å¯¹ç­‰èŠ‚ç‚¹å‘é€è¯·æ±‚ä¸‹è½½block</li></ul><h2 id="mining-æŒ–çŸ¿"><a class="markdownIt-Anchor" href="#mining-æŒ–çŸ¿"></a> Mining æŒ–çŸ¿</h2><ul><li>ç°åœ¨æœ‰ä¸¤ç§æŒ–çŸ¿æ–¹å¼ï¼šå•ç‹¬æŒ–çŸ¿å’ŒçŸ¿æ± æŒ–çŸ¿<ul><li>å•ç‹¬æŒ–çŸ¿ï¼šbitcoindæ¥è·å–P2Pç½‘ç»œä¸Šçš„äº¤æ˜“ï¼ŒæŒ–çŸ¿è½¯ä»¶é€šè¿‡RPCæ–¹æ³•æ¥è·å–åˆ—è¡¨ï¼Œå¹¶æ„é€ ä¸€ä¸ªBlockæ¨¡æ¿ï¼Œç„¶åå°†å¯¹åº”çš„block headerå‘é€ç»™ASICè¿›è¡Œè¿ç®—ã€‚æŒ–çŸ¿è½¯ä»¶ä¼šå°†ä¸€ä¸ªnonceå€¼å¡«å…¥å¸åŸºäº¤æ˜“çš„çš„å­—æ®µä¸­ï¼Œè·å¾—æ–°çš„Merkle rootçš„hashå€¼ï¼Œç„¶åå°†æ–°çš„Block headerå‘é€ä¸ªASICã€‚å¦‚æœASICè®¡ç®—ç”Ÿæˆçš„block header hashå°äºé¢„å®šçš„é˜ˆå€¼ï¼Œåˆ™è¡¨æ˜æ·»åŠ çš„nonceå€¼ç¬¦åˆæ¡ä»¶ï¼Œå°†block headerè¿”å›ç»™æŒ–çŸ¿è½¯ä»¶ï¼ŒæŒ–çŸ¿è½¯ä»¶æ ¹æ®è¿”å›çš„block headeræ›´æ–°blockï¼Œæœ€åå°†å®Œæ•´çš„block è¿”å›ç»™bitcoindï¼Œbitcoindå†å‘ç½‘ç»œä¼ æ’­åŒºå—</li></ul></li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110111350617.(null)" alt="" /></p><ul><li>çŸ¿æ± æŒ–çŸ¿ï¼šå·¥ä½œæµè·Ÿå•ç‹¬æŒ–çŸ¿ç±»ä¼¼ã€‚ä¸åŒçš„æ˜¯ï¼ŒçŸ¿æ± è®¾å®šçš„é˜ˆå€¼è¦æ¯”ç½‘ç»œä¸Šè®¾å®šçš„é˜ˆå€¼å°å¾ˆå¤šï¼ˆé™ä½äº†éš¾åº¦ï¼‰ï¼Œå› æ­¤å„ä¸ªçŸ¿å·¥é€šè¿‡æŒ–çŸ¿è½¯ä»¶è¿”å›ç»™çŸ¿æ± çš„block hearderä¸­ï¼Œæœ‰å¾ˆå¤šæ˜¯æ»¡è¶³çŸ¿æ± çš„é˜ˆå€¼ä½†ä¸æ»¡è¶³ç½‘ç»œçš„é˜ˆå€¼ï¼Œè¿™äº›è¿”å›çš„block headerç›¸å½“äºæ˜¯ä»½é¢ï¼Œè¯æ˜äº†çŸ¿å·¥çš„å·¥ä½œé‡ï¼›åŒæ—¶æ€»ä¼šæœ‰å‡ ç‡äº§ç”ŸåŒæ—¶æ»¡è¶³ä¸¤ä¸ªé˜ˆå€¼çš„block headerï¼ŒçŸ¿æ± å°†æ»¡è¶³ç½‘ç»œé˜ˆå€¼æ¡ä»¶çš„blockå‘é€ç»™bitcoindï¼Œä»è€Œè·å¾—å¥–åŠ±ã€‚ç„¶åçŸ¿æ± æ ¹æ®çŸ¿å·¥è´¡çŒ®çš„ä»½é¢ï¼Œå¹³å‡åˆ†å‘å¥–åŠ±ã€‚ä¸¾ä¸ªå…·ä½“ä¾‹å­å°±æ˜¯ï¼ŒçŸ¿å·¥ä»¬æ€»å…±è¿”å›äº†100ä¸ªæ»¡è¶³çŸ¿æ± æ¡ä»¶çš„block headerï¼ˆç›¸å½“äºæœ‰100ä»½é¢ï¼‰ï¼Œåªæœ‰1ä¸ªæ»¡è¶³ç½‘ç»œé˜ˆå€¼ï¼Œé‚£ä¹ˆæ¯ä»½é¢çš„å¥–åŠ±å°±æ˜¯æ€»å¥–åŠ±çš„1/100ï¼ŒçŸ¿å·¥æ ¹æ®è‡ªå·±çš„ä»½é¢è·å¾—ç›¸åº”å¥–åŠ±ã€‚</li></ul><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110111350905.(null)" alt="" /></p><ul><li>è¿˜ä»‹ç»äº†ä¸‰ç§æŒ–çŸ¿è½¯ä»¶è·å–Blockçš„RPC<ul><li>getwork RPCï¼šå½“å‰Bitcoin Coreå·²ç»åºŸå¼ƒï¼Œè¿™ä¸ªæ–¹æ³•ç›´æ¥ä¸ºçŸ¿å·¥æ„é€ å¥½block headerï¼Œå› æ­¤çŸ¿å·¥å¯èƒ½éœ€è¦è°ƒç”¨æˆç™¾ä¸Šåƒæ¬¡RPC</li><li>getblocktemplate RPCï¼šè·å–ä»¥ä¸‹å†…å®¹ï¼›ç„¶åæŒ–çŸ¿è½¯ä»¶å°±èƒ½è‡ªå·±æ”¹å˜nonceå€¼ï¼Œè‡ªå·±ç”Ÿæˆblock header<ul><li>æ„é€ å¸åŸºäº¤æ˜“çš„ä¿¡æ¯</li><li>bitcoindå‘é€ç»™çŸ¿æ± çš„äº¤æ˜“åˆ—è¡¨å’Œå…·ä½“äº¤æ˜“ä¿¡æ¯ï¼Œè¿™ä½¿å¾—æŒ–çŸ¿è½¯ä»¶å¯ä»¥æŸ¥çœ‹äº¤æ˜“ï¼Œå¹¶æœ‰é€‰æ‹©æ€§åœ°æ·»åŠ æˆ–åˆ é™¤äº¤æ˜“</li><li>æ„é€ block headerçš„å…¶ä»–ä¿¡æ¯</li><li>çŸ¿æ± æä¾›çš„éš¾åº¦å€¼æˆ–è€…ç½‘ç»œè®¾å®šçš„éš¾åº¦å€¼</li></ul></li><li>Stratumï¼šè·Ÿgetblocktemplateå¾ˆç±»ä¼¼ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯ï¼ŒæŒ–çŸ¿è½¯ä»¶è·å–åˆ°çš„æ˜¯é‡æ–°æ„é€ Merkleæ ‘çš„å¿…è¦ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å…·ä½“çš„äº¤æ˜“åˆ—è¡¨å’Œäº¤æ˜“å†…å®¹ã€‚å› æ­¤ï¼ŒæŒ–çŸ¿è½¯ä»¶ä¸èƒ½æ·»åŠ æˆ–è€…åˆ é™¤äº¤æ˜“ï¼Œä¸è¿‡æ­¤æ—¶æŒ–çŸ¿è½¯ä»¶å’ŒçŸ¿æ± å»ºç«‹åŒå‘çš„TCPè¿æ¥ï¼›åœ¨getblocktemplate é‡Œï¼ŒæŒ–çŸ¿è½¯ä»¶ç”¨çš„æ˜¯HTTP longpollé•¿è½®è¯¢ï¼Œæ¥è·å–æœ€è¿‘çš„æ›´æ–°ã€‚</li></ul></li></ul><h1 id="å­˜åœ¨ç–‘é—®"><a class="markdownIt-Anchor" href="#å­˜åœ¨ç–‘é—®"></a> å­˜åœ¨ç–‘é—®</h1><p>é˜…è¯»å®Œæ‰€æœ‰å†…å®¹åï¼Œè¿˜æ˜¯æœ‰å¾ˆå¤šé—®é¢˜å’Œç»†èŠ‚æ²¡æœ‰å¼„æ˜ç™½ã€‚</p><ol><li>åŸæ–‡ï¼šSince it is impractical to have separate transactions with identical txids, this does not impose a burden on honest software, but must be checked if the invalid status of a block is to be cached; otherwise, a valid block with the duplicates eliminated could have the same merkle root and block hash, but be rejected by the cached invalid outcome, resulting in security bugs such as <a href="https://en.bitcoin.it/wiki/CVEs#CVE-2012-2459">CVE-2012-2459</a>.</li></ol><blockquote><p>å¯¹äºä¸Šè¿°å†…å®¹ä¸æ˜¯å¾ˆèƒ½ç†è§£ï¼Œä¸åŒçš„transactionsæ€ä¹ˆä¼šæœ‰ç›¸åŒçš„TXIDï¼Œå¯èƒ½æ˜¯ç”±äºhashå†²çªå¯¼è‡´çš„ï¼Ÿè™½ç„¶æ¦‚ç‡å¾ˆå°ã€‚ç„¶åâ€œå¯¹äºç¼“å­˜ä¸€ä¸ªæ— æ•ˆåŒºå—çš„çŠ¶æ€â€ï¼Œè¿™è¯¥å¦‚ä½•ç†è§£ï¼Ÿä»€ä¹ˆæ—¶å€™ç”¨åˆ°äº†ç¼“å­˜ï¼Œç¼“å­˜ä»€ä¹ˆå†…å®¹ï¼ˆåŒºå—çš„çŠ¶æ€ï¼Ÿï¼‰ï¼Œä»¥åŠå¦‚ä½•åˆ¤æ–­åŒºå—æ˜¯æœ‰æ•ˆè¿˜æ˜¯æ— æ•ˆï¼Ÿå¦‚æœå› ä¸ºæœ‰TXIDå†²çªåˆ¤å®šåŒºå—æ— æ•ˆçš„è¯ï¼Œå¯ä»¥å»é‡TXIDï¼Œè¾¾åˆ°æœ‰æ•ˆï¼Ÿ</p></blockquote><ol><li>æ ‡å‡†äº¤æ˜“ä¸­ï¼ŒNull Dataçš„çš„pubkey scriptsç±»å‹ç”¨æ¥å¹²ä»€ä¹ˆçš„ï¼Ÿ</li><li>P2PK è¢« P2PKHæ‰€å–ä»£äº†ï¼Œæ”¯ä»˜åˆ°å…¬é’¥å“ˆå¸Œçš„åœ°å€ï¼Œå¯ä»¥ä½¿å¾—å…¬é’¥ç›´åˆ°UTXOè¢«ä½¿ç”¨æ—¶æ‰ä¼šå‘å¸ƒï¼Œå»¶è¿Ÿå…¬é’¥å‘å¸ƒçš„åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯ä¸ºäº†é¿å…æ”»å‡»è€…åˆ©ç”¨å…¬é’¥è¿›è¡ŒæŸäº›æ”»å‡»å—ï¼Ÿ</li><li>å¤šç§Signature hash typesçš„ç”¨é€”æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆè¦æœ‰é€‰æ‹©æ€§çš„è¿›è¡Œç­¾åï¼Ÿ</li><li>äº¤æ˜“è¢«æ‰“åŒ…åˆ°åŒºå—ï¼Œäº¤æ˜“çš„è´¹ç”¨æ˜¯æ ¹æ®äº¤æ˜“çš„ç­¾åå­—èŠ‚é•¿åº¦è®¡ç®—å‡ºæ¥ï¼Œé‚£ä¹ˆè¿™ç¬”è´¹æ˜¯ç”±ä¹°å®¶ï¼ˆæ”¯ä»˜è€…ï¼‰æ¥ä»˜å—ï¼Ÿåœ¨å¯¹åº”çš„ä¸€ä¸ªäº¤æ˜“ä¸­ï¼Œæ˜¯ä¼šå¢åŠ ä¸€ä¸ªoutputæ¥æŒ‡å‘çŸ¿å·¥å—ï¼Ÿ</li><li>å¯¹äºHDé’±åŒ…ï¼Œå³åˆ†å±‚ç¡®å®šæ€§é’±åŒ…ä¸­çš„å·¥ä½œåŸç†è¿˜æ˜¯ä¸å¤ªç†è§£ï¼Œç‰¹åˆ«æ˜¯extened keysåˆ°harderned keysçš„è½¬å˜ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Ÿè¿™ä¹ˆåšå¦‚ä½•è§£å†³é—®é¢˜çš„ï¼Ÿ</li><li>SPVå®¢æˆ·ç«¯å…·ä½“æ˜¯æ€ä¹ˆä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨çš„ï¼Ÿ</li><li>çŸ¿å·¥å‘å¸ƒåŒºå—æ—¶ï¼Œå…·ä½“æ˜¯æ€ä¹ˆç»™çŸ¿å·¥å‘æ”¾å¥–åŠ±çš„ï¼Ÿæ˜¯åœ¨åˆ›å»ºåŒºå—çš„æ—¶å€™ï¼Œç›´æ¥ç”Ÿæˆä¸€ä¸ªå¸åŸºäº¤æ˜“ï¼ˆæŠŠé’±è½¬è´¦ç»™è¯¥çŸ¿å·¥ï¼‰ï¼Œç„¶åçŸ¿å·¥æ‰“åŒ…æ‰€æœ‰äº¤æ˜“åï¼Œå¼€å§‹æ‰¾æ»¡è¶³æ¡ä»¶çš„nonceï¼Œæ‰¾åˆ°åå¹¿æ’­åŒºå—ï¼Œè¿™æ ·å¦‚æœåŒºå—å¾—åˆ°å…¶ä»–èŠ‚ç‚¹è®¤å¯ä¸Šé“¾äº†ï¼Œé‚£ä¹ˆçŸ¿å·¥å°±åˆ‡å®å¾—åˆ°äº†æ”¶ç›Šã€‚ï¼ˆè¿™æ ·çš„è¯ï¼Œæ¯ä¸ªèŠ‚ç‚¹åœ¨ç”ŸæˆåŒºå—ï¼‰</li></ol><h1 id="æ‰€æ€æ‰€æ„Ÿ"><a class="markdownIt-Anchor" href="#æ‰€æ€æ‰€æ„Ÿ"></a> æ‰€æ€æ‰€æ„Ÿ</h1><p>é˜…è¯»å®Œè¿™ç¯‡Guideæ¦‚è§ˆï¼Œè®©æˆ‘è®¤è¯†äº†è§£æ¯”ç‰¹å¸ä¸­è®¸å¤šæŠ€æœ¯å’Œå®ç°ç»†èŠ‚ï¼Œä½†æ˜¯é€šè¯»å®Œä¸€éåï¼Œå‘ç°è‡ªå·±å¥½åƒæ‡‚äº†ï¼Œåˆå¥½åƒæ²¡æ‡‚ï¼Œæˆ–è€…è¯´ä»æ•´ä½“ä¸Šå¯¹æ¯”ç‰¹å¸çš„æ•´ä½“æ¶æ„æœ‰äº†ä¸€å®šçš„è®¤è¯†ï¼Œå…·ä½“æœ‰å“ªäº›éƒ¨åˆ†ç»„æˆï¼Œæ¶‰åŠå“ªäº›å…³é”®æŠ€æœ¯ï¼Œä½†æ˜¯å¯¹ä¸ªå„ä¸ªæ¨¡å—è¿›ä¸€æ­¥çš„ç»†èŠ‚è¿˜æ˜¯ä¼¼æ‡‚éæ‡‚ï¼Œå¹¶ä¸”è¿˜æ˜¯éš¾ä»¥ä¸²è”èµ·æ¥ï¼Œå„ä¸ªéƒ¨åˆ†æœ‰æ˜æ˜¾çš„è”ç³»ï¼ˆæ¯”å¦‚äº¤æ˜“ä¸é’±åŒ…ä¸æ”¯ä»˜å¤„ç†ï¼‰ï¼Œä½†æ˜¯æ„Ÿè§‰è‡ªå·±è¿˜æ˜¯å¾ˆéš¾å°†è¿™ä¸‰è€…çš„å…³ç³»è¡¨ç¤ºæ¸…æ¥šï¼Œæˆ–è€…è¯´ï¼Œå½“æŠŠæ•´ä¸ªæ¯”ç‰¹å¸çœ‹åšä¸€ä¸ªæ•´ä½“æ—¶ï¼Œå„ä¸ªéƒ¨åˆ†æ˜¯æ€ä¹ˆæ ·æœ‰æœºç‹¬ç«‹åˆç›¸äº’é…åˆçš„ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªç®€å•çš„æ€è€ƒï¼Œå°±æ˜¯å¯¹äºåˆçº¦éƒ¨åˆ†ä¸­å¤šé‡ç­¾åçš„ä½¿ç”¨ï¼Œä¾‹å¦‚æ‰˜ç®¡å’Œä»²è£ï¼ŒAå’ŒBä¹‹é—´çš„äº¤æ˜“è¿˜æ˜¯è¦ä¾èµ–äºä»²è£ç¬¬ä¸‰æ–¹Cï¼Œè¿™æ˜¯å¦ä¸æ¯”ç‰¹å¸å»ä¸­å¿ƒåŒ–çš„æ€æƒ³ç›¸çŸ›ç›¾äº†å‘¢ï¼Ÿåæ¥è¿›ä¸€æ­¥æ€è€ƒå’ŒæŸ¥é˜…èµ„æ–™ï¼Œä»å¦ä¸€ä¸ªè§†è§’å»çœ‹ï¼Œå»ä¸­å¿ƒåŒ–ï¼Œä¸æ˜¯ä¸è¦ä¸­å¿ƒï¼Œè€Œæ˜¯ç”±èŠ‚ç‚¹æ¥è‡ªç”±é€‰æ‹©ä¸­å¿ƒã€è‡ªç”±å†³å®šä¸­å¿ƒã€‚ç®€å•åœ°è¯´ï¼Œä¸­å¿ƒåŒ–çš„æ„æ€ï¼Œæ˜¯ä¸­å¿ƒå†³å®šèŠ‚ç‚¹ã€‚èŠ‚ç‚¹å¿…é¡»ä¾èµ–ä¸­å¿ƒï¼ŒèŠ‚ç‚¹ç¦»å¼€äº†ä¸­å¿ƒå°±æ— æ³•ç”Ÿå­˜ï¼ˆç±»ä¼¼äºæ²¡äº†æ”¯ä»˜å®å°±ä¸èƒ½ç”¨æ·˜å®ï¼Ÿï¼‰ã€‚è€Œåœ¨å»ä¸­å¿ƒåŒ–ç³»ç»Ÿä¸­ï¼Œä»»ä½•äººéƒ½æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»»ä½•äººä¹Ÿéƒ½å¯ä»¥æˆä¸ºä¸€ä¸ªä¸­å¿ƒã€‚ä»»ä½•ä¸­å¿ƒéƒ½ä¸æ˜¯æ°¸ä¹…çš„ï¼Œè€Œæ˜¯é˜¶æ®µæ€§çš„ï¼Œä»»ä½•ä¸­å¿ƒå¯¹èŠ‚ç‚¹éƒ½ä¸å…·æœ‰å¼ºåˆ¶æ€§ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>æ¯”ç‰¹å¸</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Bitcoin</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€99%ç¯å¢ƒæ­å»ºç³»åˆ—ã€‘äº‘è®¡ç®—ç®¡ç†å¹³å°Devstackå®‰è£…</title>
    <link href="/2021/10/08/2021-10/2021-10-08%20%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E7%B3%BB%E5%88%97%20-devstack%E5%AE%89%E8%A3%85/"/>
    <url>/2021/10/08/2021-10/2021-10-08%20%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E7%B3%BB%E5%88%97%20-devstack%E5%AE%89%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<h1 id="å¼•è¨€"><a class="markdownIt-Anchor" href="#å¼•è¨€"></a> å¼•è¨€</h1><p class='note note-success'>99%æ¦‚ç‡å®Œæˆç¯å¢ƒæ­å»ºï¼Œè®©å¤©ä¸‹æ²¡æœ‰æ­å»ºä¸äº†çš„ç¯å¢ƒï¼ </p><p>openstackä½œä¸ºå¼€æºçš„äº‘è®¡ç®—ç®¡ç†å¹³å°ï¼Œå¯ä»¥è®©æˆ‘ä»¬ä½“éªŒäº‘è®¡ç®—æŠ€æœ¯çš„å„ç§ç»„ä»¶å’ŒåŠŸèƒ½ï¼Œç„¶è€Œå®˜ç½‘ç¹ççš„é…ç½®æ•™ç¨‹ä»¤äººæœ›è€Œå´æ­¥ã€‚å¥½åœ¨devstackæä¾›äº†ä¸€ç«™å¼å®‰è£…æœåŠ¡ï¼Œ<s>åªéœ€ç®€å•æ‰§è¡Œå‡ ä¸ªå‘½ä»¤å³å¯å®Œæˆå®‰è£…</s>ï¼ˆæ ¹æœ¬ä¸æ˜¯è¿™æ ·å¥½å—ï¼ï¼‰ã€‚ä¸è¿‡ç»è¿‡æˆ‘çš„ç™¾èˆ¬æµ‹è¯•ï¼Œåªè¦å®‰è£…æ•™ç¨‹é‡Œçš„æ–¹å¼æ‰§è¡Œå‘½ä»¤ï¼ŒæˆåŠŸæ¦‚ç‡99%ï¼</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110082112035.png" alt="" /></p><h1 id="å®‰è£…ç¯å¢ƒ"><a class="markdownIt-Anchor" href="#å®‰è£…ç¯å¢ƒ"></a> å®‰è£…ç¯å¢ƒ</h1><p>è¿™é‡Œè¯´ä¸€ä¸‹æˆ‘ä¸ªäººçš„å®‰è£…ç¯å¢ƒ</p><ul><li>PCæ“ä½œç³»ç»Ÿï¼šwin10</li><li>VMware Workstationç‰ˆæœ¬ï¼š16.x Pro</li><li>Ubuntuç‰ˆæœ¬ï¼š18.04</li></ul><h1 id="å®‰è£…æ­¥éª¤"><a class="markdownIt-Anchor" href="#å®‰è£…æ­¥éª¤"></a> å®‰è£…æ­¥éª¤</h1><ol start="0"><li><strong>ç®€è¦è¯´æ˜</strong></li></ol><p class='note note-primary'>ubuntuæ“ä½œç³»ç»Ÿåœ¨è™šæ‹Ÿæœºçš„å®‰è£…è¿™é‡Œä¸å†æ¼”ç¤ºï¼Œå‡è®¾ä½ å·²ç»å®Œæˆäº†ubuntu18.04çš„å®‰è£…ï¼Œç„¶åç»§ç»­ï¼›<br>åœ¨~/ ç›®å½•ä¸‹ï¼Œä¾æ¬¡æ‰§è¡Œå‘½ä»¤å³å¯ï¼Œæ²¡æœ‰ç‰¹æ®Šè¯´æ˜ï¼Œä¸ç”¨æ‰§è¡Œåˆ«çš„å¤šä½™å‘½ä»¤</p><ol><li><strong>è®¾ç½®é™æ€IPï¼ˆå¯é€‰ï¼‰</strong></li></ol><blockquote><p>è¯´æ˜ï¼šè¿™ä¸€æ­¥æ˜¯å¯é€‰çš„ï¼Œä¹‹æ‰€ä»¥è®¾ç½®æˆé™æ€IPï¼Œæ˜¯ä¸ºäº†æ–¹ä¾¿åé¢çš„é…ç½®ï¼Œä»¥åŠæ’é™¤IPå˜åŠ¨çš„åŸå› å¯¼è‡´çš„ç§ç§æ„å¤–ï¼›ä¸è¿‡ä¸è¿›è¡Œé…ç½®çš„è¯ï¼Œåº”è¯¥ä¹Ÿæ˜¯okçš„ï¼Œåªè¦ä¿è¯æ•´ä¸ªå®‰è£…ä»¥åŠä½¿ç”¨è¿‡ç¨‹IPä¸ä¼šæ”¹å˜</p><p>å‚è€ƒç½‘ç«™ï¼š<a href="https://www.cnblogs.com/yaohong/p/11593989.html">ubuntué…ç½®é™æ€ip</a>       <a href="https://blog.csdn.net/zh2508/article/details/85250360">VMwareé…ç½®é™æ€ip</a></p></blockquote><p>é¦–å…ˆç»™æœºå™¨è®¾ç½®é™æ€ipï¼Œä¿®æ”¹<code>/etc/netplan</code>ç›®å½•ä¸‹å¯¹åº”çš„æ–‡ä»¶ï¼ŒæŒ‰å¦‚ä¸‹æ–‡ä»¶è¿›è¡Œé…ç½®ã€‚</p><p class='note note-info'>  ä¸‰ä¸ªæ³¨æ„ç‚¹ï¼š<br>  1. æ³¨æ„é…ç½®é‡Œçš„"ens32" æ ¹æ®è‡ªå·±çš„æœºå™¨è¿›è¡Œæ”¹åŠ¨ï¼Œå¯èƒ½æ˜¯"ens33"ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤ ip addr æ¥è¿›è¡ŒæŸ¥çœ‹ <br>  2. è¿™é‡Œå¤åˆ¶çš„è¯ï¼Œæ³¨æ„å¤åˆ¶åçš„ç»“æœæ˜¯å¦ä¸€è‡´ï¼Œå¯èƒ½éœ€è¦è‡ªå·±æ‰‹åŠ¨è¾“å…¥ä¸€ä¸‹ï¼Œè¿™æ ·çš„è¯è¦ä¸¥æ ¼æ³¨æ„æ ¼å¼ï¼Œå†’å·åé¢éœ€è¦ä¸€ä¸ªç©ºæ ¼ï¼Œæ¢è¡Œç¼©è¿›æ˜¯4ä¸ªç©ºæ ¼<br>  3. è®¾ç½®çš„ipå’Œç½‘å…³è¦åœ¨åŒä¸€ä¸ªç½‘æ®µä¸Šï¼Œè®°ä½è¿™é‡Œå¡«å…¥çš„ipï¼Œéœ€è¦ç”¨åœ¨ä¸‹é¢çš„é…ç½®ä¸­</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-number">2</span><br><span class="hljs-attr">renderer:</span> <span class="hljs-string">NetworkManager</span><br><span class="hljs-attr">network:</span><br><span class="hljs-string">â€‹</span>    <span class="hljs-attr">ethernets:</span><br><span class="hljs-string">â€‹</span>        <span class="hljs-attr">ens32:</span><br><span class="hljs-string">â€‹</span>            <span class="hljs-attr">dhcp4:</span> <span class="hljs-literal">no</span><br><span class="hljs-string">â€‹</span>            <span class="hljs-attr">addresses:</span> [<span class="hljs-number">192.168</span><span class="hljs-number">.17</span><span class="hljs-number">.10</span><span class="hljs-string">/24</span>]<br><span class="hljs-string">â€‹</span>            <span class="hljs-attr">optional:</span> <span class="hljs-literal">true</span><br><span class="hljs-string">â€‹</span>            <span class="hljs-attr">gateway4:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.17</span><span class="hljs-number">.2</span><br><span class="hljs-string">â€‹</span>            <span class="hljs-attr">nameservers:</span><br><span class="hljs-string">â€‹</span>                    <span class="hljs-attr">addresses:</span> [<span class="hljs-number">192.168</span><span class="hljs-number">.17</span><span class="hljs-number">.1</span>,<span class="hljs-number">192.168</span><span class="hljs-number">.17</span><span class="hljs-number">.2</span>] <span class="hljs-comment"># è¿™é‡ŒDNSçš„ä¿®æ”¹ï¼Œæ˜¯å› ä¸ºæˆ‘é…ç½®äº†ä¸Šé¢VMwareé…ç½®é™æ€ip</span><br></code></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œ<code>sudo netplan apply</code>ï¼Œè®©é…ç½®ç”Ÿæ•ˆï¼Œå†é€šè¿‡<code>ip addr</code>æŸ¥çœ‹æ˜¯å¦ç”Ÿæ•ˆï¼Œå·²ç»<code>ping</code>å‘½ä»¤æŸ¥çœ‹ç½‘ç»œæ˜¯å¦è¿é€š</p><ol start="2"><li><strong>åˆ‡æ¢aptæº</strong></li></ol><p>åˆ‡æ¢aptæºçš„ç›®çš„æ˜¯ä¸ºäº†åŠ å¿«ä¸‹è½½å®‰è£…çš„é€Ÿåº¦</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt-get install vim #å…ˆå®‰è£…ä¸‹vim<br>sudo mv /etc/apt/sources.list /etc/apt/sources.list.bak<br>sudo vim /etc/apt/sources.list # å¦‚æœvimè¿˜æ²¡æœ‰å®‰è£…ï¼Œæ”¹ç”¨ vi å¤åˆ¶ä¸‹å°±è¡Œ<br></code></pre></td></tr></table></figure><p>è¿™é‡Œé…ç½®ç”¨çš„æ˜¯é˜¿é‡Œäº‘çš„é•œåƒï¼Œå¦‚æœä¹‹åå› ä¸ºç½‘ç»œçš„é—®é¢˜å¯ä»¥å°è¯•æ¢ä¸‹åˆ«çš„æºï¼Œä¸è¿‡æˆ‘æµ‹è¯•ä½¿ç”¨çš„éƒ½æ˜¯é˜¿é‡Œäº‘</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æ³¨æ„ubuntuç‰ˆæœ¬å·å¯¹åº”ä¸åŒçš„ä»£å·ï¼Œè¿™é‡Œç”¨çš„æ˜¯18.04ï¼Œå¯¹åº”bionic</span><br>deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse<br>deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse<br>deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse<br>deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse<br>deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse<br>deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse<br>deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse<br>deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse<br>deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse<br></code></pre></td></tr></table></figure><ol start="3"><li><strong>æ›´æ¢pipæº</strong></li></ol><p>ä¹Ÿæ˜¯ä¸ºäº†åŠ å¿«ä¸‹è½½å®‰è£…ä¾èµ–çš„é€Ÿåº¦</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">mkdir .pip<br>vim .pip/pip.conf<br></code></pre></td></tr></table></figure><p>é…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼Œç”¨çš„æ˜¯è±†ç“£çš„é•œåƒ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[global]<br>index-url = http://pypi.douban.com/simple/<br>trusted-host = pypi.douban.com<br></code></pre></td></tr></table></figure><ol start="4"><li><strong>æ›´æ–°å¹¶å®‰è£…åŒ…</strong></li></ol><p>ä¾æ¬¡æ‰§è¡Œä¸‹åˆ—å‘½ä»¤ï¼Œä¸»è¦æ˜¯æ›´æ–°å®‰è£…ç›¸å…³ä¾èµ–ï¼Œä¸‹è½½pipç®¡ç†ä¾èµ–å·¥å…·</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt-get update<br>sudo apt-get upgrade<br>sudo apt-get install git<br>sudo apt-get install python-pip<br>sudo pip install --upgrade pip<br>sudo pip install -U os-testr  # sudo pip install wcwidth å¯é€‰ï¼Œå¦‚æœè¿™ä¸€æ­¥å‡ºäº†wcwidthç›¸å…³çš„errorçš„è¯<br></code></pre></td></tr></table></figure><ol start="5"><li><strong>è®¾ç½®æ—¶åŒºåŒæ­¥</strong></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt-get install ntpdate // å®‰è£…æ—¶é—´åŒæ­¥å·¥å…·<br>sudo ntpdate cn.pool.ntp.org // ä¸ç½‘ç»œæœåŠ¡å™¨åŒæ­¥æ—¶é—´<br>date // æŸ¥çœ‹æ—¶é—´æ˜¯å¦å·²ç»åŒæ­¥<br></code></pre></td></tr></table></figure><ol start="6"><li><strong>ä¸‹è½½devstack</strong></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> git <span class="hljs-built_in">clone</span> https://github.com/openstack/devstack.git -b stable/queens</span> <br><span class="hljs-meta">#</span><span class="bash"> æ¨èä½¿ç”¨opendev.orgå®˜ç½‘çš„wallbyè¿™ä¸ªåˆ†æ”¯ï¼Œgithubä¸Šå¯¹åº”çš„queensè¿™ä¸ªåˆ†æ”¯å°è¯•è¿‡æœ‰é—®é¢˜è§£å†³ä¸äº†</span><br>git clone https://opendev.org/openstack/devstack.git -b stable/wallaby <br></code></pre></td></tr></table></figure><ol start="7"><li><strong>åˆ›å»ºstackç”¨æˆ·</strong></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo devstack/tools/create-stack-user.sh<br></code></pre></td></tr></table></figure><ol start="8"><li><strong>ç§»åŠ¨å¹¶è®¾ç½®æ–‡ä»¶å¤¹æƒé™</strong></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo mv devstack /opt/stack<br>sudo chown -R stack:stack /opt/stack<br>sudo chown stack:stack /opt/stack<br></code></pre></td></tr></table></figure><ol start="9"><li><strong>åˆ‡æ¢åˆ°stackç”¨æˆ·</strong></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo su - stack<br></code></pre></td></tr></table></figure><ol start="10"><li><strong>åˆ›å»ºlocal.confé…ç½®æ–‡ä»¶</strong></li></ol><p>æ‰§è¡Œä¸‹åˆ—å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd devstack<br>vim local.conf<br></code></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œ<strong>æ³¨æ„ä¿®æ”¹HOST_IP</strong>ï¼Œæ”¹æˆè‡ªå·±å½“å‰çš„IPï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs shell">[[local|localrc]]<br><span class="hljs-meta">#</span><span class="bash"> Define images to be automatically downloaded during the DevStack built process.</span><br>DOWNLOAD_DEFAULT_IMAGES=False<br>IMAGE_URLS=&quot;http://download.cirros-cloud.net/0.3.4/cirros-0.3.4-x86_64-disk.img&quot;<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> use TryStack git mirror</span><br>GIT_BASE=http://git.trystack.cn<br>NOVNC_REPO=http://git.trystack.cn/kanaka/noVNC.git<br>SPICE_REPO=http://git.trystack.cn/git/spice/sice-html5.git<br><span class="hljs-meta"></span><br><span class="hljs-meta">#</span><span class="bash"> Credentials</span><br>[[local|localrc]]<br>ADMIN_PASSWORD=admin<br>DATABASE_PASSWORD=$ADMIN_PASSWORD<br>RABBIT_PASSWORD=$ADMIN_PASSWORD<br>SERVICE_PASSWORD=$ADMIN_PASSWORD<br><span class="hljs-meta">#</span><span class="bash"> Host IP - get your Server/VM IP address from ip addr <span class="hljs-built_in">command</span></span><br>HOST_IP=192.168.10.112 # ifconfigè·å–æœ¬æœºip<br>enable_service placement-api<br>enable_service placement-client<br></code></pre></td></tr></table></figure><ol start="11"><li><strong>æå‰ä¸‹è½½ä¾èµ–åŒ…</strong></li></ol><p>å› ä¸ºæ˜¯ä»githubä¸Šè¿æ¥ä¸‹è½½ä¾èµ–åŒ…ï¼Œå¯èƒ½ç”±äºç½‘ç»œä¸å¥½çš„é—®é¢˜ï¼Œç›´æ¥å®‰è£…çš„è¯å¯èƒ½ä¸­é€”ä¼šå› ä¸ºä¸‹è½½å¤±è´¥å¯¼è‡´å®‰è£…å¤±è´¥ï¼Œæ‰€ä»¥è¿™é‡Œæå‰ä¸‹è½½ï¼›å¦‚æœä¸‹è½½å¤±è´¥äº†ï¼Œå°±å¤šæ‰§è¡Œå‡ æ¬¡ï¼Œè‚¯å®šæ˜¯å¯ä»¥çš„</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd files/<br>wget -c https://github.com/coreos/etcd/releases/download/v3.1.10/etcd-v3.1.10-linux-amd64.tar.gz<br>wget -c https://github.com/coreos/etcd/releases/download/v3.1.7/etcd-v3.1.7-linux-amd64.tar.gz<br>wget -c https://github.com/etcd-io/etcd/releases/download/v3.3.12/etcd-v3.3.12-linux-amd64.tar.gz<br></code></pre></td></tr></table></figure><ol start="12"><li><strong>å®‰è£…simplejson</strong></li></ol><p>ç»è¿‡æµ‹è¯•ï¼Œä¹‹åå®‰è£…çš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šæŠ¥é”™simplejsonå®‰è£…å¤±è´¥ï¼Œæ‰€ä»¥è¿™é‡Œæå‰è¿›è¡Œå®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> sudo apt-get purge python3-simplejson æ¸…æ¥šä¹‹å‰çš„è½¯ä»¶åŒ…å’Œé…ç½®</span><br>sudo apt-get install python3-simplejson<br><span class="hljs-meta">#</span><span class="bash"> sudo apt-get install python-simplejson <span class="hljs-comment"># ä¸Šé¢çš„å‘½ä»¤ä¸è¡Œå¯ä»¥è¯•ä¸‹è¿™ä¸ª</span></span><br></code></pre></td></tr></table></figure><ol start="13"><li><strong>ä¿®æ”¹pipå®‰è£…é…ç½®</strong></li></ol><p class='note note-info'>  åœ¨æµ‹è¯•ä¸­ï¼Œpipç›¸å…³å®‰è£…å¯èƒ½ä¼šæŠ¥é”™ï¼Œè¿™é‡Œæå‰ä¿®æ”¹ä¸‹</p><p>ä¿®æ”¹å¯¹åº”çš„ç›®å½•æ–‡ä»¶ <code>devstack/inc/python file 198 line</code></p><p>æºä»£ç  <code>$cmd_pip $upgrade</code></p><p>ä¿®æ”¹æˆ <code>$cmd_pip $upgrade --ignore-installed</code></p><ol start="14"><li><strong>ä¿®æ”¹æƒé™</strong></li></ol><p>ç»è¿‡æµ‹è¯•ï¼Œä¹‹åå®‰è£…çš„è¿‡ç¨‹å¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹æƒé™é”™è¯¯çš„é”™è¯¯ï¼Œæ‰€ä»¥è¿™é‡Œå†æ¬¡ä¿®æ”¹æƒé™</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110082049771.png" alt="pipä¸‹è½½æŠ¥é”™" /></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo chown -R stack:stack /opt/stack<br>sudo chown stack:stack /opt/stack<br>sudo chown -R stack:stack /opt/stack/devstack<br><span class="hljs-meta">#</span><span class="bash"> sudo chmod -R 777 /opt/stack  <span class="hljs-comment"># å…ˆç”¨å‰ä¸‰ä¸ªå‘½ä»¤åº”è¯¥è¶³å¤Ÿäº†ï¼Œä¸è¡Œå†è¯•è¯•è¿™ä¸ª</span></span><br></code></pre></td></tr></table></figure><ol start="15"><li><strong>å¼€å§‹å®‰è£…</strong></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd ..<br>FORCE=yes ./stack.sh<br></code></pre></td></tr></table></figure><p>å¯èƒ½å› ä¸ºç½‘ç»œçš„åŸå› ï¼Œä¸­é€”ä¼šè¿æ¥ä¸ä¸Šgithubï¼Œå¯¼è‡´å®‰è£…å¤±è´¥ï¼Œè¿™æ ·å°±éœ€è¦é‡æ–°å°è¯•ï¼Œå…ˆæ¸…ç†ä¸‹ç¯å¢ƒå†å®‰è£…ï¼Œå¤šå°è¯•å‡ æ¬¡åº”è¯¥éƒ½ä¼šæˆåŠŸçš„ï¼Œä¸è¿‡ç¡®ä¿ç½‘ç»œè´¨é‡ä¹Ÿæ¯”è¾ƒé‡è¦ã€‚</p><p>å¦‚æœæ˜¯å› ä¸ºä¸‹è½½githubä¸ŠæŸä¸ªä¾èµ–åŒ…å¯¼è‡´çš„å¤±è´¥ï¼Œå¯ä»¥äº‹å…ˆå®‰è£…å¥½å¯¹åº”çš„ä¾èµ–ï¼Œä½¿ç”¨pipå‘½ä»¤ä¸‹è½½å³å¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">./unstack.sh<br>./clean.sh<br>FORCE=yes ./stack.sh<br></code></pre></td></tr></table></figure><ol start="16"><li><strong>è§è¯å¥‡è¿¹çš„æ—¶åˆ»</strong></li></ol><p>å½“ä½ çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯çš„æ—¶å€™ï¼Œæ­å–œä½ ï¼Œå®Œæˆå®‰è£…~</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110081954141.(null)" alt="æˆåŠŸæˆªå›¾" /></p><ol start="17"><li><strong>openstackç•Œé¢å±•ç¤º</strong></li></ol><p>å…·ä½“å¦‚ä½•ä½¿ç”¨openstackï¼Œè¿™é‡Œå°±ä¸å†è¯¦ç»†æ¼”ç¤ºï¼ŒopenstackåŠŸèƒ½å¤§å®¶å°±è‡ªè¡Œåœ°å¿«ä¹ç©è€å§~</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110081954271.(null)" alt="openstackç•Œé¢å±•ç¤º" /></p><h1 id="ç»“è¯­"><a class="markdownIt-Anchor" href="#ç»“è¯­"></a> ç»“è¯­</h1><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œdevstackçš„å®‰è£…æ•™ç¨‹å°±åˆ°æ­¤ç»“æŸäº†ï¼Œå¦‚æœå®‰è£…ä¸Šé¢çš„æ­¥éª¤æˆåŠŸäº†ï¼Œæ­å–œä½ æˆ‘çš„æœ‹å‹ï¼</p><div align='center'><img src='https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110082121023.jpeg' width='30%' height='30%' > </div><p>å½“ç„¶å¦‚æœå‡ºç°äº†åˆ«çš„é—®é¢˜æ— æ³•è§£å†³çš„è¯ï¼Œå¯ä»¥è¯„è®ºç•™ä¸‹ä½ çš„é—®é¢˜ï¼Œæˆ–è€…ä¸æˆ‘è”ç³»ã€‚</p><hr /><p>å¦‚æœçœŸçš„å±±ç©·æ°´å°½äº†çš„è¯ï¼Œmicrostack å®˜ç½‘æ•™ç¨‹å€¼å¾—ä½ çš„æ‹¥æœ‰~</p><p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202110082124003.png" alt="" /></p><h1 id="å‚è€ƒ"><a class="markdownIt-Anchor" href="#å‚è€ƒ"></a> å‚è€ƒ</h1><p><a href="https://blog.csdn.net/hunjiancuo5340/article/details/85005995">https://blog.csdn.net/hunjiancuo5340/article/details/85005995</a></p><p><a href="https://blog.csdn.net/u013184378/article/details/84973629">https://blog.csdn.net/u013184378/article/details/84973629</a></p><p><a href="http://www.cnblogs.com/lianshuiwuyi/p/10955041.html">http://www.cnblogs.com/lianshuiwuyi/p/10955041.html</a></p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¯å¢ƒæ­å»ºç³»åˆ—</category>
      
    </categories>
    
    
    <tags>
      
      <tag>devstack</tag>
      
      <tag>ç¯å¢ƒæ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¸¸æˆç‹å°è¯æ”¶å½•</title>
    <link href="/2021/09/30/2021-09/2021-09-30%20%E6%B8%B8%E6%88%8F%E7%8E%8B%E5%8F%B0%E8%AF%8D%E6%94%B6%E5%BD%95/"/>
    <url>/2021/09/30/2021-09/2021-09-30%20%E6%B8%B8%E6%88%8F%E7%8E%8B%E5%8F%B0%E8%AF%8D%E6%94%B6%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h1 id="æ¸¸æˆç‹"><a class="markdownIt-Anchor" href="#æ¸¸æˆç‹"></a> æ¸¸æˆç‹</h1><h2 id="å‡¯æ’’äº®"><a class="markdownIt-Anchor" href="#å‡¯æ’’äº®"></a> å‡¯æ’’äº®</h2><p>å› ä¸ºä¹‹å‰ä¹Ÿå…¥å‘è¿‡æ¸¸æˆç‹å†³æ–—é“¾æ¥å›½é™…æœï¼Œä¹Ÿå°±ç»„è¿‡æœˆå…‰ã€ä¸çŸ¥ç«ã€ç”µå­é¾™ä¸‰å¥—ç‰Œç»„ï¼Œç”µå­é¾™æ˜¯æˆ‘é€€å‘å‰æœ€åç»„çš„å¡ç»„ï¼Œå› æ­¤ä¹Ÿæœ‰ç€ç‰¹æ®Šçš„æ„Ÿæƒ…ã€‚ä¸ä¹…å‰å¬é—»ç”µå­é¾™è¢«å½»åº•å‰ŠåºŸäº†ï¼Œç›´æ¥å…¥åœŸä¸ºå®‰ï¼Œå¿ƒæƒ…ä¹Ÿæ˜¯äº”å‘³æ‚é™ˆï¼Œè¿˜èƒ½ç»§ç»­æŒ£æ‰å—ï¼Ÿ</p><div class="group-image-container"><div class="group-image-row"><div class="group-image-wrap"><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202109301523396.jpg" alt="img" /></div><div class="group-image-wrap"><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202109301531454.jpg" alt="img" /></div></div></div><p><a href="https://www.bilibili.com/video/BV12b4y1C7wC">ã€æ—¥è¯­æ¯æ—¥ä¸€å¥ã€‘å‡¯æ’’äº®ç»å…¸å°è¯æ•™å­¦</a></p><p>Ko re ga, i ki no ku ru ta me no, o re no a ga ki da !</p><img src="https://kingofdark-blog.oss-cn-beijing.aliyuncs.com/picture_backend/picture_backend/img/202109301537861.png" width="50%" height="50%" align="middle" ><p>ä½ åˆæ˜¯å¦‚ä½•å‘¢ï¼Œä½ åˆæ˜¯ä¸ºäº†ä»€ä¹ˆè€Œå¥‹æˆ˜è‡³ä»Šï¼Ÿåªè¦ä¸ºäº†è¾¾åˆ°ç†æƒ³çš„ç»ˆç‚¹ï¼Œå°±ç®—æ˜¯å‘å¾®çš„æŒ£æ‰åˆå¦‚ä½•ï¼Œè¿™å°±æ˜¯æˆ‘æ‰€é€‰æ‹©çš„é“è·¯ï¼ï¼</p>]]></content>
    
    
    <categories>
      
      <category>å¨±ä¹</category>
      
      <category>åŠ¨æ¼«</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¸¸æˆç‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hexo + Fluidä¸»é¢˜åšå®¢æ­å»º</title>
    <link href="/2021/09/28/2021-09/2021-09-28%20%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"/>
    <url>/2021/09/28/2021-09/2021-09-28%20%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a class="markdownIt-Anchor" href="#å‰è¨€"></a> å‰è¨€</h1><p>å…¶å®è¿™ä¸ªå‰è¨€åº”è¯¥å«åšâ€åè®°â€œäº†ï¼Œä¹‹å‰ä¸€ç›´è¿™ç¯‡æ–‡ç« ä¸€ç›´å¤„äºè‰ç¨¿çš„çŠ¶æ€ï¼Œå¿ƒæƒ³ç€ç­‰åšå®¢ç½‘ç«™æ­£å¼ä¸Šçº¿äº†å†æ”¹ä¹Ÿä¸è¿Ÿï¼Œè¿™ä¸€æ‹–å°±æ˜¯3ã€4ä¸ªæœˆï¼Œå±å®æ˜¯æƒ­æ„§ã€‚ä½†æ¬ ä¸‹çš„å€ºç»ˆå½’æ˜¯è¦å¿è¿˜çš„ï¼Œä¸æ˜¯å—ï¼Ÿ</p><h1 id="åšå®¢æ­å»º"><a class="markdownIt-Anchor" href="#åšå®¢æ­å»º"></a> åšå®¢æ­å»º</h1><p>å…¶å®ç½‘ä¸Šæ­å»ºhexoåšå®¢çš„æ•™ç¨‹å¾ˆå¤šï¼Œæ„Ÿè§‰è‡ªå·±å†é‡å¤é€ è½®å­ä¹Ÿæ²¡ä»€ä¹ˆå¿…è¦ï¼Œå› æ­¤è¿™é‡Œç»™å‡ºæˆ‘åœ¨å­¦ä¹ æ­å»ºåšå®¢è¿‡ç¨‹ä¸­å‚è€ƒçš„ä¸€äº›æ–‡ç« åšå®¢ï¼š</p><ul><li><p><a href="https://evenweiss.github.io/2021-08-02-blog-building/#%E4%B8%80%E3%80%81Github-Pages-%E4%BB%8B%E7%BB%8D%E5%8F%8A%E9%85%8D%E7%BD%AE">åšå®¢æ­å»ºæ•™ç¨‹</a></p></li><li><p><a href="https://www.cnblogs.com/mfrank/p/12829882.html">Hexoåšå®¢éƒ¨ç½²Github Pages</a></p></li><li><p><a href="https://blog.csdn.net/i_do_not_know_you/article/details/105594269">ç»‘å®šåŸŸåçš„é‡åˆ°å‘</a></p></li><li><p><a href="https://hexo.fluid-dev.com/posts/fluid-write/">æ­é… Fluid å¦‚ä½•ä¼˜é›…çš„å†™ä¸€ç¯‡æ–‡ç« </a></p></li></ul><h1 id="è¸©å‘è®°å½•"><a class="markdownIt-Anchor" href="#è¸©å‘è®°å½•"></a> è¸©å‘è®°å½•</h1><ol><li>ç»‘å®šé˜¿é‡Œäº‘çš„topåŸŸåï¼Œè§£ææˆåŠŸçš„é—®é¢˜æ˜¯ï¼šè®¿é—®é€Ÿåº¦å˜å¾—å·¨æ…¢ï¼Œå¹¶ä¸”é¡µé¢æ•ˆæœå¾ˆå·®ï¼Œå›¾ç‰‡å‡ ä¹å±•ç¤ºä¸å‡ºæ¥ï¼›å’Œverceléƒ¨ç½²å‡ºæ¥çš„æ•ˆæœä¸€è‡´ï¼ˆæ˜¯ä¸æ˜¯å­˜åœ¨ä»€ä¹ˆå…±æ€§ï¼Ÿï¼‰</li></ol><ul><li>è¿™ä¸ªé—®é¢˜åé¢ä¹Ÿæ²¡æœ‰è§£å†³ï¼Œä»¤äººæƒ­æ„§ï¼Œä½†æˆ‘æ„Ÿè§‰æ˜¯éƒ¨ç½²åœ¨å¢ƒå¤–æœåŠ¡å™¨çš„é—®é¢˜ï¼Ÿ</li></ul><hr /><ol start="2"><li>å½“åˆ é™¤é˜¿é‡Œäº‘åŸŸåè§£æç›¸å…³è®°å½•åï¼Œ<a href="http://xn--2017zhangyuxuan-1u97bj59g.github.io">è®¿é—®2017zhangyuxuan.github.io</a> ä¾ç„¶ä¼šè·³è½¬åˆ°æ³¨å†Œçš„åŸŸåä¸Škingofdark.topï¼Œç„¶åæŠ¥é”™HTTP 502</li></ol><ul><li>è¿‡äº†ä¸€å¤©ä¹‹åå¥½åƒæ­£å¸¸äº†ï¼Œåº”è¯¥æ˜¯DNSè§£æç¼“å­˜çš„é—®é¢˜ã€‚</li></ul><hr /><ol start="3"><li>å–æ¶ˆWalineè¯„è®ºæ—¶æ˜¾ç¤ºæµè§ˆå™¨å†…æ ¸ä¸æ“ä½œç³»ç»Ÿä¿¡æ¯</li></ol><ul><li>hexo-theme-fluid/source/css/main.styl è·¯å¾„ä¸‹æ·»åŠ ä»¥ä¸‹é…ç½® (ä¸è¿‡å¥½åƒåªæœ‰æœ¬åœ°é¢„è§ˆæœ‰æ•ˆï¼Œéƒ¨ç½²åˆ°Github pagesä¸Šä¾ç„¶ä¸ç”Ÿæ•ˆï¼›åœ¨Verceléƒ¨ç½²çš„ï¼ŒåŒæ ·ä¹Ÿå·²ç»ç”Ÿæ•ˆäº†)</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.vmeta</span> &#123;<br>  <span class="hljs-attribute">display</span>:none;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æ›´å¥½çš„åšæ³•æ˜¯åœ¨æœåŠ¡ç«¯é…ç½® DISABLE_USERAGENT ç¯å¢ƒå˜é‡ä¸ºtrueï¼›é‡æ–°éƒ¨ç½²åå¾—åˆ°æ–°çš„server urlï¼Œä¸€å®šè¦è®°å¾—æŠŠè¿™ä¸ªserver urlå¡«å†™åˆ°_config.fluid.ymlæ–‡ä»¶ä¸­ï¼Œæ›´æ–°ï¼ï¼ è¿™é‡Œè¸©äº†ä¸ªå¤§å‘ï¼ï¼</li></ul><hr /><ol start="4"><li>å› ä¸ºæˆ‘æ˜¯ä½¿ç”¨typoraæ¥å†™æœ¬åœ°åšå®¢çš„ï¼Œå†™åšå®¢æ—¶ä¼šéœ€è¦æ’å…¥å›¾ç‰‡ï¼Œå› æ­¤é…ç½®å›¾åºŠè¿˜æ˜¯æŒºæœ‰å¿…è¦çš„ï¼Œä¸‹é¢æ¨èä¸¤ç¯‡æ•™ç¨‹ï¼š</li></ol><ul><li><a href="https://zhuanlan.zhihu.com/p/365829157">Typora+PicGo+Github = Markdownç¼–è¾‘å™¨+å›¾åºŠ</a></li><li><a href="https://www.jianshu.com/p/1059cc94d63d">picgo + gitee é…ç½®</a></li></ul><h1 id="è¿›é˜¶æ”¹åŠ¨"><a class="markdownIt-Anchor" href="#è¿›é˜¶æ”¹åŠ¨"></a> è¿›é˜¶æ”¹åŠ¨</h1><p>å½“èƒ½å¤Ÿæ­£å¸¸æ­å»ºèµ·æœ¬åœ°åšå®¢åï¼Œå¯ä»¥å°è¯•ä¸€äº›è¿›é˜¶æ”¹åŠ¨ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢å‡ ç¯‡æ–‡ç« ï¼š</p><ul><li><p><a href="https://github.com/qixa/hexo-theme-fluid-mod#%E8%AF%A6%E7%BB%86%E4%BF%AE%E6%94%B9%E4%BF%A1%E6%81%AF">Fluidä¸»é¢˜è¿›é˜¶ä¿®æ”¹ç‰ˆ</a></p></li><li><p><a href="https://2017zhangyuxuan.github.io/2022/02/13/2022-02/2022-02-13%20%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AEHexo%E5%8D%9A%E5%AE%A2/">é˜¿é‡Œäº‘æœåŠ¡å™¨é…ç½®Hexoåšå®¢</a></p></li><li><p><a href="https://www.julydate.com/post/60859300/#%E6%80%BB%E7%BB%93">CDNåŠ é€Ÿ</a></p></li><li><p><a href="https://github.com/cjh0613/hexo-submit-urls-to-search-engine">ç½‘ç«™SEOä¼˜åŒ–</a></p></li></ul><hr /><p>æœ€åé™„ä¸Šæˆ‘å½“æ—¶çš„å¿ƒè·¯å†ç¨‹ï¼šå¿ƒæ€å´©äº†ï¼Œå¼„äº†å‡ å¤©ä¹Ÿæ²¡ç»‘å®šä¸Šè‡ªå·±çš„åŸŸåï¼Œç„¶åCDNåŠ é€Ÿä¹Ÿéœ€è¦é…ç½®è‡ªå·±çš„åŸŸåï¼Œåæ¥æƒ³æƒ³è¿˜æ˜¯ç®—äº†ï¼Œæ¯•ç«Ÿåšå®¢è¿˜æ˜¯å†…å®¹æœ€é‡è¦ï¼Œåƒæ˜¯é¡µé¢çš„ç¾è§‚æˆ–è€…æ˜¯ç½‘ç«™åŠ è½½é€Ÿåº¦éƒ½æ˜¯å…¶æ¬¡äº†ï¼Œä¸‹æ¬¡ä¸€å®šã€‚ï¼ˆä¹Ÿåªèƒ½è¿™æ ·å®‰æ…°è‡ªå·±äº†ï¼Œæµä¸‹äº†æ— èƒ½çš„æ³ªæ°´ï¼‰</p><center><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fww4.sinaimg.cn%2Fbmiddle%2F9150e4e5ly1fkonbtgn8aj20qo0qomyg.jpg&refer=http%3A%2F%2Fwww.sina.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1647397220&t=7ee46f97d55b16b2e4057e967d3fc105" alt="" style="zoom:67%;" /></center><p class='note note-primary' >  <font size='4'>     æœ€åæ€»ç»“æ¥è¯´ï¼Œå†™åšå®¢ï¼Œæœ€é‡è¦çš„è¿˜æ˜¯æŒä¹‹ä»¥æ’ï¼Œè¿˜æ˜¯äº§å‡ºå†…å®¹ï¼Œä¸èƒ½æœ¬æœ«å€’ç½®ï¼Œæ¡äº†èŠéº»ä¸¢äº†è¥¿ç“œã€‚  </font></p>]]></content>
    
    
    <categories>
      
      <category>è®¡ç®—æœºçŸ¥è¯†</category>
      
      <category>ç¯å¢ƒæ­å»ºç³»åˆ—</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åšå®¢æ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2021/09/25/2021-09/2021-09-25%20hello-world/"/>
    <url>/2021/09/25/2021-09/2021-09-25%20hello-world/</url>
    
    <content type="html"><![CDATA[<p>æœ€åˆçš„åšå®¢ï¼Œçºªå¿µé‚£ä»½æ¢ç´¢æ–°äº‹ç‰©çš„æ¿€åŠ¨ä¸å–œæ‚¦ï¼Œä¹Ÿæ˜¯å‘Šè¯‰è‡ªå·±ä¸å¿˜åˆå¿ƒã€‚</p><p>Hello world !</p><p>I will be the best animation lover who is able to save the world !</p>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
